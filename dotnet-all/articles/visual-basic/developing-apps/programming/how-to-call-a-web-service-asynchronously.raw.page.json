{"content":"<div><div class=\"content\">\n<p>This example attaches a handler to a Web service&#39;s asynchronous handler event, so that it can retrieve the result of an asynchronous method call. This example used the DemoTemperatureService Web service at <a href=\"http://www.xmethods.net\" data-linktype=\"external\">http://www.xmethods.net</a>.  </p>\n<p> When you reference a Web service in your project in the Visual Studio Integrated Development Environment (IDE), it is added to the <code>My.WebServices</code> object, and the IDE generates a client proxy class to access a specified Web service  </p>\n<p> The proxy class allows you to call the Web service methods synchronously, where your application waits for the function to complete. In addition, the proxy creates additional members to help call the method asynchronously. For each Web service function, <em>NameOfWebServiceFunction</em>, the proxy creates a <em>NameOfWebServiceFunction</em><code>Async</code> subroutine, a <em>NameOfWebServiceFunction</em><code>Completed</code> event, and a <em>NameOfWebServiceFunction</em><code>CompletedEventArgs</code> class. This example demonstrates how to use the asynchronous members to access the <code>getTemp</code> function of the DemoTemperatureService Web service.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> This code does not work in Web applications, because ASP.NET does not support the <code>My.WebServices</code> object.  </p>\n</div>\n<h3 id=\"to-call-a-web-service-asynchronously\">To call a Web service asynchronously</h3>\n<ol>\n<li><p>Reference the DemoTemperatureService Web service at <a href=\"http://www.xmethods.net\" data-linktype=\"external\">http://www.xmethods.net</a>. The address is  </p>\n<pre class=\"loading\"><code>http://www.xmethods.net/sd/2001/DemoTemperatureService.wsdl  \n</code></pre></li>\n<li><p>Add an event handler for the <code>getTempCompleted</code> event:  </p>\n<pre class=\"loading\"><code>Private Sub getTempCompletedHandler(ByVal sender As Object,   \n    ByVal e As net.xmethods.www.getTempCompletedEventArgs)  \n\n    MsgBox(&quot;Temperature: &quot; &amp; e.Result)  \nEnd Sub  \n</code></pre><div class=\"NOTE\"><h5>Note</h5><p> You cannot use the <code>Handles</code> statement to associate an event handler with the <code>My.WebServices</code> object&#39;s events.  </p>\n</div>\n</li>\n<li><p>Add a field to track if the event handler has been added to the <code>getTempCompleted</code> event:  </p>\n<pre class=\"loading\"><code>Private handlerAttached As Boolean = False  \n</code></pre></li>\n<li><p>Add a method to add the event handler to the <code>getTempCompleted</code> event, if necessary, and to call the <code>getTempAsynch</code> method:  </p>\n<pre class=\"loading\"><code>Sub CallGetTempAsync(ByVal zipCode As Integer)  \n    If Not handlerAttached Then  \n        AddHandler My.WebServices.  \n            TemperatureService.getTempCompleted,   \n            AddressOf Me.TS_getTempCompleted  \n        handlerAttached = True  \n    End If  \n    My.WebServices.TemperatureService.getTempAsync(zipCode)  \nEnd Sub  \n</code></pre><p> To call the <code>getTemp</code> Web method asynchronously, call the <code>CallGetTempAsync</code> method. When the Web method finishes, its return value is passed to the <code>getTempCompletedHandler</code> event handler.  </p>\n</li>\n</ol>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"accessing-application-web-services\" data-linktype=\"relative-path\">Accessing Application Web Services</a><br> <a href=\"../../language-reference/objects/my-webservices-object\" data-linktype=\"relative-path\">My.WebServices Object</a></p>\n</div></div>","outputRootRelativePath":"../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"uhfHeaderId\" content=\"MSDocsHeader-DotNet\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"ff8046f4-f1f2-4d8b-90b7-95e3f7415418\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"14\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/developing-apps/programming/how-to-call-a-web-service-asynchronously.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/developing-apps/programming/how-to-call-a-web-service-asynchronously.md\">\r\n<meta name=\"document_id\" content=\"4a2aa9b3-fea0-7339-2f00-057cb8eaddab\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../../toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","uhfHeaderId":"MSDocsHeader-DotNet","title":"How to: Call a Web Service Asynchronously (Visual Basic) | Microsoft Docs","ms.suite":"","ms.assetid":"ff8046f4-f1f2-4d8b-90b7-95e3f7415418","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":14,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["asynchronous calls","Web services, accessing"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/developing-apps/programming/how-to-call-a-web-service-asynchronously.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/developing-apps/programming/how-to-call-a-web-service-asynchronously.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/developing-apps/programming/how-to-call-a-web-service-asynchronously.md","document_id":"4a2aa9b3-fea0-7339-2f00-057cb8eaddab","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/developing-apps/programming/how-to-call-a-web-service-asynchronously","toc_asset_id":"articles/toc.json","toc_rel":"../../../toc.json","_op_ogTitle":"How to: Call a Web Service Asynchronously (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":319,"_op_rawTitle":"<h1 id=\"how-to-call-a-web-service-asynchronously-visual-basic\" sourcefile=\"docs/visual-basic/developing-apps/programming/how-to-call-a-web-service-asynchronously.md\" sourcestartlinenumber=\"37\" sourceendlinenumber=\"37\">How to: Call a Web Service Asynchronously (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/developing-apps/programming/how-to-call-a-web-service-asynchronously","fileRelativePath":"articles/visual-basic/developing-apps/programming/how-to-call-a-web-service-asynchronously.html"},"themesRelativePathToOutputRoot":"_themes/"}