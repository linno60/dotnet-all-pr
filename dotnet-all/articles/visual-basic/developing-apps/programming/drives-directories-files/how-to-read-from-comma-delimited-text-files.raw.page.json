{"content":"<div><div class=\"content\">\n<p>The <code>TextFieldParser</code> object provides a way to easily and efficiently parse structured text files, such as logs. The <code>TextFieldType</code> property defines whether it is a delimited file or one with fixed-width fields of text.  </p>\n<h3 id=\"to-parse-a-comma-delimited-text-file\">To parse a comma delimited text file</h3>\n<ol>\n<li><p>Create a new <code>TextFieldParser</code>. The following code creates the <code>TextFieldParser</code> named <code>MyReader</code> and opens the file <code>test.txt</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbFileIORead#15\">Using MyReader As New Microsoft.VisualBasic.\n                      FileIO.TextFieldParser(\n                        &quot;C:\\TestFolder\\test.txt&quot;)\n</code></pre></li>\n<li><p>Define the <code>TextField</code> type and delimiter. The following code defines the <code>TextFieldType</code> property as <code>Delimited</code> and the delimiter as &quot;,&quot;.  </p>\n<pre><code class=\"lang-vb\" name=\"VbFileIORead#16\">MyReader.TextFieldType = FileIO.FieldType.Delimited\nMyReader.SetDelimiters(&quot;,&quot;)\n</code></pre></li>\n<li><p>Loop through the fields in the file. If any lines are corrupt, report an error and continue parsing. The following code loops through the file, displaying each field in turn and reporting any fields that are formatted incorrectly.  </p>\n<pre><code class=\"lang-vb\" name=\"VbFileIORead#17\">\nDim currentRow As String()\n   While Not MyReader.EndOfData\n      Try\n         currentRow = MyReader.ReadFields()\n         Dim currentField As String\n         For Each currentField In currentRow\n            MsgBox(currentField)\n         Next\n         Catch ex As Microsoft.VisualBasic.\n                     FileIO.MalformedLineException\n           MsgBox(&quot;Line &quot; &amp; ex.Message &amp;\n           &quot;is not valid and will be skipped.&quot;)\n     End Try\n</code></pre></li>\n<li><p>Close the <code>While</code> and <code>Using</code> blocks with <code>End While</code> and <code>End Using</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbFileIORead#18\">   End While\nEnd Using\n</code></pre></li>\n</ol>\n<h2 id=\"example\">Example</h2>\n<p> This example reads from the file <code>test.txt</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbFileIORead#19\">  Using MyReader As New Microsoft.VisualBasic.\n                        FileIO.TextFieldParser(\n                          &quot;C:\\TestFolder\\test.txt&quot;)\n   MyReader.TextFieldType = FileIO.FieldType.Delimited\n   MyReader.SetDelimiters(&quot;,&quot;)\n   Dim currentRow As String()\n   While Not MyReader.EndOfData\n      Try\n         currentRow = MyReader.ReadFields()\n         Dim currentField As String\n         For Each currentField In currentRow\n            MsgBox(currentField)\n         Next\n      Catch ex As Microsoft.VisualBasic.\n                  FileIO.MalformedLineException\n        MsgBox(&quot;Line &quot; &amp; ex.Message &amp;\n        &quot;is not valid and will be skipped.&quot;)\n      End Try\n   End While\nEnd Using\n</code></pre><h2 id=\"robust-programming\">Robust programming</h2>\n<p> The following conditions may cause an exception:  </p>\n<ul>\n<li><p>A row cannot be parsed using the specified format (<a class=\"xref\" href=\"../../../../../api/microsoft.visualbasic.fileio.malformedlineexception\" data-linktype=\"relative-path\">MalformedLineException</a>). The exception message specifies the line causing the exception, while the <a class=\"xref\" href=\"../../../../../api/microsoft.visualbasic.fileio.textfieldparser#Microsoft_VisualBasic_FileIO_TextFieldParser_ErrorLine_\" data-linktype=\"relative-path\">ErrorLine</a> property is assigned the text contained in the line.  </p>\n</li>\n<li><p>The specified file does not exist (<a class=\"xref\" href=\"../../../../../api/system.io.filenotfoundexception\" data-linktype=\"relative-path\">FileNotFoundException</a>).  </p>\n</li>\n<li><p>A partial-trust situation in which the user does not have sufficient permissions to access the file. (<a class=\"xref\" href=\"../../../../../api/system.security.securityexception\" data-linktype=\"relative-path\">SecurityException</a>).  </p>\n</li>\n<li><p>The path is too long (<a class=\"xref\" href=\"../../../../../api/system.io.pathtoolongexception\" data-linktype=\"relative-path\">PathTooLongException</a>).  </p>\n</li>\n<li><p>The user does not have sufficient permissions to access the file (<a class=\"xref\" href=\"../../../../../api/system.unauthorizedaccessexception\" data-linktype=\"relative-path\">UnauthorizedAccessException</a>).  </p>\n</li>\n</ul>\n<h2 id=\"see-also\">See also</h2>\n<p> <a class=\"xref\" href=\"../../../../../api/microsoft.visualbasic.fileio.textfieldparser\" data-linktype=\"relative-path\">Microsoft.VisualBasic.FileIO.TextFieldParser</a><br> <a href=\"how-to-read-from-fixed-width-text-files\" data-linktype=\"relative-path\">How to: Read From Fixed-width Text Files</a><br> <a href=\"how-to-read-from-text-files-with-multiple-formats\" data-linktype=\"relative-path\">How to: Read From Text Files with Multiple Formats</a><br> <a href=\"parsing-text-files-with-the-textfieldparser-object\" data-linktype=\"relative-path\">Parsing Text Files with the TextFieldParser Object</a><br> <a href=\"walkthrough-manipulating-files-and-directories\" data-linktype=\"relative-path\">Walkthrough: Manipulating Files and Directories in Visual Basic</a><br> <a href=\"troubleshooting-reading-from-and-writing-to-text-files\" data-linktype=\"relative-path\">Troubleshooting: Reading from and Writing to Text Files</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"uhfHeaderId\" content=\"MSDocsHeader-DotNet\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"a8413fe4-0dba-49c8-8692-44fb67a9ec4f\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"19\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md\">\r\n<meta name=\"document_id\" content=\"2efbae3e-c419-4956-62de-3e32214e9062\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","uhfHeaderId":"MSDocsHeader-DotNet","title":"How to: read from comma-delimited text files in Visual Basic | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"a8413fe4-0dba-49c8-8692-44fb67a9ec4f","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":19,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["files, parsing","text files, tasks","reading text files, comma-delimited","text files, reading"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Fixes miscellaneous issues in VB content (#1268)","commit_sha":"0ca80554a76b1162be2607a073c5b94e31c7a834","commit_date":"2016-11-22 09:44:20 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md","document_id":"2efbae3e-c419-4956-62de-3e32214e9062","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files","toc_asset_id":"articles/visual-basic/developing-apps/programming/drives-directories-files/toc.json","toc_rel":"toc.json","_op_ogTitle":"How to: read from comma-delimited text files in Visual Basic","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":365,"_op_rawTitle":"<h1 id=\"how-to-read-from-comma-delimited-text-files-in-visual-basic\" sourcefile=\"docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md\" sourcestartlinenumber=\"39\" sourceendlinenumber=\"39\">How to: read from comma-delimited text files in Visual Basic</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files","fileRelativePath":"articles/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.html"},"themesRelativePathToOutputRoot":"_themes/"}