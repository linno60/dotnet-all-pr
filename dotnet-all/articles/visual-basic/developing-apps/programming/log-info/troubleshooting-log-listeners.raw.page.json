{"content":"<div><div class=\"content\">\n<p>You can use the <code>My.Application.Log</code> and <code>My.Log</code> objects to log information about events that occur in your application.  </p>\n<p> To determine which log listeners receive those messages, see <a href=\"walkthrough-determining-where-my-application-log-writes-information\" data-linktype=\"relative-path\">Walkthrough: Determining Where My.Application.Log Writes Information</a>.  </p>\n<p> The <code>Log</code> object can use log filtering to limit the amount of information that it logs. If the filters are misconfigured, the logs might contain the wrong information. For more information about filtering, see <a href=\"walkthrough-filtering-my-application-log-output\" data-linktype=\"relative-path\">Walkthrough: Filtering My.Application.Log Output</a>.  </p>\n<p> However, if a log is configured incorrectly, you may need more information about its current configuration. You can get to this information through the log&#39;s advanced <code>TraceSource</code> property.  </p>\n<h3 id=\"to-determine-the-log-listeners-for-the-log-object-in-code\">To determine the log listeners for the Log object in code</h3>\n<ol>\n<li><p>Import the <a class=\"xref\" href=\"../../../../../api/system.diagnostics\" data-linktype=\"relative-path\">System.Diagnostics</a> namespace at the beginning of the code file. For more information, see <a href=\"../../../language-reference/statements/imports-statement-net-namespace-and-type\" data-linktype=\"relative-path\">Imports Statement (.NET Namespace and Type)</a>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrMyApplicationLog#13\">Imports System.Diagnostics\n</code></pre></li>\n<li><p>Create a function that returns a string consisting of information for each of the log&#39;s listeners.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrMyApplicationLog#14\">    Function GetListeners(ByVal listeners As TraceListenerCollection) As String\n        Dim ret As String = &quot;&quot;\n        For Each listener As TraceListener In listeners\n            ret &amp;= listener.Name\n            Dim listenerType As Type = listener.GetType\n            If listenerType Is GetType(DefaultTraceListener) Then\n                Dim tmp As DefaultTraceListener = \n                    DirectCast(listener, DefaultTraceListener)\n                ret &amp;= &quot;: Writes to the debug output.&quot;\n            ElseIf listenerType Is GetType(Logging.FileLogTraceListener) Then\n                Dim tmp As Logging.FileLogTraceListener = \n                    DirectCast(listener, Logging.FileLogTraceListener)\n                ret &amp;= &quot;: Log filename: &quot; &amp; tmp.FullLogFileName\n            ElseIf listenerType Is GetType(EventLogTraceListener) Then\n                Dim tmp As EventLogTraceListener = \n                    DirectCast(listener, EventLogTraceListener)\n                ret &amp;= &quot;: Event log name: &quot; &amp; tmp.EventLog.Log\n            ElseIf listenerType Is GetType(XmlWriterTraceListener) Then\n                Dim tmp As Diagnostics.XmlWriterTraceListener = \n                    DirectCast(listener, XmlWriterTraceListener)\n                ret &amp;= &quot;: XML log&quot;\n            ElseIf listenerType Is GetType(ConsoleTraceListener) Then\n                Dim tmp As ConsoleTraceListener = \n                    DirectCast(listener, ConsoleTraceListener)\n                ret &amp;= &quot;: Console log&quot;\n            ElseIf listenerType Is GetType(DelimitedListTraceListener) Then\n                Dim tmp As DelimitedListTraceListener = \n                    DirectCast(listener, DelimitedListTraceListener)\n                ret &amp;= &quot;: Delimited log&quot;\n            Else\n                ret &amp;= &quot;: Unhandeled log type: &quot; &amp; \n                    listenerType.ToString\n            End If\n            ret &amp;= vbCrLf\n        Next\n\n        Return ret\n    End Function\n</code></pre></li>\n<li><p>Pass the collection of the log&#39;s trace listeners to the <code>GetListeners</code> function, and display the return value.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrMyApplicationLog#19\">        Dim ListenerCollection As TraceListenerCollection\n        ListenerCollection = My.Application.Log.TraceSource.Listeners\n        Dim ListenersText As String = GetListeners(ListenerCollection)\n        MsgBox(ListenersText)\n</code></pre><p> For more information, see <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/ms128199(v=vs.110).aspx\" data-linktype=\"external\">TraceSource</a>.  </p>\n</li>\n</ol>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/microsoft.visualbasic.logging.log(v=vs.110).aspx\" data-linktype=\"external\">Microsoft.VisualBasic.Logging.Log</a><br> <a href=\"working-with-application-logs\" data-linktype=\"relative-path\">Working with Application Logs</a><br> <a href=\"walkthrough-determining-where-my-application-log-writes-information\" data-linktype=\"relative-path\">Walkthrough: Determining Where My.Application.Log Writes Information</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"ac6eb760-3d5d-461e-aedd-40599ee22e49\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"11\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-21 01:42 AM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/developing-apps/programming/log-info/troubleshooting-log-listeners.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/developing-apps/programming/log-info/troubleshooting-log-listeners.md\">\r\n<meta name=\"document_id\" content=\"94f7fac7-b175-1dca-0f3e-6f6953a2e7c0\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Troubleshooting: Log Listeners (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"ac6eb760-3d5d-461e-aedd-40599ee22e49","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":11,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["event logs, troubleshooting","troubleshooting Visual Basic, event logs","troubleshooting event logs"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2017-03-21 01:42 AM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"3/21/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/developing-apps/programming/log-info/troubleshooting-log-listeners.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/developing-apps/programming/log-info/troubleshooting-log-listeners.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/developing-apps/programming/log-info/troubleshooting-log-listeners.md","document_id":"94f7fac7-b175-1dca-0f3e-6f6953a2e7c0","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/developing-apps/programming/log-info/troubleshooting-log-listeners","toc_asset_id":"articles/visual-basic/developing-apps/programming/log-info/toc.json","toc_rel":"toc.json","_op_ogTitle":"Troubleshooting: Log Listeners (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":356,"_op_rawTitle":"<h1 id=\"troubleshooting-log-listeners-visual-basic\" sourcefile=\"docs/visual-basic/developing-apps/programming/log-info/troubleshooting-log-listeners.md\" sourcestartlinenumber=\"38\" sourceendlinenumber=\"38\">Troubleshooting: Log Listeners (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/developing-apps/programming/log-info/troubleshooting-log-listeners","fileRelativePath":"articles/visual-basic/developing-apps/programming/log-info/troubleshooting-log-listeners.html"},"themesRelativePathToOutputRoot":"_themes/"}