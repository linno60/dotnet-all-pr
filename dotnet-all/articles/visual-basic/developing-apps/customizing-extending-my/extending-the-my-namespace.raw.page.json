{"content":"<div><div class=\"content\">\n<p>The <code>My</code> namespace in Visual Basic exposes properties and methods that enable you to easily take advantage of the power of the .NET Framework. The <code>My</code> namespace simplifies common programming problems, often reducing a difficult task to a single line of code. Additionally, the <code>My</code> namespace is fully extensible so that you can customize the behavior of <code>My</code> and add new services to its hierarchy to adapt to specific application needs. This topic discusses both how to customize existing members of the <code>My</code> namespace and how to add your own custom classes to the <code>My</code> namespace.  </p>\n<p> <strong>Topic Contents</strong>  </p>\n<ul>\n<li><p><a href=\"#customizing\" data-linktype=\"self-bookmark\">Customizing Existing My Namespace Members</a>  </p>\n</li>\n<li><p><a href=\"#addingtoobjects\" data-linktype=\"self-bookmark\">Adding Members to My Objects</a>  </p>\n</li>\n<li><p><a href=\"#addingcustom\" data-linktype=\"self-bookmark\">Adding Custom Objects to the My Namespace</a>  </p>\n</li>\n<li><p><a href=\"#addingtonamespace\" data-linktype=\"self-bookmark\">Adding Members to the My Namespace</a>  </p>\n</li>\n<li><p><a href=\"#addingevents\" data-linktype=\"self-bookmark\">Adding Events to Custom My Objects</a>  </p>\n</li>\n<li><p><a href=\"#design\" data-linktype=\"self-bookmark\">Design Guidelines</a>  </p>\n</li>\n<li><p><a href=\"#designing\" data-linktype=\"self-bookmark\">Designing Class Libraries for My</a>  </p>\n</li>\n<li><p><a href=\"#packaging\" data-linktype=\"self-bookmark\">Packaging and Deploying Extensions</a>  </p>\n</li>\n</ul>\n<h2 id=\"a-namecustomizinga-customizing-existing-my-namespace-members\"><a name=\"customizing\"></a> Customizing Existing My Namespace Members</h2>\n<p> The <code>My</code> namespace in Visual Basic exposes frequently used information about your application, your computer, and more. For a complete list of the objects in the <code>My</code> namespace, see <a href=\"../../language-reference/keywords/my-reference\" data-linktype=\"relative-path\">My Reference</a>. You may have to customize existing members of the <code>My</code> namespace so that they better match the needs of your application. Any property of an object in the <code>My</code> namespace that is not read-only can be set to a custom value.  </p>\n<p> For example, assume that you frequently use the <code>My.User</code> object to access the current security context for the user running your application. However, your company uses a custom user object to expose additional information and capabilities for users within the company. In this scenario, you can replace the default value of the <code>My.User.CurrentPrincipal</code> property with an instance of your own custom principal object, as shown in the following example.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbcnExtendingMy#1\">      My.User.CurrentPrincipal = CustomPrincipal\n</code></pre><p> Setting the <code>CurrentPrincipal</code> property on the <code>My.User</code> object changes the identity under which the application runs. The <code>My.User</code> object, in turn, returns information about the newly specified user.  </p>\n<h2 id=\"a-nameaddingtoobjectsa-adding-members-to-my-objects\"><a name=\"addingtoobjects\"></a> Adding Members to My Objects</h2>\n<p> The types returned from <code>My.Application</code> and <code>My.Computer</code> are defined as <code>Partial</code> classes. Therefore, you can extend the <code>My.Application</code> and <code>My.Computer</code> objects by creating a <code>Partial</code> class named <code>MyApplication</code> or <code>MyComputer</code>. The class cannot be a <code>Private</code> class. If you specify the class as part of the <code>My</code> namespace, you can add properties and methods that will be included with the <code>My.Application</code> or <code>My.Computer</code> objects.  </p>\n<p> For example, the following example adds a property named <code>DnsServerIPAddresses</code> to the <code>My.Computer</code> object.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbcnExtendingMy#2\">Imports System.Net.NetworkInformation\n\nNamespace My\n\n  Partial Class MyComputer\n    Friend ReadOnly Property DnsServerIPAddresses() As IPAddressCollection\n      Get\n        Dim dnsAddressList As IPAddressCollection = Nothing\n\n        For Each adapter In System.Net.NetworkInformation.\n          NetworkInterface.GetAllNetworkInterfaces()\n\n          Dim adapterProperties = adapter.GetIPProperties()\n          Dim dnsServers As IPAddressCollection = adapterProperties.DnsAddresses\n          If dnsAddressList Is Nothing Then\n            dnsAddressList = dnsServers\n          Else\n            dnsAddressList.Union(dnsServers)\n          End If\n        Next adapter\n\n        Return dnsAddressList\n      End Get\n    End Property\n  End Class\n\nEnd Namespace\n</code></pre><h2 id=\"a-nameaddingcustoma-adding-custom-objects-to-the-my-namespace\"><a name=\"addingcustom\"></a> Adding Custom Objects to the My Namespace</h2>\n<p> Although the <code>My</code> namespace provides solutions for many common programming tasks, you may encounter tasks that the <code>My</code> namespace does not address. For example, your application might access custom directory services for user data, or your application might use assemblies that are not installed by default with Visual Basic. You can extend the <code>My</code> namespace to include custom solutions to common tasks that are specific to your environment. The <code>My</code> namespace can easily be extended to add new members to meet growing application needs. Additionally, you can deploy your <code>My</code> namespace extensions to other developers as a Visual Basic template.  </p>\n<h3 id=\"a-nameaddingtonamespacea-adding-members-to-the-my-namespace\"><a name=\"addingtonamespace\"></a> Adding Members to the My Namespace</h3>\n<p> Because <code>My</code> is a namespace like any other namespace, you can add top-level properties to it by just adding a module and specifying a <code>Namespace</code> of <code>My</code>. Annotate the module with the <code>HideModuleName</code> attribute as shown in the following example. The <code>HideModuleName</code> attribute ensures that IntelliSense will not display the module name when it displays the members of the <code>My</code> namespace.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbcnExtendingMy#3\">Namespace My\n  &lt;HideModuleName()&gt; \n  Module MyCustomModule\n\n  End Module\nEnd Namespace\n</code></pre><p> To add members to the <code>My</code> namespace, add properties as needed to the module. For each property added to the <code>My</code> namespace, add a private field of type <code>ThreadSafeObjectProvider(Of T)</code>, where the type is the type returned by your custom property. This field is used to create thread-safe object instances to be returned by the property by calling the <code>GetInstance</code> method. As a result, each thread that is accessing the extended property receives its own instance of the returned type. The following example adds a property named <code>SampleExtension</code> that is of type <code>SampleExtension</code> to the <code>My</code> namespace:  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbcnExtendingMy#4\">Namespace My\n  &lt;HideModuleName()&gt; \n  Module MyCustomExtensions\n    Private _extension As New ThreadSafeObjectProvider(Of SampleExtension)\n    Friend ReadOnly Property SampleExtension() As SampleExtension\n      Get\n        Return _extension.GetInstance()\n      End Get\n    End Property\n  End Module\nEnd Namespace\n</code></pre><h2 id=\"a-nameaddingeventsa-adding-events-to-custom-my-objects\"><a name=\"addingevents\"></a> Adding Events to Custom My Objects</h2>\n<p> You can use the <code>My.Application</code> object to expose events for your custom <code>My</code> objects by extending the <code>MyApplication</code> partial class in the <code>My</code> namespace. For Windows-based projects, you can double-click the <strong>My Project</strong> node in for your project in <strong>Solution Explorer</strong>. In the Visual Basic <strong>Project Designer</strong>, click the <code>Application</code> tab and then click the <code>View Application Events</code> button. A new file that is named ApplicationEvents.vb will be created. It contains the following code for extending the <code>MyApplication</code> class.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbcnExtendingMy#5\">Namespace My\n  Partial Friend Class MyApplication\n  End Class\nEnd Namespace\n</code></pre><p> You can add event handlers for your custom <code>My</code> objects by adding custom event handlers to the <code>MyApplication</code> class. Custom events enable you to add code that will execute when an event handler is added, removed, or the event is raised. Note that the <code>AddHandler</code> code for a custom event runs only if code is added by a user to handle the event. For example, consider that the <code>SampleExtension</code> object from the previous section has a <code>Load</code> event that you want to add a custom event handler for. The following code example shows a custom event handler named <code>SampleExtensionLoad</code> that will be invoked when the <code>My.SampleExtension.Load</code> event occurs. When code is added to handle the new <code>My.SampleExtensionLoad</code> event, the <code>AddHandler</code> part of this custom event code is executed. The <code>MyApplication_SampleExtensionLoad</code> method is included in the code example to show an example of an event handler that handles the <code>My.SampleExtensionLoad</code> event. Note that the <code>SampleExtensionLoad</code> event will be available when you select the <strong>My Application Events</strong> option in the left drop-down list above the Code Editor when you are editing the ApplicationEvents.vb file.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbcnExtendingMy#6\">Namespace My\n\n  Partial Friend Class MyApplication\n\n    &#39; Custom event handler for Load event.\n    Private _sampleExtensionHandlers As EventHandler\n\n    Public Custom Event SampleExtensionLoad As EventHandler\n      AddHandler(ByVal value As EventHandler)\n        &#39; Warning: This code is not thread-safe. Do not call\n        &#39; this code from multiple concurrent threads.\n        If _sampleExtensionHandlers Is Nothing Then\n          AddHandler My.SampleExtension.Load, AddressOf OnSampleExtensionLoad\n        End If\n        _sampleExtensionHandlers = \n            System.Delegate.Combine(_sampleExtensionHandlers, value)\n      End AddHandler\n      RemoveHandler(ByVal value As EventHandler)\n        _sampleExtensionHandlers = \n          System.Delegate.Remove(_sampleExtensionHandlers, value)\n      End RemoveHandler\n      RaiseEvent(ByVal sender As Object, ByVal e As EventArgs)\n        If _sampleExtensionHandlers IsNot Nothing Then\n          _sampleExtensionHandlers.Invoke(sender, e)\n        End If\n      End RaiseEvent\n    End Event\n\n    &#39; Method called by custom event handler to raise user-defined\n    &#39; event handlers.\n    &lt;Global.System.ComponentModel.EditorBrowsable( \n         Global.System.ComponentModel.EditorBrowsableState.Advanced)&gt; \n      Protected Overridable Sub OnSampleExtensionLoad( \n                ByVal sender As Object, ByVal e As EventArgs)\n      RaiseEvent SampleExtensionLoad(sender, e)\n    End Sub\n\n    &#39; Event handler to call My.SampleExtensionLoad event.\n    Private Sub MyApplication_SampleExtensionLoad( \n        ByVal sender As Object, ByVal e As System.EventArgs\n        ) Handles Me.SampleExtensionLoad\n\n    End Sub\n  End Class\nEnd Namespace\n</code></pre><h2 id=\"a-namedesigna-design-guidelines\"><a name=\"design\"></a> Design Guidelines</h2>\n<p> When you develop extensions to the <code>My</code> namespace, use the following guidelines to help minimize the maintenance costs of your extension components.  </p>\n<ul>\n<li><p><strong>Include only the extension logic.</strong> The logic included in the <code>My</code> namespace extension should include only the code that is needed to expose the required functionality in the <code>My</code> namespace. Because your extension will reside in user projects as source code, updating the extension component incurs a high maintenance cost and should be avoided if possible.  </p>\n</li>\n<li><p><strong>Minimize project assumptions.</strong> When you create your extensions of the <code>My</code> namespace, do not assume a set of references, project-level imports, or specific compiler settings (for example, <code>Option Strict</code> off). Instead, minimize dependencies and fully qualify all type references by using the <code>Global</code> keyword. Also, ensure that the extension compiles with <code>Option Strict</code> on to minimize errors in the extension.  </p>\n</li>\n<li><p><strong>Isolate the extension code.</strong> Placing the code in a single file makes your extension easily deployable as a Visual Studio item template. For more information, see &quot;Packaging and Deploying Extensions&quot; later in this topic. Placing all the <code>My</code> namespace extension code in a single file or a separate folder in a project will also help users locate the <code>My</code> namespace extension.  </p>\n</li>\n</ul>\n<h2 id=\"a-namedesigninga-designing-class-libraries-for-my\"><a name=\"designing\"></a> Designing Class Libraries for My</h2>\n<p> As is the case with most object models, some design patterns work well in the <code>My</code> namespace and others do not. When designing an extension to the <code>My</code> namespace, consider the following principles:  </p>\n<ul>\n<li><p><strong>Stateless methods.</strong> Methods in the <code>My</code> namespace should provide a complete solution to a specific task. Ensure that the parameter values that are passed to the method provide all the input required to complete the particular task. Avoid creating methods that rely on prior state, such as open connections to resources.  </p>\n</li>\n<li><p><strong>Global instances.</strong> The only state that is maintained in the <code>My</code> namespace is global to the project. For example, <code>My.Application.Info</code> encapsulates state that is shared throughout the application.  </p>\n</li>\n<li><p><strong>Simple parameter types.</strong> Keep things simple by avoiding complex parameter types. Instead, create methods that either take no parameter input or that take simple input types such as strings, primitive types, and so on.  </p>\n</li>\n<li><p><strong>Factory methods.</strong> Some types are necessarily difficult to instantiate. Providing factory methods as extensions to the <code>My</code> namespace enables you to more easily discover and consume types that fall into this category. An example of a factory method that works well is <code>My.Computer.FileSystem.OpenTextFileReader</code>. There are several stream types available in the .NET Framework. By specifying text files specifically, the <code>OpenTextFileReader</code> helps the user understand which stream to use.  </p>\n<p>These guidelines do not preclude general design principles for class libraries. Rather, they are recommendations that are optimized for developers who are using Visual Basic and the <code>My</code> namespace. For general design principles for creating class libraries, see <a href=\"http://msdn.microsoft.com/library/5fbcaf4f-ea2a-4d20-b0d6-e61dee202b4b\" data-linktype=\"external\">Framework Design Guidelines</a>.  </p>\n</li>\n</ul>\n<h2 id=\"a-namepackaginga-packaging-and-deploying-extensions\"><a name=\"packaging\"></a> Packaging and Deploying Extensions</h2>\n<p> You can include <code>My</code> namespace extensions in a Visual Studio project template, or you can package your extensions and deploy them as a Visual Studio item template. When you package your <code>My</code> namespace extensions as a Visual Studio item template, you can take advantage of additional capabilities provided by Visual Basic. These capabilities enable you to include an extension when a project references a particular assembly, or enable users to explicitly add your <code>My</code> namespace extension by using the <strong>My Extensions</strong> page of the Visual Basic Project Designer.  </p>\n<p> For details about how to deploy <code>My</code> namespace extensions, see <a href=\"packaging-and-deploying-custom-my-extensions\" data-linktype=\"relative-path\">Packaging and Deploying Custom My Extensions</a>.  </p>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"packaging-and-deploying-custom-my-extensions\" data-linktype=\"relative-path\">Packaging and Deploying Custom My Extensions</a><br> <a href=\"extending-the-visual-basic-application-model\" data-linktype=\"relative-path\">Extending the Visual Basic Application Model</a><br> <a href=\"customizing-which-objects-are-available-in-my\" data-linktype=\"relative-path\">Customizing Which Objects are Available in My</a><br> <a href=\"https://docs.microsoft.com/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic\" data-linktype=\"external\">My Extensions Page, Project Designer</a><br> <a href=\"https://docs.microsoft.com/visualstudio/ide/reference/application-page-project-designer-visual-basic\" data-linktype=\"external\">Application Page, Project Designer (Visual Basic)</a><br> <a href=\"../../language-reference/modifiers/partial\" data-linktype=\"relative-path\">Partial</a></p>\n</div></div>","outputRootRelativePath":"../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc2.json\">\r\n<meta name=\"ms.assetid\" content=\"808e8617-b01c-4135-8b21-babe87389e8e\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"13\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-21 01:42 AM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.md\">\r\n<meta name=\"document_id\" content=\"0c7b951d-edaf-72df-0e6f-03a02e797bab\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../../toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Extending the My Namespace in Visual Basic | Microsoft Docs","ms.assetid":"808e8617-b01c-4135-8b21-babe87389e8e","f1_keywords":["vb.AddingMyExtensions"],"translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":13,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["My namespace, customizing","My namespace","My namespace, extending"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Absolute urls and other fixes (#1281)","commit_sha":"f7dffe4885b331cec8d37f3cc5c9163f69c3b4c9","commit_date":"2016-11-22 12:57:26 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2017-03-21 01:42 AM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"3/21/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.md","document_id":"0c7b951d-edaf-72df-0e6f-03a02e797bab","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace","toc_asset_id":"articles/toc.json","toc_rel":"../../../toc.json","_op_ogTitle":"Extending the My Namespace in Visual Basic","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":1795,"_op_rawTitle":"<h1 id=\"extending-the-my-namespace-in-visual-basic\" sourcefile=\"docs/visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.md\" sourcestartlinenumber=\"40\" sourceendlinenumber=\"40\">Extending the My Namespace in Visual Basic</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace","fileRelativePath":"articles/visual-basic/developing-apps/customizing-extending-my/extending-the-my-namespace.html"},"themesRelativePathToOutputRoot":"_themes/"}