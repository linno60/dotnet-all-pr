{"content":"<div><div class=\"content\">\n<p>The compiler does not accept conversion of an anonymous to an expression tree when one property of the anonymous type is used to initialize another property of the anonymous type. For example, in the following code, <code>Prop1</code> is declared in the initialization list and then used as the initial value for <code>Prop2</code>.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Module M2  \n\n    Sub ExpressionExample(Of T)(ByVal x As Expressions.Expression(Of Func(Of T)))  \n    End Sub  \n\n    Sub Main()  \n        &#39; The following line causes the error.  \n        &#39; ExpressionExample(Function() New With {.Prop1 = 2, .Prop2 = .Prop1})  \n\n    End Sub  \nEnd Module  \n</code></pre><p> <strong>Error ID:</strong> BC36548  </p>\n<h2 id=\"to-correct-this-error\">To correct this error</h2>\n<ul>\n<li><p>Assign the initial value for <code>Prop1</code> to a local variable. Assign that variable to both <code>Prop1</code> and <code>Prop2</code>, as shown in the following code.  </p>\n<pre class=\"loading\"><code>Sub Main()  \n\n    Dim temp = 2  \n    ExpressionExample(Function() New With {.Prop1 = temp, .Prop2 = temp})  \n\nEnd Sub  \n</code></pre></li>\n</ul>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"../../programming-guide/language-features/objects-and-classes/anonymous-types\" data-linktype=\"relative-path\">Anonymous Types</a><br> <a href=\"http://msdn.microsoft.com/library/fb1d3ed8-d5b0-4211-a71f-dd271529294b\" data-linktype=\"external\">Expression Trees</a><br> <a href=\"http://msdn.microsoft.com/library/1e37e0cc-eef3-48bb-8b69-3adabf322735\" data-linktype=\"external\">How to: Use Expression Trees to Build Dynamic Queries</a></p>\n</div></div>","outputRootRelativePath":"../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"27de068f-080e-4160-86bf-1ec23fd1925a\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"9\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/language-reference/error-messages/cannot-convert-anonymous-type-to-expression-tree.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/language-reference/error-messages/cannot-convert-anonymous-type-to-expression-tree.md\">\r\n<meta name=\"document_id\" content=\"00f0bcd3-f795-e1f7-055d-f530eb3fdaab\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../../toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","title":"Cannot convert anonymous type to expression tree because it contains a field that is used in the initialization of another field | Microsoft Docs","ms.suite":"","ms.assetid":"27de068f-080e-4160-86bf-1ec23fd1925a","f1_keywords":["bc36548","vbc36548"],"translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":9,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["BC36548"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/language-reference/error-messages/cannot-convert-anonymous-type-to-expression-tree.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/language-reference/error-messages/cannot-convert-anonymous-type-to-expression-tree.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/language-reference/error-messages/cannot-convert-anonymous-type-to-expression-tree.md","document_id":"00f0bcd3-f795-e1f7-055d-f530eb3fdaab","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/language-reference/error-messages/cannot-convert-anonymous-type-to-expression-tree","toc_asset_id":"articles/toc.json","toc_rel":"../../../toc.json","_op_ogTitle":"Cannot convert anonymous type to expression tree because it contains a field that is used in the initialization of another field","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":150,"_op_rawTitle":"<h1 id=\"cannot-convert-anonymous-type-to-expression-tree-because-it-contains-a-field-that-is-used-in-the-initialization-of-another-field\" sourcefile=\"docs/visual-basic/language-reference/error-messages/cannot-convert-anonymous-type-to-expression-tree.md\" sourcestartlinenumber=\"39\" sourceendlinenumber=\"39\">Cannot convert anonymous type to expression tree because it contains a field that is used in the initialization of another field</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/language-reference/error-messages/cannot-convert-anonymous-type-to-expression-tree","fileRelativePath":"articles/visual-basic/language-reference/error-messages/cannot-convert-anonymous-type-to-expression-tree.html"},"themesRelativePathToOutputRoot":"_themes/"}