{"content":"<div><div class=\"content\">\n<p>Combines two collections into a single hierarchical collection. The join operation is based on matching keys.  </p>\n<h2 id=\"syntax\">Syntax</h2>\n<pre class=\"loading\"><code>Group Join element [As type] In collection _  \n  On key1 Equals key2 [ And key3 Equals key4 [... ] ] _  \n  Into expressionList  \n</code></pre><h2 id=\"parts\">Parts</h2>\n<table>\n<thead>\n<tr>\n<th>Term</th>\n<th>Definition</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>element</code></td>\n<td>Required. The control variable for the collection being joined.</td>\n</tr>\n<tr>\n<td><code>type</code></td>\n<td>Optional. The type of <code>element</code>. If no <code>type</code> is specified, the type of <code>element</code> is inferred from <code>collection</code>.</td>\n</tr>\n<tr>\n<td><code>collection</code></td>\n<td>Required. The collection to combine with the collection that is on the left side of the <code>Group Join</code> operator. A <code>Group Join</code> clause can be nested in a <code>Join</code> clause or in another <code>Group Join</code> clause.</td>\n</tr>\n<tr>\n<td><code>key1</code> <code>Equals</code> <code>key2</code></td>\n<td>Required. Identifies keys for the collections being joined. You must use the <code>Equals</code> operator to compare keys from the collections being joined. You can combine join conditions by using the <code>And</code> operator to identify multiple keys. The <code>key1</code> parameter must be from the collection on the left side of the <code>Join</code> operator. The <code>key2</code> parameter must be from the collection on the right side of the <code>Join</code> operator.<br><br> The keys used in the join condition can be expressions that include more than one item from the collection. However, each key expression can contain only items from its respective collection.</td>\n</tr>\n<tr>\n<td><code>expressionList</code></td>\n<td>Required. One or more expressions that identify how the groups of elements from the collection are aggregated. To identify a member name for the grouped results, use the <code>Group</code> keyword (<code>&lt;alias&gt; = Group</code>). You can also include aggregate functions to apply to the group.</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"remarks\">Remarks</h2>\n<p> The <code>Group Join</code> clause combines two collections based on matching key values from the collections being joined. The resulting collection can contain a member that references a collection of elements from the second collection that match the key value from the first collection. You can also specify aggregate functions to apply to the grouped elements from the second collection. For information about aggregate functions, see <a href=\"aggregate-clause\" data-linktype=\"relative-path\">Aggregate Clause</a>.  </p>\n<p> Consider, for example, a collection of managers and a collection of employees. Elements from both collections have a ManagerID property that identifies the employees that report to a particular manager. The results from a join operation would contain a result for each manager and employee with a matching ManagerID value. The results from a <code>Group Join</code> operation would contain the complete list of managers. Each manager result would have a member that referenced the list of employees that were a match for the specific manager.  </p>\n<p> The collection resulting from a <code>Group Join</code> operation can contain any combination of values from the collection identified in the <code>From</code> clause and the expressions identified in the <code>Into</code> clause of the <code>Group Join</code> clause. For more information about valid expressions for the <code>Into</code> clause, see <a href=\"aggregate-clause\" data-linktype=\"relative-path\">Aggregate Clause</a>.  </p>\n<p> A <code>Group Join</code> operation will return all results from the collection identified on the left side of the <code>Group Join</code> operator. This is true even if there are no matches in the collection being joined. This is like a <code>LEFT OUTER JOIN</code> in SQL.  </p>\n<p> You can use the <code>Join</code> clause to combine collections into a single collection. This is equivalent to an <code>INNER JOIN</code> in SQL.  </p>\n<h2 id=\"example\">Example</h2>\n<p> The following code example joins two collections by using the <code>Group Join</code> clause.  </p>\n<pre><code class=\"lang-vb\" name=\"VbSimpleQuerySamples#14\">Dim customerList = From cust In customers\n                   Group Join ord In orders On\n                   cust.CustomerID Equals ord.CustomerID\n                   Into CustomerOrders = Group,\n                        OrderTotal = Sum(ord.Total)\n                   Select cust.CompanyName, cust.CustomerID,\n                          CustomerOrders, OrderTotal\n\nFor Each customer In customerList\n  Console.WriteLine(customer.CompanyName &amp;\n                    &quot; (&quot; &amp; customer.OrderTotal &amp; &quot;)&quot;)\n\n  For Each order In customer.CustomerOrders\n    Console.WriteLine(vbTab &amp; order.OrderID &amp; &quot;: &quot; &amp; order.Total)\n  Next\nNext\n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"../../programming-guide/language-features/linq/introduction-to-linq\" data-linktype=\"relative-path\">Introduction to LINQ in Visual Basic</a><br> <a href=\"queries\" data-linktype=\"relative-path\">Queries</a><br> <a href=\"select-clause\" data-linktype=\"relative-path\">Select Clause</a><br> <a href=\"from-clause\" data-linktype=\"relative-path\">From Clause</a><br> <a href=\"join-clause\" data-linktype=\"relative-path\">Join Clause</a><br> <a href=\"where-clause\" data-linktype=\"relative-path\">Where Clause</a><br> <a href=\"group-by-clause\" data-linktype=\"relative-path\">Group By Clause</a></p>\n</div></div>","outputRootRelativePath":"../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"37dbf79c-7b5c-421b-bbb7-dadfd2b92a1c\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"24\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/language-reference/queries/group-join-clause.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/language-reference/queries/group-join-clause.md\">\r\n<meta name=\"document_id\" content=\"e5369601-b03e-a860-2dea-920ecb5057ac\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../../toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","title":"Group Join Clause (Visual Basic) | Microsoft Docs","ms.suite":"","ms.assetid":"37dbf79c-7b5c-421b-bbb7-dadfd2b92a1c","f1_keywords":["vb.QueryGroupJoinIn","vb.QueryGroupJoinOn","vb.QueryGroupJoin","vb.QueryGroupJoinInto"],"translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":24,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["Group Join clause","Group Join statement","queries [Visual Basic], Group Join"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/language-reference/queries/group-join-clause.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/language-reference/queries/group-join-clause.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/language-reference/queries/group-join-clause.md","document_id":"e5369601-b03e-a860-2dea-920ecb5057ac","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/language-reference/queries/group-join-clause","toc_asset_id":"articles/toc.json","toc_rel":"../../../toc.json","_op_ogTitle":"Group Join Clause (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":609,"_op_rawTitle":"<h1 id=\"group-join-clause-visual-basic\" sourcefile=\"docs/visual-basic/language-reference/queries/group-join-clause.md\" sourcestartlinenumber=\"43\" sourceendlinenumber=\"43\">Group Join Clause (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/language-reference/queries/group-join-clause","fileRelativePath":"articles/visual-basic/language-reference/queries/group-join-clause.html"},"themesRelativePathToOutputRoot":"_themes/"}