{"content":"<div><div class=\"content\">\n<p>Executes a series of statements that repeatedly refer to a single object or structure so that the statements can use a simplified syntax when accessing members of the object or structure.  When using a structure, you can only read the values of members or invoke methods, and you get an error if you try to assign values to members of a structure used in a <code>With...End With</code> statement.  </p>\n<h2 id=\"syntax\">Syntax</h2>\n<pre class=\"loading\"><code>With objectExpression  \n    [ statements ]  \nEnd With  \n</code></pre><h2 id=\"parts\">Parts</h2>\n<table>\n<thead>\n<tr>\n<th>Term</th>\n<th>Definition</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>objectExpression</code></td>\n<td>Required. An expression that evaluates to an object. The expression may be arbitrarily complex and is evaluated only once. The expression can evaluate to any data type, including elementary types.</td>\n</tr>\n<tr>\n<td><code>statements</code></td>\n<td>Optional. One or more statements between <code>With</code> and <code>End With</code> that may refer to members of an object that&#39;s produced by the evaluation of <code>objectExpression</code>.</td>\n</tr>\n<tr>\n<td><code>End With</code></td>\n<td>Required. Terminates the definition of the <code>With</code> block.</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"remarks\">Remarks</h2>\n<p> By using <code>With...End With</code>, you can perform a series of statements on a specified object without specifying the name of the object multiple times. Within a <code>With</code> statement block, you can specify a member of the object starting with a period, as if the <code>With</code> statement object preceded it.  </p>\n<p> For example, to change multiple properties on a single object, place the property assignment statements inside the <code>With...End With</code> block, referring to the object only once instead of once for each property assignment.  </p>\n<p> If your code accesses the same object in multiple statements, you gain the following benefits by using the <code>With</code> statement:  </p>\n<ul>\n<li><p>You don&#39;t need to evaluate a complex expression multiple times or assign the result to a temporary variable to refer to its members multiple times.  </p>\n</li>\n<li><p>You make your code more readable by eliminating repetitive qualifying expressions.  </p>\n<p>The data type of <code>objectExpression</code> can be any class or structure type or even a Visual Basic elementary type such as <code>Integer</code>.  If <code>objectExpression</code> results in anything other than an object, you can only read the values of its members or invoke methods, and you get an error if you try to assign values to members of a structure used in a <code>With...End With</code> statement.  This is the same error you would get if you invoked a method that returned a structure and immediately accessed and assigned a value to a member of the function’s result, such as <code>GetAPoint().x = 1</code>.  The problem in both cases is that the structure exists only on the call stack, and there is no way a modified structure member in these situations can write to  a location such that any other code in the program can observe the change.  </p>\n<p>The <code>objectExpression</code> is evaluated once, upon entry into the block. You can&#39;t reassign the <code>objectExpression</code> from within the <code>With</code> block.  </p>\n<p>Within a <code>With</code> block, you can access the methods and properties of only the specified object without qualifying them. You can use methods and properties of other objects, but you must qualify them with their object names.  </p>\n<p>You can place one <code>With...End With</code> statement within another. Nested <code>With...End With</code> statements may be confusing if the objects that are being referred to aren&#39;t clear from context. You must provide a fully qualified reference to an object that&#39;s in an outer <code>With</code> block when the object is referenced from within an inner <code>With</code> block.  </p>\n<p>You can&#39;t branch into a <code>With</code> statement block from outside the block.  </p>\n<p>Unless the block contains a loop, the statements run only once. You can nest different kinds of control structures. For more information, see <a href=\"../../programming-guide/language-features/control-flow/nested-control-structures\" data-linktype=\"relative-path\">Nested Control Structures</a>.  </p>\n</li>\n</ul>\n<div class=\"NOTE\"><h5>Note</h5><p> You can use the <code>With</code> keyword in object initializers also. For more information and examples, see <a href=\"../../programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types\" data-linktype=\"relative-path\">Object Initializers: Named and Anonymous Types</a> and <a href=\"../../programming-guide/language-features/objects-and-classes/anonymous-types\" data-linktype=\"relative-path\">Anonymous Types</a>.  </p>\n<p> If you&#39;re using a <code>With</code> block only to initialize the properties or fields of an object that you&#39;ve just instantiated, consider using an object initializer instead.  </p>\n</div>\n<h2 id=\"example\">Example</h2>\n<p> In the following example, each <code>With</code> block executes a series of statements on a single object.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrWithStatement#2\">    Private Sub AddCustomer()\n        Dim theCustomer As New Customer\n\n        With theCustomer\n            .Name = &quot;Coho Vineyard&quot;\n            .URL = &quot;http://www.cohovineyard.com/&quot;\n            .City = &quot;Redmond&quot;\n        End With\n\n        With theCustomer.Comments\n            .Add(&quot;First comment.&quot;)\n            .Add(&quot;Second comment.&quot;)\n        End With\n    End Sub\n\n    Public Class Customer\n        Public Property Name As String\n        Public Property City As String\n        Public Property URL As String\n\n        Public Property Comments As New List(Of String)\n    End Class\n</code></pre><h2 id=\"example-1\">Example</h2>\n<p> The following example nests <code>With…End With</code> statements. Within the nested <code>With</code> statement, the syntax refers to the inner object.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrWithStatement#1\">        Dim theWindow As New EntryWindow\n\n        With theWindow\n            With .InfoLabel\n                .Content = &quot;This is a message.&quot;\n                .Foreground = Brushes.DarkSeaGreen\n                .Background = Brushes.LightYellow\n            End With\n\n            .Title = &quot;The Form Title&quot;\n            .Show()\n        End With\n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a class=\"xref\" href=\"../../../../api/system.collections.generic.list-1\" data-linktype=\"relative-path\">List&lt;T&gt;</a><br> <a href=\"../../programming-guide/language-features/control-flow/nested-control-structures\" data-linktype=\"relative-path\">Nested Control Structures</a><br> <a href=\"../../programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types\" data-linktype=\"relative-path\">Object Initializers: Named and Anonymous Types</a><br> <a href=\"../../programming-guide/language-features/objects-and-classes/anonymous-types\" data-linktype=\"relative-path\">Anonymous Types</a></p>\n</div></div>","outputRootRelativePath":"../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"340d5fbb-4f43-48ec-a024-80843c137817\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"34\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/language-reference/statements/with-end-with-statement.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/language-reference/statements/with-end-with-statement.md\">\r\n<meta name=\"document_id\" content=\"caa1ace3-03de-615e-0fce-dfa923e94f64\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../../toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","title":"With...End With Statement (Visual Basic) | Microsoft Docs","ms.suite":"","ms.assetid":"340d5fbb-4f43-48ec-a024-80843c137817","f1_keywords":["vb.With"],"translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":34,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["With keyword","loop structures, and With...End With statements","execution, on object","instructions, repeating","With...End With statements","With statement","With statement, nesting","objects [Visual Basic], accessing","With block","End keyword, With...End With statements"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/language-reference/statements/with-end-with-statement.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/language-reference/statements/with-end-with-statement.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/language-reference/statements/with-end-with-statement.md","document_id":"caa1ace3-03de-615e-0fce-dfa923e94f64","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/language-reference/statements/with-end-with-statement","toc_asset_id":"articles/toc.json","toc_rel":"../../../toc.json","_op_ogTitle":"With...End With Statement (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":770,"_op_rawTitle":"<h1 id=\"withend-with-statement-visual-basic\" sourcefile=\"docs/visual-basic/language-reference/statements/with-end-with-statement.md\" sourcestartlinenumber=\"47\" sourceendlinenumber=\"47\">With...End With Statement (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/language-reference/statements/with-end-with-statement","fileRelativePath":"articles/visual-basic/language-reference/statements/with-end-with-statement.html"},"themesRelativePathToOutputRoot":"_themes/"}