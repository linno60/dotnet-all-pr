{"content":"<div><div class=\"content\">\n<p>Repeats a group of statements for each element in a collection.  </p>\n<h2 id=\"syntax\">Syntax</h2>\n<pre class=\"loading\"><code>For Each element [ As datatype ] In group  \n    [ statements ]  \n    [ Continue For ]  \n    [ statements ]  \n    [ Exit For ]  \n    [ statements ]  \nNext [ element ]  \n</code></pre><h2 id=\"parts\">Parts</h2>\n<table>\n<thead>\n<tr>\n<th>Term</th>\n<th>Definition</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>element</code></td>\n<td>Required in the <code>For Each</code> statement. Optional in the <code>Next</code> statement. Variable. Used to iterate through the elements of the collection.</td>\n</tr>\n<tr>\n<td><code>datatype</code></td>\n<td>Required if <code>element</code> isn&#39;t already declared. Data type of <code>element</code>.</td>\n</tr>\n<tr>\n<td><code>group</code></td>\n<td>Required. A variable with a type that&#39;s a collection type or Object. Refers to the collection over which the <code>statements</code> are to be repeated.</td>\n</tr>\n<tr>\n<td><code>statements</code></td>\n<td>Optional. One or more statements between <code>For Each</code> and <code>Next</code> that run on each item in <code>group</code>.</td>\n</tr>\n<tr>\n<td><code>Continue For</code></td>\n<td>Optional. Transfers control to the start of the <code>For Each</code> loop.</td>\n</tr>\n<tr>\n<td><code>Exit For</code></td>\n<td>Optional. Transfers control out of the <code>For Each</code> loop.</td>\n</tr>\n<tr>\n<td><code>Next</code></td>\n<td>Required. Terminates the definition of the <code>For Each</code> loop.</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"simple-example\">Simple Example</h2>\n<p> Use a <code>For Each</code>...<code>Next</code> loop when you want to repeat a set of statements for each element of a collection or array.  </p>\n<div class=\"TIP\"><h5>Tip</h5><p> A <a href=\"for-next-statement\" data-linktype=\"relative-path\">For...Next Statement</a> works well when you can associate each iteration of a loop with a control variable and determine that variable&#39;s initial and final values. However, when you are dealing with a collection, the concept of initial and final values isn&#39;t meaningful, and you don&#39;t necessarily know how many elements the collection has. In this kind of case, a <code>For Each</code>...<code>Next</code> loop is often a better choice.  </p>\n</div>\n<p> In the following example, the <code>For Each</code>…<code>Next</code> statement iterates through all the elements of a List collection.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrStatements#121\">&#39; Create a list of strings by using a\n&#39; collection initializer.\nDim lst As New List(Of String) _\n    From {&quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;}\n\n&#39; Iterate through the list.\nFor Each item As String In lst\n    Debug.Write(item &amp; &quot; &quot;)\nNext\nDebug.WriteLine(&quot;&quot;)\n&#39;Output: abc def ghi\n</code></pre><p> For more examples, see <a href=\"http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b\" data-linktype=\"external\">Collections</a> and <a href=\"../../programming-guide/language-features/arrays/index\" data-linktype=\"relative-path\">Arrays</a>.  </p>\n<h2 id=\"nested-loops\">Nested Loops</h2>\n<p> You can nest <code>For Each</code> loops by putting one loop within another.  </p>\n<p> The following example demonstrates nested <code>For Each</code>…<code>Next</code> structures.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrStatements#122\">&#39; Create lists of numbers and letters\n&#39; by using array initializers.\nDim numbers() As Integer = {1, 4, 7}\nDim letters() As String = {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;}\n\n&#39; Iterate through the list by using nested loops.\nFor Each number As Integer In numbers\n    For Each letter As String In letters\n        Debug.Write(number.ToString &amp; letter &amp; &quot; &quot;)\n    Next\nNext\nDebug.WriteLine(&quot;&quot;)\n&#39;Output: 1a 1b 1c 4a 4b 4c 7a 7b 7c \n</code></pre><p> When you nest loops, each loop must have a unique <code>element</code> variable.  </p>\n<p> You can also nest different kinds of control structures within each other. For more information, see <a href=\"../../programming-guide/language-features/control-flow/nested-control-structures\" data-linktype=\"relative-path\">Nested Control Structures</a>.  </p>\n<h2 id=\"exit-for-and-continue-for\">Exit For and Continue For</h2>\n<p> The <a href=\"exit-statement\" data-linktype=\"relative-path\">Exit For</a> statement causes execution to exit the <code>For</code>…<code>Next</code> loop and transfers control to the statement that follows the <code>Next</code> statement.  </p>\n<p> The <code>Continue For</code> statement transfers control immediately to the next iteration of the loop. For more information, see <a href=\"continue-statement\" data-linktype=\"relative-path\">Continue Statement</a>.  </p>\n<p> The following example shows how to use the <code>Continue For</code> and <code>Exit For</code> statements.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrStatements#123\">Dim numberSeq() As Integer =\n    {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12}\n\nFor Each number As Integer In numberSeq\n    &#39; If number is between 5 and 7, continue\n    &#39; with the next iteration.\n    If number &gt;= 5 And number &lt;= 8 Then\n        Continue For\n    End If\n\n    &#39; Display the number.\n    Debug.Write(number.ToString &amp; &quot; &quot;)\n\n    &#39; If number is 10, exit the loop.\n    If number = 10 Then\n        Exit For\n    End If\nNext\nDebug.WriteLine(&quot;&quot;)\n&#39; Output: 1 2 3 4 9 10\n</code></pre><p> You can put any number of <code>Exit For</code> statements in a <code>For Each</code> loop. When used within nested <code>For Each</code> loops, <code>Exit For</code> causes execution to exit the innermost loop and transfers control to the next higher level of nesting.  </p>\n<p> <code>Exit For</code> is often used after an evaluation of some condition, for example, in an <code>If</code>...<code>Then</code>...<code>Else</code> structure. You might want to use <code>Exit For</code> for the following conditions:  </p>\n<ul>\n<li><p>Continuing to iterate is unnecessary or impossible. This might be caused by an erroneous value or a termination request.  </p>\n</li>\n<li><p>An exception is caught in a <code>Try</code>...<code>Catch</code>...<code>Finally</code>. You might use <code>Exit For</code> at the end of the <code>Finally</code> block.  </p>\n</li>\n<li><p>There an endless loop, which is a loop that could run a large or even infinite number of times. If you detect such a condition, you can use <code>Exit For</code> to escape the loop. For more information, see <a href=\"do-loop-statement\" data-linktype=\"relative-path\">Do...Loop Statement</a>.  </p>\n</li>\n</ul>\n<h2 id=\"iterators\">Iterators</h2>\n<p> You use an <em>iterator</em> to perform a custom iteration over a collection. An iterator can be a function or a <code>Get</code> accessor. It uses a <code>Yield</code> statement to return each element of the collection one at a time.  </p>\n<p> You call an iterator by using a <code>For Each...Next</code> statement. Each iteration of the <code>For Each</code> loop calls the iterator. When a <code>Yield</code> statement is reached in the iterator, the expression in the <code>Yield</code> statement is returned, and the current location in code is retained. Execution is restarted from that location the next time that the iterator is called.  </p>\n<p> The following example uses an iterator function. The iterator function has a <code>Yield</code> statement that&#39;s inside a <a href=\"for-next-statement\" data-linktype=\"relative-path\">For…Next</a> loop. In the <code>ListEvenNumbers</code> method, each iteration of the <code>For Each</code> statement body creates a call to the iterator function, which proceeds to the next <code>Yield</code> statement.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrStatements#127\">Public Sub ListEvenNumbers()\n    For Each number As Integer In EvenSequence(5, 18)\n        Debug.Write(number &amp; &quot; &quot;)\n    Next\n    Debug.WriteLine(&quot;&quot;)\n    &#39; Output: 6 8 10 12 14 16 18\nEnd Sub\n\nPrivate Iterator Function EvenSequence(\nByVal firstNumber As Integer, ByVal lastNumber As Integer) _\nAs System.Collections.Generic.IEnumerable(Of Integer)\n\n    &#39; Yield even numbers in the range.\n    For number = firstNumber To lastNumber\n        If number Mod 2 = 0 Then\n            Yield number\n        End If\n    Next\nEnd Function\n</code></pre><p> For more information, see <a href=\"http://msdn.microsoft.com/library/f45331db-d595-46ec-9142-551d3d1eb1a7\" data-linktype=\"external\">Iterators</a>, <a href=\"yield-statement\" data-linktype=\"relative-path\">Yield Statement</a>, and <a href=\"../modifiers/iterator\" data-linktype=\"relative-path\">Iterator</a>.  </p>\n<h2 id=\"technical-implementation\">Technical Implementation</h2>\n<p> When a <code>For Each</code>…<code>Next</code> statement runs, Visual Basic evaluates the collection only one time, before the loop starts. If your statement block changes <code>element</code> or <code>group</code>, these changes don&#39;t affect the iteration of the loop.  </p>\n<p> When all the elements in the collection have been successively assigned to <code>element</code>, the <code>For Each</code> loop stops and control passes to the statement following the <code>Next</code> statement.  </p>\n<p> If <code>element</code> hasn&#39;t been declared outside this loop, you must declare it in the <code>For Each</code> statement. You can declare the type of <code>element</code> explicitly by using an <code>As</code> statement, or you can rely on type inference to assign the type. In either case, the scope of <code>element</code> is the body of the loop. However, you cannot declare <code>element</code> both outside and inside the loop.  </p>\n<p> You can optionally specify <code>element</code> in the <code>Next</code> statement. This improves the readability of your program, especially if you have nested <code>For Each</code> loops. You must specify the same variable as the one that appears in the corresponding <code>For Each</code> statement.  </p>\n<p> You might want to avoid changing the value of <code>element</code> inside a loop. Doing this can make it more difficult to read and debug your code. Changing the value of <code>group</code> doesn&#39;t affect the collection or its elements, which were determined when the loop was first entered.  </p>\n<p> When you&#39;re nesting loops, if a <code>Next</code> statement of an outer nesting level is encountered before the <code>Next</code> of an inner level, the compiler signals an error. However, the compiler can detect this overlapping error only if you specify <code>element</code> in every <code>Next</code> statement.  </p>\n<p> If your code depends on traversing a collection in a particular order, a <code>For Each</code>...<code>Next</code> loop isn&#39;t the best choice, unless you know the characteristics of the enumerator object the collection exposes. The order of traversal isn&#39;t determined by Visual Basic, but by the <a class=\"xref\" href=\"../../../../api/system.collections.ienumerator#System_Collections_IEnumerator_MoveNext_\" data-linktype=\"relative-path\">MoveNext</a> method of the enumerator object. Therefore, you might not be able to predict which element of the collection is the first to be returned in <code>element</code>, or which is the next to be returned after a given element. You might achieve more reliable results using a different loop structure, such as <code>For</code>...<code>Next</code> or <code>Do</code>...<code>Loop</code>.  </p>\n<p> The data type of <code>element</code> must be such that the data type of the elements of <code>group</code> can be converted to it.  </p>\n<p> The data type of <code>group</code> must be a reference type that refers to a collection or an array that&#39;s enumerable. Most commonly this means that <code>group</code> refers to an object that implements the <a class=\"xref\" href=\"../../../../api/system.collections.ienumerable\" data-linktype=\"relative-path\">IEnumerable</a> interface of the <code>System.Collections</code> namespace or the <a class=\"xref\" href=\"../../../../api/system.collections.generic.ienumerable-1\" data-linktype=\"relative-path\">IEnumerable&lt;T&gt;</a> interface of the <code>System.Collections.Generic</code> namespace. <code>System.Collections.IEnumerable</code> defines the <a class=\"xref\" href=\"../../../../api/system.collections.ienumerable#System_Collections_IEnumerable_GetEnumerator_\" data-linktype=\"relative-path\">GetEnumerator</a> method, which returns an enumerator object for the collection. The enumerator object implements the <code>System.Collections.IEnumerator</code> interface of the <code>System.Collections</code> namespace and exposes the <a class=\"xref\" href=\"../../../../api/system.collections.ienumerator#System_Collections_IEnumerator_Current_\" data-linktype=\"relative-path\">Current</a> property and the <a class=\"xref\" href=\"../../../../api/system.collections.ienumerator#System_Collections_IEnumerator_Reset_\" data-linktype=\"relative-path\">Reset</a> and <a class=\"xref\" href=\"../../../../api/system.collections.ienumerator#System_Collections_IEnumerator_MoveNext_\" data-linktype=\"relative-path\">MoveNext</a> methods. Visual Basic uses these to traverse the collection.  </p>\n<h3 id=\"narrowing-conversions\">Narrowing Conversions</h3>\n<p> When <code>Option Strict</code> is set to <code>On</code>, narrowing conversions ordinarily cause compiler errors. In a <code>For Each</code> statement, however, conversions from the elements in <code>group</code> to <code>element</code> are evaluated and performed at run time, and compiler errors caused by narrowing conversions are suppressed.  </p>\n<p> In the following example, the assignment of <code>m</code> as the initial value for <code>n</code> doesn&#39;t compile when <code>Option Strict</code> is on because the conversion of a <code>Long</code> to an <code>Integer</code> is a narrowing conversion. In the <code>For Each</code> statement, however, no compiler error is reported, even though the assignment to <code>number</code> requires the same conversion from <code>Long</code> to <code>Integer</code>. In the <code>For Each</code> statement that contains a large number, a run-time error occurs when <a class=\"xref\" href=\"../../../../api/microsoft.visualbasic.compilerservices.conversions#Microsoft_VisualBasic_CompilerServices_Conversions_ToInteger_\" data-linktype=\"relative-path\">ToInteger</a> is applied to the large number.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrStatements#89\">Option Strict On\n\nModule Module1\n    Sub Main()\n        &#39; The assignment of m to n causes a compiler error when \n        &#39; Option Strict is on.\n        Dim m As Long = 987\n        &#39;Dim n As Integer = m\n\n        &#39; The For Each loop requires the same conversion but\n        &#39; causes no errors, even when Option Strict is on.\n        For Each number As Integer In New Long() {45, 3, 987}\n            Console.Write(number &amp; &quot; &quot;)\n        Next\n        Console.WriteLine()\n        &#39; Output: 45 3 987\n\n        &#39; Here a run-time error is raised because 9876543210\n        &#39; is too large for type Integer.\n        &#39;For Each number As Integer In New Long() {45, 3, 9876543210}\n        &#39;    Console.Write(number &amp; &quot; &quot;)\n        &#39;Next\n\n        Console.ReadKey()\n    End Sub\nEnd Module\n</code></pre><h3 id=\"ienumerator-calls\">IEnumerator Calls</h3>\n<p> When execution of a <code>For Each</code>...<code>Next</code> loop starts, Visual Basic verifies that <code>group</code> refers to a valid collection object. If not, it throws an exception. Otherwise, it calls the <a class=\"xref\" href=\"../../../../api/system.collections.ienumerator#System_Collections_IEnumerator_MoveNext_\" data-linktype=\"relative-path\">MoveNext</a> method and the <a class=\"xref\" href=\"../../../../api/system.collections.ienumerator#System_Collections_IEnumerator_Current_\" data-linktype=\"relative-path\">Current</a> property of the enumerator object to return the first element. If <code>MoveNext</code> indicates that there is no next element, that is, if the collection is empty, the <code>For Each</code> loop stops and control passes to the statement following the <code>Next</code> statement. Otherwise, Visual Basic sets <code>element</code> to the first element and runs the statement block.  </p>\n<p> Each time Visual Basic encounters the <code>Next</code> statement, it returns to the <code>For Each</code> statement. Again it calls <code>MoveNext</code> and <code>Current</code> to return the next element, and again it either runs the block or stops the loop depending on the result. This process continues until <code>MoveNext</code> indicates that there is no next element or an <code>Exit For</code> statement is encountered.  </p>\n<p> <strong>Modifying the Collection.</strong> The enumerator object returned by <a class=\"xref\" href=\"../../../../api/system.collections.ienumerable#System_Collections_IEnumerable_GetEnumerator_\" data-linktype=\"relative-path\">GetEnumerator</a> normally doesn&#39;t let you change the collection by adding, deleting, replacing, or reordering any elements. If you change the collection after you have initiated a <code>For Each</code>...<code>Next</code> loop, the enumerator object becomes invalid, and the next attempt to access an element causes an <a class=\"xref\" href=\"../../../../api/system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a> exception.  </p>\n<p> However, this blocking of modification isn&#39;t determined by Visual Basic, but rather by the implementation of the <a class=\"xref\" href=\"../../../../api/system.collections.ienumerable\" data-linktype=\"relative-path\">IEnumerable</a> interface. It is possible to implement <code>IEnumerable</code> in a way that allows for modification during iteration. If you are considering doing such dynamic modification, make sure that you understand the characteristics of the <code>IEnumerable</code> implementation on the collection you are using.  </p>\n<p> <strong>Modifying Collection Elements.</strong> The <a class=\"xref\" href=\"../../../../api/system.collections.ienumerator#System_Collections_IEnumerator_Current_\" data-linktype=\"relative-path\">Current</a> property of the enumerator object is <a href=\"../modifiers/readonly\" data-linktype=\"relative-path\">ReadOnly</a>, and it returns a local copy of each collection element. This means that you cannot modify the elements themselves in a <code>For Each</code>...<code>Next</code> loop. Any modification you make affects only the local copy from <code>Current</code> and isn&#39;t reflected back into the underlying collection. However, if an element is a reference type, you can modify the members of the instance to which it points. The following example modifies the <code>BackColor</code> member of each <code>thisControl</code> element. You cannot, however, modify <code>thisControl</code> itself.  </p>\n<p><codecontentplaceholder>1</codecontentplaceholder><br> The previous example can modify the <code>BackColor</code> member of each <code>thisControl</code> element, although it cannot modify <code>thisControl</code> itself.  </p>\n<p> <strong>Traversing Arrays.</strong> Because the <a class=\"xref\" href=\"../../../../api/system.array\" data-linktype=\"relative-path\">Array</a> class implements the <a class=\"xref\" href=\"../../../../api/system.collections.ienumerable\" data-linktype=\"relative-path\">IEnumerable</a> interface, all arrays expose the <a class=\"xref\" href=\"../../../../api/system.array#System_Array_GetEnumerator_\" data-linktype=\"relative-path\">GetEnumerator</a> method. This means that you can iterate through an array with a <code>For Each</code>...<code>Next</code> loop. However, you can only read the array elements. You cannot change them.  </p>\n<h2 id=\"example\">Example</h2>\n<p> The following example lists all the folders in the C:\\ directory by using the <a class=\"xref\" href=\"../../../../api/system.io.directoryinfo\" data-linktype=\"relative-path\">DirectoryInfo</a> class.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrStatements#124\">Dim dInfo As New System.IO.DirectoryInfo(&quot;c:\\&quot;)\nFor Each dir As System.IO.DirectoryInfo In dInfo.GetDirectories()\n    Debug.WriteLine(dir.Name)\nNext\n</code></pre><h2 id=\"example-1\">Example</h2>\n<p> The following example illustrates a procedure for sorting a collection. The example sorts instances of a <code>Car</code> class that are stored in a <a class=\"xref\" href=\"../../../../api/system.collections.generic.list-1\" data-linktype=\"relative-path\">List&lt;T&gt;</a>. The <code>Car</code> class implements the <a class=\"xref\" href=\"../../../../api/system.icomparable-1\" data-linktype=\"relative-path\">IComparable&lt;T&gt;</a> interface, which requires that the <a class=\"xref\" href=\"../../../../api/system.icomparable-1#System_IComparable_1_CompareTo_\" data-linktype=\"relative-path\">CompareTo</a> method be implemented.  </p>\n<p> Each call to the <a class=\"xref\" href=\"../../../../api/system.icomparable-1#System_IComparable_1_CompareTo_\" data-linktype=\"relative-path\">CompareTo</a> method makes a single comparison that&#39;s used for sorting. User-written code in the <code>CompareTo</code> method returns a value for each comparison of the current object with another object. The value returned is less than zero if the current object is less than the other object, greater than zero if the current object is greater than the other object, and zero if they are equal. This enables you to define in code the criteria for greater than, less than, and equal.  </p>\n<p> In the <code>ListCars</code> method, the <code>cars.Sort()</code> statement sorts the list. This call to the <a class=\"xref\" href=\"../../../../api/system.collections.generic.list-1#System_Collections_Generic_List_1_Sort_\" data-linktype=\"relative-path\">Sort</a> method of the <a class=\"xref\" href=\"../../../../api/system.collections.generic.list-1\" data-linktype=\"relative-path\">List&lt;T&gt;</a> causes the <code>CompareTo</code> method to be called automatically for the <code>Car</code> objects in the <code>List</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrStatements#125\">Public Sub ListCars()\n\n    &#39; Create some new cars.\n    Dim cars As New List(Of Car) From\n    {\n        New Car With {.Name = &quot;car1&quot;, .Color = &quot;blue&quot;, .Speed = 20},\n        New Car With {.Name = &quot;car2&quot;, .Color = &quot;red&quot;, .Speed = 50},\n        New Car With {.Name = &quot;car3&quot;, .Color = &quot;green&quot;, .Speed = 10},\n        New Car With {.Name = &quot;car4&quot;, .Color = &quot;blue&quot;, .Speed = 50},\n        New Car With {.Name = &quot;car5&quot;, .Color = &quot;blue&quot;, .Speed = 30},\n        New Car With {.Name = &quot;car6&quot;, .Color = &quot;red&quot;, .Speed = 60},\n        New Car With {.Name = &quot;car7&quot;, .Color = &quot;green&quot;, .Speed = 50}\n    }\n\n    &#39; Sort the cars by color alphabetically, and then by speed\n    &#39; in descending order.\n    cars.Sort()\n\n    &#39; View all of the cars.\n    For Each thisCar As Car In cars\n        Debug.Write(thisCar.Color.PadRight(5) &amp; &quot; &quot;)\n        Debug.Write(thisCar.Speed.ToString &amp; &quot; &quot;)\n        Debug.Write(thisCar.Name)\n        Debug.WriteLine(&quot;&quot;)\n    Next\n\n    &#39; Output:\n    &#39;  blue  50 car4\n    &#39;  blue  30 car5\n    &#39;  blue  20 car1\n    &#39;  green 50 car7\n    &#39;  green 10 car3\n    &#39;  red   60 car6\n    &#39;  red   50 car2\nEnd Sub\n\nPublic Class Car\n    Implements IComparable(Of Car)\n\n    Public Property Name As String\n    Public Property Speed As Integer\n    Public Property Color As String\n\n    Public Function CompareTo(ByVal other As Car) As Integer _\n        Implements System.IComparable(Of Car).CompareTo\n        &#39; A call to this method makes a single comparison that is\n        &#39; used for sorting.\n\n        &#39; Determine the relative order of the objects being compared.\n        &#39; Sort by color alphabetically, and then by speed in\n        &#39; descending order.\n\n        &#39; Compare the colors.\n        Dim compare As Integer\n        compare = String.Compare(Me.Color, other.Color, True)\n\n        &#39; If the colors are the same, compare the speeds.\n        If compare = 0 Then\n            compare = Me.Speed.CompareTo(other.Speed)\n\n            &#39; Use descending order for speed.\n            compare = -compare\n        End If\n\n        Return compare\n    End Function\nEnd Class\n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b\" data-linktype=\"external\">Collections</a><br> <a href=\"for-next-statement\" data-linktype=\"relative-path\">For...Next Statement</a><br> <a href=\"../../programming-guide/language-features/control-flow/loop-structures\" data-linktype=\"relative-path\">Loop Structures</a><br> <a href=\"while-end-while-statement\" data-linktype=\"relative-path\">While...End While Statement</a><br> <a href=\"do-loop-statement\" data-linktype=\"relative-path\">Do...Loop Statement</a><br> <a href=\"../../programming-guide/language-features/data-types/widening-and-narrowing-conversions\" data-linktype=\"relative-path\">Widening and Narrowing Conversions</a><br> <a href=\"../../programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types\" data-linktype=\"relative-path\">Object Initializers: Named and Anonymous Types</a><br> <a href=\"../../programming-guide/language-features/collection-initializers/index\" data-linktype=\"relative-path\">Collection Initializers</a><br> <a href=\"../../programming-guide/language-features/arrays/index\" data-linktype=\"relative-path\">Arrays</a></p>\n</div></div>","outputRootRelativePath":"../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc1.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"ebce3120-95c3-42b1-b70b-fa7da40c75e2\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"56\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"translation.priority.mt\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.mt\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.mt\" content=\"pt-br\">\r\n<meta name=\"translation.priority.mt\" content=\"tr-tr\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/language-reference/statements/for-each-next-statement.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/language-reference/statements/for-each-next-statement.md\">\r\n<meta name=\"document_id\" content=\"89425584-dd15-ae9f-ccce-204f1c5de6ee\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../../toc1.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","title":"For Each...Next Statement (Visual Basic) | Microsoft Docs","ms.suite":"","ms.assetid":"ebce3120-95c3-42b1-b70b-fa7da40c75e2","f1_keywords":["vb.ForEach","vb.ForEachNext","vb.Each","ForEachNext"],"translation.priority.ht":["de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","ru-ru","zh-cn","zh-tw"],"caps.latest.revision":56,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["infinite loops","Next statement, For Each...Next","endless loops","loop structures, For Each...Next","loops, endless","Each keyword","instructions, repeating","For Each statement","collections, instruction repetition","loops, infinite","For Each...Next statements","For keyword [Visual Basic], For Each...Next statements","Exit statement, For Each...Next statements","iteration"],"translation.priority.mt":["cs-cz","pl-pl","pt-br","tr-tr"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/language-reference/statements/for-each-next-statement.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/language-reference/statements/for-each-next-statement.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/language-reference/statements/for-each-next-statement.md","document_id":"89425584-dd15-ae9f-ccce-204f1c5de6ee","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/language-reference/statements/for-each-next-statement","toc_asset_id":"articles/toc.json","toc_rel":"../../../toc.json","_op_ogTitle":"For Each...Next Statement (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":2575,"_op_rawTitle":"<h1 id=\"for-eachnext-statement-visual-basic\" sourcefile=\"docs/visual-basic/language-reference/statements/for-each-next-statement.md\" sourcestartlinenumber=\"55\" sourceendlinenumber=\"55\">For Each...Next Statement (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/language-reference/statements/for-each-next-statement","fileRelativePath":"articles/visual-basic/language-reference/statements/for-each-next-statement.html"},"themesRelativePathToOutputRoot":"_themes/"}