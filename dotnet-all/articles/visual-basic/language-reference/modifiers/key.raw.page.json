{"content":"<div><div class=\"content\">\n<p>The <code>Key</code> keyword enables you to specify behavior for properties of anonymous types. Only properties you designate as key properties participate in tests of equality between anonymous type instances, or calculation of hash code values. The values of key properties cannot be changed.  </p>\n<p> You designate a property of an anonymous type as a key property by placing the keyword <code>Key</code> in front of its declaration in the initialization list. In the following example, <code>Airline</code> and <code>FlightNo</code> are key properties, but <code>Gate</code> is not.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrAnonymousTypes#26\">Dim flight1 = New With {Key .Airline = &quot;Blue Yonder Airlines&quot;,\n                        Key .FlightNo = 3554, .Gate = &quot;C33&quot;}\n</code></pre><p> When a new anonymous type is created, it inherits directly from <a class=\"xref\" href=\"../../../../api/system.object\" data-linktype=\"relative-path\">Object</a>. The compiler overrides three inherited members: <a class=\"xref\" href=\"../../../../api/system.object#System_Object_Equals_\" data-linktype=\"relative-path\">Equals</a>, <a class=\"xref\" href=\"../../../../api/system.object#System_Object_GetHashCode_\" data-linktype=\"relative-path\">GetHashCode</a>, and <a class=\"xref\" href=\"../../../../api/system.object#System_Object_ToString_\" data-linktype=\"relative-path\">ToString</a>. The override code that is produced for <a class=\"xref\" href=\"../../../../api/system.object#System_Object_Equals_\" data-linktype=\"relative-path\">Equals</a> and <a class=\"xref\" href=\"../../../../api/system.object#System_Object_GetHashCode_\" data-linktype=\"relative-path\">GetHashCode</a> is based on key properties. If there are no key properties in the type, <a class=\"xref\" href=\"../../../../api/system.object#System_Object_GetHashCode_\" data-linktype=\"relative-path\">GetHashCode</a> and <a class=\"xref\" href=\"../../../../api/system.object#System_Object_Equals_\" data-linktype=\"relative-path\">Equals</a> are not overridden.  </p>\n<h2 id=\"equality\">Equality</h2>\n<p> Two anonymous type instances are equal if they are instances of the same type and if the values of their key properties are equal. In the following examples, <code>flight2</code> is equal to <code>flight1</code> from the previous example because they are instances of the same anonymous type and they have matching values for their key properties. However, <code>flight3</code> is not equal to <code>flight1</code> because it has a different value for a key property, <code>FlightNo</code>. Instance <code>flight4</code> is not the same type as <code>flight1</code> because they designate different properties as key properties.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrAnonymousTypes#27\">Dim flight2 = New With {Key .Airline = &quot;Blue Yonder Airlines&quot;,\n                        Key .FlightNo = 3554, .Gate = &quot;D14&quot;}\n&#39; The following statement displays True. The values of the non-key \n&#39; property, Gate, do not have to be equal.\nConsole.WriteLine(flight1.Equals(flight2))\n\nDim flight3 = New With {Key .Airline = &quot;Blue Yonder Airlines&quot;,\n                        Key .FlightNo = 431, .Gate = &quot;C33&quot;}\n&#39; The following statement displays False, because flight3 has a\n&#39; different value for key property FlightNo.\nConsole.WriteLine(flight1.Equals(flight3))\n\nDim flight4 = New With {Key .Airline = &quot;Blue Yonder Airlines&quot;,\n                        .FlightNo = 3554, .Gate = &quot;C33&quot;}\n&#39; The following statement displays False. Instance flight4 is not the \n&#39; same type as flight1 because they have different key properties. \n&#39; FlightNo is a key property of flight1 but not of flight4.\nConsole.WriteLine(flight1.Equals(flight4))\n</code></pre><p> If two instances are declared with only non-key properties, identical in name, type, order, and value, the two instances are not equal. An instance without key properties is equal only to itself.  </p>\n<p> For more information about the conditions under which two anonymous type instances are instances of the same anonymous type, see <a href=\"../../programming-guide/language-features/objects-and-classes/anonymous-types\" data-linktype=\"relative-path\">Anonymous Types</a>.  </p>\n<h2 id=\"hash-code-calculation\">Hash Code Calculation</h2>\n<p> Like <a class=\"xref\" href=\"../../../../api/system.object#System_Object_Equals_\" data-linktype=\"relative-path\">Equals</a>, the hash function that is defined in <a class=\"xref\" href=\"../../../../api/system.object#System_Object_GetHashCode_\" data-linktype=\"relative-path\">GetHashCode</a> for an anonymous type is based on the key properties of the type. The following examples show the interaction between key properties and hash code values.  </p>\n<p> Instances of an anonymous type that have the same values for all key properties have the same hash code value, even if non-key properties do not have matching values. The following statement returns <code>True</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrAnonymousTypes#37\">Console.WriteLine(flight1.GetHashCode = flight2.GetHashCode)\n</code></pre><p> Instances of an anonymous type that have different values for one or more key properties have different hash code values. The following statement returns <code>False</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrAnonymousTypes#38\">Console.WriteLine(flight1.GetHashCode = flight3.GetHashCode)\n</code></pre><p> Instances of anonymous types that designate different properties as key properties are not instances of the same type. They have different hash code values even when the names and values of all properties are the same. The following statement returns <code>False</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrAnonymousTypes#39\">Console.WriteLine(flight1.GetHashCode = flight4.GetHashCode)\n</code></pre><h2 id=\"read-only-values\">Read-Only Values</h2>\n<p> The values of key properties cannot be changed. For example, in <code>flight1</code> in the earlier examples, the <code>Airline</code> and <code>FlightNo</code> fields are read-only, but <code>Gate</code> can be changed.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrAnonymousTypes#28\">&#39; The following statement will not compile, because FlightNo is a key\n&#39; property and cannot be changed.\n&#39; flight1.FlightNo = 1234\n&#39;\n&#39; Gate is not a key property. Its value can be changed.\nflight1.Gate = &quot;C5&quot;\n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"../../programming-guide/language-features/objects-and-classes/anonymous-type-definition\" data-linktype=\"relative-path\">Anonymous Type Definition</a><br> <a href=\"../../programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations\" data-linktype=\"relative-path\">How to: Infer Property Names and Types in Anonymous Type Declarations</a><br> <a href=\"../../programming-guide/language-features/objects-and-classes/anonymous-types\" data-linktype=\"relative-path\">Anonymous Types</a></p>\n</div></div>","outputRootRelativePath":"../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"7697a928-7d14-4430-a72a-c9e96e8d6c11\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"22\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/language-reference/modifiers/key.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/language-reference/modifiers/key.md\">\r\n<meta name=\"document_id\" content=\"792dbc60-6698-dd9e-1391-aa7916503086\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../../toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","title":"Key (Visual Basic) | Microsoft Docs","ms.suite":"","ms.assetid":"7697a928-7d14-4430-a72a-c9e96e8d6c11","f1_keywords":["vb.AnonymousKey"],"translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":22,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["anonymous types [Visual Basic], key","Key [Visual Basic]","Key keyword [Visual Basic]"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/language-reference/modifiers/key.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/language-reference/modifiers/key.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/language-reference/modifiers/key.md","document_id":"792dbc60-6698-dd9e-1391-aa7916503086","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/language-reference/modifiers/key","toc_asset_id":"articles/toc.json","toc_rel":"../../../toc.json","_op_ogTitle":"Key (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":649,"_op_rawTitle":"<h1 id=\"key-visual-basic\" sourcefile=\"docs/visual-basic/language-reference/modifiers/key.md\" sourcestartlinenumber=\"40\" sourceendlinenumber=\"40\">Key (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/language-reference/modifiers/key","fileRelativePath":"articles/visual-basic/language-reference/modifiers/key.html"},"themesRelativePathToOutputRoot":"_themes/"}