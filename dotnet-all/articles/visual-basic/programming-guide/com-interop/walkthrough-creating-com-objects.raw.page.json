{"content":"<div><div class=\"content\">\n<p>When creating new applications or components, it is best to create .NET Framework assemblies. However, Visual Basic also makes it easy to expose a .NET Framework component to COM. This enables you to provide new components for earlier application suites that require COM components. This walkthrough demonstrates how to use Visual Basic to expose .NET Framework objects as COM objects, both with and without the COM class template.  </p>\n<p> The easiest way to expose COM objects is by using the COM class template. The COM class template creates a new class, and then configures your project to generate the class and interoperability layer as a COM object and register it with the operating system.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> Although you can also expose a class created in Visual Basic as a COM object for unmanaged code to use, it is not a true COM object and cannot be used by Visual Basic. For more information, see <a href=\"com-interoperability-in-net-framework-applications\" data-linktype=\"relative-path\">COM Interoperability in .NET Framework Applications</a>.  </p>\n</div>\n<div class=\"NOTE\"><h5>Note</h5><p>Your computer might show different names or locations for some of the Visual Studio user interface elements in the following instructions. The Visual Studio edition that you have and the settings that you use determine these elements. For more information, see <a href=\"https://docs.microsoft.com/visualstudio/ide/personalizing-the-visual-studio-ide\" data-linktype=\"external\">Personalizing the IDE</a>.</p>\n</div>\n<h3 id=\"to-create-a-com-object-by-using-the-com-class-template\">To create a COM object by using the COM class template</h3>\n<ol>\n<li><p>Open a new Windows Application project from the <strong>File</strong> menu by clicking <strong>New Project</strong>.  </p>\n</li>\n<li><p>In the <strong>New Project</strong> dialog box under the <strong>Project Types</strong> field, check that Windows is selected. Select <strong>Class Library</strong> from the <strong>Templates</strong> list, and then click <strong>OK</strong>. The new project is displayed.  </p>\n</li>\n<li><p>Select <strong>Add New Item</strong> from the <strong>Project</strong> menu. The <strong>Add New Item</strong> dialog box is displayed.  </p>\n</li>\n<li><p>Select <strong>COM Class</strong> from the <strong>Templates</strong> list, and then click <strong>Add</strong>. Visual Basic adds a new class and configures the new project for COM interop.  </p>\n</li>\n<li><p>Add code such as properties, methods, and events to the COM class.  </p>\n</li>\n<li><p>Select <strong>Build ClassLibrary1</strong> from the <strong>Build</strong> menu. Visual Basic builds the assembly and registers the COM object with the operating system.  </p>\n</li>\n</ol>\n<h2 id=\"creating-com-objects-without-the-com-class-template\">Creating COM Objects without the COM Class Template</h2>\n<p> You can also create a COM class manually instead of using the COM class template. This procedure is helpful when you are working from the command line or when you want more control over how COM objects are defined.  </p>\n<h4 id=\"to-set-up-your-project-to-generate-a-com-object\">To set up your project to generate a COM object</h4>\n<ol>\n<li><p>Open a new Windows Application project from the <strong>File</strong> menu by clicking <strong>NewProject</strong>.  </p>\n</li>\n<li><p>In the <strong>New Project</strong> dialog box under the <strong>Project Types</strong> field, check that Windows is selected. Select <strong>Class Library</strong> from the <strong>Templates</strong> list, and then click <strong>OK</strong>. The new project is displayed.  </p>\n</li>\n<li><p>In <strong>Solution Explorer</strong>, right-click your project, and then click <strong>Properties</strong>. The <strong>Project Designer</strong> is displayed.  </p>\n</li>\n<li><p>Click the <strong>Compile</strong> tab.  </p>\n</li>\n<li><p>Select the <strong>Register for COM Interop</strong> check box.  </p>\n</li>\n</ol>\n<h4 id=\"to-set-up-the-code-in-your-class-to-create-a-com-object\">To set up the code in your class to create a COM object</h4>\n<ol>\n<li><p>In <strong>Solution Explorer</strong>, double-click <strong>Class1.vb</strong> to display its code.  </p>\n</li>\n<li><p>Rename the class to <code>ComClass1</code>.  </p>\n</li>\n<li><p>Add the following constants to <code>ComClass1</code>. They will store the Globally Unique Identifier (GUID) constants that the COM objects are required to have.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrInterop#2\">        Public Const ClassId As String = &quot;&quot;\n        Public Const InterfaceId As String = &quot;&quot;\n        Public Const EventsId As String = &quot;&quot;\n</code></pre></li>\n<li><p>On the <strong>Tools</strong> menu, click <strong>Create Guid</strong>. In the <strong>Create GUID</strong> dialog box, click <strong>Registry Format</strong> and then click <strong>Copy</strong>. Click <strong>Exit</strong>.  </p>\n</li>\n<li><p>Replace the empty string for the <code>ClassId</code> with the GUID, removing the leading and trailing braces. For example, if the GUID provided by Guidgen is <code>&quot;{2C8B0AEE-02C9-486e-B809-C780A11530FE}&quot;</code> then your code should appear as follows.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrInterop#3\">        Public Const ClassId As String = &quot;2C8B0AEE-02C9-486e-B809-C780A11530FE&quot;\n</code></pre></li>\n<li><p>Repeat the previous steps for the <code>InterfaceId</code> and <code>EventsId</code> constants, as in the following example.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrInterop#4\">        Public Const InterfaceId As String = &quot;3D8B5BA4-FB8C-5ff8-8468-11BF6BD5CF91&quot;\n        Public Const EventsId As String = &quot;2B691787-6ED7-401e-90A4-B3B9C0360E31&quot;\n</code></pre><div class=\"NOTE\"><h5>Note</h5><p> Make sure that the GUIDs are new and unique; otherwise, your COM component could conflict with other COM components.  </p>\n</div>\n</li>\n<li><p>Add the <code>ComClass</code> attribute to <code>ComClass1</code>, specifying the GUIDs for the Class ID, Interface ID, and Events ID as in the following example:  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrInterop#5\">    &lt;ComClass(ComClass1.ClassId, ComClass1.InterfaceId, ComClass1.EventsId)&gt;\n    Public Class ComClass1\n</code></pre></li>\n<li><p>COM classes must have a parameterless <code>Public Sub New()</code> constructor, or the class will not register correctly. Add a parameterless constructor to the class:  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrInterop#6\">        Public Sub New()\n            MyBase.New()\n        End Sub\n</code></pre></li>\n<li><p>Add properties, methods, and events to the class, ending it with an <code>End Class</code> statement. Select <strong>Build Solution</strong> from the <strong>Build</strong> menu. Visual Basic builds the assembly and registers the COM object with the operating system.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> The COM objects you generate with Visual Basic cannot be used by other Visual Basic applications because they are not true COM objects. Attempts to add references to such COM objects will raise an error. For details, see <a href=\"com-interoperability-in-net-framework-applications\" data-linktype=\"relative-path\">COM Interoperability in .NET Framework Applications</a>.  </p>\n</div>\n</li>\n</ol>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a class=\"xref\" href=\"../../../../api/microsoft.visualbasic.comclassattribute\" data-linktype=\"relative-path\">ComClassAttribute</a><br> <a href=\"index\" data-linktype=\"relative-path\">COM Interop</a><br> <a href=\"walkthrough-implementing-inheritance-with-com-objects\" data-linktype=\"relative-path\">Walkthrough: Implementing Inheritance with COM Objects</a><br> <a href=\"../../language-reference/directives/region-directive\" data-linktype=\"relative-path\">#Region Directive</a><br> <a href=\"com-interoperability-in-net-framework-applications\" data-linktype=\"relative-path\">COM Interoperability in .NET Framework Applications</a><br> <a href=\"troubleshooting-interoperability\" data-linktype=\"relative-path\">Troubleshooting Interoperability</a></p>\n</div></div>","outputRootRelativePath":"../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-all/api/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"7b07a463-bc72-4392-9ba0-9dfcb697a44f\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"30\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/com-interop/walkthrough-creating-com-objects.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/com-interop/walkthrough-creating-com-objects.md\">\r\n<meta name=\"document_id\" content=\"0b206248-35d9-6aec-c6f8-461ca87bd8fb\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../../toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Walkthrough: Creating COM Objects with Visual Basic | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"7b07a463-bc72-4392-9ba0-9dfcb697a44f","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":30,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["COM interop, creating COM objects","COM objects, creating","COM interop, walkthroughs","object creation, COM objects","COM objects, walkthroughs"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/com-interop/walkthrough-creating-com-objects.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/com-interop/walkthrough-creating-com-objects.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/com-interop/walkthrough-creating-com-objects.md","document_id":"0b206248-35d9-6aec-c6f8-461ca87bd8fb","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/com-interop/walkthrough-creating-com-objects","toc_asset_id":"articles/toc.json","toc_rel":"../../../toc.json","_op_ogTitle":"Walkthrough: Creating COM Objects with Visual Basic","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":805,"_op_rawTitle":"<h1 id=\"walkthrough-creating-com-objects-with-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/com-interop/walkthrough-creating-com-objects.md\" sourcestartlinenumber=\"40\" sourceendlinenumber=\"40\">Walkthrough: Creating COM Objects with Visual Basic</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/com-interop/walkthrough-creating-com-objects","fileRelativePath":"articles/visual-basic/programming-guide/com-interop/walkthrough-creating-com-objects.html"},"themesRelativePathToOutputRoot":"_themes/"}