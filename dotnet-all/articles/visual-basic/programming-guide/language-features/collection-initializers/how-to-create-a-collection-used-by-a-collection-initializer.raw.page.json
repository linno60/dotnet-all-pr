{"content":"<div><div class=\"content\">\n<p>When you use a collection initializer to create a collection, the Visual Basic compiler searches for an <code>Add</code> method of the collection type for which the parameters for the <code>Add</code> method match the types of the values in the collection initializer. This <code>Add</code> method is used to populate the collection with the values from the collection initializer.  </p>\n<h2 id=\"example\">Example</h2>\n<p> The following example shows an <code>OrderCollection</code> collection that contains a public <code>Add</code> method that a collection initializer can use to add objects of type <code>Order</code>. The <code>Add</code> method enables you to use the shortened collection initializer syntax.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrCollectionInitializersHowTo2#4\">Public Class Customer\n    Public Property Id As Integer\n    Public Property Name As String\n    Public Property Orders As OrderCollection\n\n    Public Sub New(ByVal id As Integer, ByVal name As String, ByVal orders As OrderCollection)\n        Me.Id = id\n        Me.Name = name\n        Me.Orders = orders\n    End Sub\nEnd Class\n\nPublic Class Order\n    Public Property Id As Integer\n    Public Property CustomerId As Integer\n    Public Property OrderDate As DateTime\n\n    Public Sub New(ByVal id As Integer,\n                   ByVal customerId As Integer,\n                   ByVal orderDate As DateTime)\n        Me.Id = id\n        Me.CustomerId = customerId\n        Me.OrderDate = orderDate\n    End Sub\nEnd Class\n</code></pre><pre><code class=\"lang-vb\" name=\"VbVbalrCollectionInitializersHowTo2#1\">Public Class OrderCollection\n    Implements IEnumerable(Of Order)\n\n    Dim items As New List(Of Order)\n\n    Public Property Item(ByVal index As Integer) As Order\n        Get\n            Return CType(Me(index), Order)\n        End Get\n        Set(ByVal value As Order)\n            items(index) = value\n        End Set\n    End Property\n\n    Public Sub Add(ByVal id As Integer, ByVal customerID As Integer, ByVal orderDate As DateTime)\n        items.Add(New Order(id, customerID, orderDate))\n    End Sub\n\n    Public Function GetEnumerator() As IEnumerator(Of Order) Implements IEnumerable(Of Order).GetEnumerator\n        Return items.GetEnumerator()\n    End Function\n\n    Public Function GetEnumerator1() As IEnumerator Implements IEnumerable.GetEnumerator\n        Return Me.GetEnumerator()\n    End Function\nEnd Class\n</code></pre><pre><code class=\"lang-vb\" name=\"VbVbalrCollectionInitializersHowTo2#2\">Imports System.Runtime.CompilerServices\n\nModule Module1\n\n    &lt;Extension()&gt;\n    Sub Add(ByVal genericList As List(Of Customer),\n            ByVal id As Integer,\n            ByVal name As String,\n            ByVal orders As OrderCollection)\n\n        genericList.Add(New Customer(id, name, orders))\n    End Sub\nEnd Module\n</code></pre><pre><code class=\"lang-vb\" name=\"VbVbalrCollectionInitializersHowTo2#3\">        Dim customerList = New List(Of Customer) From\n          {\n            {1, &quot;John Rodman&quot;, New OrderCollection From {{9, 1, #6/12/2008#},\n                                                         {8, 1, #6/11/2008#},\n                                                         {5, 1, #5/1/2008#}}},\n            {2, &quot;Ariane Berthier&quot;, New OrderCollection From {{2, 2, #1/18/2008#},\n                                                             {4, 2, #3/8/2008#},\n                                                             {6, 2, #3/18/2008#},\n                                                             {7, 2, #5/14/2008#},\n                                                             {5, 2, #4/4/2008#}}},\n             {3, &quot;Brian Perry&quot;, New OrderCollection From {{1, 3, #1/15/2008#},\n                                                          {3, 3, #3/8/2008#}}}\n          }\n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"index\" data-linktype=\"relative-path\">Collection Initializers</a><br> <a href=\"how-to-create-an-add-extension-method-used-by-a-collection-initializer\" data-linktype=\"relative-path\">How to: Create an Add Extension Method Used by a Collection Initializer</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"c858db10-424d-47e0-92cd-e08087cc5ebc\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"8\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-21 01:42 AM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md\">\r\n<meta name=\"document_id\" content=\"c78fabba-b242-efa0-4f2a-d996ee1e6571\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"How to: Create a Collection Used by a Collection Initializer (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"c858db10-424d-47e0-92cd-e08087cc5ebc","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":8,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["collection initializers [Visual Basic]"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2017-03-21 01:42 AM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"3/21/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md","document_id":"c78fabba-b242-efa0-4f2a-d996ee1e6571","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer","toc_asset_id":"articles/visual-basic/programming-guide/language-features/collection-initializers/toc.json","toc_rel":"toc.json","_op_ogTitle":"How to: Create a Collection Used by a Collection Initializer (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":372,"_op_rawTitle":"<h1 id=\"how-to-create-a-collection-used-by-a-collection-initializer-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md\" sourcestartlinenumber=\"36\" sourceendlinenumber=\"36\">How to: Create a Collection Used by a Collection Initializer (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer","fileRelativePath":"articles/visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.html"},"themesRelativePathToOutputRoot":"_themes/"}