{"content":"<div><div class=\"content\">\n<p>When you declare a programming element in a module, Visual Basic promotes its scope to the namespace containing the module. This is known as <em>type promotion</em>.  </p>\n<p> The following example shows a skeleton definition of a module and two members of that module.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrDeclaredElements#1\">Namespace projNamespace\n    Module projModule\n        Public Enum basicEnum As Integer\n            one = 1\n            two = 2\n        End Enum\n        Public Class innerClass\n            Shared Sub numberSub(ByVal firstArg As Integer)\n            End Sub\n        End Class\n    End Module\nEnd Namespace\n</code></pre><p> Within <code>projModule</code>, programming elements declared at module level are promoted to <code>projNamespace</code>. In the preceding example, <code>basicEnum</code> and <code>innerClass</code> are promoted, but <code>numberSub</code> is not, because it is not declared at module level.  </p>\n<h2 id=\"effect-of-type-promotion\">Effect of Type Promotion</h2>\n<p> The effect of type promotion is that a qualification string does not need to include the module name. The following example makes two calls to the procedure in the preceding example.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrDeclaredElements#2\">    Sub usePromotion()\n        projNamespace.projModule.innerClass.numberSub(projNamespace.projModule.basicEnum.one)\n        projNamespace.innerClass.numberSub(projNamespace.basicEnum.two)\n    End Sub\n</code></pre><p> In the preceding example, the first call uses complete qualification strings. However, this is not necessary because of type promotion. The second call also accesses the module&#39;s members without including <code>projModule</code> in the qualification strings.  </p>\n<h2 id=\"defeat-of-type-promotion\">Defeat of Type Promotion</h2>\n<p> If the namespace already has a member with the same name as a module member, type promotion is defeated for that module member. The following example shows a skeleton definition of an enumeration and a module within the same namespace.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrDeclaredElements#3\">Namespace thisNamespace\n    Public Enum abc\n        first = 1\n        second\n    End Enum\n    Module thisModule\n        Public Class abc\n            Public Sub abcSub()\n            End Sub\n        End Class\n        Public Class xyz\n            Public Sub xyzSub()\n            End Sub\n        End Class\n    End Module\nEnd Namespace\n</code></pre><p> In the preceding example, Visual Basic cannot promote class <code>abc</code> to <code>thisNameSpace</code> because there is already an enumeration with the same name at namespace level. To access <code>abcSub</code>, you must use the full qualification string <code>thisNamespace.thisModule.abc.abcSub</code>. However, class <code>xyz</code> is still promoted, and you can access <code>xyzSub</code> with the shorter qualification string <code>thisNamespace.xyz.xyzSub</code>.  </p>\n<h3 id=\"defeat-of-type-promotion-for-partial-types\">Defeat of Type Promotion for Partial Types</h3>\n<p> If a class or structure inside a module uses the <a href=\"../../../language-reference/modifiers/partial\" data-linktype=\"relative-path\">Partial</a> keyword, type promotion is automatically defeated for that class or structure, whether or not the namespace has a member with the same name. Other elements in the module are still eligible for type promotion.  </p>\n<p> <strong>Consequences.</strong> Defeat of type promotion of a partial definition can cause unexpected results and even compiler errors. The following example shows skeleton partial definitions of a class, one of which is inside a module.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrDeclaredElements#4\">Namespace sampleNamespace\n    Partial Public Class sampleClass\n        Public Sub sub1()\n        End Sub\n    End Class\n    Module sampleModule\n        Partial Public Class sampleClass\n            Public Sub sub2()\n            End Sub\n        End Class\n    End Module\nEnd Namespace\n</code></pre><p> In the preceding example, the developer might expect the compiler to merge the two partial definitions of <code>sampleClass</code>. However, the compiler does not consider promotion for the partial definition inside <code>sampleModule</code>. As a result, it attempts to compile two separate and distinct classes, both named <code>sampleClass</code> but with different qualification paths.  </p>\n<p> The compiler merges partial definitions only when their fully qualified paths are identical.  </p>\n<h2 id=\"recommendations\">Recommendations</h2>\n<p> The following recommendations represent good programming practice.  </p>\n<ul>\n<li><p><strong>Unique Names.</strong> When you have full control over the naming of programming elements, it is always a good idea to use unique names everywhere. Identical names require extra qualification and can make your code harder to read. They can also lead to subtle errors and unexpected results.  </p>\n</li>\n<li><p><strong>Full Qualification.</strong> When you are working with modules and other elements in the same namespace, the safest approach is to always use full qualification for all programming elements. If type promotion is defeated for a module member and you do not fully qualify that member, you could inadvertently access a different programming element.  </p>\n</li>\n</ul>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"../../../language-reference/statements/module-statement\" data-linktype=\"relative-path\">Module Statement</a><br> <a href=\"../../../language-reference/statements/namespace-statement\" data-linktype=\"relative-path\">Namespace Statement</a><br> <a href=\"../../../language-reference/modifiers/partial\" data-linktype=\"relative-path\">Partial</a><br> <a href=\"scope\" data-linktype=\"relative-path\">Scope in Visual Basic</a><br> <a href=\"how-to-control-the-scope-of-a-variable\" data-linktype=\"relative-path\">How to: Control the Scope of a Variable</a><br> <a href=\"references-to-declared-elements\" data-linktype=\"relative-path\">References to Declared Elements</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"035eeb15-e4c5-4288-ab3c-6bd5d22f7051\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"17\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/declared-elements/type-promotion.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/declared-elements/type-promotion.md\">\r\n<meta name=\"document_id\" content=\"1efa64c6-bfdf-3662-f725-02e0ccfa798e\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","title":"Type Promotion (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"035eeb15-e4c5-4288-ab3c-6bd5d22f7051","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":17,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["declared elements, scope","visibility, declared elements","Partial keyword, unexpected results with type promotion","scope, declared elements","scope, Visual Basic","type promotion","declared elements, visibility"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/declared-elements/type-promotion.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/declared-elements/type-promotion.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/declared-elements/type-promotion.md","document_id":"1efa64c6-bfdf-3662-f725-02e0ccfa798e","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/language-features/declared-elements/type-promotion","toc_asset_id":"articles/visual-basic/programming-guide/language-features/declared-elements/toc.json","toc_rel":"toc.json","_op_ogTitle":"Type Promotion (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":630,"_op_rawTitle":"<h1 id=\"type-promotion-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/declared-elements/type-promotion.md\" sourcestartlinenumber=\"42\" sourceendlinenumber=\"42\">Type Promotion (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/language-features/declared-elements/type-promotion","fileRelativePath":"articles/visual-basic/programming-guide/language-features/declared-elements/type-promotion.html"},"themesRelativePathToOutputRoot":"_themes/"}