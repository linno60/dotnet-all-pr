{"content":"<div><div class=\"content\">\n<p>In Visual Basic, you can pass an argument to a procedure <em>by value</em> or <em>by reference</em>. This is known as the <em>passing mechanism</em>, and it determines whether the procedure can modify the programming element underlying the argument in the calling code. The procedure declaration determines the passing mechanism for each parameter by specifying the <a href=\"../../../language-reference/modifiers/byval\" data-linktype=\"relative-path\">ByVal</a> or <a href=\"../../../language-reference/modifiers/byref\" data-linktype=\"relative-path\">ByRef</a> keyword.  </p>\n<h2 id=\"distinctions\">Distinctions</h2>\n<p> When passing an argument to a procedure, be aware of several different distinctions that interact with each other:  </p>\n<ul>\n<li><p>Whether the underlying programming element is modifiable or nonmodifiable  </p>\n</li>\n<li><p>Whether the argument itself is modifiable or nonmodifiable  </p>\n</li>\n<li><p>Whether the argument is being passed by value or by reference  </p>\n</li>\n<li><p>Whether the argument data type is a value type or a reference type  </p>\n<p>For more information, see <a href=\"differences-between-modifiable-and-nonmodifiable-arguments\" data-linktype=\"relative-path\">Differences Between Modifiable and Nonmodifiable Arguments</a> and <a href=\"differences-between-passing-an-argument-by-value-and-by-reference\" data-linktype=\"relative-path\">Differences Between Passing an Argument By Value and By Reference</a>.  </p>\n</li>\n</ul>\n<h2 id=\"choice-of-passing-mechanism\">Choice of Passing Mechanism</h2>\n<p> You should choose the passing mechanism carefully for each argument.  </p>\n<ul>\n<li><p><strong>Protection</strong>. In choosing between the two passing mechanisms, the most important criterion is the exposure of calling variables to change. The advantage of passing an argument <code>ByRef</code> is that the procedure can return a value to the calling code through that argument. The advantage of passing an argument <code>ByVal</code> is that it protects a variable from being changed by the procedure.  </p>\n</li>\n<li><p><strong>Performance</strong>. Although the passing mechanism can affect the performance of your code, the difference is usually insignificant. One exception to this is a value type passed <code>ByVal</code>. In this case, Visual Basic copies the entire data contents of the argument. Therefore, for a large value type such as a structure, it can be more efficient to pass it <code>ByRef</code>.  </p>\n<p> For reference types, only the pointer to the data is copied (four bytes on 32-bit platforms, eight bytes on 64-bit platforms). Therefore, you can pass arguments of type <code>String</code> or <code>Object</code> by value without harming performance.  </p>\n</li>\n</ul>\n<h2 id=\"determination-of-the-passing-mechanism\">Determination of the Passing Mechanism</h2>\n<p> The procedure declaration specifies the passing mechanism for each parameter. The calling code can&#39;t override a <code>ByVal</code> mechanism.  </p>\n<p> If a parameter is declared with <code>ByRef</code>, the calling code can force the mechanism to <code>ByVal</code> by enclosing the argument name in parentheses in the call. For more information, see <a href=\"how-to-force-an-argument-to-be-passed-by-value\" data-linktype=\"relative-path\">How to: Force an Argument to Be Passed by Value</a>.  </p>\n<p> The default in Visual Basic is to pass arguments by value.  </p>\n<h2 id=\"when-to-pass-an-argument-by-value\">When to Pass an Argument by Value</h2>\n<ul>\n<li><p>If the calling code element underlying the argument is a nonmodifiable element, declare the corresponding parameter <a href=\"../../../language-reference/modifiers/byval\" data-linktype=\"relative-path\">ByVal</a>. No code can change the value of a nonmodifiable element.  </p>\n</li>\n<li><p>If the underlying element is modifiable, but you do not want the procedure to be able to change its value, declare the parameter <code>ByVal</code>. Only the calling code can change the value of a modifiable element passed by value.  </p>\n</li>\n</ul>\n<h2 id=\"when-to-pass-an-argument-by-reference\">When to Pass an Argument by Reference</h2>\n<ul>\n<li><p>If the procedure has a genuine need to change the underlying element in the calling code, declare the corresponding parameter <a href=\"../../../language-reference/modifiers/byref\" data-linktype=\"relative-path\">ByRef</a>.  </p>\n</li>\n<li><p>If the correct execution of the code depends on the procedure changing the underlying element in the calling code, declare the parameter <code>ByRef</code>. If you pass it by value, or if the calling code overrides the <code>ByRef</code> passing mechanism by enclosing the argument in parentheses, the procedure call might produce unexpected results.  </p>\n</li>\n</ul>\n<h2 id=\"example\">Example</h2>\n<h3 id=\"description\">Description</h3>\n<p> The following example illustrates when to pass arguments by value and when to pass them by reference. Procedure <code>Calculate</code> has both a <code>ByVal</code> and a <code>ByRef</code> parameter. Given an interest rate, <code>rate</code>, and a sum of money, <code>debt</code>, the task of the procedure is to calculate a new value for <code>debt</code> that is the result of applying the interest rate to the original value of <code>debt</code>. Because <code>debt</code> is a <code>ByRef</code> parameter, the new total is reflected in the value of the argument in the calling code that corresponds to <code>debt</code>. Parameter <code>rate</code> is a <code>ByVal</code> parameter because <code>Calculate</code> should not change its value.  </p>\n<h3 id=\"code\">Code</h3>\n<pre><code class=\"lang-vb\" name=\"VbVbcnProcedures#74\">Module Module1\n\n    Sub Main()\n        &#39; Two interest rates are declared, one a constant and one a \n        &#39; variable.\n        Const highRate As Double = 12.5\n        Dim lowRate = highRate * 0.6\n\n        Dim initialDebt = 4999.99\n        &#39; Make a copy of the original value of the debt.\n        Dim debtWithInterest = initialDebt\n\n        &#39; Calculate the total debt with the high interest rate applied.\n        &#39; Argument highRate is a constant, which is appropriate for a \n        &#39; ByVal parameter. Argument debtWithInterest must be a variable\n        &#39; because the procedure will change its value to the calculated\n        &#39; total with interest applied.\n        Calculate(highRate, debtWithInterest)\n        &#39; Format the result to represent currency, and display it.\n        Dim debtString = Format(debtWithInterest, &quot;C&quot;)\n        Console.WriteLine(&quot;What I owe with high interest: &quot; &amp; debtString)\n\n        &#39; Repeat the process with lowRate. Argument lowRate is not a \n        &#39; constant, but the ByVal parameter protects it from accidental\n        &#39; or intentional change by the procedure. \n\n        &#39; Set debtWithInterest back to the original value.\n        debtWithInterest = initialDebt\n        Calculate(lowRate, debtWithInterest)\n        debtString = Format(debtWithInterest, &quot;C&quot;)\n        Console.WriteLine(&quot;What I owe with low interest:  &quot; &amp; debtString)\n    End Sub\n\n    &#39; Parameter rate is a ByVal parameter because the procedure should\n    &#39; not change the value of the corresponding argument in the \n    &#39; calling code. \n\n    &#39; The calculated value of the debt parameter, however, should be\n    &#39; reflected in the value of the corresponding argument in the \n    &#39; calling code. Therefore, it must be declared ByRef. \n    Sub Calculate(ByVal rate As Double, ByRef debt As Double)\n        debt = debt + (debt * rate / 100)\n    End Sub\n\nEnd Module\n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"index\" data-linktype=\"relative-path\">Procedures</a><br> <a href=\"procedure-parameters-and-arguments\" data-linktype=\"relative-path\">Procedure Parameters and Arguments</a><br> <a href=\"how-to-pass-arguments-to-a-procedure\" data-linktype=\"relative-path\">How to: Pass Arguments to a Procedure</a><br> <a href=\"how-to-change-the-value-of-a-procedure-argument\" data-linktype=\"relative-path\">How to: Change the Value of a Procedure Argument</a><br> <a href=\"how-to-protect-a-procedure-argument-against-value-changes\" data-linktype=\"relative-path\">How to: Protect a Procedure Argument Against Value Changes</a><br> <a href=\"how-to-force-an-argument-to-be-passed-by-value\" data-linktype=\"relative-path\">How to: Force an Argument to Be Passed by Value</a><br> <a href=\"passing-arguments-by-position-and-by-name\" data-linktype=\"relative-path\">Passing Arguments by Position and by Name</a><br> <a href=\"../data-types/value-types-and-reference-types\" data-linktype=\"relative-path\">Value Types and Reference Types</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"fd8a9de6-7178-44d5-a9bf-458d4ad907c2\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"23\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-21 01:42 AM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/procedures/passing-arguments-by-value-and-by-reference.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/programming-guide/language-features/procedures/passing-arguments-by-value-and-by-reference.md\">\r\n<meta name=\"document_id\" content=\"e065d197-ff54-5e96-1ab7-6cf47f47b809\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Passing Arguments by Value and by Reference (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"fd8a9de6-7178-44d5-a9bf-458d4ad907c2","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":23,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["ByRef keyword, passing arguments by reference","Visual Basic code, procedures","passing arguments, by value or by reference","ByVal keyword, passing arguments by value","arguments [Visual Basic], passing by value or by reference","argument passing, by value or by reference"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2017-03-21 01:42 AM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"3/21/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/procedures/passing-arguments-by-value-and-by-reference.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/programming-guide/language-features/procedures/passing-arguments-by-value-and-by-reference.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/procedures/passing-arguments-by-value-and-by-reference.md","document_id":"e065d197-ff54-5e96-1ab7-6cf47f47b809","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/procedures/passing-arguments-by-value-and-by-reference","toc_asset_id":"articles/visual-basic/programming-guide/language-features/procedures/toc.json","toc_rel":"toc.json","_op_ogTitle":"Passing Arguments by Value and by Reference (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":953,"_op_rawTitle":"<h1 id=\"passing-arguments-by-value-and-by-reference-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/procedures/passing-arguments-by-value-and-by-reference.md\" sourcestartlinenumber=\"41\" sourceendlinenumber=\"41\">Passing Arguments by Value and by Reference (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/procedures/passing-arguments-by-value-and-by-reference","fileRelativePath":"articles/visual-basic/programming-guide/language-features/procedures/passing-arguments-by-value-and-by-reference.html"},"themesRelativePathToOutputRoot":"_themes/"}