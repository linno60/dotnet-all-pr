{"content":"<div><div class=\"content\">\n<p>An operator procedure is a series of Visual Basic statements that define the behavior of a standard operator (such as <code>*</code>, <code>&lt;&gt;</code>, or <code>And</code>) on a class or structure you have defined. This is also called <em>operator overloading</em>.  </p>\n<h2 id=\"when-to-define-operator-procedures\">When to Define Operator Procedures</h2>\n<p> When you have defined a class or structure, you can declare variables to be of the type of that class or structure. Sometimes such a variable needs to participate in an operation as part of an expression. To do this, it must be an operand of an operator.  </p>\n<p> Visual Basic defines operators only on its fundamental data types. You can define the behavior of an operator when one or both of the operands are of the type of your class or structure.  </p>\n<p> For more information, see <a href=\"../../../language-reference/statements/operator-statement\" data-linktype=\"relative-path\">Operator Statement</a>.  </p>\n<h2 id=\"types-of-operator-procedure\">Types of Operator Procedure</h2>\n<p> An operator procedure can be one of the following types:  </p>\n<ul>\n<li><p>A definition of a unary operator where the argument is of the type of your class or structure.  </p>\n</li>\n<li><p>A definition of a binary operator where at least one of the arguments is of the type of your class or structure.  </p>\n</li>\n<li><p>A definition of a conversion operator where the argument is of the type of your class or structure.  </p>\n</li>\n<li><p>A definition of a conversion operator that returns the type of your class or structure.  </p>\n<p>Conversion operators are always unary, and you always use <code>CType</code> as the operator you are defining.  </p>\n</li>\n</ul>\n<h2 id=\"declaration-syntax\">Declaration Syntax</h2>\n<p> The syntax for declaring an operator procedure is as follows:  </p>\n<p> <code>Public Shared</code>   <code>[Widening | Narrowing]</code>   <code>Operator</code>  <em>operatorsymbol</em>  <code>(</code> <em>operand1</em>  <code>[,</code>  <em>operand2</em> <code>]) As</code>  <em>datatype</em>  </p>\n<p> <code>&#39; Statements of the operator procedure.</code>  </p>\n<p> <code>End Operator</code>  </p>\n<p> You use the <code>Widening</code> or <code>Narrowing</code> keyword only on a type conversion operator. The operator symbol is always <a href=\"../../../language-reference/functions/ctype-function\" data-linktype=\"relative-path\">CType Function</a> for a type conversion operator.  </p>\n<p> You declare two operands to define a binary operator, and you declare one operand to define a unary operator, including a type conversion operator. All operands must be declared <code>ByVal</code>.  </p>\n<p> You declare each operand the same way you declare parameters for <a href=\"sub-procedures\" data-linktype=\"relative-path\">Sub Procedures</a>.  </p>\n<h3 id=\"data-type\">Data Type</h3>\n<p> Because you are defining an operator on a class or structure you have defined, at least one of the operands must be of the data type of that class or structure. For a type conversion operator, either the operand or the return type must be of the data type of the class or structure.  </p>\n<p> For more details, see <a href=\"../../../language-reference/statements/operator-statement\" data-linktype=\"relative-path\">Operator Statement</a>.  </p>\n<h2 id=\"calling-syntax\">Calling Syntax</h2>\n<p> You invoke an operator procedure implicitly by using the operator symbol in an expression. You supply the operands the same way you do for predefined operators.  </p>\n<p> The syntax for an implicit call to an operator procedure is as follows:  </p>\n<p> <code>Dim testStruct As</code>  <em>structurename</em>  </p>\n<p> <code>Dim testNewStruct As</code>  <em>structurename</em>  <code>= testStruct</code>  <em>operatorsymbol</em>  <code>10</code>  </p>\n<h3 id=\"illustration-of-declaration-and-call\">Illustration of Declaration and Call</h3>\n<p> The following structure stores a signed 128-bit integer value as the constituent high-order and low-order parts. It defines the <code>+</code> operator to add two <code>veryLong</code> values and generate a resulting <code>veryLong</code> value.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbcnProcedures#23\">  Public Structure veryLong\n      Dim highOrder As Long\n      Dim lowOrder As Long\n      Public Shared Operator +(ByVal v As veryLong, \n                               ByVal w As veryLong) As veryLong\n          Dim sum As New veryLong\n          sum = v\n          Try\n              sum.lowOrder += w.lowOrder\n          Catch ex As System.OverflowException\n              sum.lowOrder -= (Long.MaxValue - w.lowOrder + 1)\n              sum.highOrder += 1\n          End Try\n          sum.highOrder += w.highOrder\n          Return sum\n      End Operator\n  End Structure\n</code></pre><p> The following example shows a typical call to the <code>+</code> operator defined on <code>veryLong</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbcnProcedures#24\">    Dim v1, v2, v3 As veryLong\n    v1.highOrder = 1\n    v1.lowOrder = Long.MaxValue\n    v2.highOrder = 0\n    v2.lowOrder = 4\n    v3 = v1 + v2\n</code></pre><p> For more information and examples, see <a href=\"http://go.microsoft.com/fwlink/?LinkId=101703\" data-linktype=\"external\">Operator Overloading in Visual Basic 2005</a>.  </p>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"index\" data-linktype=\"relative-path\">Procedures</a><br> <a href=\"sub-procedures\" data-linktype=\"relative-path\">Sub Procedures</a><br> <a href=\"function-procedures\" data-linktype=\"relative-path\">Function Procedures</a><br> <a href=\"property-procedures\" data-linktype=\"relative-path\">Property Procedures</a><br> <a href=\"procedure-parameters-and-arguments\" data-linktype=\"relative-path\">Procedure Parameters and Arguments</a><br> <a href=\"../../../language-reference/statements/operator-statement\" data-linktype=\"relative-path\">Operator Statement</a><br> <a href=\"how-to-define-an-operator\" data-linktype=\"relative-path\">How to: Define an Operator</a><br> <a href=\"how-to-define-a-conversion-operator\" data-linktype=\"relative-path\">How to: Define a Conversion Operator</a><br> <a href=\"how-to-call-an-operator-procedure\" data-linktype=\"relative-path\">How to: Call an Operator Procedure</a><br> <a href=\"how-to-use-a-class-that-defines-operators\" data-linktype=\"relative-path\">How to: Use a Class that Defines Operators</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-all/api/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"8c513d38-246b-4fb7-8b75-29e1364e555b\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"17\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/procedures/operator-procedures.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/procedures/operator-procedures.md\">\r\n<meta name=\"document_id\" content=\"6f56689f-dfa7-1daa-322a-3e1aaf94c218\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Operator Procedures (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"8c513d38-246b-4fb7-8b75-29e1364e555b","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":17,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["Visual Basic code, procedures","procedures, operator","Visual Basic code, operators","syntax, Operator procedures","operators [Visual Basic], overloading","overloaded operators","operator overloading","operator procedures"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/procedures/operator-procedures.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/procedures/operator-procedures.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/procedures/operator-procedures.md","document_id":"6f56689f-dfa7-1daa-322a-3e1aaf94c218","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/procedures/operator-procedures","toc_asset_id":"articles/visual-basic/programming-guide/language-features/procedures/toc.json","toc_rel":"toc.json","_op_ogTitle":"Operator Procedures (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":635,"_op_rawTitle":"<h1 id=\"operator-procedures-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/procedures/operator-procedures.md\" sourcestartlinenumber=\"43\" sourceendlinenumber=\"43\">Operator Procedures (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/procedures/operator-procedures","fileRelativePath":"articles/visual-basic/programming-guide/language-features/procedures/operator-procedures.html"},"themesRelativePathToOutputRoot":"_themes/"}