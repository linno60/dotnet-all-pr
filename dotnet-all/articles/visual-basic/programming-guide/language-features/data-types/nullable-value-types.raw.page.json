{"content":"<div><div class=\"content\">\n<p>Sometimes you work with a value type that does not have a defined value in certain circumstances. For example, a field in a database might have to distinguish between having an assigned value that is meaningful and not having an assigned value. Value types can be extended to take either their normal values or a null value. Such an extension is called a <em>nullable type</em>.  </p>\n<p> Each nullable type is constructed from the generic <a class=\"xref\" href=\"../../../../../api/system.nullable-1\" data-linktype=\"relative-path\">Nullable&lt;T&gt;</a> structure. Consider a database that tracks work-related activities. The following example constructs a nullable <code>Boolean</code> type and declares a variable of that type. You can write the declaration in three ways:  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrNullableValue#1\">        Dim ridesBusToWork1? As Boolean\n        Dim ridesBusToWork2 As Boolean?\n        Dim ridesBusToWork3 As Nullable(Of Boolean)\n</code></pre><p> The variable <code>ridesBusToWork</code> can hold a value of <code>True</code>, a value of <code>False</code>, or no value at all. Its initial default value is no value at all, which in this case could mean that the information has not yet been obtained for this person. In contrast, <code>False</code> could mean that the information has been obtained and the person does not ride the bus to work.  </p>\n<p> You can declare variables and properties with nullable types, and you can declare an array with elements of a nullable type. You can declare procedures with nullable types as parameters, and you can return a nullable type from a <code>Function</code> procedure.  </p>\n<p> You cannot construct a nullable type on a reference type such as an array, a <code>String</code>, or a class. The underlying type must be a value type. For more information, see <a href=\"value-types-and-reference-types\" data-linktype=\"relative-path\">Value Types and Reference Types</a>.  </p>\n<h2 id=\"using-a-nullable-type-variable\">Using a Nullable Type Variable</h2>\n<p> The most important members of a nullable type are its <a class=\"xref\" href=\"../../../../../api/system.nullable-1#System_Nullable_1_HasValue_\" data-linktype=\"relative-path\">HasValue</a> and <a class=\"xref\" href=\"../../../../../api/system.nullable-1#System_Nullable_1_Value_\" data-linktype=\"relative-path\">Value</a> properties. For a variable of a nullable type, <a class=\"xref\" href=\"../../../../../api/system.nullable-1#System_Nullable_1_HasValue_\" data-linktype=\"relative-path\">HasValue</a> tells you whether the variable contains a defined value. If <a class=\"xref\" href=\"../../../../../api/system.nullable-1#System_Nullable_1_HasValue_\" data-linktype=\"relative-path\">HasValue</a> is <code>True</code>, you can read the value from <a class=\"xref\" href=\"../../../../../api/system.nullable-1#System_Nullable_1_Value_\" data-linktype=\"relative-path\">Value</a>. Note that both <a class=\"xref\" href=\"../../../../../api/system.nullable-1#System_Nullable_1_HasValue_\" data-linktype=\"relative-path\">HasValue</a> and <a class=\"xref\" href=\"../../../../../api/system.nullable-1#System_Nullable_1_Value_\" data-linktype=\"relative-path\">Value</a> are <code>ReadOnly</code> properties.  </p>\n<h3 id=\"default-values\">Default Values</h3>\n<p> When you declare a variable with a nullable type, its <a class=\"xref\" href=\"../../../../../api/system.nullable-1#System_Nullable_1_HasValue_\" data-linktype=\"relative-path\">HasValue</a> property has a default value of <code>False</code>. This means that by default the variable has no defined value, instead of the default value of its underlying value type. In the following example, the variable <code>numberOfChildren</code> initially has no defined value, even though the default value of the <code>Integer</code> type is 0.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrNullableValue#2\">        Dim numberOfChildren? As Integer\n</code></pre><p> A null value is useful to indicate an undefined or unknown value. If <code>numberOfChildren</code> had been declared as <code>Integer</code>, there would be no value that could indicate that the information is not currently available.  </p>\n<h3 id=\"storing-values\">Storing Values</h3>\n<p> You store a value in a variable or property of a nullable type in the typical way. The following example assigns a value to the variable <code>numberOfChildren</code> declared in the previous example.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrNullableValue#3\">        numberOfChildren = 2\n</code></pre><p> If a variable or property of a nullable type contains a defined value, you can cause it to revert to its initial state of not having a value assigned. You do this by setting the variable or property to <code>Nothing</code>, as the following example shows.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrNullableValue#4\">        numberOfChildren = Nothing\n</code></pre><div class=\"NOTE\"><h5>Note</h5><p> Although you can assign <code>Nothing</code> to a variable of a nullable type, you cannot test it for <code>Nothing</code> by using the equal sign. Comparison that uses the equal sign, <code>someVar = Nothing</code>, always evaluates to <code>Nothing</code>. You can test the variable&#39;s <a class=\"xref\" href=\"../../../../../api/system.nullable-1#System_Nullable_1_HasValue_\" data-linktype=\"relative-path\">HasValue</a> property for <code>False</code>, or test by using the <code>Is</code> or <code>IsNot</code> operator.  </p>\n</div>\n<h3 id=\"retrieving-values\">Retrieving Values</h3>\n<p> To retrieve the value of a variable of a nullable type, you should first test its <a class=\"xref\" href=\"../../../../../api/system.nullable-1#System_Nullable_1_HasValue_\" data-linktype=\"relative-path\">HasValue</a> property to confirm that it has a value. If you try to read the value when <a class=\"xref\" href=\"../../../../../api/system.nullable-1#System_Nullable_1_HasValue_\" data-linktype=\"relative-path\">HasValue</a> is <code>False</code>, Visual Basic throws an <a class=\"xref\" href=\"../../../../../api/system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a> exception. The following example shows the recommended way to read the variable <code>numberOfChildren</code> of the previous examples.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrNullableValue#5\">        If numberOfChildren.HasValue Then\n            MsgBox(&quot;There are &quot; &amp; CStr(numberOfChildren) &amp; &quot; children.&quot;)\n        Else\n            MsgBox(&quot;It is not known how many children there are.&quot;)\n        End If\n</code></pre><h2 id=\"comparing-nullable-types\">Comparing Nullable Types</h2>\n<p> When nullable <code>Boolean</code> variables are used in Boolean expressions, the result can be <code>True</code>, <code>False</code>, or <code>Nothing</code>. The following is the truth table for <code>And</code> and <code>Or</code>. Because <code>b1</code> and <code>b2</code> now have three possible values, there are nine combinations to evaluate.  </p>\n<table>\n<thead>\n<tr>\n<th>b1</th>\n<th>b2</th>\n<th>b1 And b2</th>\n<th>b1 Or b2</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>Nothing</code></td>\n<td><code>Nothing</code></td>\n<td><code>Nothing</code></td>\n<td><code>Nothing</code></td>\n</tr>\n<tr>\n<td><code>Nothing</code></td>\n<td><code>True</code></td>\n<td><code>Nothing</code></td>\n<td><code>True</code></td>\n</tr>\n<tr>\n<td><code>Nothing</code></td>\n<td><code>False</code></td>\n<td><code>False</code></td>\n<td><code>Nothing</code></td>\n</tr>\n<tr>\n<td><code>True</code></td>\n<td><code>Nothing</code></td>\n<td><code>Nothing</code></td>\n<td><code>True</code></td>\n</tr>\n<tr>\n<td><code>True</code></td>\n<td><code>True</code></td>\n<td><code>True</code></td>\n<td><code>True</code></td>\n</tr>\n<tr>\n<td><code>True</code></td>\n<td><code>False</code></td>\n<td><code>False</code></td>\n<td><code>True</code></td>\n</tr>\n<tr>\n<td><code>False</code></td>\n<td><code>Nothing</code></td>\n<td><code>False</code></td>\n<td><code>Nothing</code></td>\n</tr>\n<tr>\n<td><code>False</code></td>\n<td><code>True</code></td>\n<td><code>False</code></td>\n<td><code>True</code></td>\n</tr>\n<tr>\n<td><code>False</code></td>\n<td><code>False</code></td>\n<td><code>False</code></td>\n<td><code>False</code></td>\n</tr>\n</tbody>\n</table>\n<p> When the value of a Boolean variable or expression is <code>Nothing</code>, it is neither <code>true</code> nor <code>false</code>. Consider the following example.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrNullableValue#6\">        Dim b1? As Boolean\n        Dim b2? As Boolean\n        b1 = True\n        b2 = Nothing\n\n        &#39; The following If statement displays &quot;Expression is not true&quot;.\n        If (b1 And b2) Then\n            Console.WriteLine(&quot;Expression is true&quot;)\n        Else\n            Console.WriteLine(&quot;Expression is not true&quot;)\n        End If\n\n        &#39; The following If statement displays &quot;Expression is not false&quot;.\n        If Not (b1 And b2) Then\n            Console.WriteLine(&quot;Expression is false&quot;)\n        Else\n            Console.WriteLine(&quot;Expression is not false&quot;)\n        End If\n</code></pre><p> In this example, <code>b1 And b2</code> evaluates to <code>Nothing</code>. As a result, the <code>Else</code> clause is executed in each <code>If</code> statement, and the output is as follows:  </p>\n<p> <code>Expression is not true</code>  </p>\n<p> <code>Expression is not false</code>  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> <code>AndAlso</code> and <code>OrElse</code>, which use short-circuit evaluation, must evaluate their second operands when the first evaluates to <code>Nothing</code>.  </p>\n</div>\n<h2 id=\"propagation\">Propagation</h2>\n<p> If one or both of the operands of an arithmetic, comparison, shift, or type operation is nullable, the result of the operation is also nullable. If both operands have values that are not <code>Nothing</code>, the operation is performed on the underlying values of the operands, as if neither were a nullable type. In the following example, variables <code>compare1</code> and <code>sum1</code> are implicitly typed. If you rest the mouse pointer over them, you will see that the compiler infers nullable types for both of them.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrNullableValue#7\">        &#39; Variable n is a nullable type, but both m and n have proper values.\n        Dim m As Integer = 3\n        Dim n? As Integer = 2\n\n        &#39; The comparison evaluated is 3&gt;2, but compare1 is inferred to be of \n        &#39; type Boolean?.\n        Dim compare1 = m &gt; n\n        &#39; The values summed are 3 and 2, but sum1 is inferred to be of type Integer?.\n        Dim sum1 = m + n\n\n        &#39; The following line displays: 3 * 2 * 5 * True\n        Console.WriteLine(m &amp; &quot; * &quot; &amp; n &amp; &quot; * &quot; &amp; sum1 &amp; &quot; * &quot; &amp; compare1)\n</code></pre><p> If one or both operands have a value of <code>Nothing</code>, the result will be <code>Nothing</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrNullableValue#8\">        &#39; Change the value of n to Nothing.\n        n = Nothing\n\n        Dim compare2 = m &gt; n\n        Dim sum2 = m + n\n\n        &#39; Because the values of n, compare2, and sum2 are all Nothing, the\n        &#39; following line displays 3 * * *\n        Console.WriteLine(m &amp; &quot; * &quot; &amp; n &amp; &quot; * &quot; &amp; sum2 &amp; &quot; * &quot; &amp; compare2)\n</code></pre><h2 id=\"using-nullable-types-with-data\">Using Nullable Types with Data</h2>\n<p> A database is one of the most important places to use nullable types. Not all database objects currently support nullable types, but the designer-generated table adapters do. See &quot;TableAdapter Support for Nullable Types&quot; in <a href=\"https://docs.microsoft.com/visualstudio/data-tools/tableadapter-overview\" data-linktype=\"external\">TableAdapter Overview</a>.  </p>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a class=\"xref\" href=\"../../../../../api/system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a><br> <a class=\"xref\" href=\"../../../../../api/system.nullable-1#System_Nullable_1_HasValue_\" data-linktype=\"relative-path\">HasValue</a><br> <a href=\"../../../../csharp/programming-guide/nullable-types/using-nullable-types\" data-linktype=\"relative-path\">Using Nullable Types</a><br> <a href=\"index\" data-linktype=\"relative-path\">Data Types</a><br> <a href=\"value-types-and-reference-types\" data-linktype=\"relative-path\">Value Types and Reference Types</a><br> <a href=\"troubleshooting-data-types\" data-linktype=\"relative-path\">Troubleshooting Data Types</a><br> <a href=\"https://docs.microsoft.com/visualstudio/data-tools/tableadapter-overview\" data-linktype=\"external\">TableAdapter Overview</a><br> <a href=\"../../../language-reference/operators/if-operator\" data-linktype=\"relative-path\">If Operator</a><br> <a href=\"../variables/local-type-inference\" data-linktype=\"relative-path\">Local Type Inference</a><br> <a href=\"../../../language-reference/operators/is-operator\" data-linktype=\"relative-path\">Is Operator</a><br> <a href=\"../../../language-reference/operators/isnot-operator\" data-linktype=\"relative-path\">IsNot Operator</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"9ac3b602-6f96-4e6d-96f7-cd4e81c468a6\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"23\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/data-types/nullable-value-types.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/data-types/nullable-value-types.md\">\r\n<meta name=\"document_id\" content=\"48eb1cea-18db-ffcd-5af8-c49ce6c4269e\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Nullable Value Types (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"9ac3b602-6f96-4e6d-96f7-cd4e81c468a6","f1_keywords":["vb.Nullable"],"translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":23,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["nullable types [Visual Basic]","? [Visual Basic]","types [Visual Basic], nullable","nullable types","data types [Visual Basic], nullable"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Absolute urls and other fixes (#1281)","commit_sha":"f7dffe4885b331cec8d37f3cc5c9163f69c3b4c9","commit_date":"2016-11-22 12:57:26 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/data-types/nullable-value-types.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/data-types/nullable-value-types.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/data-types/nullable-value-types.md","document_id":"48eb1cea-18db-ffcd-5af8-c49ce6c4269e","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/data-types/nullable-value-types","toc_asset_id":"articles/visual-basic/programming-guide/language-features/data-types/toc.json","toc_rel":"toc.json","_op_ogTitle":"Nullable Value Types (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":1190,"_op_rawTitle":"<h1 id=\"nullable-value-types-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/data-types/nullable-value-types.md\" sourcestartlinenumber=\"42\" sourceendlinenumber=\"42\">Nullable Value Types (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/data-types/nullable-value-types","fileRelativePath":"articles/visual-basic/programming-guide/language-features/data-types/nullable-value-types.html"},"themesRelativePathToOutputRoot":"_themes/"}