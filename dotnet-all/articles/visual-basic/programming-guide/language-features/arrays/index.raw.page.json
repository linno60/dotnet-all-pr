{"content":"<div><div class=\"content\">\n<p>An array is a set of values that are logically related to each other, such as the number of students in each grade in a grammar school.  If you are looking for help on arrays in Visual Basic for Applications (VBA), see the <a href=\"https://msdn.microsoft.com/library/office/gg264383(v=office.14).aspx\" data-linktype=\"external\">language reference</a>.  </p>\n<p> By using an array, you can refer to these related values by the same name, and use a number that’s called an index or subscript to tell them apart. The individual values are called the elements of the array. They’re contiguous from index 0 through the highest index value.  </p>\n<p> In contrast to an array, a variable that contain a single value is called a <em>scalar</em> variable.  </p>\n<p> Some quick examples before explanation:  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">\n&#39;Declare a single-dimension array of 5 values  \nDim numbers(4) As Integer   \n\n‘Declare a single-dimension array and set array element values  \nDim numbers = New Integer() {1, 2, 4, 8}  \n\n ‘Redefine the size of an existing array retaining the current values  \nReDim Preserve numbers(15)  \n\n ‘Redefine the size of an existing array, resetting the values  \nReDim numbers(15)  \n\n‘Declare a multi-dimensional array  \nDim matrix(5, 5) As Double  \n\n‘Declare a multi-dimensional array and set array element values  \nDim matrix = New Integer(4, 4) {{1, 2}, {3, 4}, {5, 6}, {7, 8}}  \n\n ‘Declare a jagged array  \nDim sales()() As Double = New Double(11)() {}  \n</code></pre><p> <strong>In this topic</strong>  </p>\n<ul>\n<li><p><a href=\"#BKMK_ArrayElements\" data-linktype=\"self-bookmark\">Array Elements in a Simple Array</a>  </p>\n</li>\n<li><p><a href=\"#BKMK_CreatingAnArray\" data-linktype=\"self-bookmark\">Creating an Array</a>  </p>\n</li>\n<li><p><a href=\"#BKMK_StoringValues\" data-linktype=\"self-bookmark\">Storing Values in an Array</a>  </p>\n</li>\n<li><p><a href=\"#BKMK_Populating\" data-linktype=\"self-bookmark\">Populating an Array with Initial Values</a>  </p>\n<ul>\n<li><a href=\"#BKMK_NestedArrayLiterals\" data-linktype=\"self-bookmark\">Nested Array Literals</a>  </li>\n</ul>\n</li>\n<li><p><a href=\"#BKMK_Iterating\" data-linktype=\"self-bookmark\">Iterating Through an Array</a>  </p>\n</li>\n<li><p><a href=\"#BKMK_ReturnValues\" data-linktype=\"self-bookmark\">Arrays as Return Values and Parameters</a>  </p>\n</li>\n<li><p><a href=\"#BKMK_JaggedArrays\" data-linktype=\"self-bookmark\">Jagged Arrays</a>  </p>\n</li>\n<li><p><a href=\"#BKMK_ZeroLength\" data-linktype=\"self-bookmark\">Zero-Length Arrays</a>  </p>\n</li>\n<li><p><a href=\"#BKMK_ArraySize\" data-linktype=\"self-bookmark\">Array Size</a>  </p>\n</li>\n<li><p><a href=\"#BKMK_ArrayTypes\" data-linktype=\"self-bookmark\">Array Types and Other Types</a>  </p>\n</li>\n<li><p><a href=\"#BKMK_Collections\" data-linktype=\"self-bookmark\">Collections as an Alternative to Arrays</a>  </p>\n</li>\n</ul>\n<h2 id=\"a-namebkmkarrayelementsa-array-elements-in-a-simple-array\"><a name=\"BKMK_ArrayElements\"></a> Array Elements in a Simple Array</h2>\n<p> The following example declares an array variable to hold the number of students in each grade in a grammar school.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#2\">&#39; Create an array of type String().\nDim winterMonths = {&quot;December&quot;, &quot;January&quot;, &quot;February&quot;}\n\n&#39; Create an array of type Integer()\nDim numbers = {1, 2, 3, 4, 5}\n\n&#39; Create a list of menu options. (Requires an extension method\n&#39; named Add for List(Of MenuOption)\nDim menuOptions = New List(Of MenuOption) From {{1, &quot;Home&quot;},\n                                                {2, &quot;Products&quot;},\n                                                {3, &quot;News&quot;},\n                                                {4, &quot;Contact Us&quot;}}\n</code></pre><p> The array <code>students</code> in the preceding example contains seven elements. The indexes of the elements range from 0 through 6. Having this array is simpler than declaring seven variables.  </p>\n<p> The following illustration shows the array <code>students</code>. For each element of the array:  </p>\n<ul>\n<li><p>The index of the element represents the grade (index 0 represents kindergarten).  </p>\n</li>\n<li><p>The value that’s contained in the element represents the number of students in that grade.  </p>\n</li>\n</ul>\n<p> <img src=\"media/arrayexampleschool.gif\" alt=\"Picture of array showing numbers of students\" title=\"ArrayExampleSchool\" data-linktype=\"relative-path\"><br>Elements of the &quot;students&quot; array  </p>\n<p> The following example shows how to refer to the first, second, and last element of the array <code>students</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#3\">Dim names As New List(Of String) From {&quot;Christa&quot;, &quot;Brian&quot;, &quot;Tim&quot;}\n</code></pre><p> You can refer to the array as a whole by using just the array variable name without indexes.  </p>\n<p> The array <code>students</code> in the preceding example uses one index and is said to be one-dimensional. An array that uses more than one index or subscript is called multidimensional. For more information, see the rest of this topic and <a href=\"array-dimensions\" data-linktype=\"relative-path\">Array Dimensions in Visual Basic</a>.  </p>\n<h2 id=\"a-namebkmkcreatinganarraya-creating-an-array\"><a name=\"BKMK_CreatingAnArray\"></a> Creating an Array</h2>\n<p> You can define the size of an array several ways. You can supply the size when the array is declared, as the following example shows.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#12\">Public Class AppMenu\n    Public Property Items As List(Of String) =\n        New List(Of String) From {&quot;Home&quot;, &quot;About&quot;, &quot;Contact&quot;}\nEnd Class\n</code></pre><p> You can also use a <code>New</code> clause to supply the size of an array when it’s created, as the following example shows.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#11\">Dim customers = New List(Of Customer) From\n    {\n        New Customer(&quot;City Power &amp; Light&quot;, &quot;http://www.cpandl.com/&quot;),\n        New Customer(&quot;Wide World Importers&quot;, &quot;http://www.wideworldimporters.com/&quot;),\n        New Customer(&quot;Lucerne Publishing&quot;, &quot;http://www.lucernepublishing.com/&quot;)\n    }\n</code></pre><p> If you have an existing array, you can redefine its size by using the <code>Redim</code> statement. You can specify that the <code>Redim</code> statement should keep the values that are in the array, or you can specify that it create an empty array. The following example shows different uses of the <code>Redim</code> statement to modify the size of an existing array.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#13\">Dim customers = New List(Of Customer) \ncustomers.Add(New Customer(&quot;City Power &amp; Light&quot;, &quot;http://www.cpandl.com/&quot;))\ncustomers.Add(New Customer(&quot;Wide World Importers&quot;, &quot;http://www.wideworldimporters.com/&quot;))\ncustomers.Add(New Customer(&quot;Lucerne Publishing&quot;, &quot;http://www.lucernepublishing.com/&quot;))\n</code></pre><p> For more information, see <a href=\"../../../language-reference/statements/redim-statement\" data-linktype=\"relative-path\">ReDim Statement</a>.  </p>\n<h2 id=\"a-namebkmkstoringvaluesa-storing-values-in-an-array\"><a name=\"BKMK_StoringValues\"></a> Storing Values in an Array</h2>\n<p> You can access each location in an array by using an index of type <code>Integer</code>. You can store and retrieve values in an array by referencing each array location by using its index enclosed in parentheses. Indexes for multi-dimensional arrays are separated by commas (,). You need one index for each array dimension. The following example shows some statements that store values in arrays.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#5\">Dim days = New Dictionary(Of Integer, String) From\n    {{0, &quot;Sunday&quot;}, {1, &quot;Monday&quot;}}\n</code></pre><p> The following example shows some statements that get values from arrays.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#6\">Dim days = New Dictionary(Of Integer, String)\ndays.Add(0, &quot;Sunday&quot;)\ndays.Add(1, &quot;Monday&quot;)\n</code></pre><h2 id=\"a-namebkmkpopulatinga-populating-an-array-with-initial-values\"><a name=\"BKMK_Populating\"></a> Populating an Array with Initial Values</h2>\n<p> By using an array literal, you can create an array that contains an initial set of values. An array literal consists of a list of comma-separated values that are enclosed in braces (<code>{}</code>).  </p>\n<p> When you create an array by using an array literal, you can either supply the array type or use type inference to determine the array type. The following code shows both options.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrCollectionInitializers#3\">Dim numbers = New Integer() {1, 2, 4, 8}\nDim doubles = {1.5, 2, 9.9, 18}\n</code></pre><p> When you use type inference, the type of the array is determined by the dominant type in the list of values that’s supplied for the array literal. The dominant type is a unique type to which all other types in the array literal can widen. If this unique type can’t be determined, the dominant type is the unique type to which all other types in the array can narrow. If neither of these unique types can be determined, the dominant type is <code>Object</code>. For example, if the list of values that’s supplied to the array literal contains values of type <code>Integer</code>, <code>Long</code>, and <code>Double</code>, the resulting array is of type <code>Double</code>. Both <code>Integer</code> and <code>Long</code> widen only to <code>Double</code>. Therefore, <code>Double</code> is the dominant type. For more information, see <a href=\"../data-types/widening-and-narrowing-conversions\" data-linktype=\"relative-path\">Widening and Narrowing Conversions</a>. These inference rules apply to types that are inferred for arrays that are local variables that are defined in a class member. Although you can use array literals when you create class-level variables, you can’t use type inference at the class level. As a result, array literals that are specified at the class level infer the values that are supplied for the array literal as type <code>Object</code>.  </p>\n<p> You can explicitly specify the type of the elements in an array that’s created by using an array literal. In this case, the values in the array literal must widen to the type of the elements of the array. The following code example creates an array of type <code>Double</code> from a list of integers.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrCollectionInitializers#4\">Dim values As Double() = {1, 2, 3, 4, 5, 6}\n</code></pre><h3 id=\"a-namebkmknestedarrayliteralsa-nested-array-literals\"><a name=\"BKMK_NestedArrayLiterals\"></a> Nested Array Literals</h3>\n<p> You can create a multidimensional array by using nested array literals. Nested array literals must have a dimension and number of dimensions, or rank, that’s consistent with the resulting array. The following code example creates a two-dimensional array of integers by using an array literal.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrCollectionInitializers#7\">Dim grid = {{1, 2}, {3, 4}}\n</code></pre><p> In the previous example, an error would occur if the number of elements in the nested array literals didn’t match. An error would also occur if you explicitly declared the array variable to be other than two-dimensional.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> You can avoid an error when you supply nested array literals of different dimensions by enclosing the inner array literals in parentheses. The parentheses force the array literal expression to be evaluated, and the resulting values are used with the outer array literal, as the following code shows.  </p>\n</div>\n<pre><code class=\"lang-vb\" name=\"VbVbalrCollectionInitializers#11\">Dim values = {({1, 2}), ({3, 4, 5})}\n</code></pre><p> When you create a multidimensional array by using nested array literals, you can use type inference. When you use type inference, the inferred type is the dominant type for all the values in all the array literals for a nesting level. The following code example creates a two-dimensional array of type <code>Double</code> from values that are of type <code>Integer</code> and <code>Double</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrCollectionInitializers#8\">Dim a = {{1, 2.0}, {3, 4}, {5, 6}, {7, 8}}\n</code></pre><p> For additional examples, see <a href=\"how-to-initialize-an-array-variable\" data-linktype=\"relative-path\">How to: Initialize an Array Variable in Visual Basic</a>.  </p>\n<h2 id=\"a-namebkmkiteratinga-iterating-through-an-array\"><a name=\"BKMK_Iterating\"></a> Iterating Through an Array</h2>\n<p> When you iterate through an array, you access each element in the array from the lowest index to the highest index.  </p>\n<p> The following example iterates through a one-dimensional array by using the <a href=\"../../../language-reference/statements/for-next-statement\" data-linktype=\"relative-path\">For...Next Statement</a>. The <a class=\"xref\" href=\"../../../../../api/system.array#System_Array_GetUpperBound_\" data-linktype=\"relative-path\">GetUpperBound</a> method returns the highest value that the index can have. The lowest index value is always 0.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#41\">Dim numbers = {10, 20, 30}\n\nFor index = 0 To numbers.GetUpperBound(0)\n    Debug.WriteLine(numbers(index))\nNext\n&#39; Output:\n&#39;  10\n&#39;  20\n&#39;  30\n</code></pre><p> The following example iterates through a multidimensional array by using a <code>For...Next</code> statement. The <a class=\"xref\" href=\"../../../../../api/system.array#System_Array_GetUpperBound_\" data-linktype=\"relative-path\">GetUpperBound</a> method has a parameter that specifies the dimension. <code>GetUpperBound(0)</code> returns the high index value for the first dimension, and <code>GetUpperBound(1)</code> returns the high index value for the second dimension.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#42\">Dim numbers = {{1, 2}, {3, 4}, {5, 6}}\n\nFor index0 = 0 To numbers.GetUpperBound(0)\n    For index1 = 0 To numbers.GetUpperBound(1)\n        Debug.Write(numbers(index0, index1).ToString &amp; &quot; &quot;)\n    Next\n    Debug.WriteLine(&quot;&quot;)\nNext\n&#39; Output \n&#39;  1 2 \n&#39;  3 4 \n&#39;  5 6\n</code></pre><p> The following example iterates through a one-dimensional array by using a <a href=\"../../../language-reference/statements/for-each-next-statement\" data-linktype=\"relative-path\">For Each...Next Statement</a>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#43\">Dim numbers = {10, 20, 30}\n\nFor Each number In numbers\n    Debug.WriteLine(number)\nNext\n&#39; Output:\n&#39;  10\n&#39;  20\n&#39;  30\n</code></pre><p> The following example iterates through a multidimensional array by using a <code>For Each...Next</code> statement. However, you have more control over the elements of a multidimensional array if you use a nested <code>For…Next</code> statement, as in a previous example, instead of a <code>For Each…Next</code> statement.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#44\">Dim numbers = {{1, 2}, {3, 4}, {5, 6}}\n\nFor Each number In numbers\n    Debug.WriteLine(number)\nNext\n&#39; Output:\n&#39;  1\n&#39;  2\n&#39;  3\n&#39;  4\n&#39;  5\n&#39;  6\n</code></pre><h2 id=\"a-namebkmkreturnvaluesa-arrays-as-return-values-and-parameters\"><a name=\"BKMK_ReturnValues\"></a> Arrays as Return Values and Parameters</h2>\n<p> To return an array from a <code>Function</code> procedure, specify the array data type and the number of dimensions as the return type of the <a href=\"../../../language-reference/statements/function-statement\" data-linktype=\"relative-path\">Function Statement</a>. Within the function, declare a local array variable with same data type and number of dimensions. In the <a href=\"../../../language-reference/statements/return-statement\" data-linktype=\"relative-path\">Return Statement</a>, include the local array variable without parentheses.  </p>\n<p> To specify an array as a parameter to a <code>Sub</code> or <code>Function</code> procedure, define the parameter as an array with a specified data type and number of dimensions. In the call to the procedure, send an array variable with the same data type and number of dimensions.  </p>\n<p> In the following example, the <code>GetNumbers</code> function returns an <code>Integer()</code>. This array type is a one dimensional array of type <code>Integer</code>. The <code>ShowNumbers</code> procedure accepts an <code>Integer()</code> argument.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#51\">Public Sub Process()\n    Dim numbers As Integer() = GetNumbers()\n    ShowNumbers(numbers)\nEnd Sub\n\nPrivate Function GetNumbers() As Integer()\n    Dim numbers As Integer() = {10, 20, 30}\n    Return numbers\nEnd Function\n\nPrivate Sub ShowNumbers(numbers As Integer())\n    For index = 0 To numbers.GetUpperBound(0)\n        Debug.WriteLine(numbers(index) &amp; &quot; &quot;)\n    Next\nEnd Sub\n\n&#39; Output:\n&#39;   10\n&#39;   20\n&#39;   30\n</code></pre><p> In the following example, the <code>GetNumbersMultiDim</code> function returns an <code>Integer(,)</code>. This array type is a two dimensional array of type <code>Integer</code>.  The <code>ShowNumbersMultiDim</code> procedure accepts an <code>Integer(,)</code> argument.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#52\">Public Sub ProcessMultidim()\n    Dim numbers As Integer(,) = GetNumbersMultidim()\n    ShowNumbersMultidim(numbers)\nEnd Sub\n\nPrivate Function GetNumbersMultidim() As Integer(,)\n    Dim numbers As Integer(,) = {{1, 2}, {3, 4}, {5, 6}}\n    Return numbers\nEnd Function\n\nPrivate Sub ShowNumbersMultidim(numbers As Integer(,))\n    For index0 = 0 To numbers.GetUpperBound(0)\n        For index1 = 0 To numbers.GetUpperBound(1)\n            Debug.Write(numbers(index0, index1).ToString &amp; &quot; &quot;)\n        Next\n        Debug.WriteLine(&quot;&quot;)\n    Next\nEnd Sub\n\n&#39; Output  \n&#39;  1 2  \n&#39;  3 4  \n&#39;  5 6\n</code></pre><h2 id=\"a-namebkmkjaggedarraysa-jagged-arrays\"><a name=\"BKMK_JaggedArrays\"></a> Jagged Arrays</h2>\n<p> An array that holds other arrays as elements is known as an array of arrays or a jagged array. A jagged array and each element in a jagged array can have one or more dimensions. Sometimes the data structure in your application is two-dimensional but not rectangular.  </p>\n<p> The following example has an array of months, each element of which is an array of days. Because different months have different numbers of days, the elements don’t form a rectangular two-dimensional array. Therefore, a jagged array is used instead of a multidimensional array.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#21\">&#39; Declare the jagged array.\n&#39; The New clause sets the array variable to a 12-element\n&#39; array. Each element is an array of Double elements.\nDim sales()() As Double = New Double(11)() {}\n\n&#39; Set each element of the sales array to a Double\n&#39; array of the appropriate size.\nFor month As Integer = 0 To 11\n    Dim days As Integer =\n        DateTime.DaysInMonth(Year(Now), month + 1)\n    sales(month) = New Double(days - 1) {}\nNext month\n\n&#39; Store values in each element.\nFor month As Integer = 0 To 11\n    Dim upper = sales(month).GetUpperBound(0)\n    For day = 0 To upper\n        sales(month)(day) = (month * 100) + day\n    Next\nNext\n</code></pre><h2 id=\"a-namebkmkzerolengtha-zero-length-arrays\"><a name=\"BKMK_ZeroLength\"></a> Zero-Length Arrays</h2>\n<p> An array that contains no elements is also called a zero-length array. A variable that holds a zero-length array doesn’t have the value <code>Nothing</code>. To create an array that has no elements, declare one of the array&#39;s dimensions to be -1, as the following example shows.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#14\">Dim twoDimensionalStrings(-1, 3) As String\n</code></pre><p> You might need to create a zero-length array under the following circumstances:  </p>\n<ul>\n<li><p>Without risking a <a class=\"xref\" href=\"../../../../../api/system.nullreferenceexception\" data-linktype=\"relative-path\">NullReferenceException</a> exception, your code must access members of the <a class=\"xref\" href=\"../../../../../api/system.array\" data-linktype=\"relative-path\">Array</a> class, such as <a class=\"xref\" href=\"../../../../../api/system.array#System_Array_Length_\" data-linktype=\"relative-path\">Length</a> or <a class=\"xref\" href=\"../../../../../api/system.array#System_Array_Rank_\" data-linktype=\"relative-path\">Rank</a>, or call a Visual Basic function such as <a class=\"xref\" href=\"../../../../../api/microsoft.visualbasic.information#Microsoft_VisualBasic_Information_UBound_\" data-linktype=\"relative-path\">UBound</a>.  </p>\n</li>\n<li><p>You want to keep the consuming code simpler by not having to check for <code>Nothing</code> as a special case.  </p>\n</li>\n<li><p>Your code interacts with an application programming interface (API) that either requires you to pass a zero-length array to one or more procedures or returns a zero-length array from one or more procedures.  </p>\n</li>\n</ul>\n<h2 id=\"a-namebkmkarraysizea-array-size\"><a name=\"BKMK_ArraySize\"></a> Array Size</h2>\n<p> The size of an array is the product of the lengths of all its dimensions. It represents the total number of elements currently contained in the array.  </p>\n<p> The following example declares a three-dimensional array.  </p>\n<pre class=\"loading\"><code>Dim prices(3, 4, 5) As Long  \n</code></pre><p> The overall size of the array in variable <code>prices</code> is (3 + 1) x (4 + 1) x (5 + 1) = 120.  </p>\n<p> You can find the size of an array by using the <a class=\"xref\" href=\"../../../../../api/system.array#System_Array_Length_\" data-linktype=\"relative-path\">Length</a> property. You can find the length of each dimension of a multi-dimensional array by using the <a class=\"xref\" href=\"../../../../../api/system.array#System_Array_GetLength_\" data-linktype=\"relative-path\">GetLength</a> method.  </p>\n<p> You can resize an array variable by assigning a new array object to it or by using the <code>ReDim</code> statement.  </p>\n<p> There are several things to keep in mind when dealing with the size of an array.  </p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Dimension Length</td>\n<td>The index of each dimension is 0-based, which means it ranges from 0 through its upper bound. Therefore, the length of a given dimension is greater by 1 than the declared upper bound for that dimension.</td>\n</tr>\n<tr>\n<td>Length Limits</td>\n<td>The length of every dimension of an array is limited to the maximum value of the <code>Integer</code> data type, which is (2 ^ 31) - 1. However, the total size of an array is also limited by the memory available on your system. If you attempt to initialize an array that exceeds the amount of available RAM, the common language runtime throws an <a class=\"xref\" href=\"../../../../../api/system.outofmemoryexception\" data-linktype=\"relative-path\">OutOfMemoryException</a> exception.</td>\n</tr>\n<tr>\n<td>Size and Element Size</td>\n<td>An array&#39;s size is independent of the data type of its elements. The size always represents the total number of elements, not the number of bytes that they consume in storage.</td>\n</tr>\n<tr>\n<td>Memory Consumption</td>\n<td>It is not safe to make any assumptions regarding how an array is stored in memory. Storage varies on platforms of different data widths, so the same array can consume more memory on a 64-bit system than on a 32-bit system. Depending on system configuration when you initialize an array, the common language runtime (CLR) can assign storage either to pack elements as close together as possible, or to align them all on natural hardware boundaries. Also, an array requires a storage overhead for its control information, and this overhead increases with each added dimension.</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"a-namebkmkarraytypesa-array-types-and-other-types\"><a name=\"BKMK_ArrayTypes\"></a> Array Types and Other Types</h2>\n<p> Every array has a data type, but it differs from the data type of its elements. There is no single data type for all arrays. Instead, the data type of an array is determined by the number of dimensions, or <em>rank</em>, of the array, and the data type of the elements in the array. Two array variables are considered to be of the same data type only when they have the same rank and their elements have the same data type. The lengths of the dimensions in an array do not influence the array data type.  </p>\n<p> Every array inherits from the <a class=\"xref\" href=\"../../../../../api/system.array\" data-linktype=\"relative-path\">System.Array</a> class, and you can declare a variable to be of type <code>Array</code>, but you cannot create an array of type <code>Array</code>. Also, the <a href=\"../../../language-reference/statements/redim-statement\" data-linktype=\"relative-path\">ReDim Statement</a> cannot operate on a variable declared as type <code>Array</code>. For these reasons, and for type safety, it is advisable to declare every array as a specific type, such as <code>Integer</code> in the preceding example.  </p>\n<p> You can find out the data type of either an array or its elements in several ways.  </p>\n<ul>\n<li><p>You can call the <a class=\"xref\" href=\"../../../../../api/system.object#System_Object_GetType_\" data-linktype=\"relative-path\">GetType</a> method on the variable to receive a <a class=\"xref\" href=\"../../../../../api/system.type\" data-linktype=\"relative-path\">Type</a> object for the run-time type of the variable. The <a class=\"xref\" href=\"../../../../../api/system.type\" data-linktype=\"relative-path\">Type</a> object holds extensive information in its properties and methods.  </p>\n</li>\n<li><p>You can pass the variable to the <a class=\"xref\" href=\"../../../../../api/microsoft.visualbasic.information#Microsoft_VisualBasic_Information_TypeName_\" data-linktype=\"relative-path\">TypeName</a> function to receive a <code>String</code> containing the name of run-time type.  </p>\n</li>\n<li><p>You can pass the variable to the <a class=\"xref\" href=\"../../../../../api/microsoft.visualbasic.information#Microsoft_VisualBasic_Information_VarType_\" data-linktype=\"relative-path\">VarType</a> function to receive a <code>VariantType</code> value representing the type classification of the variable.  </p>\n</li>\n</ul>\n<p> The following example calls the <code>TypeName</code> function to determine the type of the array and the type of the elements in the array. The array type is <code>Integer(,)</code> and the elements in the array are of type <code>Integer</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#15\">Dim thisTwoDimArray(,) As Integer = New Integer(9, 9) {}\nMsgBox(&quot;Type of thisTwoDimArray is &quot; &amp; TypeName(thisTwoDimArray))\nMsgBox(&quot;Type of thisTwoDimArray(0, 0) is &quot; &amp; TypeName(thisTwoDimArray(0, 0)))\n</code></pre><h2 id=\"a-namebkmkcollectionsa-collections-as-an-alternative-to-arrays\"><a name=\"BKMK_Collections\"></a> Collections as an Alternative to Arrays</h2>\n<p> Arrays are most useful for creating and working with a fixed number of strongly typed objects. Collections provide a more flexible way to work with groups of objects. Unlike arrays, the group of objects that you work with can grow and shrink dynamically as the needs of the application change.  </p>\n<p> If you need to change the size of an array, you must use the <a href=\"../../../language-reference/statements/redim-statement\" data-linktype=\"relative-path\">ReDim Statement</a>. When you do this, Visual Basic creates a new array and releases the previous array for disposal. This takes execution time. Therefore, if the number of items you are working with changes frequently, or you cannot predict the maximum number of items you need, you might obtain better performance using a collection.  </p>\n<p> For some collections, you can assign a key to any object that you put into the collection so that you can quickly retrieve the object by using the key.  </p>\n<p> If your collection contains elements of only one data type, you can use one of the classes in the <a class=\"xref\" href=\"../../../../../api/system.collections.generic\" data-linktype=\"relative-path\">System.Collections.Generic</a> namespace. A generic collection enforces type safety so that no other data type can be added to it. When you retrieve an element from a generic collection, you do not have to determine its data type or convert it.  </p>\n<p> For more information about collections, see <a href=\"http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b\" data-linktype=\"external\">Collections</a>.  </p>\n<h3 id=\"example\">Example</h3>\n<p> The following example uses the .NET Framework generic class <a class=\"xref\" href=\"../../../../../api/system.collections.generic.list-1\" data-linktype=\"relative-path\">System.Collections.Generic.List&lt;T&gt;</a> to create a list collection of <code>Customer</code> objects.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrArrays#1\">&#39; Define the class for a customer.\nPublic Class Customer\n    Public Property Name As String\n    &#39; Insert code for other members of customer structure.\nEnd Class\n\n&#39; Create a module-level collection that can hold 200 elements.\nPublic CustomerList As New List(Of Customer)(200)\n\n&#39; Add a specified customer to the collection.\nPrivate Sub AddNewCustomer(ByVal newCust As Customer)\n    &#39; Insert code to perform validity check on newCust.\n    CustomerList.Add(newCust)\nEnd Sub\n\n&#39; Display the list of customers in the Debug window.\nPrivate Sub PrintCustomers()\n    For Each cust As Customer In CustomerList\n        Debug.WriteLine(cust)\n    Next cust\nEnd Sub\n</code></pre><p> The declaration of the <code>CustomerFile</code> collection specifies that it can contain elements only of type <code>Customer</code>. It also provides for an initial capacity of 200 elements. The procedure <code>AddNewCustomer</code> checks the new element for validity and then adds it to the collection. The procedure <code>PrintCustomers</code> uses a <code>For Each</code> loop to traverse the collection and display its elements.  </p>\n<h2 id=\"related-topics\">Related Topics</h2>\n<table>\n<thead>\n<tr>\n<th>Term</th>\n<th>Definition</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"array-dimensions\" data-linktype=\"relative-path\">Array Dimensions in Visual Basic</a></td>\n<td>Explains rank and dimensions in arrays.</td>\n</tr>\n<tr>\n<td><a href=\"how-to-initialize-an-array-variable\" data-linktype=\"relative-path\">How to: Initialize an Array Variable in Visual Basic</a></td>\n<td>Describes how to populate arrays with initial values.</td>\n</tr>\n<tr>\n<td><a href=\"how-to-sort-an-array\" data-linktype=\"relative-path\">How to: Sort An Array in Visual Basic</a></td>\n<td>Shows how to sort the elements of an array alphabetically.</td>\n</tr>\n<tr>\n<td><a href=\"how-to-assign-one-array-to-another-array\" data-linktype=\"relative-path\">How to: Assign One Array to Another Array</a></td>\n<td>Describes the rules and steps for assigning an array to another array variable.</td>\n</tr>\n<tr>\n<td><a href=\"troubleshooting-arrays\" data-linktype=\"relative-path\">Troubleshooting Arrays</a></td>\n<td>Discusses some common problems that arise when working with arrays.</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a class=\"xref\" href=\"../../../../../api/system.array\" data-linktype=\"relative-path\">Array</a><br> <a href=\"../../../language-reference/statements/dim-statement\" data-linktype=\"relative-path\">Dim Statement</a><br> <a href=\"../../../language-reference/statements/redim-statement\" data-linktype=\"relative-path\">ReDim Statement</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"dbf29737-b589-4443-bee6-a27588d9c67e\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"47\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"translation.priority.mt\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.mt\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.mt\" content=\"pt-br\">\r\n<meta name=\"translation.priority.mt\" content=\"tr-tr\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/arrays/index.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/arrays/index.md\">\r\n<meta name=\"document_id\" content=\"4b0dde77-107f-065f-9ba0-ed4e8e21eada\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","title":"Arrays in Visual Basic | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"dbf29737-b589-4443-bee6-a27588d9c67e","f1_keywords":["vb.Array"],"translation.priority.ht":["de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","ru-ru","zh-cn","zh-tw"],"caps.latest.revision":47,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["arrays [Visual Basic]","Visual Basic, arrays"],"translation.priority.mt":["cs-cz","pl-pl","pt-br","tr-tr"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Absolute urls and other fixes (#1281)","commit_sha":"f7dffe4885b331cec8d37f3cc5c9163f69c3b4c9","commit_date":"2016-11-22 12:57:26 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/arrays/index.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/arrays/index.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/arrays/index.md","document_id":"4b0dde77-107f-065f-9ba0-ed4e8e21eada","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/language-features/arrays/index","toc_asset_id":"articles/visual-basic/programming-guide/language-features/arrays/toc.json","toc_rel":"toc.json","_op_ogTitle":"Arrays in Visual Basic","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":3440,"_op_rawTitle":"<h1 id=\"arrays-in-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/arrays/index.md\" sourcestartlinenumber=\"40\" sourceendlinenumber=\"40\">Arrays in Visual Basic</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/language-features/arrays/index","fileRelativePath":"articles/visual-basic/programming-guide/language-features/arrays/index.html"},"themesRelativePathToOutputRoot":"_themes/"}