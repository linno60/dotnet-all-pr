{"content":"<div><div class=\"content\">\n<p>Delegates are objects that refer to methods. They are sometimes described as <em>type-safe function pointers</em> because they are similar to function pointers used in other programming languages. But unlike function pointers, Visual Basic delegates are a reference type based on the class <a class=\"xref\" href=\"../../../../../api/system.delegate\" data-linktype=\"relative-path\">System.Delegate</a>. Delegates can reference both shared methods — methods that can be called without a specific instance of a class — and instance methods.  </p>\n<h2 id=\"delegates-and-events\">Delegates and Events</h2>\n<p> Delegates are useful in situations where you need an intermediary between a calling procedure and the procedure being called. For example, you might want an object that raises events to be able to call different event handlers under different circumstances. Unfortunately, the object raising the events cannot know ahead of time which event handler is handling a specific event. Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the <code>AddHandler</code> statement. At run time, the delegate forwards calls to the appropriate event handler.  </p>\n<p> Although you can create your own delegates, in most cases Visual Basic creates the delegate and takes care of the details for you. For example, an <code>Event</code> statement implicitly defines a delegate class named <code>&lt;EventName&gt;EventHandler</code> as a nested class of the class containing the <code>Event</code> statement, and with the same signature as the event. The <code>AddressOf</code> statement implicitly creates an instance of a delegate that refers to a specific procedure. The following two lines of code are equivalent. In the first line, you see the explicit creation of an instance of <code>Eventhandler</code>, with a reference to method <code>Button1_Click</code> sent as the argument. The second line is a more convenient way to do the same thing.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrDelegates#6\">        AddHandler Button1.Click, New EventHandler(AddressOf Button1_Click)\n        &#39; The following line of code is shorthand for the previous line.\n        AddHandler Button1.Click, AddressOf Me.Button1_Click\n</code></pre><p> You can use the shorthand way of creating delegates anywhere the compiler can determine the delegate&#39;s type by the context.  </p>\n<h2 id=\"declaring-events-that-use-an-existing-delegate-type\">Declaring Events that Use an Existing Delegate Type</h2>\n<p> In some situations, you may want to declare an event to use an existing delegate type as its underlying delegate. The following syntax demonstrates how:  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrDelegates#7\">    Delegate Sub DelegateType()\n    Event AnEvent As DelegateType\n</code></pre><p> This is useful when you want to route multiple events to the same handler.  </p>\n<h2 id=\"delegate-variables-and-parameters\">Delegate Variables and Parameters</h2>\n<p> You can use delegates for other, non-event related tasks, such as free threading or with procedures that need to call different versions of functions at run time.  </p>\n<p> For example, suppose you have a classified-ad application that includes a list box with the names of cars. The ads are sorted by title, which is normally the make of the car. A problem you may face occurs when some cars include the year of the car before the make. The problem is that the built-in sort functionality of the list box sorts only by character codes; it places all the ads starting with dates first, followed by the ads starting with the make.  </p>\n<p> To fix this, you can create a sort procedure in a class that uses the standard alphabetic sort on most list boxes, but is able to switch at run time to the custom sort procedure for car ads. To do this, you pass the custom sort procedure to the sort class at run time, using delegates.  </p>\n<h2 id=\"addressof-and-lambda-expressions\">AddressOf and Lambda Expressions</h2>\n<p> Each delegate class defines a constructor that is passed the specification of an object method. An argument to a delegate constructor must be a reference to a method, or a lambda expression.  </p>\n<p> To specify a reference to a method, use the following syntax:  </p>\n<p> <code>AddressOf</code> [<code>expression</code>.]<code>methodName</code>  </p>\n<p> The compile-time type of the <code>expression</code> must be the name of a class or an interface that contains a method of the specified name whose signature matches the signature of the delegate class. The <code>methodName</code> can be either a shared method or an instance method. The <code>methodName</code> is not optional, even if you create a delegate for the default method of the class.  </p>\n<p> To specify a lambda expression, use the following syntax:  </p>\n<p> <code>Function</code> ([<code>parm</code> As <code>type</code>, <code>parm2</code> As <code>type2</code>, ...]) <code>expression</code>  </p>\n<p> The following example shows both <code>AddressOf</code> and lambda expressions used to specify the reference for a delegate.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrDelegates#15\">Module Module1\n\n    Sub Main()\n        &#39; Create an instance of InOrderClass and assign values to the properties.\n        &#39; InOrderClass method ShowInOrder displays the numbers in ascending \n        &#39; or descending order, depending on the comparison method you specify.\n        Dim inOrder As New InOrderClass\n        inOrder.Num1 = 5\n        inOrder.Num2 = 4\n\n        &#39; Use AddressOf to send a reference to the comparison function you want\n        &#39; to use.\n        inOrder.ShowInOrder(AddressOf GreaterThan)\n        inOrder.ShowInOrder(AddressOf LessThan)\n\n        &#39; Use lambda expressions to do the same thing.\n        inOrder.ShowInOrder(Function(m, n) m &gt; n)\n        inOrder.ShowInOrder(Function(m, n) m &lt; n)\n    End Sub\n\n    Function GreaterThan(ByVal num1 As Integer, ByVal num2 As Integer) As Boolean\n        Return num1 &gt; num2\n    End Function\n\n    Function LessThan(ByVal num1 As Integer, ByVal num2 As Integer) As Boolean\n        Return num1 &lt; num2\n    End Function\n\n    Class InOrderClass\n        &#39; Define the delegate function for the comparisons.\n        Delegate Function CompareNumbers(ByVal num1 As Integer, ByVal num2 As Integer) As Boolean\n        &#39; Display properties in ascending or descending order.\n        Sub ShowInOrder(ByVal compare As CompareNumbers)\n            If compare(_num1, _num2) Then\n                Console.WriteLine(_num1 &amp; &quot;  &quot; &amp; _num2)\n            Else\n                Console.WriteLine(_num2 &amp; &quot;  &quot; &amp; _num1)\n            End If\n        End Sub\n\n        Private _num1 As Integer\n        Property Num1() As Integer\n            Get\n                Return _num1\n            End Get\n            Set(ByVal value As Integer)\n                _num1 = value\n            End Set\n        End Property\n\n        Private _num2 As Integer\n        Property Num2() As Integer\n            Get\n                Return _num2\n            End Get\n            Set(ByVal value As Integer)\n                _num2 = value\n            End Set\n        End Property\n    End Class\nEnd Module\n</code></pre><p> The signature of the function must match that of the delegate type. For more information about lambda expressions, see <a href=\"../procedures/lambda-expressions\" data-linktype=\"relative-path\">Lambda Expressions</a>. For more examples of lambda expression and <code>AddressOf</code> assignments to delegates, see <a href=\"relaxed-delegate-conversion\" data-linktype=\"relative-path\">Relaxed Delegate Conversion</a>.  </p>\n<h2 id=\"related-topics\">Related Topics</h2>\n<table>\n<thead>\n<tr>\n<th>Title</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"how-to-invoke-a-delegate-method\" data-linktype=\"relative-path\">How to: Invoke a Delegate Method</a></td>\n<td>Provides an example that shows how to associate a method with a delegate and then invoke that method through the delegate.</td>\n</tr>\n<tr>\n<td><a href=\"how-to-pass-procedures-to-another-procedure\" data-linktype=\"relative-path\">How to: Pass Procedures to Another Procedure in Visual Basic</a></td>\n<td>Demonstrates how to use delegates to pass one procedure to another procedure.</td>\n</tr>\n<tr>\n<td><a href=\"relaxed-delegate-conversion\" data-linktype=\"relative-path\">Relaxed Delegate Conversion</a></td>\n<td>Describes how you can assign subs and functions to delegates or handlers even when their signatures are not identical</td>\n</tr>\n<tr>\n<td><a href=\"../events/index\" data-linktype=\"relative-path\">Events</a></td>\n<td>Provides an overview of events in Visual Basic.</td>\n</tr>\n</tbody>\n</table>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"410b60dc-5e60-4ec0-bfae-426755a2ee28\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"10\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-21 01:42 AM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/0a5d76c154aeb9b749c9c3fc5ad0962e93754a62/docs/visual-basic/programming-guide/language-features/delegates/index.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/programming-guide/language-features/delegates/index.md\">\r\n<meta name=\"document_id\" content=\"0c228195-9cb0-997e-8de3-15be439f88de\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Delegates (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"410b60dc-5e60-4ec0-bfae-426755a2ee28","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":10,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["delegates [Visual Basic]","Visual Basic code, delegates"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Reorganizing the VB TOC (#1348)","commit_sha":"0a5d76c154aeb9b749c9c3fc5ad0962e93754a62","commit_date":"2017-02-14 10:22:48 -0800"}],"updated_at":"2017-03-21 01:42 AM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"}],"update_at":"3/21/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/0a5d76c154aeb9b749c9c3fc5ad0962e93754a62/docs/visual-basic/programming-guide/language-features/delegates/index.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/programming-guide/language-features/delegates/index.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/delegates/index.md","document_id":"0c228195-9cb0-997e-8de3-15be439f88de","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/delegates/index","toc_asset_id":"articles/visual-basic/programming-guide/language-features/delegates/toc.json","toc_rel":"toc.json","_op_ogTitle":"Delegates (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":1039,"_op_rawTitle":"<h1 id=\"delegates-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/delegates/index.md\" sourcestartlinenumber=\"37\" sourceendlinenumber=\"37\">Delegates (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/delegates/index","fileRelativePath":"articles/visual-basic/programming-guide/language-features/delegates/index.html"},"themesRelativePathToOutputRoot":"_themes/"}