{"content":"<div><div class=\"content\">\n<p>You can place control statements inside other control statements, for example an <code>If...Then...Else</code> block within a <code>For...Next</code> loop. A control statement placed inside another control statement is said to be <em>nested</em>.  </p>\n<h2 id=\"nesting-levels\">Nesting Levels</h2>\n<p> Control structures in Visual Basic can be nested to as many levels as you want. It is common practice to make nested structures more readable by indenting the body of each one. The integrated development environment (IDE) editor automatically does this.  </p>\n<p> In the following example, the procedure <code>sumRows</code> adds together the positive elements of each row of the matrix.  </p>\n<pre class=\"loading\"><code>Public Sub sumRows(ByVal a(,) As Double, ByRef r() As Double)  \n    Dim i, j As Integer  \n    For i = 0 To UBound(a, 1)  \n        r(i) = 0  \n        For j = 0 To UBound(a, 2)  \n            If a(i, j) &gt; 0 Then  \n                r(i) = r(i) + a(i, j)  \n            End If  \n        Next j  \n    Next i  \nEnd Sub  \n</code></pre><p> In the preceding example, the first <code>Next</code> statement closes the inner <code>For</code> loop and the last <code>Next</code> statement closes the outer <code>For</code> loop.  </p>\n<p> Likewise, in nested <code>If</code> statements, the <code>End If</code> statements automatically apply to the nearest prior <code>If</code> statement. Nested <code>Do</code> loops work in a similar fashion, with the innermost <code>Loop</code> statement matching the innermost <code>Do</code> statement.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> For many control structures, when you click a keyword, all of the keywords in the structure are highlighted. For instance, when you click <code>If</code> in an <code>If...Then...Else</code> construction, all instances of <code>If</code>, <code>Then</code>, <code>ElseIf</code>, <code>Else</code>, and <code>End If</code> in the construction are highlighted. To move to the next or previous highlighted keyword, press CTRL+SHIFT+DOWN ARROW or CTRL+SHIFT+UP ARROW.  </p>\n</div>\n<h2 id=\"nesting-different-kinds-of-control-structures\">Nesting Different Kinds of Control Structures</h2>\n<p> You can nest one kind of control structure within another kind. The following example uses a <code>With</code> block inside a <code>For Each</code> loop and nested <code>If</code> blocks inside the <code>With</code> block.  </p>\n<pre class=\"loading\"><code>For Each ctl As System.Windows.Forms.Control In Me.Controls  \n    With ctl  \n        .BackColor = System.Drawing.Color.Yellow  \n        .ForeColor = System.Drawing.Color.Black  \n        If .CanFocus Then  \n            .Text = &quot;Colors changed&quot;  \n            If Not .Focus() Then  \n                &#39; Insert code to process failed focus.  \n            End If  \n        End If  \n    End With  \nNext ctl  \n</code></pre><h2 id=\"overlapping-control-structures\">Overlapping Control Structures</h2>\n<p> You cannot overlap control structures. This means that any nested structure must be completely contained within the next innermost structure. For example, the following arrangement is invalid because the <code>For</code> loop terminates before the inner <code>With</code> block terminates.  </p>\n<p> <img src=\"media/nestexampleinvalid.gif\" alt=\"Graphic diagram of invalid nesting\" title=\"NestExampleInvalid\" data-linktype=\"relative-path\"><br>Invalid nesting of For and With structures  </p>\n<p> The Visual Basic compiler detects such overlapping control structures and signals a compile-time error.  </p>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"index\" data-linktype=\"relative-path\">Control Flow</a><br> <a href=\"decision-structures\" data-linktype=\"relative-path\">Decision Structures</a><br> <a href=\"loop-structures\" data-linktype=\"relative-path\">Loop Structures</a><br> <a href=\"other-control-structures\" data-linktype=\"relative-path\">Other Control Structures</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"cf60b061-65d9-44a8-81f2-b0bdccd23a05\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"20\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md\">\r\n<meta name=\"document_id\" content=\"4613d974-f1e0-a13c-d24a-0cdc213ca920\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","title":"Nested Control Structures (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"cf60b061-65d9-44a8-81f2-b0bdccd23a05","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":20,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["Visual Basic code, control flow","control structures, nested","conditional statements, nested","statements [Visual Basic], control flow","control flow, nested control statements","structures, nested control","nested control statements"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md","document_id":"4613d974-f1e0-a13c-d24a-0cdc213ca920","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/language-features/control-flow/nested-control-structures","toc_asset_id":"articles/visual-basic/programming-guide/language-features/control-flow/toc.json","toc_rel":"toc.json","_op_ogTitle":"Nested Control Structures (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":412,"_op_rawTitle":"<h1 id=\"nested-control-structures-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md\" sourcestartlinenumber=\"42\" sourceendlinenumber=\"42\">Nested Control Structures (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/language-features/control-flow/nested-control-structures","fileRelativePath":"articles/visual-basic/programming-guide/language-features/control-flow/nested-control-structures.html"},"themesRelativePathToOutputRoot":"_themes/"}