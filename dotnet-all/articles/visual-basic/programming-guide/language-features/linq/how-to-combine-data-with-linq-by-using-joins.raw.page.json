{"content":"<div><div class=\"content\">\n<p>Visual Basic provides the <code>Join</code> and <code>Group Join</code> query clauses to enable you to combine the contents of multiple collections based on common values between the collections. These values are known as <em>key</em> values. Developers familiar with relational database concepts will recognize the <code>Join</code> clause as an INNER JOIN and the <code>Group Join</code> clause as, effectively, a LEFT OUTER JOIN.  </p>\n<p> The examples in this topic demonstrate a few ways to combine data by using the <code>Join</code> and <code>Group Join</code> query clauses.  </p>\n<h2 id=\"create-a-project-and-add-sample-data\">Create a Project and Add Sample Data</h2>\n<h4 id=\"to-create-a-project-that-contains-sample-data-and-types\">To create a project that contains sample data and types</h4>\n<ol>\n<li><p>To run the samples in this topic, open Visual Studio and add a new Visual Basic Console Application project. Double-click the Module1.vb file created by Visual Basic.  </p>\n</li>\n<li><p>The samples in this topic use the <code>Person</code> and <code>Pet</code> types and data from the following code example. Copy this code into the default <code>Module1</code> module created by Visual Basic.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQHowTos#1\">    Private _people As List(Of Person)\n    Private _pets As List(Of Pet)\n\n    Function GetPeople() As List(Of Person)\n        If _people Is Nothing Then CreateLists()\n        Return _people\n    End Function\n\n    Function GetPets(ByVal people As List(Of Person)) As List(Of Pet)\n        If _pets Is Nothing Then CreateLists()\n        Return _pets\n    End Function\n\n    Private Sub CreateLists()\n        Dim pers As Person\n\n        _people = New List(Of Person)\n        _pets = New List(Of Pet)\n\n        pers = New Person With {.FirstName = &quot;Magnus&quot;, .LastName = &quot;Hedlund&quot;}\n        _people.Add(pers)\n        _pets.Add(New Pet With {.Name = &quot;Daisy&quot;, .Owner = pers})\n\n        pers = New Person With {.FirstName = &quot;Terry&quot;, .LastName = &quot;Adams&quot;}\n        _people.Add(pers)\n        _pets.Add(New Pet With {.Name = &quot;Barley&quot;, .Owner = pers})\n        _pets.Add(New Pet With {.Name = &quot;Boots&quot;, .Owner = pers})\n        _pets.Add(New Pet With {.Name = &quot;Blue Moon&quot;, .Owner = pers})\n\n        pers = New Person With {.FirstName = &quot;Charlotte&quot;, .LastName = &quot;Weiss&quot;}\n        _people.Add(pers)\n        _pets.Add(New Pet With {.Name = &quot;Whiskers&quot;, .Owner = pers})\n\n        &#39; Add a person with no pets for the sake of Join examples.\n        _people.Add(New Person With {.FirstName = &quot;Arlene&quot;, .LastName = &quot;Huff&quot;})\n\n        pers = New Person With {.FirstName = &quot;Don&quot;, .LastName = &quot;Hall&quot;}\n        &#39; Do not add person to people list for the sake of Join examples.\n        _pets.Add(New Pet With {.Name = &quot;Spot&quot;, .Owner = pers})\n\n        &#39; Add a pet with no owner for the sake of Join examples.\n        _pets.Add(New Pet With {.Name = &quot;Unknown&quot;, \n                                .Owner = New Person With {.FirstName = String.Empty, \n                                                          .LastName = String.Empty}})\n    End Sub\n</code></pre><pre><code class=\"lang-vb\" name=\"VbLINQHowTos#2\">    Class Person\n        Public Property FirstName As String\n        Public Property LastName As String\n    End Class\n\n    Class Pet\n        Public Property Name As String\n        Public Property Owner As Person\n    End Class\n</code></pre></li>\n</ol>\n<h2 id=\"perform-an-inner-join-by-using-the-join-clause\">Perform an Inner Join by Using the Join Clause</h2>\n<p> An INNER JOIN combines data from two collections. Items for which the specified key values match are included. Any items from either collection that do not have a matching item in the other collection are excluded.  </p>\n<p> In Visual Basic, LINQ provides two options for performing an INNER JOIN: an implicit join and an explicit join.  </p>\n<p> An implicit join specifies the collections to be joined in a <code>From</code> clause and identifies the matching key fields in a <code>Where</code> clause. Visual Basic implicitly joins the two collections based on the specified key fields.  </p>\n<p> You can specify an explicit join by using the <code>Join</code> clause when you want to be specific about which key fields to use in the join. In this case, a <code>Where</code> clause can still be used to filter the query results.  </p>\n<h4 id=\"to-perform-an-inner-join-by-using-the-join-clause\">To perform an Inner Join by using the Join clause</h4>\n<ol>\n<li><p>Add the following code to the <code>Module1</code> module in your project to see examples of both an implicit and explicit inner join.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQHowTos#4\">    Sub InnerJoinExample()\n        &#39; Create two lists.\n        Dim people = GetPeople()\n        Dim pets = GetPets(people)\n\n        &#39; Implicit Join.\n        Dim petOwners = From pers In people, pet In pets\n                        Where pet.Owner Is pers\n                        Select pers.FirstName, PetName = pet.Name\n\n        &#39; Display grouped results.\n        Dim output As New System.Text.StringBuilder\n        For Each pers In petOwners\n            output.AppendFormat(\n              pers.FirstName &amp; &quot;:&quot; &amp; vbTab &amp; pers.PetName &amp; vbCrLf)\n        Next\n\n        Console.WriteLine(output)\n\n        &#39; Explicit Join.\n        Dim petOwnersJoin = From pers In people\n                            Join pet In pets\n                            On pet.Owner Equals pers\n                            Select pers.FirstName, PetName = pet.Name\n\n        &#39; Display grouped results.\n        output = New System.Text.StringBuilder()\n        For Each pers In petOwnersJoin\n            output.AppendFormat(\n              pers.FirstName &amp; &quot;:&quot; &amp; vbTab &amp; pers.PetName &amp; vbCrLf)\n        Next\n\n        Console.WriteLine(output)\n\n        &#39; Both queries produce the following output:\n        &#39;\n        &#39; Magnus:    Daisy\n        &#39; Terry:     Barley\n        &#39; Terry:     Boots\n        &#39; Terry:     Blue Moon\n        &#39; Charlotte: Whiskers\n    End Sub\n</code></pre></li>\n</ol>\n<h2 id=\"perform-a-left-outer-join-by-using-the-group-join-clause\">Perform a Left Outer Join by Using the Group Join Clause</h2>\n<p> A LEFT OUTER JOIN includes all the items from the left-side collection of the join and only matching values from the right-side collection of the join. Any items from the right-side collection of the join that do not have a matching item in the left-side collection are excluded from the query result.  </p>\n<p> The <code>Group Join</code> clause performs, in effect, a LEFT OUTER JOIN. The difference between what is typically known as a LEFT OUTER JOIN and what the <code>Group Join</code> clause returns is that the <code>Group Join</code> clause groups results from the right-side collection of the join for each item in the left-side collection. In a relational database, a LEFT OUTER JOIN returns an ungrouped result in which each item in the query result contains matching items from both collections in the join. In this case, the items from the left-side collection of the join are repeated for each matching item from the right-side collection. You will see what this looks like when you complete the next procedure.  </p>\n<p> You can retrieve the results of a <code>Group Join</code> query as an ungrouped result by extending your query to return an item for each grouped query result. To accomplish this, you have to ensure that you query on the <code>DefaultIfEmpty</code> method of the grouped collection. This ensures that items from the left-side collection of the join are still included in the query result even if they have no matching results from the right-side collection. You can add code to your query to provide a default result value when there is no matching value from the right-side collection of the join.  </p>\n<h4 id=\"to-perform-a-left-outer-join-by-using-the-group-join-clause\">To perform a Left Outer Join by using the Group Join clause</h4>\n<ol>\n<li><p>Add the following code to the <code>Module1</code> module in your project to see examples of both a grouped left outer join and an ungrouped left outer join.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQHowTos#3\">    Sub LeftOuterJoinExample()\n        &#39; Create two lists.\n        Dim people = GetPeople()\n        Dim pets = GetPets(people)\n\n        &#39; Grouped results.\n        Dim petOwnersGrouped = From pers In people\n                               Group Join pet In pets\n                                 On pers Equals pet.Owner\n                               Into PetList = Group\n                               Select pers.FirstName, pers.LastName,\n                                      PetList\n\n        &#39; Display grouped results.\n        Dim output As New System.Text.StringBuilder\n        For Each pers In petOwnersGrouped\n            output.AppendFormat(pers.FirstName &amp; &quot;:&quot; &amp; vbCrLf)\n            For Each pt In pers.PetList\n                output.AppendFormat(vbTab &amp; pt.Name &amp; vbCrLf)\n            Next\n        Next\n\n        Console.WriteLine(output)\n        &#39; This code produces the following output:\n        &#39;\n        &#39; Magnus:\n        &#39;     Daisy\n        &#39; Terry:\n        &#39;     Barley\n        &#39;     Boots\n        &#39;     Blue Moon\n        &#39; Charlotte:\n        &#39;     Whiskers\n        &#39; Arlene:\n\n        &#39; &quot;Flat&quot; results.\n        Dim petOwners = From pers In people\n                        Group Join pet In pets On pers Equals pet.Owner\n                        Into PetList = Group\n                        From pet In PetList.DefaultIfEmpty()\n                        Select pers.FirstName, pers.LastName,\n                               PetName =\n                                 If(pet Is Nothing, String.Empty, pet.Name)\n\n\n        &#39; Display &quot;flat&quot; results.\n        output = New System.Text.StringBuilder()\n        For Each pers In petOwners\n            output.AppendFormat( \n              pers.FirstName &amp; &quot;:&quot; &amp; vbTab &amp; pers.PetName &amp; vbCrLf)\n        Next\n\n        Console.WriteLine(output.ToString())\n        &#39; This code produces the following output:\n        &#39;\n        &#39; Magnus:\t    Daisy\n        &#39; Terry:\t    Barley\n        &#39; Terry:\t    Boots\n        &#39; Terry:\t    Blue Moon\n        &#39; Charlotte:\tWhiskers\n        &#39; Arlene:\t  \n    End Sub\n</code></pre></li>\n</ol>\n<h2 id=\"perform-a-join-by-using-a-composite-key\">Perform a Join by Using a Composite Key</h2>\n<p> You can use the <code>And</code> keyword in a <code>Join</code> or <code>Group Join</code> clause to identify multiple key fields to use when matching values from the collections being joined. The <code>And</code> keyword specifies that all specified key fields must match for items to be joined.  </p>\n<h4 id=\"to-perform-a-join-by-using-a-composite-key\">To perform a Join by using a composite key</h4>\n<ol>\n<li><p>Add the following code to the <code>Module1</code> module in your project to see examples of a join that uses a composite key.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQHowTos#5\">    Sub CompositeKeyJoinExample()\n        &#39; Create two lists.\n        Dim people = GetPeople()\n        Dim pets = GetPets(people)\n\n        &#39; Implicit Join.\n        Dim petOwners = From pers In people\n                        Join pet In pets On\n                          pet.Owner.FirstName Equals pers.FirstName And\n                          pet.Owner.LastName Equals pers.LastName\n                    Select pers.FirstName, PetName = pet.Name\n\n        &#39; Display grouped results.\n        Dim output As New System.Text.StringBuilder\n        For Each pers In petOwners\n            output.AppendFormat(\n              pers.FirstName &amp; &quot;:&quot; &amp; vbTab &amp; pers.PetName &amp; vbCrLf)\n        Next\n\n        Console.WriteLine(output)\n        &#39; This code produces the following output:\n        &#39;\n        &#39; Magnus:    Daisy\n        &#39; Terry:     Barley\n        &#39; Terry:     Boots\n        &#39; Terry:     Blue Moon\n        &#39; Charlotte: Whiskers\n    End Sub\n</code></pre></li>\n</ol>\n<h2 id=\"run-the-code\">Run the Code</h2>\n<h4 id=\"to-add-code-to-run-the-examples\">To add code to run the examples</h4>\n<ol>\n<li><p>Replace the <code>Sub Main</code> in the <code>Module1</code> module in your project with the following code to run the examples in this topic.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQHowTos#6\">    Sub Main()\n        InnerJoinExample()\n        LeftOuterJoinExample()\n        CompositeKeyJoinExample()\n\n        Console.ReadLine()\n    End Sub\n</code></pre></li>\n<li><p>Press F5 to run the examples.  </p>\n</li>\n</ol>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"index\" data-linktype=\"relative-path\">LINQ</a><br> <a href=\"introduction-to-linq\" data-linktype=\"relative-path\">Introduction to LINQ in Visual Basic</a><br> <a href=\"../../../language-reference/queries/join-clause\" data-linktype=\"relative-path\">Join Clause</a><br> <a href=\"../../../language-reference/queries/group-join-clause\" data-linktype=\"relative-path\">Group Join Clause</a><br> <a href=\"../../../language-reference/queries/from-clause\" data-linktype=\"relative-path\">From Clause</a><br> <a href=\"../../../language-reference/queries/where-clause\" data-linktype=\"relative-path\">Where Clause</a><br> <a href=\"../../../language-reference/queries/queries\" data-linktype=\"relative-path\">Queries</a><br> <a href=\"../../../../csharp/programming-guide/concepts/linq/data-transformations-with-linq\" data-linktype=\"relative-path\">Data Transformations with LINQ (C#)</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"5b00a478-035b-41c6-8918-be1a97728396\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"13\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/linq/how-to-combine-data-with-linq-by-using-joins.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/linq/how-to-combine-data-with-linq-by-using-joins.md\">\r\n<meta name=\"document_id\" content=\"98186796-6334-294c-483a-c1e70ce00475\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"How to: Combine Data with LINQ by Using Joins (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"5b00a478-035b-41c6-8918-be1a97728396","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":13,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["queries [LINQ in Visual Basic], joins","joins [LINQ in Visual Basic]","Join clause [LINQ in Visual Basic]","Group Join clause [Visual Basic]","joining [LINQ in Visual Basic]","queries [LINQ in Visual Basic], how-to topics"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/linq/how-to-combine-data-with-linq-by-using-joins.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/linq/how-to-combine-data-with-linq-by-using-joins.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/linq/how-to-combine-data-with-linq-by-using-joins.md","document_id":"98186796-6334-294c-483a-c1e70ce00475","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/linq/how-to-combine-data-with-linq-by-using-joins","toc_asset_id":"articles/visual-basic/programming-guide/language-features/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"How to: Combine Data with LINQ by Using Joins (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":1477,"_op_rawTitle":"<h1 id=\"how-to-combine-data-with-linq-by-using-joins-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/linq/how-to-combine-data-with-linq-by-using-joins.md\" sourcestartlinenumber=\"41\" sourceendlinenumber=\"41\">How to: Combine Data with LINQ by Using Joins (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/linq/how-to-combine-data-with-linq-by-using-joins","fileRelativePath":"articles/visual-basic/programming-guide/language-features/linq/how-to-combine-data-with-linq-by-using-joins.html"},"themesRelativePathToOutputRoot":"_themes/"}