{"content":"<div><div class=\"content\">\n<p>Language-Integrated Query (LINQ) adds query capabilities to Visual Basic and provides simple and powerful capabilities when you work with all kinds of data. Rather than sending a query to a database to be processed, or working with different query syntax for each type of data that you are searching, LINQ introduces queries as part of the Visual Basic language. It uses a unified syntax regardless of the type of data.  </p>\n<p> LINQ enables you to query data from a SQL Server database, XML, in-memory arrays and collections, ADO.NET datasets, or any other remote or local data source that supports LINQ. You can do all this with common Visual Basic language elements. Because your queries are written in the Visual Basic language, your query results are returned as strongly-typed objects. These objects support IntelliSense, which enables you to write code faster and catch errors in your queries at compile time instead of at run time. LINQ queries can be used as the source of additional queries to refine results. They can also be bound to controls so that users can easily view and modify your query results.  </p>\n<p> For example, the following code example shows a LINQ query that returns a list of customers from a collection and groups them based on their location.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#1\">&#39; Obtain a list of customers.\nDim customers As List(Of Customer) = GetCustomers()\n\n&#39; Return customers that are grouped based on country.\nDim countries = From cust In customers\n                Order By cust.Country, cust.City\n                Group By CountryName = cust.Country\n                Into CustomersInCountry = Group, Count()\n                Order By CountryName\n\n&#39; Output the results.\nFor Each country In countries\n    Debug.WriteLine(country.CountryName &amp; &quot; count=&quot; &amp; country.Count)\n\n    For Each customer In country.CustomersInCountry\n        Debug.WriteLine(&quot;   &quot; &amp; customer.CompanyName &amp; &quot;  &quot; &amp; customer.City)\n    Next\nNext\n\n&#39; Output:\n&#39;   Canada count=2\n&#39;      Contoso, Ltd  Halifax\n&#39;      Fabrikam, Inc.  Vancouver\n&#39;   United States count=1\n&#39;      Margie&#39;s Travel  Redmond\n</code></pre><p> In this topic, you will find information about the following areas:  </p>\n<ul>\n<li><p><a href=\"#RunningtheExamples\" data-linktype=\"self-bookmark\">Running the Examples</a>  </p>\n</li>\n<li><p><a href=\"#LINQProviders\" data-linktype=\"self-bookmark\">LINQ Providers</a>  </p>\n</li>\n<li><p><a href=\"#StructureOfALINQQuery\" data-linktype=\"self-bookmark\">Structure of a LINQ Query</a>  </p>\n</li>\n<li><p><a href=\"#VisualBasicLINQQueryOperators\" data-linktype=\"self-bookmark\">Visual Basic LINQ Query Operators</a>  </p>\n</li>\n<li><p><a href=\"#ConnectingToADatabase\" data-linktype=\"self-bookmark\">Connecting to a Database by Using LINQ to SQL</a>  </p>\n</li>\n<li><p><a href=\"#VisualBasicFeaturesThatSupportLINQ\" data-linktype=\"self-bookmark\">Visual Basic Features That Support LINQ</a>  </p>\n</li>\n<li><p><a href=\"#QueryExecution\" data-linktype=\"self-bookmark\">Deferred and Immediate Query Execution</a>  </p>\n</li>\n<li><p><a href=\"#XMLInVisualBasic\" data-linktype=\"self-bookmark\">XML in Visual Basic</a>  </p>\n</li>\n<li><p><a href=\"#RelatedResources\" data-linktype=\"self-bookmark\">Related Resources</a>  </p>\n</li>\n<li><p><a href=\"#HowToAndWalkthroughTopics\" data-linktype=\"self-bookmark\">How To and Walkthrough Topics</a>  </p>\n</li>\n</ul>\n<h2 id=\"a-namerunningtheexamplesa-running-the-examples\"><a name=\"RunningtheExamples\"></a> Running the Examples</h2>\n<p> To run the examples in the introduction and in the &quot;Structure of a LINQ Query&quot; section, include the following code, which returns lists of customers and orders.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#31\">&#39; Return a list of customers.\nPrivate Function GetCustomers() As List(Of Customer)\n    Return New List(Of Customer) From\n        {\n            New Customer With {.CustomerID = 1, .CompanyName = &quot;Contoso, Ltd&quot;, .City = &quot;Halifax&quot;, .Country = &quot;Canada&quot;},\n            New Customer With {.CustomerID = 2, .CompanyName = &quot;Margie&#39;s Travel&quot;, .City = &quot;Redmond&quot;, .Country = &quot;United States&quot;},\n            New Customer With {.CustomerID = 3, .CompanyName = &quot;Fabrikam, Inc.&quot;, .City = &quot;Vancouver&quot;, .Country = &quot;Canada&quot;}\n        }\nEnd Function\n\n&#39; Return a list of orders.\nPrivate Function GetOrders() As List(Of Order)\n    Return New List(Of Order) From\n        {\n            New Order With {.CustomerID = 1, .Amount = &quot;200.00&quot;},\n            New Order With {.CustomerID = 3, .Amount = &quot;600.00&quot;},\n            New Order With {.CustomerID = 1, .Amount = &quot;300.00&quot;},\n            New Order With {.CustomerID = 2, .Amount = &quot;100.00&quot;},\n            New Order With {.CustomerID = 3, .Amount = &quot;800.00&quot;}\n        }\nEnd Function\n\n&#39; Customer Class.\nPrivate Class Customer\n    Public Property CustomerID As Integer\n    Public Property CompanyName As String\n    Public Property City As String\n    Public Property Country As String\nEnd Class\n\n&#39; Order Class.\nPrivate Class Order\n    Public Property CustomerID As Integer\n    Public Property Amount As Decimal\nEnd Class\n</code></pre><h2 id=\"a-namelinqprovidersa-linq-providers\"><a name=\"LINQProviders\"></a> LINQ Providers</h2>\n<p> A <em>LINQ provider</em> maps your Visual Basic LINQ queries to the data source being queried. When you write a LINQ query, the provider takes that query and translates it into commands that the data source will be able to execute. The provider also converts data from the source to the objects that make up your query result. Finally, it converts objects to data when you send updates to the data source.  </p>\n<p> Visual Basic includes the following LINQ providers.  </p>\n<table>\n<thead>\n<tr>\n<th>Provider</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>LINQ to Objects</td>\n<td>The LINQ to Objects provider enables you to query in-memory collections and arrays. If an object supports either the <a class=\"xref\" href=\"../../../../../api/system.collections.ienumerable\" data-linktype=\"relative-path\">IEnumerable</a> or <a class=\"xref\" href=\"../../../../../api/system.collections.generic.ienumerable-1\" data-linktype=\"relative-path\">IEnumerable&lt;T&gt;</a> interface, the LINQ to Objects provider enables you to query it.<br><br> You can enable the LINQ to Objects provider by importing the <a class=\"xref\" href=\"../../../../../api/system.linq\" data-linktype=\"relative-path\">System.Linq</a> namespace, which is imported by default for all Visual Basic projects.<br><br> For more information about the LINQ to Objects provider, see <a href=\"http://msdn.microsoft.com/library/73cafe73-37cf-46e7-bfa7-97c7eea7ced9\" data-linktype=\"external\">LINQ to Objects</a>.</td>\n</tr>\n<tr>\n<td>LINQ to SQL</td>\n<td>The LINQ to SQL provider enables you to query and modify data in a SQL Server database. This makes it easy to map the object model for an application to the tables and objects in a database.<br><br> Visual Basic makes it easier to work with LINQ to SQL by including the Object Relational Designer (O/R Designer). This designer is used to create an object model in an application that maps to objects in a database. The O/R Designer also provides functionality to map stored procedures and functions to the <a class=\"xref\" href=\"../../../../../api/system.data.linq.datacontext\" data-linktype=\"relative-path\">DataContext</a> object, which manages communication with the database and stores state for optimistic concurrency checks.<br><br> For more information about the LINQ to SQL provider, see <a href=\"https://msdn.microsoft.com/library/bb386976\" data-linktype=\"external\">LINQ to SQL</a>. For more information about the Object Relational Designer, see <a href=\"https://docs.microsoft.com/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2\" data-linktype=\"external\">LINQ to SQL Tools in Visual Studio</a>.</td>\n</tr>\n<tr>\n<td>LINQ to XML</td>\n<td>The LINQ to XML provider enables you to query and modify XML. You can modify in-memory XML, or you can load XML from and save XML to a file.<br><br> Additionally, the LINQ to XML provider enables XML literals and XML axis properties that enable you to write XML directly in your Visual Basic code. For more information, see <a href=\"../xml/index\" data-linktype=\"relative-path\">XML</a>.</td>\n</tr>\n<tr>\n<td>LINQ to DataSet</td>\n<td>The LINQ to DataSet provider enables you to query and update data in an ADO.NET dataset. You can add the power of LINQ to applications that use datasets in order to simplify and extend your capabilities for querying, aggregating, and updating the data in your dataset.<br><br> For more information, see <a href=\"http://msdn.microsoft.com/library/743e3755-3ecb-45a2-8d9b-9ed41f0dcf17\" data-linktype=\"external\">LINQ to DataSet</a>.</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"a-namestructureofalinqquerya-structure-of-a-linq-query\"><a name=\"StructureOfALINQQuery\"></a> Structure of a LINQ Query</h2>\n<p> A LINQ query, often referred to as a <em>query expression</em>, consists of a combination of query clauses that identify the data sources and iteration variables for the query. A query expression can also include instructions for sorting, filtering, grouping, and joining, or calculations to apply to the source data. Query expression syntax resembles the syntax of SQL; therefore, you may find much of the syntax familiar.  </p>\n<p> A query expression starts with a <code>From</code> clause. This clause identifies the source data for a query and the variables that are used to refer to each element of the source data individually. These variables are named <em>range variables</em> or <em>iteration variables</em>. The <code>From</code> clause is required for a query, except for <code>Aggregate</code> queries, where the <code>From</code> clause is optional. After the scope and source of the query are identified in the <code>From</code> or <code>Aggregate</code> clauses, you can include any combination of query clauses to refine the query. For details about query clauses, see Visual Basic LINQ Query Operators later in this topic. For example, the following query identifies a source collection of customer data as the <code>customers</code> variable, and an iteration variable named <code>cust</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#2\">Dim customers = GetCustomers()\n\nDim queryResults = From cust In customers\n\nFor Each result In queryResults\n    Debug.WriteLine(result.CompanyName &amp; &quot;  &quot; &amp; result.Country)\nNext\n\n&#39; Output:\n&#39;   Contoso, Ltd  Canada\n&#39;   Margie&#39;s Travel  United States\n&#39;   Fabrikam, Inc.  Canada\n</code></pre><p> This example is a valid query by itself; however, the query becomes far more powerful when you add more query clauses to refine the result. For example, you can add a <code>Where</code> clause to filter the result by one or more values. Query expressions are a single line of code; you can just append additional query clauses to the end of the query. You can break up a query across multiple lines of text to improve readability by using the underscore (_) line-continuation character. The following code example shows an example of a query that includes a <code>Where</code> clause.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#3\">Dim queryResults = From cust In customers\n                   Where cust.Country = &quot;Canada&quot;\n</code></pre><p> Another powerful query clause is the <code>Select</code> clause, which enables you to return only selected fields from the data source. LINQ queries return enumerable collections of strongly typed objects. A query can return a collection of anonymous types or named types. You can use the <code>Select</code> clause to return only a single field from the data source. When you do this, the type of the collection returned is the type of that single field. You can also use the <code>Select</code> clause to return multiple fields from the data source. When you do this, the type of the collection returned is a new anonymous type. You can also match the fields returned by the query to the fields of a specified named type. The following code example shows a query expression that returns a collection of anonymous types that have members populated with data from the selected fields from the data source.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#4\">Dim queryResults = From cust In customers\n               Where cust.Country = &quot;Canada&quot;\n               Select cust.CompanyName, cust.Country\n</code></pre><p> LINQ queries can also be used to combine multiple sources of data and return a single result. This can be done with one or more <code>From</code> clauses, or by using the <code>Join</code> or <code>Group Join</code> query clauses. The following code example shows a query expression that combines customer and order data and returns a collection of anonymous types containing customer and order data.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#5\">Dim customers = GetCustomers()\nDim orders = GetOrders()\n\nDim queryResults = From cust In customers, ord In orders\n           Where cust.CustomerID = ord.CustomerID\n           Select cust, ord\n\nFor Each result In queryResults\n    Debug.WriteLine(result.ord.Amount &amp; &quot;  &quot; &amp; result.ord.CustomerID &amp; &quot;  &quot; &amp; result.cust.CompanyName)\nNext\n\n&#39; Output:\n&#39;   200.00  1  Contoso, Ltd\n&#39;   300.00  1  Contoso, Ltd\n&#39;   100.00  2  Margie&#39;s Travel\n&#39;   600.00  3  Fabrikam, Inc.\n&#39;   800.00  3  Fabrikam, Inc.\n</code></pre><p> You can use the <code>Group Join</code> clause to create a hierarchical query result that contains a collection of customer objects. Each customer object has a property that contains a collection of all orders for that customer. The following code example shows a query expression that combines customer and order data as a hierarchical result and returns a collection of anonymous types. The query returns a type that includes a <code>CustomerOrders</code> property that contains a collection of order data for the customer. It also includes an <code>OrderTotal</code> property that contains the sum of the totals for all the orders for that customer. (This query is equivalent to a LEFT OUTER JOIN.)  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#6\">Dim customers = GetCustomers()\nDim orders = GetOrders()\n\nDim queryResults = From cust In customers\n                   Group Join ord In orders On\n                     cust.CustomerID Equals ord.CustomerID\n                     Into CustomerOrders = Group,\n                          OrderTotal = Sum(ord.Amount)\n                   Select cust.CompanyName, cust.CustomerID,\n                          CustomerOrders, OrderTotal\n\nFor Each result In queryResults\n    Debug.WriteLine(result.OrderTotal &amp; &quot;  &quot; &amp; result.CustomerID &amp; &quot;  &quot; &amp; result.CompanyName)\n    For Each ordResult In result.CustomerOrders\n        Debug.WriteLine(&quot;   &quot; &amp; ordResult.Amount)\n    Next\nNext\n\n&#39; Output:\n&#39;   500.00  1  Contoso, Ltd\n&#39;      200.00\n&#39;      300.00\n&#39;   100.00  2  Margie&#39;s Travel\n&#39;      100.00\n&#39;   1400.00  3  Fabrikam, Inc.\n&#39;      600.00\n&#39;      800.00\n</code></pre><p> There are several additional LINQ query operators that you can use to create powerful query expressions. The next section of this topic discusses the various query clauses that you can include in a query expression. For details about Visual Basic query clauses, see <a href=\"../../../language-reference/queries/queries\" data-linktype=\"relative-path\">Queries</a>.  </p>\n<h2 id=\"a-namevisualbasiclinqqueryoperatorsa-visual-basic-linq-query-operators\"><a name=\"VisualBasicLINQQueryOperators\"></a> Visual Basic LINQ Query Operators</h2>\n<p> The classes in the <a class=\"xref\" href=\"../../../../../api/system.linq\" data-linktype=\"relative-path\">System.Linq</a> namespace and the other namespaces that support LINQ queries include methods that you can call to create and refine queries based on the needs of your application. Visual Basic includes keywords for the most common query clauses, as described by the following table.  </p>\n<table>\n<thead>\n<tr>\n<th>Term</th>\n<th>Definition</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"../../../language-reference/queries/from-clause\" data-linktype=\"relative-path\">From Clause</a></td>\n<td>Either a <code>From</code> clause or an <code>Aggregate</code> clause is required to begin a query. A <code>From</code> clause specifies a source collection and an iteration variable for a query. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#7\">&#39; Returns the company name for all customers for which\n&#39; the Country is equal to &quot;Canada&quot;.\nDim names = From cust In customers\n            Where cust.Country = &quot;Canada&quot;\n            Select cust.CompanyName\n</code></pre></td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/select-clause\" data-linktype=\"relative-path\">Select Clause</a></td>\n<td>Optional. Declares a set of iteration variables for a query. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#8\">&#39; Returns the company name and ID value for each\n&#39; customer as a collection of a new anonymous type.\nDim customerList = From cust In customers\n                   Select cust.CompanyName, cust.CustomerID\n</code></pre><br><br> If a <code>Select</code> clause is not specified, the iteration variables for the query consist of the iteration variables specified by the <code>From</code> or <code>Aggregate</code> clause.</td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/where-clause\" data-linktype=\"relative-path\">Where Clause</a></td>\n<td>Optional. Specifies a filtering condition for a query. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#9\">&#39; Returns all product names for which the Category of\n&#39; the product is &quot;Beverages&quot;.\nDim names = From product In products\n            Where product.Category = &quot;Beverages&quot;\n            Select product.Name\n</code></pre></td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/order-by-clause\" data-linktype=\"relative-path\">Order By Clause</a></td>\n<td>Optional. Specifies the sort order for columns in a query. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#10\">&#39; Returns a list of books sorted by price in \n&#39; ascending order.\nDim titlesAscendingPrice = From b In books\n                           Order By b.price\n</code></pre></td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/join-clause\" data-linktype=\"relative-path\">Join Clause</a></td>\n<td>Optional. Combines two collections into a single collection. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#11\">&#39; Returns a combined collection of all of the \n&#39; processes currently running and a descriptive\n&#39; name for the process taken from a list of \n&#39; descriptive names.\nDim processes = From proc In Process.GetProcesses\n                Join desc In processDescriptions\n                  On proc.ProcessName Equals desc.ProcessName\n                Select proc.ProcessName, proc.Id, desc.Description\n</code></pre></td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/group-by-clause\" data-linktype=\"relative-path\">Group By Clause</a></td>\n<td>Optional. Groups the elements of a query result. Can be used to apply aggregate functions to each group. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#12\">&#39; Returns a list of orders grouped by the order date\n&#39; and sorted in ascending order by the order date.\nDim orderList = From order In orders\n                Order By order.OrderDate\n                Group By OrderDate = order.OrderDate\n                Into OrdersByDate = Group\n</code></pre></td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/group-join-clause\" data-linktype=\"relative-path\">Group Join Clause</a></td>\n<td>Optional. Combines two collections into a single hierarchical collection. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#13\">&#39; Returns a combined collection of customers and\n&#39; customer orders.\nDim customerList = From cust In customers\n                   Group Join ord In orders On\n                     cust.CustomerID Equals ord.CustomerID\n                   Into CustomerOrders = Group,\n                        TotalOfOrders = Sum(ord.Amount)\n                   Select cust.CompanyName, cust.CustomerID,\n                          CustomerOrders, TotalOfOrders\n</code></pre></td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/aggregate-clause\" data-linktype=\"relative-path\">Aggregate Clause</a></td>\n<td>Either a <code>From</code> clause or an <code>Aggregate</code> clause is required to begin a query. An <code>Aggregate</code> clause applies one or more aggregate functions to a collection. For example, you can use the <code>Aggregate</code> clause to calculate a sum for all the elements returned by a query.<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#14\">&#39; Returns the sum of all order amounts.\nDim orderTotal = Aggregate order In orders\n                 Into Sum(order.Amount)\n</code></pre><br><br> You can also use the <code>Aggregate</code> clause to modify a query. For example, you can use the <code>Aggregate</code> clause to perform a calculation on a related query collection.<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#15\">&#39; Returns the customer company name and largest \n&#39; order amount for each customer.\nDim customerMax = From cust In customers\n                  Aggregate order In cust.Orders\n                  Into MaxOrder = Max(order.Amount)\n                  Select cust.CompanyName, MaxOrder\n</code></pre></td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/let-clause\" data-linktype=\"relative-path\">Let Clause</a></td>\n<td>Optional. Computes a value and assigns it to a new variable in the query. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#16\">&#39; Returns a list of products with a calculation of\n&#39; a ten percent discount.\nDim discountedProducts = From prod In products\n                         Let Discount = prod.UnitPrice * 0.1\n                         Where Discount &gt;= 50\n                         Select prod.Name, prod.UnitPrice, Discount\n</code></pre></td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/distinct-clause\" data-linktype=\"relative-path\">Distinct Clause</a></td>\n<td>Optional. Restricts the values of the current iteration variable to eliminate duplicate values in query results. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#17\">&#39; Returns a list of cities with no duplicate entries.\nDim cities = From item In customers\n             Select item.City\n             Distinct\n</code></pre></td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/skip-clause\" data-linktype=\"relative-path\">Skip Clause</a></td>\n<td>Optional. Bypasses a specified number of elements in a collection and then returns the remaining elements. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#18\">&#39; Returns a list of customers. The first 10 customers\n&#39; are ignored and the remaining customers are\n&#39; returned.\nDim customerList = From cust In customers\n                   Skip 10\n</code></pre></td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/skip-while-clause\" data-linktype=\"relative-path\">Skip While Clause</a></td>\n<td>Optional. Bypasses elements in a collection as long as a specified condition is <code>true</code> and then returns the remaining elements. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#19\">&#39; Returns a list of customers. The query ignores all\n&#39; customers until the first customer for whom\n&#39; IsSubscriber returns false. That customer and all\n&#39; remaining customers are returned.\nDim customerList = From cust In customers\n                   Skip While IsSubscriber(cust)\n</code></pre></td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/take-clause\" data-linktype=\"relative-path\">Take Clause</a></td>\n<td>Optional. Returns a specified number of contiguous elements from the start of a collection. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#20\">&#39; Returns the first 10 customers.\nDim customerList = From cust In customers\n                   Take 10\n</code></pre></td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/take-while-clause\" data-linktype=\"relative-path\">Take While Clause</a></td>\n<td>Optional. Includes elements in a collection as long as a specified condition is <code>true</code> and bypasses the remaining elements. For example:<br><br><pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#21\">&#39; Returns a list of customers. The query returns\n&#39; customers until the first customer for whom \n&#39; HasOrders returns false. That customer and all \n&#39; remaining customers are ignored.\nDim customersWithOrders = From cust In customers\n                          Order By cust.Orders.Count Descending\n                          Take While HasOrders(cust)\n</code></pre></td>\n</tr>\n</tbody>\n</table>\n<p> For details about Visual Basic query clauses, see <a href=\"../../../language-reference/queries/queries\" data-linktype=\"relative-path\">Queries</a>.  </p>\n<p> You can use additional LINQ query features by calling members of the enumerable and queryable types provided by LINQ. You can use these additional capabilities by calling a particular query operator on the result of a query expression. For example, the following code example uses the <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/bb358229(v=vs.110).aspx\" data-linktype=\"external\">Union</a> method to combine the results of two queries into one query result. It uses the <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/bb342261(v=vs.110).aspx\" data-linktype=\"external\">ToList</a> method to return the query result as a generic list.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbalrIntroToLINQ#22\">Public Function GetAllCustomers() As List(Of Customer)\n    Dim customers1 = From cust In domesticCustomers\n    Dim customers2 = From cust In internationalCustomers\n\n    Dim customerList = customers1.Union(customers2)\n\n    Return customerList.ToList()\nEnd Function\n</code></pre><p> For details about additional LINQ capabilities, see <a href=\"http://msdn.microsoft.com/library/24cda21e-8af8-4632-b519-c404a839b9b2\" data-linktype=\"external\">Standard Query Operators Overview</a>.  </p>\n<h2 id=\"a-nameconnectingtoadatabasea-connecting-to-a-database-by-using-linq-to-sql\"><a name=\"ConnectingToADatabase\"></a> Connecting to a Database by Using LINQ to SQL</h2>\n<p> In Visual Basic, you identify the SQL Server database objects, such as tables, views, and stored procedures, that you want to access by using a LINQ to SQL file. A LINQ to SQL file has an extension of .dbml.  </p>\n<p> When you have a valid connection to a SQL Server database, you can add a <strong>LINQ to SQL Classes</strong> item template to your project. This will display the Object Relational Designer (O/R designer). The O/R Designer enables you to drag the items that you want to access in your code from the <strong>Server Explorer</strong>/<strong>Database Explorer</strong> onto the designer surface. The LINQ to SQL file adds a <a class=\"xref\" href=\"../../../../../api/system.data.linq.datacontext\" data-linktype=\"relative-path\">DataContext</a> object to your project. This object includes properties and collections for the tables and views that you want access to, and methods for the stored procedures that you want to call. After you have saved your changes to the LINQ to SQL (.dbml) file, you can access these objects in your code by referencing the <a class=\"xref\" href=\"../../../../../api/system.data.linq.datacontext\" data-linktype=\"relative-path\">DataContext</a> object that is defined by the O/R Designer. The <a class=\"xref\" href=\"../../../../../api/system.data.linq.datacontext\" data-linktype=\"relative-path\">DataContext</a> object for your project is named based on the name of your LINQ to SQL file. For example, a LINQ to SQL file that is named Northwind.dbml will create a <a class=\"xref\" href=\"../../../../../api/system.data.linq.datacontext\" data-linktype=\"relative-path\">DataContext</a> object named <code>NorthwindDataContext</code>.  </p>\n<p> For examples with step-by-step instructions, see <a href=\"how-to-query-a-database-by-using-linq\" data-linktype=\"relative-path\">How to: Query a Database</a> and <a href=\"how-to-call-a-stored-procedure-by-using-linq\" data-linktype=\"relative-path\">How to: Call a Stored Procedure</a>.  </p>\n<h2 id=\"a-namevisualbasicfeaturesthatsupportlinqa-visual-basic-features-that-support-linq\"><a name=\"VisualBasicFeaturesThatSupportLINQ\"></a> Visual Basic Features That Support LINQ</h2>\n<p> Visual Basic includes other notable features that make the use of LINQ simple and reduce the amount of code that you must write to perform LINQ queries. These include the following:  </p>\n<ul>\n<li><p><strong>Anonymous types</strong>, which enable you to create a new type based on a query result.  </p>\n</li>\n<li><p><strong>Implicitly typed variables</strong>, which enable you to defer specifying a type and let the compiler infer the type based on the query result.  </p>\n</li>\n<li><p><strong>Extension methods</strong>, which enable you to extend an existing type with your own methods without modifying the type itself.  </p>\n<p>For details, see <a href=\"../../concepts/linq/features-that-support-linq\" data-linktype=\"relative-path\">Visual Basic Features That Support LINQ</a>.  </p>\n</li>\n</ul>\n<h2 id=\"a-namequeryexecutiona-deferred-and-immediate-query-execution\"><a name=\"QueryExecution\"></a> Deferred and Immediate Query Execution</h2>\n<p> Query execution is separate from creating a query. After a query is created, its execution is triggered by a separate mechanism. A query can be executed as soon as it is defined (<em>immediate execution</em>), or the definition can be stored and the query can be executed later (<em>deferred execution</em>).  </p>\n<p> By default, when you create a query, the query itself does not execute immediately. Instead, the query definition is stored in the variable that is used to reference the query result. When the query result variable is accessed later in code, such as in a <code>Forâ€¦Next</code> loop, the query is executed. This process is referred to as <em>deferred execution</em>.  </p>\n<p> Queries can also be executed when they are defined, which is referred to as <em>immediate execution</em>. You can trigger immediate execution by applying a method that requires access to individual elements of the query result. This can be the result of including an aggregate function, such as <code>Count</code>, <code>Sum</code>, <code>Average</code>, <code>Min</code>, or <code>Max</code>. For more information about aggregate functions, see <a href=\"../../../language-reference/queries/aggregate-clause\" data-linktype=\"relative-path\">Aggregate Clause</a>.  </p>\n<p> Using the <code>ToList</code> or <code>ToArray</code> methods will also force immediate execution. This can be useful when you want to execute the query immediately and cache the results. For more information about these methods, see <a href=\"../../concepts/linq/converting-data-types\" data-linktype=\"relative-path\">Converting Data Types</a>.  </p>\n<p> For more information about query execution, see <a href=\"../../concepts/linq/writing-your-first-linq-query\" data-linktype=\"relative-path\">Writing Your First LINQ Query</a>.  </p>\n<h2 id=\"a-namexmlinvisualbasica-xml-in-visual-basic\"><a name=\"XMLInVisualBasic\"></a> XML in Visual Basic</h2>\n<p> The XML features in Visual Basic include XML literals and XML axis properties, which enable you easily to create, access, query, and modify XML in your code. XML literals enable you to write XML directly in your code. The Visual Basic compiler treats the XML as a first-class data object.  </p>\n<p> The following code example shows how to create an XML element, access its sub-elements and attributes, and query the contents of the element by using LINQ.  </p>\n<pre><code class=\"lang-vb\" name=\"VbXmlSamples#8\">&#39; Place Imports statements at the top of your program.  \nImports &lt;xmlns:ns=&quot;http://SomeNamespace&quot;&gt;\n\nModule Sample1\n\n    Sub SampleTransform()\n\n        &#39; Create test by using a global XML namespace prefix. \n\n        Dim contact = \n            &lt;ns:contact&gt;\n                &lt;ns:name&gt;Patrick Hines&lt;/ns:name&gt;\n                &lt;ns:phone ns:type=&quot;home&quot;&gt;206-555-0144&lt;/ns:phone&gt;\n                &lt;ns:phone ns:type=&quot;work&quot;&gt;425-555-0145&lt;/ns:phone&gt;\n            &lt;/ns:contact&gt;\n\n        Dim phoneTypes = \n          &lt;phoneTypes&gt;\n              &lt;%= From phone In contact.&lt;ns:phone&gt; \n                  Select &lt;type&gt;&lt;%= phone.@ns:type %&gt;&lt;/type&gt; \n              %&gt;\n          &lt;/phoneTypes&gt;\n\n        Console.WriteLine(phoneTypes)\n    End Sub\n\nEnd Module\n</code></pre><p> For more information, see <a href=\"../xml/index\" data-linktype=\"relative-path\">XML</a>.  </p>\n<h2 id=\"a-namerelatedresourcesa-related-resources\"><a name=\"RelatedResources\"></a> Related Resources</h2>\n<table>\n<thead>\n<tr>\n<th>Topic</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"../xml/index\" data-linktype=\"relative-path\">XML</a></td>\n<td>Describes the XML features in Visual Basic that can be queried and that enable you to include XML as first-class data objects in your Visual Basic code.</td>\n</tr>\n<tr>\n<td><a href=\"../../../language-reference/queries/queries\" data-linktype=\"relative-path\">Queries</a></td>\n<td>Provides reference information about the query clauses that are available in Visual Basic.</td>\n</tr>\n<tr>\n<td><a href=\"http://msdn.microsoft.com/library/a73c4aec-5d15-4e98-b962-1274021ea93d\" data-linktype=\"external\">LINQ (Language-Integrated Query)</a></td>\n<td>Includes general information, programming guidance, and samples for LINQ.</td>\n</tr>\n<tr>\n<td><a href=\"https://msdn.microsoft.com/library/bb386976\" data-linktype=\"external\">LINQ to SQL</a></td>\n<td>Includes general information, programming guidance, and samples for LINQ to SQL.</td>\n</tr>\n<tr>\n<td><a href=\"http://msdn.microsoft.com/library/73cafe73-37cf-46e7-bfa7-97c7eea7ced9\" data-linktype=\"external\">LINQ to Objects</a></td>\n<td>Includes general information, programming guidance, and samples for LINQ to Objects.</td>\n</tr>\n<tr>\n<td><a href=\"http://msdn.microsoft.com/library/dd7d3c6a-ff98-47e9-a1a7-2d4cfc42d150\" data-linktype=\"external\">LINQ to ADO.NET (Portal Page)</a></td>\n<td>Includes links to general information, programming guidance, and samples for LINQ to ADO.NET.</td>\n</tr>\n<tr>\n<td><a href=\"http://msdn.microsoft.com/library/f0fe21e9-ee43-4a55-b91a-0800e5782c13\" data-linktype=\"external\">LINQ to XML</a></td>\n<td>Includes general information, programming guidance, and samples for LINQ to XML.</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"a-namehowtoandwalkthroughtopicsa-how-to-and-walkthrough-topics\"><a name=\"HowToAndWalkthroughTopics\"></a> How To and Walkthrough Topics</h2>\n<p> <a href=\"how-to-query-a-database-by-using-linq\" data-linktype=\"relative-path\">How to: Query a Database</a>  </p>\n<p> <a href=\"how-to-call-a-stored-procedure-by-using-linq\" data-linktype=\"relative-path\">How to: Call a Stored Procedure</a>  </p>\n<p> <a href=\"how-to-modify-data-in-a-database-by-using-linq\" data-linktype=\"relative-path\">How to: Modify Data in a Database</a>  </p>\n<p> <a href=\"how-to-combine-data-with-linq-by-using-joins\" data-linktype=\"relative-path\">How to: Combine Data with Joins</a>  </p>\n<p> <a href=\"how-to-sort-query-results-by-using-linq\" data-linktype=\"relative-path\">How to: Sort Query Results</a>  </p>\n<p> <a href=\"how-to-filter-query-results-by-using-linq\" data-linktype=\"relative-path\">How to: Filter Query Results</a>  </p>\n<p> <a href=\"how-to-count-sum-or-average-data-by-using-linq\" data-linktype=\"relative-path\">How to: Count, Sum, or Average Data</a>  </p>\n<p> <a href=\"how-to-find-the-minimum-or-maximum-value-in-a-query-result\" data-linktype=\"relative-path\">How to: Find the Minimum or Maximum Value in a Query Result</a>  </p>\n<p> <a href=\"http://msdn.microsoft.com/library/e88224ab-ff61-4a3a-b6b8-6f3694546cac\" data-linktype=\"external\">How to: Assign stored procedures to perform updates, inserts, and deletes (O/R Designer)</a>  </p>\n<h2 id=\"featured-book-chapters\">Featured Book Chapters</h2>\n<p> <a href=\"http://go.microsoft.com/fwlink/?LinkId=195277\" data-linktype=\"external\">Chapter 17: LINQ</a> in <a href=\"http://go.microsoft.com/fwlink/?LinkId=195383\" data-linktype=\"external\">Programming Visual Basic 2008</a>  </p>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"http://msdn.microsoft.com/library/a73c4aec-5d15-4e98-b962-1274021ea93d\" data-linktype=\"external\">LINQ (Language-Integrated Query)</a><br> <a href=\"../xml/overview-of-linq-to-xml\" data-linktype=\"relative-path\">Overview of LINQ to XML in Visual Basic</a><br> <a href=\"http://msdn.microsoft.com/library/dc20a8fb-03f6-4b68-9c2b-7f7299e3070b\" data-linktype=\"external\">LINQ to DataSet Overview</a><br> <a href=\"https://msdn.microsoft.com/library/bb386976\" data-linktype=\"external\">LINQ to SQL</a><br> <a href=\"https://docs.microsoft.com/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2\" data-linktype=\"external\">LINQ to SQL Tools in Visual Studio</a><br> <a href=\"https://docs.microsoft.com/visualstudio/data-tools/datacontext-methods-o-r-designer\" data-linktype=\"external\">DataContext Methods (O/R Designer)</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"uhfHeaderId\" content=\"MSDocsHeader-DotNet\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"3047d86e-0d49-40e2-928b-dc02e46c7984\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"28\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/linq/introduction-to-linq.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/linq/introduction-to-linq.md\">\r\n<meta name=\"document_id\" content=\"f288d11c-60b6-d654-99ec-0c3baf2a16eb\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","uhfHeaderId":"MSDocsHeader-DotNet","title":"Introduction to LINQ in Visual Basic | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"3047d86e-0d49-40e2-928b-dc02e46c7984","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":28,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["queries [LINQ in Visual Basic], about LINQ in Visual Basic queries","query execution [LINQ in Visual Basic]","range variables","LINQ [Visual Basic]","LINQ [Visual Basic], about LINQ in Visual Basic","query expressions [LINQ in Visual Basic]","LINQ","deferred execution","iteration variables"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Absolute urls and other fixes (#1281)","commit_sha":"f7dffe4885b331cec8d37f3cc5c9163f69c3b4c9","commit_date":"2016-11-22 12:57:26 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/linq/introduction-to-linq.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/linq/introduction-to-linq.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/linq/introduction-to-linq.md","document_id":"f288d11c-60b6-d654-99ec-0c3baf2a16eb","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/language-features/linq/introduction-to-linq","toc_asset_id":"articles/visual-basic/programming-guide/language-features/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"Introduction to LINQ in Visual Basic","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":3775,"_op_rawTitle":"<h1 id=\"introduction-to-linq-in-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/linq/introduction-to-linq.md\" sourcestartlinenumber=\"44\" sourceendlinenumber=\"44\">Introduction to LINQ in Visual Basic</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/language-features/linq/introduction-to-linq","fileRelativePath":"articles/visual-basic/programming-guide/language-features/linq/introduction-to-linq.html"},"themesRelativePathToOutputRoot":"_themes/"}