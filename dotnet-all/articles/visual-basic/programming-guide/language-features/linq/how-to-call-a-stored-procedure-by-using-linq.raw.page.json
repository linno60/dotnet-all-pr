{"content":"<div><div class=\"content\">\n<p>Language-Integrated Query (LINQ) makes it easy to access database information, including database objects such as stored procedures.  </p>\n<p> The following example shows how to create an application that calls a stored procedure in a SQL Server database. The sample shows how to call two different stored procedures in the database. Each procedure returns the results of a query. One procedure takes input parameters, and the other procedure does not take parameters.  </p>\n<p> The examples in this topic use the Northwind sample database. If you do not have the Northwind sample database on your development computer, you can download it from the <a href=\"http://go.microsoft.com/fwlink/?LinkID=98088\" data-linktype=\"external\">Microsoft Download Center</a> Web site. For instructions, see <a href=\"https://msdn.microsoft.com/library/bb399411\" data-linktype=\"external\">Downloading Sample Databases</a>.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p>Your computer might show different names or locations for some of the Visual Studio user interface elements in the following instructions. The Visual Studio edition that you have and the settings that you use determine these elements. For more information, see <a href=\"https://docs.microsoft.com/visualstudio/ide/personalizing-the-visual-studio-ide\" data-linktype=\"external\">Personalizing the IDE</a>.</p>\n</div>\n<h3 id=\"to-create-a-connection-to-a-database\">To create a connection to a database</h3>\n<ol>\n<li><p>In Visual Studio, open <strong>Server Explorer</strong>/<strong>Database Explorer</strong> by clicking <strong>Server Explorer</strong>/<strong>Database Explorer</strong> on the <strong>View</strong> menu.  </p>\n</li>\n<li><p>Right-click <strong>Data Connections</strong> in <strong>Server Explorer</strong>/<strong>Database Explorer</strong> and then click <strong>Add Connection</strong>.  </p>\n</li>\n<li><p>Specify a valid connection to the Northwind sample database.  </p>\n</li>\n</ol>\n<h3 id=\"to-add-a-project-that-contains-a-linq-to-sql-file\">To add a project that contains a LINQ to SQL file</h3>\n<ol>\n<li><p>In Visual Studio, on the <strong>File</strong> menu, point to <strong>New</strong> and then click <strong>Project</strong>. Select Visual Basic <strong>Windows Forms Application</strong> as the project type.  </p>\n</li>\n<li><p>On the <strong>Project</strong> menu, click <strong>Add New Item</strong>. Select the <strong>LINQ to SQL Classes</strong> item template.  </p>\n</li>\n<li><p>Name the file <code>northwind.dbml</code>. Click <strong>Add</strong>. The Object Relational Designer (O/R Designer) is opened for the northwind.dbml file.  </p>\n</li>\n</ol>\n<h3 id=\"to-add-stored-procedures-to-the-or-designer\">To add stored procedures to the O/R Designer</h3>\n<ol>\n<li><p>In <strong>Server Explorer</strong>/<strong>Database Explorer</strong>, expand the connection to the Northwind database. Expand the <strong>Stored Procedures</strong> folder.  </p>\n<p> If you have closed the O/R Designer, you can reopen it by double-clicking the northwind.dbml file that you added earlier.  </p>\n</li>\n<li><p>Click the <strong>Sales by Year</strong> stored procedure and drag it to the right pane of the designer. Click the <strong>Ten Most Expensive Products</strong> stored procedure drag it to the right pane of the designer.  </p>\n</li>\n<li><p>Save your changes and close the designer.  </p>\n</li>\n<li><p>Save your project.  </p>\n</li>\n</ol>\n<h3 id=\"to-add-code-to-display-the-results-of-the-stored-procedures\">To add code to display the results of the stored procedures</h3>\n<ol>\n<li><p>From the <strong>Toolbox</strong>, drag a <a class=\"xref\" href=\"../../../../../api/system.windows.forms.datagridview\" data-linktype=\"relative-path\">DataGridView</a> control onto the default Windows Form for your project, Form1.  </p>\n</li>\n<li><p>Double-click Form1 to add code to its <code>Load</code> event.  </p>\n</li>\n<li><p>When you added stored procedures to the O/R Designer, the designer added a <a class=\"xref\" href=\"../../../../../api/system.data.linq.datacontext\" data-linktype=\"relative-path\">DataContext</a> object for your project. This object contains the code that you must have to access those procedures. The <a class=\"xref\" href=\"../../../../../api/system.data.linq.datacontext\" data-linktype=\"relative-path\">DataContext</a> object for the project is named based on the name of the .dbml file. For this project, the <a class=\"xref\" href=\"../../../../../api/system.data.linq.datacontext\" data-linktype=\"relative-path\">DataContext</a> object is named <code>northwindDataContext</code>.  </p>\n<p> You can create an instance of the <a class=\"xref\" href=\"../../../../../api/system.data.linq.datacontext\" data-linktype=\"relative-path\">DataContext</a> in your code and call the stored procedure methods specified by the O/R Designer. To bind to the <a class=\"xref\" href=\"../../../../../api/system.windows.forms.datagridview\" data-linktype=\"relative-path\">DataGridView</a> object, you may have to force the query to execute immediately by calling the <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/bb342261(v=vs.110).aspx\" data-linktype=\"external\">ToList</a> method on the results of the stored procedure.  </p>\n<p> Add the following code to the <code>Load</code> event to call either of the stored procedures exposed as methods for your data context.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQtoSQLHowTos#1\">    Dim db As New northwindDataContext\n\n    &#39; Display the results of the Sales_by_Year stored procedure.\n    DataGridView1.DataSource = \n        db.Sales_by_Year(#1/1/1996#, #1/1/2007#).ToList()\n</code></pre><pre><code class=\"lang-vb\" name=\"VbLINQtoSQLHowTos#2\">    &#39; Display the results of the Ten_Most_Expensive_Products\n    &#39; stored procedure.\n\n    DataGridView1.DataSource = \n        db.Ten_Most_Expensive_Products.ToList()\n</code></pre></li>\n<li><p>Press F5 to run your project and view the results.  </p>\n</li>\n</ol>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"index\" data-linktype=\"relative-path\">LINQ</a><br> <a href=\"../../../language-reference/queries/queries\" data-linktype=\"relative-path\">Queries</a><br> <a href=\"https://msdn.microsoft.com/library/bb386976\" data-linktype=\"external\">LINQ to SQL</a><br> <a href=\"https://docs.microsoft.com/visualstudio/data-tools/datacontext-methods-o-r-designer\" data-linktype=\"external\">DataContext Methods (O/R Designer)</a><br> <a href=\"http://msdn.microsoft.com/library/e88224ab-ff61-4a3a-b6b8-6f3694546cac\" data-linktype=\"external\">How to: Assign stored procedures to perform updates, inserts, and deletes (O/R Designer)</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"6436d384-d1e0-40aa-8afd-451007477260\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"12\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/linq/how-to-call-a-stored-procedure-by-using-linq.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/linq/how-to-call-a-stored-procedure-by-using-linq.md\">\r\n<meta name=\"document_id\" content=\"42c77a97-e271-5fb6-8a37-377f5056e286\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"How to: Call a Stored Procedure by Using LINQ (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"6436d384-d1e0-40aa-8afd-451007477260","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":12,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["queries [LINQ in Visual Basic], stored procedure calls","stored procedures sample [Visual Basic]","stored procedures [LINQ to SQL]","queries [LINQ in Visual Basic], how-to topics"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Absolute urls and other fixes (#1281)","commit_sha":"f7dffe4885b331cec8d37f3cc5c9163f69c3b4c9","commit_date":"2016-11-22 12:57:26 -0800"},{"author_name":"Petr Onderka","author_email":"gsvick@gmail.com","committer_name":"Maira Wenzel","comitter_email":"mairaw@microsoft.com","message":"Fixed included notes (#1275)","commit_sha":"eca9acb54f87a9c5d6ba0f632a222d43318e74c3","commit_date":"2016-11-19 17:12:50 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"},{"profile_url":"https://github.com/svick","display_name":"Petr Onderka","id":"287848"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/linq/how-to-call-a-stored-procedure-by-using-linq.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/linq/how-to-call-a-stored-procedure-by-using-linq.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/linq/how-to-call-a-stored-procedure-by-using-linq.md","document_id":"42c77a97-e271-5fb6-8a37-377f5056e286","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/linq/how-to-call-a-stored-procedure-by-using-linq","toc_asset_id":"articles/visual-basic/programming-guide/language-features/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"How to: Call a Stored Procedure by Using LINQ (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":582,"_op_rawTitle":"<h1 id=\"how-to-call-a-stored-procedure-by-using-linq-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/linq/how-to-call-a-stored-procedure-by-using-linq.md\" sourcestartlinenumber=\"39\" sourceendlinenumber=\"39\">How to: Call a Stored Procedure by Using LINQ (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/linq/how-to-call-a-stored-procedure-by-using-linq","fileRelativePath":"articles/visual-basic/programming-guide/language-features/linq/how-to-call-a-stored-procedure-by-using-linq.html"},"themesRelativePathToOutputRoot":"_themes/"}