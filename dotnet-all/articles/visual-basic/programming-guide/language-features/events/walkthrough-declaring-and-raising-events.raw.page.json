{"content":"<div><div class=\"content\">\n<p>This walkthrough demonstrates how to declare and raise events for a class named <code>Widget</code>. After you complete the steps, you might want to read the companion topic, <a href=\"walkthrough-handling-events\" data-linktype=\"relative-path\">Walkthrough: Handling Events</a>, which shows how to use events from <code>Widget</code> objects to provide status information in an application.  </p>\n<h2 id=\"the-widget-class\">The Widget Class</h2>\n<p> Assume for the moment that you have a <code>Widget</code> class. Your <code>Widget</code> class has a method that can take a long time to execute, and you want your application to be able to put up some kind of completion indicator.  </p>\n<p> Of course, you could make the <code>Widget</code> object show a percent-complete dialog box, but then you would be stuck with that dialog box in every project in which you used the <code>Widget</code> class. A good principle of object design is to let the application that uses an object handle the user interfaceâ€”unless the whole purpose of the object is to manage a form or dialog box.  </p>\n<p> The purpose of <code>Widget</code> is to perform other tasks, so it is better to add a <code>PercentDone</code> event and let the procedure that calls <code>Widget</code>&#39;s methods handle that event and display status updates. The <code>PercentDone</code> event can also provide a mechanism for canceling the task.  </p>\n<h4 id=\"to-build-the-code-example-for-this-topic\">To build the code example for this topic</h4>\n<ol>\n<li><p>Open a new Visual Basic Windows Application project and create a form named <code>Form1</code>.  </p>\n</li>\n<li><p>Add two buttons and a label to <code>Form1</code>.  </p>\n</li>\n<li><p>Name the objects as shown in the following table.  </p>\n<table>\n<thead>\n<tr>\n<th>Object</th>\n<th>Property</th>\n<th>Setting</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>Button1</code></td>\n<td><code>Text</code></td>\n<td>Start Task</td>\n</tr>\n<tr>\n<td><code>Button2</code></td>\n<td><code>Text</code></td>\n<td>Cancel</td>\n</tr>\n<tr>\n<td><code>Label</code></td>\n<td><code>(Name)</code>, <code>Text</code></td>\n<td>lblPercentDone, 0</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li><p>On the <strong>Project</strong> menu, choose <strong>Add Class</strong> to add a class named <code>Widget.vb</code> to the project.  </p>\n</li>\n</ol>\n<h4 id=\"to-declare-an-event-for-the-widget-class\">To declare an event for the Widget class</h4>\n<ul>\n<li><p>Use the <code>Event</code> keyword to declare an event in the <code>Widget</code> class. Note that an event can have <code>ByVal</code> and <code>ByRef</code> arguments, as <code>Widget</code>&#39;s <code>PercentDone</code> event demonstrates:  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbcnWalkthroughDeclaringAndRaisingEvents#1\">    Public Event PercentDone(ByVal Percent As Single, \n                             ByRef Cancel As Boolean)\n</code></pre><p>When the calling object receives a <code>PercentDone</code> event, the <code>Percent</code> argument contains the percentage of the task that is complete. The <code>Cancel</code> argument can be set to <code>True</code> to cancel the method that raised the event.  </p>\n</li>\n</ul>\n<div class=\"NOTE\"><h5>Note</h5><p> You can declare event arguments just as you do arguments of procedures, with the following exceptions: Events cannot have <code>Optional</code> or <code>ParamArray</code> arguments, and events do not have return values.  </p>\n</div>\n<p> The <code>PercentDone</code> event is raised by the <code>LongTask</code> method of the <code>Widget</code> class. <code>LongTask</code> takes two arguments: the length of time the method pretends to be doing work, and the minimum time interval before <code>LongTask</code> pauses to raise the <code>PercentDone</code> event.  </p>\n<h4 id=\"to-raise-the-percentdone-event\">To raise the PercentDone event</h4>\n<ol>\n<li><p>To simplify access to the <code>Timer</code> property used by this class, add an <code>Imports</code> statement to the top of the declarations section of your class module, above the <code>Class Widget</code> statement.  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbcnWalkthroughDeclaringAndRaisingEvents#2\">Imports Microsoft.VisualBasic.DateAndTime\n</code></pre></li>\n<li><p>Add the following code to the <code>Widget</code> class:  </p>\n<pre><code class=\"lang-vb\" name=\"VbVbcnWalkthroughDeclaringAndRaisingEvents#3\">    Public Sub LongTask(ByVal Duration As Single, \n                        ByVal MinimumInterval As Single)\n        Dim Threshold As Single\n        Dim Start As Single\n        Dim blnCancel As Boolean\n\n        &#39; The Timer property of the DateAndTime object returns the seconds\n        &#39; and milliseconds that have passed since midnight.\n        Start = CSng(Timer)\n        Threshold = MinimumInterval\n\n        Do While CSng(Timer) &lt; (Start + Duration)\n            &#39; In a real application, some unit of work would\n            &#39; be done here each time through the loop.\n            If CSng(Timer) &gt; (Start + Threshold) Then\n                RaiseEvent PercentDone( \n                Threshold / Duration, blnCancel)\n                &#39; Check to see if the operation was canceled.\n                If blnCancel Then Exit Sub\n                Threshold = Threshold + MinimumInterval\n            End If\n        Loop\n    End Sub\n</code></pre><p>When your application calls the <code>LongTask</code> method, the <code>Widget</code> class raises the <code>PercentDone</code> event every <code>MinimumInterval</code> seconds. When the event returns, <code>LongTask</code> checks to see if the <code>Cancel</code> argument was set to <code>True</code>.  </p>\n<p>A few disclaimers are necessary here. For simplicity, the <code>LongTask</code> procedure assumes you know in advance how long the task will take. This is almost never the case. Dividing tasks into chunks of even size can be difficult, and often what matters most to users is simply the amount of time that passes before they get an indication that something is happening.  </p>\n<p>You may have spotted another flaw in this sample. The <code>Timer</code> property returns the number of seconds that have passed since midnight; therefore, the application gets stuck if it is started just before midnight. A more careful approach to measuring time would take boundary conditions such as this into consideration, or avoid them altogether, using properties such as <code>Now</code>.  </p>\n<p>Now that the <code>Widget</code> class can raise events, you can move to the next walkthrough. <a href=\"walkthrough-handling-events\" data-linktype=\"relative-path\">Walkthrough: Handling Events</a> demonstrates how to use <code>WithEvents</code> to associate an event handler with the <code>PercentDone</code> event.  </p>\n</li>\n</ol>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a class=\"xref\" href=\"../../../../../api/microsoft.visualbasic.dateandtime#Microsoft_VisualBasic_DateAndTime_Timer_\" data-linktype=\"relative-path\">Timer</a><br> <a class=\"xref\" href=\"../../../../../api/microsoft.visualbasic.dateandtime#Microsoft_VisualBasic_DateAndTime_Now_\" data-linktype=\"relative-path\">Now</a><br> <a href=\"walkthrough-handling-events\" data-linktype=\"relative-path\">Walkthrough: Handling Events</a><br> <a href=\"index\" data-linktype=\"relative-path\">Events</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"8ffb3be8-097d-4d3c-b71e-04555ebda2a2\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"16\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-15 06:14 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/0a5d76c154aeb9b749c9c3fc5ad0962e93754a62/docs/visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md\">\r\n<meta name=\"document_id\" content=\"f71fb894-977e-999a-cf2d-ddf1ce06dd3c\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Declaring and Raising Events (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"8ffb3be8-097d-4d3c-b71e-04555ebda2a2","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":16,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["declarations, events","events [Visual Basic], walkthroughs","declaring events, walkthroughs","events [Visual Basic], declaring","events [Visual Basic], raising","raising events, walkthroughs"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Reorganizing the VB TOC (#1348)","commit_sha":"0a5d76c154aeb9b749c9c3fc5ad0962e93754a62","commit_date":"2017-02-14 10:22:48 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2017-03-15 06:14 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"3/15/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/0a5d76c154aeb9b749c9c3fc5ad0962e93754a62/docs/visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md","document_id":"f71fb894-977e-999a-cf2d-ddf1ce06dd3c","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events","toc_asset_id":"articles/visual-basic/programming-guide/language-features/events/toc.json","toc_rel":"toc.json","_op_ogTitle":"Declaring and Raising Events (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":773,"_op_rawTitle":"<h1 id=\"walkthrough-declaring-and-raising-events-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md\" sourcestartlinenumber=\"41\" sourceendlinenumber=\"41\">Walkthrough: Declaring and Raising Events (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events","fileRelativePath":"articles/visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.html"},"themesRelativePathToOutputRoot":"_themes/"}