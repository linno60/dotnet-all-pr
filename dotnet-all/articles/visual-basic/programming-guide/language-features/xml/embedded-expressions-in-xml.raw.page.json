{"content":"<div><div class=\"content\">\n<p>Embedded expressions enable you to create XML literals that contain expressions that are evaluated at run time. The syntax for an embedded expression is <code>&lt;%=</code> <code>expression</code> <code>%&gt;</code>, which is the same as the syntax used in ASP.NET.  </p>\n<p> For example, you can create an XML element literal, combining embedded expressions with literal text content.  </p>\n<pre><code class=\"lang-vb\" name=\"VbXMLSamples#27\">        Dim isbnNumber As String = &quot;12345&quot;\n        Dim modifiedDate As String = &quot;3/5/2006&quot;\n        Dim book As XElement = \n            &lt;book category=&quot;fiction&quot; isbn=&lt;%= isbnNumber %&gt;&gt;\n                &lt;modifiedDate&gt;&lt;%= modifiedDate %&gt;&lt;/modifiedDate&gt;\n            &lt;/book&gt;\n</code></pre><p> If <code>isbnNumber</code> contains the integer 12345 and <code>modifiedDate</code> contains the date 3/5/2006, when this code executes, the value of <code>book</code> is:  </p>\n<pre class=\"loading\"><code>&lt;book category=&quot;fiction&quot; isbn=&quot;12345&quot;&gt;  \n  &lt;modifiedDate&gt;3/5/2006&lt;/modifiedDate&gt;  \n&lt;/book&gt;  \n</code></pre><h2 id=\"embedded-expression-location-and-validation\">Embedded Expression Location and Validation</h2>\n<p> Embedded expressions can appear only at certain locations within XML literal expressions. The expression location controls which types the expression can return and how <code>Nothing</code> is handled. The following table describes the allowed locations and types of embedded expressions.  </p>\n<table>\n<thead>\n<tr>\n<th>Location in literal</th>\n<th>Type of expression</th>\n<th>Handling of <code>Nothing</code></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>XML element name</td>\n<td><a class=\"xref\" href=\"../../../../../api/system.xml.linq.xname\" data-linktype=\"relative-path\">XName</a></td>\n<td>Error</td>\n</tr>\n<tr>\n<td>XML element content</td>\n<td><code>Object</code> or array of <code>Object</code></td>\n<td>Ignored</td>\n</tr>\n<tr>\n<td>XML element attribute name</td>\n<td><a class=\"xref\" href=\"../../../../../api/system.xml.linq.xname\" data-linktype=\"relative-path\">XName</a></td>\n<td>Error, unless the attribute value is also <code>Nothing</code></td>\n</tr>\n<tr>\n<td>XML element attribute value</td>\n<td><code>Object</code></td>\n<td>Attribute declaration ignored</td>\n</tr>\n<tr>\n<td>XML element attribute</td>\n<td><a class=\"xref\" href=\"../../../../../api/system.xml.linq.xattribute\" data-linktype=\"relative-path\">XAttribute</a> or a collection of <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xattribute\" data-linktype=\"relative-path\">XAttribute</a></td>\n<td>Ignored</td>\n</tr>\n<tr>\n<td>XML document root element</td>\n<td><a class=\"xref\" href=\"../../../../../api/system.xml.linq.xelement\" data-linktype=\"relative-path\">XElement</a> or a collection of one <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xelement\" data-linktype=\"relative-path\">XElement</a> object and an arbitrary number of <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xprocessinginstruction\" data-linktype=\"relative-path\">XProcessingInstruction</a> and <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xcomment\" data-linktype=\"relative-path\">XComment</a> objects</td>\n<td>Ignored</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li><p>Example of an embedded expression in an XML element name:  </p>\n<pre><code class=\"lang-vb\" name=\"VbXMLSamples#32\">Dim elementName As String = &quot;contact&quot;\nDim contact1 As XElement = &lt;&lt;%= elementName %&gt;/&gt;\n</code></pre></li>\n<li><p>Example of an embedded expression in the content of an XML element:  </p>\n<pre><code class=\"lang-vb\" name=\"VbXMLSamples#33\">Dim contactName As String = &quot;Patrick Hines&quot;\nDim contact2 As XElement = \n  &lt;contact&gt;&lt;%= contactName %&gt;&lt;/contact&gt;\n</code></pre></li>\n<li><p>Example of an embedded expression in an XML element attribute name:  </p>\n<pre><code class=\"lang-vb\" name=\"VbXMLSamples#34\">Dim phoneType As String = &quot;home&quot;\nDim contact3 As XElement = \n  &lt;contact &lt;%= phoneType %&gt;=&quot;206-555-0144&quot;/&gt;\n</code></pre></li>\n<li><p>Example of an embedded expression in an XML element attribute value:  </p>\n<pre><code class=\"lang-vb\" name=\"VbXMLSamples#35\">Dim phoneNumber As String = &quot;206-555-0144&quot;\nDim contact4 As XElement = \n  &lt;contact home=&lt;%= phoneNumber %&gt;/&gt;\n</code></pre></li>\n<li><p>Example of an embedded expression in an XML element attribute:  </p>\n<pre><code class=\"lang-vb\" name=\"VbXMLSamples#36\">Dim phoneAttribute As XAttribute = \n  New XAttribute(XName.Get(phoneType), phoneNumber)\nDim contact5 As XElement = \n  &lt;contact &lt;%= phoneAttribute %&gt;/&gt;\n</code></pre></li>\n<li><p>Example of an embedded expression in an XML document root element:  </p>\n<pre><code class=\"lang-vb\" name=\"VbXMLSamples#37\">Dim document As XDocument = \n  &lt;?xml version=&quot;1.0&quot;?&gt;&lt;%= contact1 %&gt;\n</code></pre><p>If you enable <code>Option Strict</code>, the compiler checks that the type of each embedded expression widens to the required type. The only exception is for the root element of an XML document, which is verified when the code runs. If you compile without <code>Option Strict</code>, you can embed expressions of type <code>Object</code> and their type is verified at run time.  </p>\n<p>In locations where content is optional, embedded expressions that contain <code>Nothing</code> are ignored. This means you do not have to check that element content, attribute values, and array elements are not <code>Nothing</code> before you use an XML literal. Required values, such as element and attribute names, cannot be <code>Nothing</code>.  </p>\n<p>For more information about using an embedded expression in a particular type of literal, see <a href=\"../../../language-reference/xml-literals/xml-document-literal\" data-linktype=\"relative-path\">XML Document Literal</a>, <a href=\"../../../language-reference/xml-literals/xml-element-literal\" data-linktype=\"relative-path\">XML Element Literal</a>.  </p>\n</li>\n</ul>\n<h2 id=\"scoping-rules\">Scoping Rules</h2>\n<p> The compiler converts each XML literal into a constructor call for the appropriate literal type. The literal content and embedded expressions in an XML literal are passed as arguments to the constructor. This means that all Visual Basic programming elements available to an XML literal are also available to its embedded expressions.  </p>\n<p> Within an XML literal, you can access the XML namespace prefixes declared with the <code>Imports</code> statement. You can declare a new XML namespace prefix, or shadow an existing XML namespace prefix, in an element by using the <code>xmlns</code> attribute. The new namespace is available to the child nodes of that element, but not to XML literals in embedded expressions.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> When you declare an XML namespace prefix by using the <code>xmlns</code> namespace attribute, the attribute value must be a constant string. In this regard, using the <code>xmlns</code> attribute is like using the <code>Imports</code> statement to declare an XML namespace. You cannot use an embedded expression to specify the XML namespace value.  </p>\n</div>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"creating-xml\" data-linktype=\"relative-path\">Creating XML in Visual Basic</a><br> <a href=\"../../../language-reference/xml-literals/xml-document-literal\" data-linktype=\"relative-path\">XML Document Literal</a><br> <a href=\"../../../language-reference/xml-literals/xml-element-literal\" data-linktype=\"relative-path\">XML Element Literal</a><br> <a href=\"../../../language-reference/statements/option-strict-statement\" data-linktype=\"relative-path\">Option Strict Statement</a><br> <a href=\"../../../language-reference/statements/imports-statement-net-namespace-and-type\" data-linktype=\"relative-path\">Imports Statement (.NET Namespace and Type)</a><br> <a href=\"xml-literals-overview\" data-linktype=\"relative-path\">XML Literals Overview</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.tgt_pltfrm\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"bf2eb779-b751-4b7c-854f-9f2161482352\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"22\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/xml/embedded-expressions-in-xml.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/xml/embedded-expressions-in-xml.md\">\r\n<meta name=\"document_id\" content=\"4a6af8fc-1874-ab4c-b08e-00cee61f9609\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Embedded Expressions in XML (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.tgt_pltfrm":"","ms.assetid":"bf2eb779-b751-4b7c-854f-9f2161482352","f1_keywords":["vb.XmlEmbeddedExpression"],"translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":22,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["embedded expressions [Visual Basic]","LINQ to XML [Visual Basic], embedded expressions","XML literals [Visual Basic], embedded expressions"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/xml/embedded-expressions-in-xml.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/xml/embedded-expressions-in-xml.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/xml/embedded-expressions-in-xml.md","document_id":"4a6af8fc-1874-ab4c-b08e-00cee61f9609","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/xml/embedded-expressions-in-xml","toc_asset_id":"articles/visual-basic/programming-guide/language-features/xml/toc.json","toc_rel":"toc.json","_op_ogTitle":"Embedded Expressions in XML (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":687,"_op_rawTitle":"<h1 id=\"embedded-expressions-in-xml-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/xml/embedded-expressions-in-xml.md\" sourcestartlinenumber=\"40\" sourceendlinenumber=\"40\">Embedded Expressions in XML (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/language-features/xml/embedded-expressions-in-xml","fileRelativePath":"articles/visual-basic/programming-guide/language-features/xml/embedded-expressions-in-xml.html"},"themesRelativePathToOutputRoot":"_themes/"}