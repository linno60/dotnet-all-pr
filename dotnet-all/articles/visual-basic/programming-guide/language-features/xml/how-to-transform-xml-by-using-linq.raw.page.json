{"content":"<div><div class=\"content\">\n<p><a href=\"../../../language-reference/xml-literals/index\" data-linktype=\"relative-path\">XML Literals</a> make it easy to read XML from one source and transform it to a new XML format. You can take advantage of LINQ queries to retrieve the content to transform, or change content in an existing document to a new XML format.  </p>\n<p> The example in this topic transforms content from an XML source document to HTML to be viewed in a browser.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p>Your computer might show different names or locations for some of the Visual Studio user interface elements in the following instructions. The Visual Studio edition that you have and the settings that you use determine these elements. For more information, see <a href=\"https://docs.microsoft.com/visualstudio/ide/personalizing-the-visual-studio-ide\" data-linktype=\"external\">Personalizing the IDE</a>.</p>\n</div>\n<h3 id=\"to-transform-an-xml-document\">To transform an XML document</h3>\n<ol>\n<li><p>In Visual Studio, create a new Visual Basic project in the <strong>Console Application</strong> project template.  </p>\n</li>\n<li><p>Double-click the Module1.vb file created in the project to modify the Visual Basic code. Add the following code to the <code>Sub Main</code> of the <code>Module1</code> module. This code creates the source XML document as an <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xdocument\" data-linktype=\"relative-path\">XDocument</a> object.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Dim catalog =   \n  &lt;?xml version=&quot;1.0&quot;?&gt;  \n    &lt;Catalog&gt;  \n      &lt;Book id=&quot;bk101&quot;&gt;  \n        &lt;Author&gt;Garghentini, Davide&lt;/Author&gt;  \n        &lt;Title&gt;XML Developer&#39;s Guide&lt;/Title&gt;  \n        &lt;Price&gt;44.95&lt;/Price&gt;  \n        &lt;Description&gt;  \n          An in-depth look at creating applications  \n          with &lt;technology&gt;XML&lt;/technology&gt;. For   \n          &lt;audience&gt;beginners&lt;/audience&gt; or   \n          &lt;audience&gt;advanced&lt;/audience&gt; developers.  \n        &lt;/Description&gt;  \n      &lt;/Book&gt;  \n      &lt;Book id=&quot;bk331&quot;&gt;  \n        &lt;Author&gt;Spencer, Phil&lt;/Author&gt;  \n        &lt;Title&gt;Developing Applications with Visual Basic .NET&lt;/Title&gt;  \n        &lt;Price&gt;45.95&lt;/Price&gt;  \n        &lt;Description&gt;  \n          Get the expert insights, practical code samples,   \n          and best practices you need   \n          to advance your expertise with &lt;technology&gt;Visual   \n          Basic .NET&lt;/technology&gt;.   \n          Learn how to create faster, more reliable applications  \n          based on professional,   \n          pragmatic guidance by today&#39;s top &lt;audience&gt;developers&lt;/audience&gt;.  \n        &lt;/Description&gt;  \n      &lt;/Book&gt;  \n    &lt;/Catalog&gt;  \n</code></pre><p> <a href=\"how-to-load-xml-from-a-file-string-or-stream\" data-linktype=\"relative-path\">How to: Load XML from a File, String, or Stream</a>.  </p>\n</li>\n<li><p>After the code to create the source XML document, add the following code to retrieve all the &lt;Book&gt; elements from the object and transform them into an HTML document. The list of &lt;Book&gt; elements is created by using a LINQ query that returns a collection of <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xelement\" data-linktype=\"relative-path\">XElement</a> objects that contain the transformed HTML. You can use embedded expressions to put the values from the source document in the new XML format.  </p>\n<p> The resulting HTML document is written to a file by using the <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xelement#System_Xml_Linq_XElement_Save_\" data-linktype=\"relative-path\">Save</a> method.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Dim htmlOutput =   \n  &lt;html&gt;  \n    &lt;body&gt;  \n      &lt;%= From book In catalog.&lt;Catalog&gt;.&lt;Book&gt;   \n          Select &lt;div&gt;  \n                   &lt;h1&gt;&lt;%= book.&lt;Title&gt;.Value %&gt;&lt;/h1&gt;  \n                   &lt;h3&gt;&lt;%= &quot;By &quot; &amp; book.&lt;Author&gt;.Value %&gt;&lt;/h3&gt;  \n                    &lt;h3&gt;&lt;%= &quot;Price = &quot; &amp; book.&lt;Price&gt;.Value %&gt;&lt;/h3&gt;  \n                    &lt;h2&gt;Description&lt;/h2&gt;  \n                    &lt;%= TransformDescription(book.&lt;Description&gt;(0)) %&gt;  \n                    &lt;hr/&gt;  \n                  &lt;/div&gt; %&gt;  \n    &lt;/body&gt;  \n  &lt;/html&gt;  \n\nhtmlOutput.Save(&quot;BookDescription.html&quot;)  \n</code></pre></li>\n<li><p>After <code>Sub Main</code> of <code>Module1</code>, add a new method (<code>Sub</code>) to transform a &lt;Description&gt; node into the specified HTML format. This method is called by the code in the previous step and is used to preserve the format of the &lt;Description&gt; elements.  </p>\n<p> This method replaces sub-elements of the &lt;Description&gt; element with HTML. The <code>ReplaceWith</code> method is used to preserve the location of the sub-elements. The transformed content of the &lt;Description&gt; element is included in an HTML paragraph (&lt;p&gt;) element. The <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xcontainer#System_Xml_Linq_XContainer_Nodes_\" data-linktype=\"relative-path\">Nodes</a> property is used to retrieve the transformed content of the &lt;Description&gt; element. This ensures that sub-elements are included in the transformed content.  </p>\n<p> Add the following code after <code>Sub Main</code> of <code>Module1</code>.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Public Function TransformDescription(ByVal desc As XElement) As XElement  \n\n  &#39; Replace &lt;technology&gt; elements with &lt;b&gt;.  \n  Dim content = (From element In desc...&lt;technology&gt;).ToList()  \n\n  If content.Count &gt; 0 Then  \n    For i = 0 To content.Count - 1  \n      content(i).ReplaceWith(&lt;b&gt;&lt;%= content(i).Value %&gt;&lt;/b&gt;)  \n    Next  \n  End If  \n\n  &#39; Replace &lt;audience&gt; elements with &lt;i&gt;.  \n  content = (From element In desc...&lt;audience&gt;).ToList()  \n\n  If content.Count &gt; 0 Then  \n    For i = 0 To content.Count - 1  \n      content(i).ReplaceWith(&lt;i&gt;&lt;%= content(i).Value %&gt;&lt;/i&gt;)  \n    Next  \n  End If  \n\n  &#39; Return the updated contents of the &lt;Description&gt; element.  \n  Return &lt;p&gt;&lt;%= desc.Nodes %&gt;&lt;/p&gt;  \nEnd Function  \n</code></pre></li>\n<li><p>Save your changes.  </p>\n</li>\n<li><p>Press F5 to run the code. The resulting saved document will resemble the following:  </p>\n<pre class=\"loading\"><code>&lt;?xml version=&quot;1.0&quot;?&gt;  \n&lt;html&gt;  \n  &lt;body&gt;  \n    &lt;div&gt;  \n      &lt;h1&gt;XML Developer&#39;s Guide&lt;/h1&gt;  \n      &lt;h3&gt;By Garghentini, Davide&lt;/h3&gt;  \n      &lt;h3&gt;Price = 44.95&lt;/h3&gt;  \n      &lt;h2&gt;Description&lt;/h2&gt;  \n      &lt;p&gt;  \n        An in-depth look at creating applications  \n        with &lt;b&gt;XML&lt;/b&gt;. For   \n        &lt;i&gt;beginners&lt;/i&gt; or   \n        &lt;i&gt;advanced&lt;/i&gt; developers.  \n      &lt;/p&gt;  \n      &lt;hr /&gt;  \n    &lt;/div&gt;  \n    &lt;div&gt;  \n      &lt;h1&gt;Developing Applications with Visual Basic .NET&lt;/h1&gt;  \n      &lt;h3&gt;By Spencer, Phil&lt;/h3&gt;  \n      &lt;h3&gt;Price = 45.95&lt;/h3&gt;  \n      &lt;h2&gt;Description&lt;/h2&gt;  \n      &lt;p&gt;  \n        Get the expert insights, practical code   \n        samples, and best practices you need   \n        to advance your expertise with &lt;b&gt;Visual   \n        Basic .NET&lt;/b&gt;. Learn how to create faster,  \n        more reliable applications based on  \n        professional, pragmatic guidance by today&#39;s   \n        top &lt;i&gt;developers&lt;/i&gt;.  \n      &lt;/p&gt;  \n      &lt;hr /&gt;  \n    &lt;/div&gt;  \n  &lt;/body&gt;  \n&lt;/html&gt;  \n</code></pre></li>\n</ol>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"../../../language-reference/xml-literals/index\" data-linktype=\"relative-path\">XML Literals</a><br> <a href=\"manipulating-xml\" data-linktype=\"relative-path\">Manipulating XML in Visual Basic</a><br> <a href=\"index\" data-linktype=\"relative-path\">XML</a><br> <a href=\"how-to-load-xml-from-a-file-string-or-stream\" data-linktype=\"relative-path\">How to: Load XML from a File, String, or Stream</a><br> <a href=\"../linq/index\" data-linktype=\"relative-path\">LINQ</a><br> <a href=\"../linq/introduction-to-linq\" data-linktype=\"relative-path\">Introduction to LINQ in Visual Basic</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.tgt_pltfrm\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"815687f4-0bc2-4c0b-adc6-d78744aa356f\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"14\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/xml/how-to-transform-xml-by-using-linq.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/xml/how-to-transform-xml-by-using-linq.md\">\r\n<meta name=\"document_id\" content=\"d961033e-4fff-4f4a-15fe-e035d5f9b5fe\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","title":"How to: Transform XML by Using LINQ (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.tgt_pltfrm":"","ms.assetid":"815687f4-0bc2-4c0b-adc6-d78744aa356f","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":14,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["XML [Visual Basic], transforming","LINQ to XML [Visual Basic], transforming XML"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Petr Onderka","author_email":"gsvick@gmail.com","committer_name":"Maira Wenzel","comitter_email":"mairaw@microsoft.com","message":"Fixed included notes (#1275)","commit_sha":"eca9acb54f87a9c5d6ba0f632a222d43318e74c3","commit_date":"2016-11-19 17:12:50 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"},{"profile_url":"https://github.com/svick","display_name":"Petr Onderka","id":"287848"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/language-features/xml/how-to-transform-xml-by-using-linq.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/language-features/xml/how-to-transform-xml-by-using-linq.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/language-features/xml/how-to-transform-xml-by-using-linq.md","document_id":"d961033e-4fff-4f4a-15fe-e035d5f9b5fe","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/language-features/xml/how-to-transform-xml-by-using-linq","toc_asset_id":"articles/visual-basic/programming-guide/language-features/xml/toc.json","toc_rel":"toc.json","_op_ogTitle":"How to: Transform XML by Using LINQ (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":710,"_op_rawTitle":"<h1 id=\"how-to-transform-xml-by-using-linq-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/language-features/xml/how-to-transform-xml-by-using-linq.md\" sourcestartlinenumber=\"37\" sourceendlinenumber=\"37\">How to: Transform XML by Using LINQ (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/language-features/xml/how-to-transform-xml-by-using-linq","fileRelativePath":"articles/visual-basic/programming-guide/language-features/xml/how-to-transform-xml-by-using-linq.html"},"themesRelativePathToOutputRoot":"_themes/"}