{"content":"<div><div class=\"content\">\n<p>Sometimes you might have to write a query that selects elements based on their context. You might want to filter based on preceding or following sibling elements. You might want to filter based on child or ancestor elements.  </p>\n<p> You can do this by writing a query and using the results of the query in the <code>where</code> clause. If you have to first test against null, and then test the value, it is more convenient to do the query in a <code>let</code> clause, and then use the results in the <code>where</code> clause.  </p>\n<h2 id=\"example\">Example</h2>\n<p> The following example selects all <code>p</code> elements that are immediately followed by a <code>ul</code> element.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Dim doc As XElement = _  \n    &lt;Root&gt;  \n        &lt;p id=&#39;1&#39;/&gt;  \n        &lt;ul&gt;abc&lt;/ul&gt;  \n        &lt;Child&gt;  \n            &lt;p id=&#39;2&#39;/&gt;  \n            &lt;notul/&gt;  \n            &lt;p id=&#39;3&#39;/&gt;  \n            &lt;ul&gt;def&lt;/ul&gt;  \n            &lt;p id=&#39;4&#39;/&gt;  \n        &lt;/Child&gt;  \n        &lt;Child&gt;  \n            &lt;p id=&#39;5&#39;/&gt;  \n            &lt;notul/&gt;  \n            &lt;p id=&#39;6&#39;/&gt;  \n            &lt;ul&gt;abc&lt;/ul&gt;  \n            &lt;p id=&#39;7&#39;/&gt;  \n        &lt;/Child&gt;  \n    &lt;/Root&gt;  \n\nDim items As IEnumerable(Of XElement) = _  \n    From e In doc...&lt;p&gt; _  \n    Let z = e.ElementsAfterSelf().FirstOrDefault() _  \n    Where z IsNot Nothing AndAlso z.Name.LocalName = &quot;ul&quot; _  \n    Select e  \n\nFor Each e As XElement In items  \n    Console.WriteLine(&quot;id = {0}&quot;, e.@&lt;id&gt;)  \nNext  \n</code></pre><p> This code produces the following output:  </p>\n<pre class=\"loading\"><code>id = 1  \nid = 3  \nid = 6  \n</code></pre><h2 id=\"example-1\">Example</h2>\n<p> The following example shows the same query for XML that is in a namespace. For more information, see <a href=\"working-with-xml-namespaces\" data-linktype=\"relative-path\">Working with XML Namespaces (Visual Basic)</a>.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Imports &lt;xmlns=&#39;http://www.adatum.com&#39;&gt;  \n\nModule Module1  \n    Sub Main()  \n        Dim doc As XElement = _  \n            &lt;Root&gt;  \n                &lt;p id=&#39;1&#39;/&gt;  \n                &lt;ul&gt;abc&lt;/ul&gt;  \n                &lt;Child&gt;  \n                    &lt;p id=&#39;2&#39;/&gt;  \n                    &lt;notul/&gt;  \n                    &lt;p id=&#39;3&#39;/&gt;  \n                    &lt;ul&gt;def&lt;/ul&gt;  \n                    &lt;p id=&#39;4&#39;/&gt;  \n                &lt;/Child&gt;  \n                &lt;Child&gt;  \n                    &lt;p id=&#39;5&#39;/&gt;  \n                    &lt;notul/&gt;  \n                    &lt;p id=&#39;6&#39;/&gt;  \n                    &lt;ul&gt;abc&lt;/ul&gt;  \n                    &lt;p id=&#39;7&#39;/&gt;  \n                &lt;/Child&gt;  \n            &lt;/Root&gt;  \n\n        Dim items As IEnumerable(Of XElement) = _  \n            From e In doc...&lt;p&gt; _  \n            Let z = e.ElementsAfterSelf().FirstOrDefault() _  \n            Where z IsNot Nothing AndAlso z.Name = GetXmlNamespace().GetName(&quot;ul&quot;) _  \n            Select e  \n\n        For Each e As XElement In items  \n            Console.WriteLine(&quot;id = {0}&quot;, e.@&lt;id&gt;)  \n        Next  \n    End Sub  \nEnd Module  \n</code></pre><p> This code produces the following output:  </p>\n<pre class=\"loading\"><code>id = 1  \nid = 3  \nid = 6  \n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xelement#System_Xml_Linq_XElement_Parse_\" data-linktype=\"relative-path\">Parse</a><br> <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xcontainer#System_Xml_Linq_XContainer_Descendants_\" data-linktype=\"relative-path\">Descendants</a><br> <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xnode#System_Xml_Linq_XNode_ElementsAfterSelf_\" data-linktype=\"relative-path\">ElementsAfterSelf</a><br> <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/bb358452(v=vs.110).aspx\" data-linktype=\"external\">FirstOrDefault</a><br> <a href=\"basic-queries-linq-to-xml\" data-linktype=\"relative-path\">Basic Queries (LINQ to XML) (Visual Basic)</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-all/api/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.tgt_pltfrm\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"0b085290-ddc1-4126-aaa0-e4c95a3d9a09\">\r\n<meta name=\"caps.latest.revision\" content=\"3\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/how-to-write-a-query-that-finds-elements-based-on-context.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/linq/how-to-write-a-query-that-finds-elements-based-on-context.md\">\r\n<meta name=\"document_id\" content=\"135d3f18-8bdf-acd5-da55-d212cf124d6f\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"How to: Write a Query that Finds Elements Based on Context (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.tgt_pltfrm":"","ms.assetid":"0b085290-ddc1-4126-aaa0-e4c95a3d9a09","caps.latest.revision":3,"ms.topic":"article","dev_langs":["vb"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/how-to-write-a-query-that-finds-elements-based-on-context.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/linq/how-to-write-a-query-that-finds-elements-based-on-context.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/concepts/linq/how-to-write-a-query-that-finds-elements-based-on-context.md","document_id":"135d3f18-8bdf-acd5-da55-d212cf124d6f","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/concepts/linq/how-to-write-a-query-that-finds-elements-based-on-context","toc_asset_id":"articles/visual-basic/programming-guide/concepts/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"How to: Write a Query that Finds Elements Based on Context (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":323,"_op_rawTitle":"<h1 id=\"how-to-write-a-query-that-finds-elements-based-on-context-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/concepts/linq/how-to-write-a-query-that-finds-elements-based-on-context.md\" sourcestartlinenumber=\"20\" sourceendlinenumber=\"20\">How to: Write a Query that Finds Elements Based on Context (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/concepts/linq/how-to-write-a-query-that-finds-elements-based-on-context","fileRelativePath":"articles/visual-basic/programming-guide/concepts/linq/how-to-write-a-query-that-finds-elements-based-on-context.html"},"themesRelativePathToOutputRoot":"_themes/"}