{"content":"<div><div class=\"content\">\n<p>This walkthrough demonstrates how you can use Visual Basic language features to write Language-Integrated Query (LINQ) query expressions. The walkthrough demonstrates how to create queries on a list of Student objects, how to run the queries, and how to modify them. The queries incorporate several features including object initializers, local type inference, and anonymous types.  </p>\n<p> After completing this walkthrough, you will be ready to move on to the samples and documentation for the specific LINQ provider you are interested in. LINQ providers include LINQ to SQL, LINQ to DataSet, and LINQ to XML.  </p>\n<h2 id=\"create-a-project\">Create a Project</h2>\n<h4 id=\"to-create-a-console-application-project\">To create a console application project</h4>\n<ol>\n<li><p>Start Visual Studio.  </p>\n</li>\n<li><p>On the <strong>File</strong> menu, point to <strong>New</strong>, and then click <strong>Project</strong>.  </p>\n</li>\n<li><p>In the <strong>Installed Templates</strong> list, click <strong>Visual Basic</strong>.  </p>\n</li>\n<li><p>In the list of project types, click <strong>Console Application</strong>. In the <strong>Name</strong> box, type a name for the project, and then click <strong>OK</strong>.  </p>\n<p> A project is created. By default, it contains a reference to System.Core.dll. Also, the <strong>Imported namespaces</strong> list on the <a href=\"https://docs.microsoft.com/visualstudio/ide/reference/references-page-project-designer-visual-basic\" data-linktype=\"external\">References Page, Project Designer (Visual Basic)</a> includes the <a class=\"xref\" href=\"../../../../../api/system.linq\" data-linktype=\"relative-path\">System.Linq</a> namespace.  </p>\n</li>\n<li><p>On the <a href=\"https://docs.microsoft.com/visualstudio/ide/reference/compile-page-project-designer-visual-basic\" data-linktype=\"external\">Compile Page, Project Designer (Visual Basic)</a>, ensure that <strong>Option infer</strong> is set to <strong>On</strong>.  </p>\n</li>\n</ol>\n<h2 id=\"add-an-in-memory-data-source\">Add an In-Memory Data Source</h2>\n<p> The data source for the queries in this walkthrough is a list of <code>Student</code> objects. Each <code>Student</code> object contains a first name, a last name, a class year, and an academic rank in the student body.  </p>\n<h4 id=\"to-add-the-data-source\">To add the data source</h4>\n<ul>\n<li><p>Define a <code>Student</code> class, and create a list of instances of the class.  </p>\n<div class=\"IMPORTANT\"><h5>Important</h5><p> The code needed to define the <code>Student</code> class and create the list used in the walkthrough examples is provided in <a href=\"how-to-create-a-list-of-items\" data-linktype=\"relative-path\">How to: Create a List of Items</a>. You can copy it from there and paste it into your project. The new code replaces the code that appeared when you created the project.  </p>\n</div>\n</li>\n</ul>\n<h4 id=\"to-add-a-new-student-to-the-students-list\">To add a new student to the students list</h4>\n<ul>\n<li>Follow the pattern in the <code>getStudents</code> method to add another instance of the <code>Student</code> class to the list. Adding the student will introduce you to object initializers. For more information, see <a href=\"../../language-features/objects-and-classes/object-initializers-named-and-anonymous-types\" data-linktype=\"relative-path\">Object Initializers: Named and Anonymous Types</a>.  </li>\n</ul>\n<h2 id=\"create-a-query\">Create a Query</h2>\n<p> When executed, the query added in this section produces a list of the students whose academic rank puts them in the top ten. Because the query selects the complete <code>Student</code> object each time, the type of the query result is <code>IEnumerable(Of Student)</code>. However, the type of the query typically is not specified in query definitions. Instead, the compiler uses local type inference to determine the type. For more information, see <a href=\"../../language-features/variables/local-type-inference\" data-linktype=\"relative-path\">Local Type Inference</a>. The query&#39;s range variable, <code>currentStudent</code>, serves as a reference to each <code>Student</code> instance in the source, <code>students</code>, providing access to the properties of each object in <code>students</code>.  </p>\n<h4 id=\"to-create-a-simple-query\">To create a simple query</h4>\n<ol>\n<li><p>Find the place in the <code>Main</code> method of the project that is marked as follows:  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQWalkthrough#1\">&#39; ****Paste query and query execution code from the walkthrough,\n&#39; ****or any code of your own, here in Main.\n</code></pre><p> Copy the following code and paste it in.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQWalkthrough#2\">Dim studentQuery = From currentStudent In students\n                   Where currentStudent.Rank &lt;= 10\n                   Select currentStudent\n</code></pre></li>\n<li><p>Rest the mouse pointer over <code>studentQuery</code> in your code to verify that the compiler-assigned type is <code>IEnumerable(Of Student)</code>.  </p>\n</li>\n</ol>\n<h2 id=\"run-the-query\">Run the Query</h2>\n<p> The variable <code>studentQuery</code> contains the definition of the query, not the results of running the query. A typical mechanism for running a query is a <code>For Each</code> loop. Each element in the returned sequence is accessed through the loop iteration variable. For more information about query execution, see <a href=\"writing-your-first-linq-query\" data-linktype=\"relative-path\">Writing Your First LINQ Query</a>.  </p>\n<h4 id=\"to-run-the-query\">To run the query</h4>\n<ol>\n<li><p>Add the following <code>For Each</code> loop below the query in your project.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQWalkthrough#3\">For Each studentRecord In studentQuery\n    Console.WriteLine(studentRecord.Last &amp; &quot;, &quot; &amp; studentRecord.First)\nNext\n</code></pre></li>\n<li><p>Rest the mouse pointer over the loop control variable <code>studentRecord</code> to see its data type. The type of <code>studentRecord</code> is inferred to be <code>Student</code>, because <code>studentQuery</code> returns a collection of <code>Student</code> instances.  </p>\n</li>\n<li><p>Build and run the application by pressing CTRL+F5. Note the results in the console window.  </p>\n</li>\n</ol>\n<h2 id=\"modify-the-query\">Modify the Query</h2>\n<p> It is easier to scan query results if they are in a specified order. You can sort the returned sequence based on any available field.  </p>\n<h4 id=\"to-order-the-results\">To order the results</h4>\n<ol>\n<li><p>Add the following <code>Order By</code> clause between the <code>Where</code> statement and the <code>Select</code> statement of the query. The <code>Order By</code> clause will order the results alphabetically from A to Z, according to the last name of each student.  </p>\n<pre class=\"loading\"><code>Order By currentStudent.Last Ascending   \n</code></pre></li>\n<li><p>To order by last name and then first name, add both fields to the query:  </p>\n<pre class=\"loading\"><code>Order By currentStudent.Last Ascending, currentStudent.First Ascending   \n</code></pre><p> You can also specify <code>Descending</code> to order from Z to A.  </p>\n</li>\n<li><p>Build and run the application by pressing CTRL+F5. Note the results in the console window.  </p>\n</li>\n</ol>\n<h4 id=\"to-introduce-a-local-identifier\">To introduce a local identifier</h4>\n<ol>\n<li><p>Add the code in this section to introduce a local identifier in the query expression. The local identifier will hold an intermediate result. In the following example, <code>name</code> is an identifier that holds a concatenation of the student&#39;s first and last names. A local identifier can be used for convenience, or it can enhance performance by storing the results of an expression that would otherwise be calculated multiple times.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQWalkthrough#4\">Dim studentQuery2 =\n        From currentStudent In students\n        Let name = currentStudent.Last &amp; &quot;, &quot; &amp; currentStudent.First\n        Where currentStudent.Year = &quot;Senior&quot; And currentStudent.Rank &lt;= 10\n        Order By name Ascending\n        Select currentStudent\n\n&#39; If you see too many results, comment out the previous\n&#39; For Each loop.\nFor Each studentRecord In studentQuery2\n    Console.WriteLine(studentRecord.Last &amp; &quot;, &quot; &amp; studentRecord.First)\nNext\n</code></pre></li>\n<li><p>Build and run the application by pressing CTRL+F5. Note the results in the console window.  </p>\n</li>\n</ol>\n<h4 id=\"to-project-one-field-in-the-select-clause\">To project one field in the Select clause</h4>\n<ol>\n<li><p>Add the query and <code>For Each</code> loop from this section to create a query that produces a sequence whose elements differ from the elements in the source. In the following example, the source is a collection of <code>Student</code> objects, but only one member of each object is returned: the first name of students whose last name is Garcia. Because <code>currentStudent.First</code> is a string, the data type of the sequence returned by <code>studentQuery3</code> is <code>IEnumerable(Of String)</code>, a sequence of strings. As in earlier examples, the assignment of a data type for <code>studentQuery3</code> is left for the compiler to determine by using local type inference.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQWalkthrough#5\">Dim studentQuery3 = From currentStudent In students\n                    Where currentStudent.Last = &quot;Garcia&quot;\n                    Select currentStudent.First\n\n&#39; If you see too many results, comment out the previous\n&#39; For Each loops.\nFor Each studentRecord In studentQuery3\n    Console.WriteLine(studentRecord)\nNext\n</code></pre></li>\n<li><p>Rest the mouse pointer over <code>studentQuery3</code> in your code to verify that the assigned type is <code>IEnumerable(Of String)</code>.  </p>\n</li>\n<li><p>Build and run the application by pressing CTRL+F5. Note the results in the console window.  </p>\n</li>\n</ol>\n<h4 id=\"to-create-an-anonymous-type-in-the-select-clause\">To create an anonymous type in the Select clause</h4>\n<ol>\n<li><p>Add the code from this section to see how anonymous types are used in queries. You use them in queries when you want to return several fields from the data source rather than complete records (<code>currentStudent</code> records in previous examples) or single fields (<code>First</code> in the preceding section). Instead of defining a new named type that contains the fields you want to include in the result, you specify the fields in the <code>Select</code> clause and the compiler creates an anonymous type with those fields as its properties. For more information, see <a href=\"../../language-features/objects-and-classes/anonymous-types\" data-linktype=\"relative-path\">Anonymous Types</a>.  </p>\n<p> The following example creates a query that returns the name and rank of seniors whose academic rank is between 1 and 10, in order of academic rank. In this example, the type of <code>studentQuery4</code> must be inferred because the <code>Select</code> clause returns an instance of an anonymous type, and an anonymous type has no usable name.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQWalkthrough#6\">Dim studentQuery4 =\n        From currentStudent In students\n        Where currentStudent.Year = &quot;Senior&quot; And currentStudent.Rank &lt;= 10\n        Order By currentStudent.Rank Ascending\n        Select currentStudent.First, currentStudent.Last, currentStudent.Rank\n\n&#39; If you see too many results, comment out the previous\n&#39; For Each loops.\nFor Each studentRecord In studentQuery4\n    Console.WriteLine(studentRecord.Last &amp; &quot;, &quot; &amp; studentRecord.First &amp;\n                      &quot;:  &quot; &amp; studentRecord.Rank)\nNext\n</code></pre></li>\n<li><p>Build and run the application by pressing CTRL+F5. Note the results in the console window.  </p>\n</li>\n</ol>\n<h2 id=\"additional-examples\">Additional Examples</h2>\n<p> Now that you understand the basics, the following is a list of additional examples to illustrate the flexibility and power of LINQ queries. Each example is preceded by a brief description of what it does. Rest the mouse pointer over the query result variable for each query to see the inferred type. Use a <code>For Each</code> loop to produce the results.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQWalkthrough#7\">&#39; Find all students who are seniors.\nDim q1 = From currentStudent In students\n         Where currentStudent.Year = &quot;Senior&quot;\n         Select currentStudent\n\n&#39; Write a For Each loop to execute the query.\nFor Each q In q1\n    Console.WriteLine(q.First &amp; &quot; &quot; &amp; q.Last)\nNext\n\n&#39; Find all students with a first name beginning with &quot;C&quot;.\nDim q2 = From currentStudent In students\n         Where currentStudent.First.StartsWith(&quot;C&quot;)\n         Select currentStudent\n\n&#39; Find all top ranked seniors (rank &lt; 40).\nDim q3 = From currentStudent In students\n         Where currentStudent.Rank &lt; 40 And currentStudent.Year = &quot;Senior&quot;\n         Select currentStudent\n\n&#39; Find all seniors with a lower rank than a student who \n&#39; is not a senior.\nDim q4 = From student1 In students, student2 In students\n         Where student1.Year = &quot;Senior&quot; And student2.Year &lt;&gt; &quot;Senior&quot; And\n               student1.Rank &gt; student2.Rank\n         Select student1\n         Distinct\n\n&#39; Retrieve the full names of all students, sorted by last name.\nDim q5 = From currentStudent In students\n         Order By currentStudent.Last\n         Select Name = currentStudent.First &amp; &quot; &quot; &amp; currentStudent.Last\n\n&#39; Determine how many students are ranked in the top 20.\nDim q6 = Aggregate currentStudent In students\n         Where currentStudent.Rank &lt;= 20\n         Into Count()\n\n&#39; Count the number of different last names in the group of students.\nDim q7 = Aggregate currentStudent In students\n         Select currentStudent.Last\n         Distinct\n         Into Count()\n\n&#39; Create a list box to show the last names of students.\nDim lb As New System.Windows.Forms.ListBox\nDim q8 = From currentStudent In students\n         Order By currentStudent.Last\n         Select currentStudent.Last Distinct\n\nFor Each nextName As String In q8\n    lb.Items.Add(nextName)\nNext\n\n&#39; Find every process that has a lowercase &quot;h&quot;, &quot;l&quot;, or &quot;d&quot; in its name.\nDim letters() As String = {&quot;h&quot;, &quot;l&quot;, &quot;d&quot;}\nDim q9 = From proc In System.Diagnostics.Process.GetProcesses,\n         letter In letters\n         Where proc.ProcessName.Contains(letter)\n         Select proc\n\nFor Each proc In q9\n    Console.WriteLine(proc.ProcessName &amp; &quot;, &quot; &amp; proc.WorkingSet64)\nNext\n</code></pre><h2 id=\"additional-information\">Additional Information</h2>\n<p> After you are familiar with the basic concepts of working with queries, you are ready to read the documentation and samples for the specific type of LINQ provider that you are interested in:  </p>\n<p> <a href=\"http://msdn.microsoft.com/library/73cafe73-37cf-46e7-bfa7-97c7eea7ced9\" data-linktype=\"external\">LINQ to Objects</a>  </p>\n<p> <a href=\"https://msdn.microsoft.com/library/bb386976\" data-linktype=\"external\">LINQ to SQL</a>  </p>\n<p> <a href=\"http://msdn.microsoft.com/library/f0fe21e9-ee43-4a55-b91a-0800e5782c13\" data-linktype=\"external\">LINQ to XML</a>  </p>\n<p> <a href=\"http://msdn.microsoft.com/library/743e3755-3ecb-45a2-8d9b-9ed41f0dcf17\" data-linktype=\"external\">LINQ to DataSet</a>  </p>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"index\" data-linktype=\"relative-path\">Language-Integrated Query (LINQ) (Visual Basic)</a><br> <a href=\"getting-started-with-linq\" data-linktype=\"relative-path\">Getting Started with LINQ in Visual Basic</a><br> <a href=\"../../language-features/variables/local-type-inference\" data-linktype=\"relative-path\">Local Type Inference</a><br> <a href=\"../../language-features/objects-and-classes/object-initializers-named-and-anonymous-types\" data-linktype=\"relative-path\">Object Initializers: Named and Anonymous Types</a><br> <a href=\"../../language-features/objects-and-classes/anonymous-types\" data-linktype=\"relative-path\">Anonymous Types</a><br> <a href=\"../../language-features/linq/introduction-to-linq\" data-linktype=\"relative-path\">Introduction to LINQ in Visual Basic</a><br> <a href=\"../../language-features/linq/index\" data-linktype=\"relative-path\">LINQ</a><br> <a href=\"../../../language-reference/queries/queries\" data-linktype=\"relative-path\">Queries</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.tgt_pltfrm\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"f0045808-b9fe-4d31-88d1-473d9957211e\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"70\">\r\n<meta name=\"ms.topic\" content=\"get-started-article\">\r\n<meta name=\"translation.priority.mt\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.mt\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.mt\" content=\"pt-br\">\r\n<meta name=\"translation.priority.mt\" content=\"tr-tr\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-15 06:14 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/0a5d76c154aeb9b749c9c3fc5ad0962e93754a62/docs/visual-basic/programming-guide/concepts/linq/walkthrough-writing-queries.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/linq/walkthrough-writing-queries.md\">\r\n<meta name=\"document_id\" content=\"cba18187-1017-1e40-e322-0248cf840d80\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","title":"Writing Queries in Visual Basic | Microsoft Docs","ms.suite":"","ms.custom":"","ms.tgt_pltfrm":"","ms.assetid":"f0045808-b9fe-4d31-88d1-473d9957211e","translation.priority.ht":["de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","ru-ru","zh-cn","zh-tw"],"caps.latest.revision":70,"ms.topic":"get-started-article","dev_langs":["vb"],"helpviewer_keywords":["queries [LINQ in Visual Basic], writing","LINQ [Visual Basic], walkthroughs","LINQ [Visual Basic], writing queries","writing LINQ queries [Visual Basic]"],"translation.priority.mt":["cs-cz","pl-pl","pt-br","tr-tr"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Reorganizing the VB TOC (#1348)","commit_sha":"0a5d76c154aeb9b749c9c3fc5ad0962e93754a62","commit_date":"2017-02-14 10:22:48 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Absolute urls and other fixes (#1281)","commit_sha":"f7dffe4885b331cec8d37f3cc5c9163f69c3b4c9","commit_date":"2016-11-22 12:57:26 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2017-03-15 06:14 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"3/15/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/0a5d76c154aeb9b749c9c3fc5ad0962e93754a62/docs/visual-basic/programming-guide/concepts/linq/walkthrough-writing-queries.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/linq/walkthrough-writing-queries.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/concepts/linq/walkthrough-writing-queries.md","document_id":"cba18187-1017-1e40-e322-0248cf840d80","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/concepts/linq/walkthrough-writing-queries","toc_asset_id":"articles/visual-basic/programming-guide/concepts/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"Writing Queries in Visual Basic","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":1779,"_op_rawTitle":"<h1 id=\"walkthrough-writing-queries-in-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/concepts/linq/walkthrough-writing-queries.md\" sourcestartlinenumber=\"40\" sourceendlinenumber=\"40\">Walkthrough: Writing Queries in Visual Basic</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/concepts/linq/walkthrough-writing-queries","fileRelativePath":"articles/visual-basic/programming-guide/concepts/linq/walkthrough-writing-queries.html"},"themesRelativePathToOutputRoot":"_themes/"}