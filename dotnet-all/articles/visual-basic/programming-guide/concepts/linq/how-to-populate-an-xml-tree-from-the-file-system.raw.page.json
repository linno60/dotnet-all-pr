{"content":"<div><div class=\"content\">\n<p>A common and useful application of XML trees is as a hierarchical name/value data store. You can populate an XML tree with hierarchical data, and then query it, transform it, and if necessary, serialize it. In this usage scenario, many of the XML specific semantics, such as namespaces and white space behavior, are not important. Instead, you are using the XML tree as a small, in memory, single user hierarchical database.  </p>\n<h2 id=\"example\">Example</h2>\n<p> The following example populates an XML tree from the local file system using recursion. It then queries the tree, calculating the total of the sizes of all files in the tree.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Module Module1  \n    Function CreateFileSystemXmlTree(ByVal source As String) As XElement  \n        Dim di As DirectoryInfo = New DirectoryInfo(source)  \n        Return &lt;Dir Name=&lt;%= di.Name %&gt;&gt;  \n                   &lt;%= From d In Directory.GetDirectories(source) _  \n                       Select CreateFileSystemXmlTree(d) %&gt;  \n                   &lt;%= From fi In di.GetFiles() _  \n                       Select &lt;File&gt;  \n                                  &lt;Name&gt;&lt;%= fi.Name %&gt;&lt;/Name&gt;  \n                                  &lt;Length&gt;&lt;%= fi.Length %&gt;&lt;/Length&gt;  \n                              &lt;/File&gt; %&gt;  \n               &lt;/Dir&gt;  \n    End Function  \n\n    Sub Main()  \n        Dim fileSystemTree As XElement = CreateFileSystemXmlTree(&quot;C:/Tmp&quot;)  \n        Console.WriteLine(fileSystemTree)  \n        Console.WriteLine(&quot;------&quot;)  \n        Dim totalFileSize As Long = _  \n            ( _  \n                From f In fileSystemTree...&lt;File&gt; _  \n                Select CLng(f.&lt;Length&gt;(0)) _  \n            ).Sum()  \n        Console.WriteLine(&quot;Total File Size:{0}&quot;, totalFileSize)  \n    End Sub  \nEnd Module  \n</code></pre><p> This example produces output similar to the following:  </p>\n<pre class=\"loading\"><code class=\"lang-xml\">&lt;Dir Name=&quot;Tmp&quot;&gt;  \n  &lt;Dir Name=&quot;ConsoleApplication1&quot;&gt;  \n    &lt;Dir Name=&quot;bin&quot;&gt;  \n      &lt;Dir Name=&quot;Debug&quot;&gt;  \n        &lt;File&gt;  \n          &lt;Name&gt;ConsoleApplication1.exe&lt;/Name&gt;  \n          &lt;Length&gt;4608&lt;/Length&gt;  \n        &lt;/File&gt;  \n        &lt;File&gt;  \n          &lt;Name&gt;ConsoleApplication1.pdb&lt;/Name&gt;  \n          &lt;Length&gt;11776&lt;/Length&gt;  \n        &lt;/File&gt;  \n        &lt;File&gt;  \n          &lt;Name&gt;ConsoleApplication1.vshost.exe&lt;/Name&gt;  \n          &lt;Length&gt;9568&lt;/Length&gt;  \n        &lt;/File&gt;  \n        &lt;File&gt;  \n          &lt;Name&gt;ConsoleApplication1.vshost.exe.manifest&lt;/Name&gt;  \n          &lt;Length&gt;473&lt;/Length&gt;  \n        &lt;/File&gt;  \n      &lt;/Dir&gt;  \n    &lt;/Dir&gt;  \n    &lt;Dir Name=&quot;obj&quot;&gt;  \n      &lt;Dir Name=&quot;Debug&quot;&gt;  \n        &lt;Dir Name=&quot;TempPE&quot; /&gt;  \n        &lt;File&gt;  \n          &lt;Name&gt;ConsoleApplication1.csproj.FileListAbsolute.txt&lt;/Name&gt;  \n          &lt;Length&gt;322&lt;/Length&gt;  \n        &lt;/File&gt;  \n        &lt;File&gt;  \n          &lt;Name&gt;ConsoleApplication1.exe&lt;/Name&gt;  \n          &lt;Length&gt;4608&lt;/Length&gt;  \n        &lt;/File&gt;  \n        &lt;File&gt;  \n          &lt;Name&gt;ConsoleApplication1.pdb&lt;/Name&gt;  \n          &lt;Length&gt;11776&lt;/Length&gt;  \n        &lt;/File&gt;  \n      &lt;/Dir&gt;  \n    &lt;/Dir&gt;  \n    &lt;Dir Name=&quot;Properties&quot;&gt;  \n      &lt;File&gt;  \n        &lt;Name&gt;AssemblyInfo.cs&lt;/Name&gt;  \n        &lt;Length&gt;1454&lt;/Length&gt;  \n      &lt;/File&gt;  \n    &lt;/Dir&gt;  \n    &lt;File&gt;  \n      &lt;Name&gt;ConsoleApplication1.csproj&lt;/Name&gt;  \n      &lt;Length&gt;2546&lt;/Length&gt;  \n    &lt;/File&gt;  \n    &lt;File&gt;  \n      &lt;Name&gt;ConsoleApplication1.sln&lt;/Name&gt;  \n      &lt;Length&gt;937&lt;/Length&gt;  \n    &lt;/File&gt;  \n    &lt;File&gt;  \n      &lt;Name&gt;ConsoleApplication1.suo&lt;/Name&gt;  \n      &lt;Length&gt;10752&lt;/Length&gt;  \n    &lt;/File&gt;  \n    &lt;File&gt;  \n      &lt;Name&gt;Program.cs&lt;/Name&gt;  \n      &lt;Length&gt;269&lt;/Length&gt;  \n    &lt;/File&gt;  \n  &lt;/Dir&gt;  \n&lt;/Dir&gt;  \n------  \nTotal File Size:59089  \n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"advanced-query-techniques-linq-to-xml\" data-linktype=\"relative-path\">Advanced Query Techniques (LINQ to XML) (Visual Basic)</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc1.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.tgt_pltfrm\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"34eec79e-7945-4ba8-9f74-d05bb8ec67f6\">\r\n<meta name=\"caps.latest.revision\" content=\"3\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/how-to-populate-an-xml-tree-from-the-file-system.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/linq/how-to-populate-an-xml-tree-from-the-file-system.md\">\r\n<meta name=\"document_id\" content=\"2983b443-f812-3ba0-7845-40da92905b4a\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc1.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","title":"How to: Populate an XML Tree from the File System (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.tgt_pltfrm":"","ms.assetid":"34eec79e-7945-4ba8-9f74-d05bb8ec67f6","caps.latest.revision":3,"ms.topic":"article","dev_langs":["vb"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/how-to-populate-an-xml-tree-from-the-file-system.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/linq/how-to-populate-an-xml-tree-from-the-file-system.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/concepts/linq/how-to-populate-an-xml-tree-from-the-file-system.md","document_id":"2983b443-f812-3ba0-7845-40da92905b4a","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/concepts/linq/how-to-populate-an-xml-tree-from-the-file-system","toc_asset_id":"articles/visual-basic/programming-guide/concepts/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"How to: Populate an XML Tree from the File System (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":280,"_op_rawTitle":"<h1 id=\"how-to-populate-an-xml-tree-from-the-file-system-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/concepts/linq/how-to-populate-an-xml-tree-from-the-file-system.md\" sourcestartlinenumber=\"20\" sourceendlinenumber=\"20\">How to: Populate an XML Tree from the File System (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/concepts/linq/how-to-populate-an-xml-tree-from-the-file-system","fileRelativePath":"articles/visual-basic/programming-guide/concepts/linq/how-to-populate-an-xml-tree-from-the-file-system.html"},"themesRelativePathToOutputRoot":"_themes/"}