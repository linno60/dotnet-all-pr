{"content":"<div><div class=\"content\">\n<p>This topic shows an example that serializes and deserializes using <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer(v=vs.110).aspx\" data-linktype=\"external\">DataContractSerializer</a>.  </p>\n<h2 id=\"example\">Example</h2>\n<p> The following example creates a number of objects that contain <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.xml.linq.xelement(v=vs.110).aspx\" data-linktype=\"external\">XElement</a> objects. It then serializes them to text files, and then deserializes them from the text files.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Imports System  \nImports System.Xml  \nImports System.Xml.Linq  \nImports System.IO  \nImports System.Runtime.Serialization  \n\nPublic Class XLinqTest  \n    Shared Sub Main()  \n        Test(Of XElement)(CreateXElement())  \n        Test(Of XElementContainer)(New XElementContainer())  \n        Test(Of XElementNullContainer)(New XElementNullContainer())  \n    End Sub  \n\n    Public Shared Sub Test(Of T)(ByRef obj)  \n        Dim s As DataContractSerializer = New DataContractSerializer(GetType(T))  \n        Using fs As FileStream = File.Open(&quot;test&quot; &amp; GetType(T).Name &amp; &quot;.xml&quot;, FileMode.Create)  \n            Console.WriteLine(&quot;Testing for type: {0}&quot;, GetType(T))  \n            s.WriteObject(fs, obj)  \n        End Using  \n\n        Using fs As FileStream = File.Open(&quot;test&quot; &amp; GetType(T).Name &amp; &quot;.xml&quot;, FileMode.Open)  \n            Dim s2 As Object = s.ReadObject(fs)  \n            If s2 Is Nothing Then  \n                Console.WriteLine(&quot;  Deserialized object is null (Nothing in VB)&quot;)  \n            Else  \n                Console.WriteLine(&quot;  Deserialized type: {0}&quot;, s2.GetType())  \n            End If  \n        End Using  \n    End Sub  \n\n    Public Shared Function CreateXElement() As XElement  \n        Return New XElement(XName.Get(&quot;NameInNamespace&quot;, &quot;http://www.adventure-works.org&quot;))  \n    End Function  \nEnd Class  \n\n&lt;DataContract()&gt; _  \nPublic Class XElementContainer  \n    &lt;DataMember()&gt; _  \n    Public member As XElement  \n\n    Public Sub XElementContainer()  \n        member = XLinqTest.CreateXElement()  \n    End Sub  \nEnd Class  \n\n&lt;DataContract()&gt; _  \nPublic Class XElementNullContainer  \n    &lt;DataMember()&gt; _  \n    Public member As XElement  \n\n    Public Sub XElementNullContainer()  \n        member = Nothing  \n    End Sub  \nEnd Class  \n</code></pre><p> This example produces the following output:  </p>\n<pre class=\"loading\"><code>Testing for type: System.Xml.Linq.XElement  \n  Deserialized type: System.Xml.Linq.XElement  \nTesting for type: XElementContainer  \n  Deserialized type: XElementContainer  \nTesting for type: XElementNullContainer  \n  Deserialized type: XElementNullContainer  \n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"serializing-object-graphs-that-contain-xelement-objects\" data-linktype=\"relative-path\">Serializing Object Graphs that Contain XElement Objects (Visual Basic)</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.tgt_pltfrm\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"ecaea518-8a0f-4249-b4e5-9b3fb0cdd8ad\">\r\n<meta name=\"caps.latest.revision\" content=\"3\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"translation.priority.mt\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.mt\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.mt\" content=\"pt-br\">\r\n<meta name=\"translation.priority.mt\" content=\"tr-tr\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-21 01:42 AM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/how-to-serialize-using-datacontractserializer.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/programming-guide/concepts/linq/how-to-serialize-using-datacontractserializer.md\">\r\n<meta name=\"document_id\" content=\"1b28f8fb-cd40-607f-33d9-1cfe348985fc\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"How to: Serialize Using DataContractSerializer (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.tgt_pltfrm":"","ms.assetid":"ecaea518-8a0f-4249-b4e5-9b3fb0cdd8ad","caps.latest.revision":3,"ms.topic":"article","dev_langs":["vb"],"translation.priority.mt":["cs-cz","pl-pl","pt-br","tr-tr"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2017-03-21 01:42 AM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"3/21/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/how-to-serialize-using-datacontractserializer.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/programming-guide/concepts/linq/how-to-serialize-using-datacontractserializer.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/concepts/linq/how-to-serialize-using-datacontractserializer.md","document_id":"1b28f8fb-cd40-607f-33d9-1cfe348985fc","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/concepts/linq/how-to-serialize-using-datacontractserializer","toc_asset_id":"articles/visual-basic/programming-guide/concepts/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"How to: Serialize Using DataContractSerializer (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":232,"_op_rawTitle":"<h1 id=\"how-to-serialize-using-datacontractserializer-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/concepts/linq/how-to-serialize-using-datacontractserializer.md\" sourcestartlinenumber=\"25\" sourceendlinenumber=\"25\">How to: Serialize Using DataContractSerializer (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/concepts/linq/how-to-serialize-using-datacontractserializer","fileRelativePath":"articles/visual-basic/programming-guide/concepts/linq/how-to-serialize-using-datacontractserializer.html"},"themesRelativePathToOutputRoot":"_themes/"}