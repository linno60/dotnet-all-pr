{"content":"<div><div class=\"content\">\n<p>The name Language-Integrated Query (LINQ) refers to technology in Visual Basic that supports query syntax and other language constructs directly in the language. With LINQ, you do not have to learn a new language to query against an external data source. You can query against data in relational databases, XML stores, or objects by using Visual Basic. This integration of query capabilities into the language enables compile-time checking for syntax errors and type safety. This integration also ensures that you already know most of what you have to know to write rich, varied queries in Visual Basic.  </p>\n<p> The following sections describe the language constructs that support LINQ in enough detail to enable you to get started in reading the introductory documentation, code examples, and sample applications. You can also click the links to find more detailed explanations of how the language features come together to enable language-integrated query. A good place to start is <a href=\"walkthrough-writing-queries\" data-linktype=\"relative-path\">Walkthrough: Writing Queries in Visual Basic</a>.  </p>\n<h2 id=\"query-expressions\">Query Expressions</h2>\n<p> Query expressions in Visual Basic can be expressed in a declarative syntax similar to that of SQL or XQuery. At compile time, query syntax is converted into method calls to a LINQ provider&#39;s implementation of the standard query operator extension methods. Applications control which standard query operators are in scope by specifying the appropriate namespace with an <code>Imports</code> statement. Syntax for a Visual Basic query expression looks like this:  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQVbFeatures#1\">        Dim londonCusts = From cust In customers\n                          Where cust.City = &quot;London&quot;\n                          Order By cust.Name Ascending\n                          Select cust.Name, cust.Phone\n</code></pre><p> For more information, see <a href=\"../../language-features/linq/introduction-to-linq\" data-linktype=\"relative-path\">Introduction to LINQ in Visual Basic</a>.  </p>\n<h2 id=\"implicitly-typed-variables\">Implicitly Typed Variables</h2>\n<p> Instead of explicitly specifying a type when you declare and initialize a variable, you can enable the compiler to infer and assign the type. This is referred to as <em>local type inference</em>.  </p>\n<p> Variables whose types are inferred are strongly typed, just like variables whose type you specify explicitly. Local type inference works only when you are defining a local variable inside a method body. For more information, see <a href=\"../../../language-reference/statements/option-infer-statement\" data-linktype=\"relative-path\">Option Infer Statement</a> and <a href=\"../../language-features/variables/local-type-inference\" data-linktype=\"relative-path\">Local Type Inference</a>.  </p>\n<p> The following example illustrates local type inference. To use this example, you must set <code>Option Infer</code> to <code>On</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQVbFeatures#2\">        &#39; The variable aNumber will be typed as an integer.\n        Dim aNumber = 5\n\n        &#39; The variable aName will be typed as a String.\n        Dim aName = &quot;Virginia&quot;\n</code></pre><p> Local type inference also makes it possible to create anonymous types, which are described later in this section and are necessary for LINQ queries.  </p>\n<p> In the following LINQ example, type inference occurs if <code>Option Infer</code> is either <code>On</code> or <code>Off</code>. A compile-time error occurs if <code>Option Infer</code> is <code>Off</code> and <code>Option Strict</code> is <code>On</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQVbFeatures#3\">        &#39; Query example.\n        &#39; If numbers is a one-dimensional array of integers, num will be typed\n        &#39; as an integer and numQuery will be typed as IEnumerable(Of Integer)--\n        &#39; basically a collection of integers.\n\n        Dim numQuery = From num In numbers\n                       Where num Mod 2 = 0\n                       Select num\n</code></pre><h2 id=\"object-initializers\">Object Initializers</h2>\n<p> Object initializers are used in query expressions when you have to create an anonymous type to hold the results of a query. They also can be used to initialize objects of named types outside of queries. By using an object initializer, you can initialize an object in a single line without explicitly calling a constructor. Assuming that you have a class named <code>Customer</code> that has public <code>Name</code> and <code>Phone</code> properties, along with other properties, an object initializer can be used in this manner:  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQVbFeatures#4\">        Dim aCust = New Customer With {.Name = &quot;Mike&quot;,\n                                       .Phone = &quot;555-0212&quot;}\n</code></pre><p> For more information, see <a href=\"../../language-features/objects-and-classes/object-initializers-named-and-anonymous-types\" data-linktype=\"relative-path\">Object Initializers: Named and Anonymous Types</a>.  </p>\n<h2 id=\"anonymous-types\">Anonymous Types</h2>\n<p> Anonymous types provide a convenient way to temporarily group a set of properties into an element that you want to include in a query result. This enables you to choose any combination of available fields in the query, in any order, without defining a named data type for the element.  </p>\n<p> An <em>anonymous type</em> is constructed dynamically by the compiler. The name of the type is assigned by the compiler, and it might change with each new compilation. Therefore, the name cannot be used directly. Anonymous types are initialized in the following way:  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQVbFeatures#5\">        &#39; Outside a query.\n        Dim product = New With {.Name = &quot;paperclips&quot;, .Price = 1.29}\n\n        &#39; Inside a query.\n        &#39; You can use the existing member names of the selected fields, as was\n        &#39; shown previously in the Query Expressions section of this topic.\n        Dim londonCusts1 = From cust In customers\n                           Where cust.City = &quot;London&quot;\n                           Select cust.Name, cust.Phone\n\n        &#39; Or you can specify new names for the selected fields.\n        Dim londonCusts2 = From cust In customers\n                           Where cust.City = &quot;London&quot;\n                           Select CustomerName = cust.Name,\n                           CustomerPhone = cust.Phone\n</code></pre><p> For more information, see <a href=\"../../language-features/objects-and-classes/anonymous-types\" data-linktype=\"relative-path\">Anonymous Types</a>.  </p>\n<h2 id=\"extension-methods\">Extension Methods</h2>\n<p> Extension methods enable you to add methods to a data type or interface from outside the definition. This feature enables you to, in effect, add new methods to an existing type without actually modifying the type. The standard query operators are themselves a set of extension methods that provide LINQ query functionality for any type that implements <a class=\"xref\" href=\"../../../../../api/system.collections.generic.ienumerable-1\" data-linktype=\"relative-path\">IEnumerable&lt;T&gt;</a>. Other extensions to <a class=\"xref\" href=\"../../../../../api/system.collections.generic.ienumerable-1\" data-linktype=\"relative-path\">IEnumerable&lt;T&gt;</a> include <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/bb357758(v=vs.110).aspx\" data-linktype=\"external\">Count</a>, <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/bb358229(v=vs.110).aspx\" data-linktype=\"external\">Union</a>, and <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/bb302032(v=vs.110).aspx\" data-linktype=\"external\">Intersect</a>.  </p>\n<p> The following extension method adds a print method to the <a class=\"xref\" href=\"../../../../../api/system.string\" data-linktype=\"relative-path\">String</a> class.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQVbFeatures#6\">    &#39; Import System.Runtime.CompilerServices to use the Extension attribute.\n    &lt;Extension()&gt;\n        Public Sub Print(ByVal str As String)\n        Console.WriteLine(str)\n    End Sub\n</code></pre><p> The method is called like an ordinary instance method of <a class=\"xref\" href=\"../../../../../api/system.string\" data-linktype=\"relative-path\">String</a>:  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQVbFeatures#7\">        Dim greeting As String = &quot;Hello&quot;\n        greeting.Print()\n</code></pre><p> For more information, see <a href=\"../../language-features/procedures/extension-methods\" data-linktype=\"relative-path\">Extension Methods</a>.  </p>\n<h2 id=\"lambda-expressions\">Lambda Expressions</h2>\n<p> A lambda expression is a function without a name that calculates and returns a single value. Unlike named functions, a lambda expression can be defined and executed at the same time. The following example displays 4.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQVbFeatures#8\">        Console.WriteLine((Function(num As Integer) num + 1)(3))\n</code></pre><p> You can assign the lambda expression definition to a variable name and then use the name to call the function. The following example also displays 4.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQVbFeatures#12\">        Dim add1 = Function(num As Integer) num + 1\n        Console.WriteLine(add1(3))\n</code></pre><p> In LINQ, lambda expressions underlie many of the standard query operators. The compiler creates lambda expressions to capture the calculations that are defined in fundamental query methods such as <code>Where</code>, <code>Select</code>, <code>Order By</code>, <code>Take While</code>, and others.  </p>\n<p> For example, the following code defines a query that returns all senior students from a list of students.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQVbFeatures#9\">        Dim seniorsQuery = From stdnt In students\n                           Where stdnt.Year = &quot;Senior&quot;\n                           Select stdnt\n</code></pre><p> The query definition is compiled into code that is similar to the following example, which uses two lambda expressions to specify the arguments for <code>Where</code> and <code>Select</code>.  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQVbFeatures#10\">        Dim seniorsQuery2 = students.\n            Where(Function(st) st.Year = &quot;Senior&quot;).\n            Select(Function(s) s)\n</code></pre><p> Either version can be run by using a <code>For Each</code> loop:  </p>\n<pre><code class=\"lang-vb\" name=\"VbLINQVbFeatures#11\">        For Each senior In seniorsQuery\n            Console.WriteLine(senior.Last &amp; &quot;, &quot; &amp; senior.First)\n        Next\n</code></pre><p> For more information, see <a href=\"../../language-features/procedures/lambda-expressions\" data-linktype=\"relative-path\">Lambda Expressions</a>.  </p>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"index\" data-linktype=\"relative-path\">Language-Integrated Query (LINQ) (Visual Basic)</a><br> <a href=\"getting-started-with-linq\" data-linktype=\"relative-path\">Getting Started with LINQ in Visual Basic</a><br> <a href=\"linq-and-strings\" data-linktype=\"relative-path\">LINQ and Strings (Visual Basic)</a><br> <a href=\"../../../language-reference/statements/option-infer-statement\" data-linktype=\"relative-path\">Option Infer Statement</a><br> <a href=\"../../../language-reference/statements/option-strict-statement\" data-linktype=\"relative-path\">Option Strict Statement</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.tgt_pltfrm\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"c821bb50-b6f6-4cf9-8aba-2717e465bd3a\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"51\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"translation.priority.mt\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.mt\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.mt\" content=\"pt-br\">\r\n<meta name=\"translation.priority.mt\" content=\"tr-tr\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-21 01:42 AM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/features-that-support-linq.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/programming-guide/concepts/linq/features-that-support-linq.md\">\r\n<meta name=\"document_id\" content=\"0aec0d7a-dc31-cd14-8d30-e7b292a96185\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Visual Basic Features That Support LINQ | Microsoft Docs","ms.suite":"","ms.custom":"","ms.tgt_pltfrm":"","ms.assetid":"c821bb50-b6f6-4cf9-8aba-2717e465bd3a","translation.priority.ht":["de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","ru-ru","zh-cn","zh-tw"],"caps.latest.revision":51,"ms.topic":"article","dev_langs":["vb"],"helpviewer_keywords":["Visual Basic, LINQ features","LINQ [Visual Basic], features supporting LINQ"],"translation.priority.mt":["cs-cz","pl-pl","pt-br","tr-tr"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2017-03-21 01:42 AM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"3/21/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/features-that-support-linq.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/visual-basic/programming-guide/concepts/linq/features-that-support-linq.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/concepts/linq/features-that-support-linq.md","document_id":"0aec0d7a-dc31-cd14-8d30-e7b292a96185","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/concepts/linq/features-that-support-linq","toc_asset_id":"articles/visual-basic/programming-guide/concepts/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"Visual Basic Features That Support LINQ","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":1135,"_op_rawTitle":"<h1 id=\"visual-basic-features-that-support-linq\" sourcefile=\"docs/visual-basic/programming-guide/concepts/linq/features-that-support-linq.md\" sourcestartlinenumber=\"38\" sourceendlinenumber=\"38\">Visual Basic Features That Support LINQ</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/concepts/linq/features-that-support-linq","fileRelativePath":"articles/visual-basic/programming-guide/concepts/linq/features-that-support-linq.html"},"themesRelativePathToOutputRoot":"_themes/"}