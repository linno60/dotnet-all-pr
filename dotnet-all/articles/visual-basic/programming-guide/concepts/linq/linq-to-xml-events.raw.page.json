{"content":"<div><div class=\"content\">\n<p>LINQ to XML events enable you to be notified when an XML tree is altered.  </p>\n<p> You can add events to an instance of any <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobject\" data-linktype=\"relative-path\">XObject</a>. The event handler will then receive events for modifications to that <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobject\" data-linktype=\"relative-path\">XObject</a> and any of its descendants. For example, you can add an event handler to the root of the tree, and handle all modifications to the tree from that event handler.  </p>\n<p> For examples of LINQ to XML events, see <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobject#System_Xml_Linq_XObject_Changing\" data-linktype=\"relative-path\">Changing</a> and <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobject#System_Xml_Linq_XObject_Changed\" data-linktype=\"relative-path\">Changed</a>.  </p>\n<h2 id=\"types-and-events\">Types and Events</h2>\n<p> You use the following types when working with events:  </p>\n<table>\n<thead>\n<tr>\n<th>Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobjectchange\" data-linktype=\"relative-path\">XObjectChange</a></td>\n<td>Specifies the event type when an event is raised for an <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobject\" data-linktype=\"relative-path\">XObject</a>.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobjectchangeeventargs\" data-linktype=\"relative-path\">XObjectChangeEventArgs</a></td>\n<td>Provides data for the <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobject#System_Xml_Linq_XObject_Changing\" data-linktype=\"relative-path\">Changing</a> and <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobject#System_Xml_Linq_XObject_Changed\" data-linktype=\"relative-path\">Changed</a> events.</td>\n</tr>\n</tbody>\n</table>\n<p> The following events are raised when you modify an XML tree:  </p>\n<table>\n<thead>\n<tr>\n<th>Event</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobject#System_Xml_Linq_XObject_Changing\" data-linktype=\"relative-path\">Changing</a></td>\n<td>Occurs just before this <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobject\" data-linktype=\"relative-path\">XObject</a> or any of its descendants is going to change.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobject#System_Xml_Linq_XObject_Changed\" data-linktype=\"relative-path\">Changed</a></td>\n<td>Occurs when an <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xobject\" data-linktype=\"relative-path\">XObject</a> has changed or any of its descendants have changed.</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"example\">Example</h2>\n<h3 id=\"description\">Description</h3>\n<p> Events are useful when you want to maintain some aggregate information in an XML tree. For example, you may want maintain an invoice total that is the sum of the line items of the invoice. This example uses events to maintain the total of all of the child elements under the complex element <code>Items</code>.  </p>\n<h3 id=\"code\">Code</h3>\n<pre class=\"loading\"><code class=\"lang-vb\">Module Module1  \n    Dim WithEvents items As XElement = Nothing  \n    Dim total As XElement = Nothing  \n    Dim root As XElement = _  \n            &lt;Root&gt;  \n                &lt;Total&gt;0&lt;/Total&gt;  \n                &lt;Items&gt;&lt;/Items&gt;  \n            &lt;/Root&gt;  \n\n    Private Sub XObjectChanged( _  \n            ByVal sender As Object, _  \n            ByVal cea As XObjectChangeEventArgs) _  \n            Handles items.Changed  \n        Select Case cea.ObjectChange  \n            Case XObjectChange.Add  \n                If sender.GetType() Is GetType(XElement) Then  \n                    total.Value = CStr(CInt(total.Value) + _  \n                            CInt((DirectCast(sender, XElement)).Value))  \n                End If  \n                If sender.GetType() Is GetType(XText) Then  \n                    total.Value = CStr(CInt(total.Value) + _  \n                            CInt((DirectCast(sender, XText)).Value))  \n                End If  \n            Case XObjectChange.Remove  \n                If sender.GetType() Is GetType(XElement) Then  \n                    total.Value = CStr(CInt(total.Value) - _  \n                            CInt((DirectCast(sender, XElement)).Value))  \n                End If  \n                If sender.GetType() Is GetType(XText) Then  \n                    total.Value = CStr(CInt(total.Value) - _  \n                            CInt((DirectCast(sender, XText)).Value))  \n                End If  \n        End Select  \n        Console.WriteLine(&quot;Changed {0} {1}&quot;, _  \n                            sender.GetType().ToString(), _  \n                            cea.ObjectChange.ToString())  \n    End Sub  \n\n    Sub Main()  \n        total = root.&lt;Total&gt;(0)  \n        items = root.&lt;Items&gt;(0)  \n        items.SetElementValue(&quot;Item1&quot;, 25)  \n        items.SetElementValue(&quot;Item2&quot;, 50)  \n        items.SetElementValue(&quot;Item2&quot;, 75)  \n        items.SetElementValue(&quot;Item3&quot;, 133)  \n        items.SetElementValue(&quot;Item1&quot;, Nothing)  \n        items.SetElementValue(&quot;Item4&quot;, 100)  \n        Console.WriteLine(&quot;Total:{0}&quot;, CInt(total))  \n        Console.WriteLine(root)  \n    End Sub  \nEnd Module  \n</code></pre><h3 id=\"comments\">Comments</h3>\n<p> This code produces the following output:  </p>\n<pre class=\"loading\"><code>Changed System.Xml.Linq.XElement Add  \nChanged System.Xml.Linq.XElement Add  \nChanged System.Xml.Linq.XText Remove  \nChanged System.Xml.Linq.XText Add  \nChanged System.Xml.Linq.XElement Add  \nChanged System.Xml.Linq.XElement Remove  \nChanged System.Xml.Linq.XElement Add  \nTotal:308  \n&lt;Root&gt;  \n  &lt;Total&gt;308&lt;/Total&gt;  \n  &lt;Items&gt;  \n    &lt;Item2&gt;75&lt;/Item2&gt;  \n    &lt;Item3&gt;133&lt;/Item3&gt;  \n    &lt;Item4&gt;100&lt;/Item4&gt;  \n  &lt;/Items&gt;  \n&lt;/Root&gt;  \n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"advanced-linq-to-xml-programming\" data-linktype=\"relative-path\">Advanced LINQ to XML Programming (Visual Basic)</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"uhfHeaderId\" content=\"MSDocsHeader-DotNet\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.tgt_pltfrm\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"34923928-b99c-4004-956e-38f6db25e910\">\r\n<meta name=\"caps.latest.revision\" content=\"3\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"translation.priority.mt\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.mt\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.mt\" content=\"pt-br\">\r\n<meta name=\"translation.priority.mt\" content=\"tr-tr\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/linq-to-xml-events.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/linq/linq-to-xml-events.md\">\r\n<meta name=\"document_id\" content=\"f8c657aa-29f0-9ff7-2dd9-ff4260993159\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","uhfHeaderId":"MSDocsHeader-DotNet","title":"LINQ to XML Events (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.tgt_pltfrm":"","ms.assetid":"34923928-b99c-4004-956e-38f6db25e910","caps.latest.revision":3,"ms.topic":"article","dev_langs":["vb"],"translation.priority.mt":["cs-cz","pl-pl","pt-br","tr-tr"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/linq-to-xml-events.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/linq/linq-to-xml-events.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/concepts/linq/linq-to-xml-events.md","document_id":"f8c657aa-29f0-9ff7-2dd9-ff4260993159","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/concepts/linq/linq-to-xml-events","toc_asset_id":"articles/visual-basic/programming-guide/concepts/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"LINQ to XML Events (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":388,"_op_rawTitle":"<h1 id=\"linq-to-xml-events-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/concepts/linq/linq-to-xml-events.md\" sourcestartlinenumber=\"25\" sourceendlinenumber=\"25\">LINQ to XML Events (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/concepts/linq/linq-to-xml-events","fileRelativePath":"articles/visual-basic/programming-guide/concepts/linq/linq-to-xml-events.html"},"themesRelativePathToOutputRoot":"_themes/"}