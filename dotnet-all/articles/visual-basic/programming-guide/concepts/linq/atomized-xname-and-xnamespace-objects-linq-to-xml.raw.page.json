{"content":"<div><div class=\"content\">\n<p><a class=\"xref\" href=\"../../../../../api/system.xml.linq.xname\" data-linktype=\"relative-path\">XName</a> and <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xnamespace\" data-linktype=\"relative-path\">XNamespace</a> objects are <em>atomized</em>; that is, if they contain the same qualified name, they refer to the same object. This yields performance benefits for queries: When you compare two atomized names for equality, the underlying intermediate language only has to determine whether the two references point to the same object. The underlying code does not have to do string comparisons, which would be time consuming.  </p>\n<h2 id=\"atomization-semantics\">Atomization Semantics</h2>\n<p> Atomization means that if two <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xname\" data-linktype=\"relative-path\">XName</a> objects have the same local name, and they are in the same namespace, they share the same instance. In the same way, if two <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xnamespace\" data-linktype=\"relative-path\">XNamespace</a> objects have the same namespace URI, they share the same instance.  </p>\n<p> For a class to enable atomized objects, the constructor for the class must be private, not public. This is because if the constructor were public, you could create a non-atomized object. The <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xname\" data-linktype=\"relative-path\">XName</a> and <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xnamespace\" data-linktype=\"relative-path\">XNamespace</a> classes implement an implicit conversion operator to convert a string into an <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xname\" data-linktype=\"relative-path\">XName</a> or <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xnamespace\" data-linktype=\"relative-path\">XNamespace</a>. This is how you get an instance of these objects. You cannot get an instance by using a constructor, because the constructor is inaccessible.  </p>\n<p> <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xname\" data-linktype=\"relative-path\">XName</a> and <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xnamespace\" data-linktype=\"relative-path\">XNamespace</a> also implement the equality and inequality operators, to determine whether the two objects being compared are references to the same instance.  </p>\n<h2 id=\"example\">Example</h2>\n<p> The following code creates some <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xelement\" data-linktype=\"relative-path\">XElement</a> objects and demonstrates that identical names share the same instance.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Dim r1 As New XElement(&quot;Root&quot;, &quot;data1&quot;)  \nDim r2 As XElement = XElement.Parse(&quot;&lt;Root&gt;data2&lt;/Root&gt;&quot;)  \n\nIf DirectCast(r1.Name, Object) = DirectCast(r2.Name, Object) Then  \n    Console.WriteLine(&quot;r1 and r2 have names that refer to the same instance.&quot;)  \nElse  \n    Console.WriteLine(&quot;Different&quot;)  \nEnd If  \n\nDim n As XName = &quot;Root&quot;  \n\nIf DirectCast(n, Object) = DirectCast(r1.Name, Object) Then  \n    Console.WriteLine(&quot;The name of r1 and the name in &#39;n&#39; refer to the same instance.&quot;)  \nElse  \n    Console.WriteLine(&quot;Different&quot;)  \nEnd If  \n</code></pre><p> This example produces the following output:  </p>\n<pre class=\"loading\"><code>r1 and r2 have names that refer to the same instance.  \nThe name of r1 and the name in &#39;n&#39; refer to the same instance.  \n</code></pre><p> As mentioned earlier, the benefit of atomized objects is that when you use one of the axis methods that take an <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xname\" data-linktype=\"relative-path\">XName</a> as a parameter, the axis method only has to determine that two names reference the same instance to select the desired elements.  </p>\n<p> The following example passes an <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xname\" data-linktype=\"relative-path\">XName</a> to the <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xcontainer#System_Xml_Linq_XContainer_Descendants_\" data-linktype=\"relative-path\">Descendants</a> method call, which then has better performance because of the atomization pattern.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Dim root As New XElement(&quot;Root&quot;, New XElement(&quot;C1&quot;, 1), New XElement(&quot;Z1&quot;, New XElement(&quot;C1&quot;, 2), New XElement(&quot;C1&quot;, 1)))  \n\nDim query = From e In root.Descendants(&quot;C1&quot;) Where CInt(e) = 1e  \n\nFor Each z As var In query  \n    Console.WriteLine(z)  \nNext  \n</code></pre><p> This example produces the following output:  </p>\n<pre class=\"loading\"><code>&lt;C1&gt;1&lt;/C1&gt;  \n&lt;C1&gt;1&lt;/C1&gt;  \n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"performance-linq-to-xml\" data-linktype=\"relative-path\">Performance (LINQ to XML) (Visual Basic)</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc1.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.tgt_pltfrm\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"21ee7585-7df9-40b4-8c76-a12bb5f29bb3\">\r\n<meta name=\"caps.latest.revision\" content=\"3\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/atomized-xname-and-xnamespace-objects-linq-to-xml.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/linq/atomized-xname-and-xnamespace-objects-linq-to-xml.md\">\r\n<meta name=\"document_id\" content=\"eed7f1f1-0403-be87-64df-f2e4e254fa95\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc1.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","title":"Atomized XName and XNamespace Objects (LINQ to XML) (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.tgt_pltfrm":"","ms.assetid":"21ee7585-7df9-40b4-8c76-a12bb5f29bb3","caps.latest.revision":3,"ms.topic":"article","dev_langs":["vb"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/atomized-xname-and-xnamespace-objects-linq-to-xml.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/linq/atomized-xname-and-xnamespace-objects-linq-to-xml.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/concepts/linq/atomized-xname-and-xnamespace-objects-linq-to-xml.md","document_id":"eed7f1f1-0403-be87-64df-f2e4e254fa95","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/concepts/linq/atomized-xname-and-xnamespace-objects-linq-to-xml","toc_asset_id":"articles/visual-basic/programming-guide/concepts/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"Atomized XName and XNamespace Objects (LINQ to XML) (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":425,"_op_rawTitle":"<h1 id=\"atomized-xname-and-xnamespace-objects-linq-to-xml-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/concepts/linq/atomized-xname-and-xnamespace-objects-linq-to-xml.md\" sourcestartlinenumber=\"20\" sourceendlinenumber=\"20\">Atomized XName and XNamespace Objects (LINQ to XML) (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/concepts/linq/atomized-xname-and-xnamespace-objects-linq-to-xml","fileRelativePath":"articles/visual-basic/programming-guide/concepts/linq/atomized-xname-and-xnamespace-objects-linq-to-xml.html"},"themesRelativePathToOutputRoot":"_themes/"}