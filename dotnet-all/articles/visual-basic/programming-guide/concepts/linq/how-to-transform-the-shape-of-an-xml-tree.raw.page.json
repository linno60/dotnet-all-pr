{"content":"<div><div class=\"content\">\n<p>The <em>shape</em> of an XML document refers to its element names, attribute names, and the characteristics of its hierarchy.  </p>\n<p> Sometimes you will have to change the shape of an XML document. For example, you might have to send an existing XML document to another system that requires different element and attribute names. You could go through the document, deleting and renaming elements as required, but using functional construction results in more readable and maintainable code. For more information about functional construction, see <a href=\"functional-construction-linq-to-xml\" data-linktype=\"relative-path\">Functional Construction (LINQ to XML) (Visual Basic)</a>.  </p>\n<p> The first example changes the organization of the XML document. It moves complex elements from one location in the tree to another.  </p>\n<p> The second example in this topic creates an XML document with a different shape than the source document. It changes the casing of the element names, renames some elements, and leaves some elements from the source tree out of the transformed tree.  </p>\n<h2 id=\"example\">Example</h2>\n<p> The following code changes the shape of an XML file using embedded query expressions.  </p>\n<p> The source XML document in this example contains a <code>Customers</code> element under the <code>Root</code> element that contains all customers. It also contains an <code>Orders</code> element under the <code>Root</code> element that contains all orders. This example creates a new XML tree in which the orders for each customer are contained in an <code>Orders</code> element within the <code>Customer</code> element. The original document also contains a <code>CustomerID</code> element in the <code>Order</code> element; this element will be removed from the re-shaped document.  </p>\n<p> This example uses the following XML document: <a href=\"sample-xml-file-customers-and-orders-linq-to-xml\" data-linktype=\"relative-path\">Sample XML File: Customers and Orders (LINQ to XML)</a>.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Dim co As XElement = XElement.Load(&quot;CustomersOrders.xml&quot;)  \nDim newCustOrd = _  \n    &lt;Root&gt;  \n        &lt;%= From cust In co.&lt;Customers&gt;.&lt;Customer&gt; _  \n            Select _  \n            &lt;Customer&gt;  \n                &lt;%= cust.Attributes() %&gt;  \n                &lt;%= cust.Elements() %&gt;  \n                &lt;Orders&gt;  \n                    &lt;%= From ord In co.&lt;Orders&gt;.&lt;Order&gt; _  \n                        Where ord.&lt;CustomerID&gt;.Value = cust.@CustomerID _  \n                        Select _  \n                        &lt;Order&gt;  \n                            &lt;%= ord.Attributes() %&gt;  \n                            &lt;%= ord.&lt;EmployeeID&gt; %&gt;  \n                            &lt;%= ord.&lt;OrderDate&gt; %&gt;  \n                            &lt;%= ord.&lt;RequiredDate&gt; %&gt;  \n                            &lt;%= ord.&lt;ShipInfo&gt; %&gt;  \n                        &lt;/Order&gt; _  \n                    %&gt;  \n                &lt;/Orders&gt;  \n            &lt;/Customer&gt; _  \n        %&gt;  \n    &lt;/Root&gt;  \nConsole.WriteLine(newCustOrd)  \n</code></pre><p> This code produces the following output:  </p>\n<pre class=\"loading\"><code class=\"lang-xml\">\n        &lt;Root&gt;  \n&lt;Customer CustomerID=&quot;GREAL&quot;&gt;  \n  &lt;CompanyName&gt;Great Lakes Food Market&lt;/CompanyName&gt;  \n  &lt;ContactName&gt;Howard Snyder&lt;/ContactName&gt;  \n  &lt;ContactTitle&gt;Marketing Manager&lt;/ContactTitle&gt;  \n  &lt;Phone&gt;(503) 555-7555&lt;/Phone&gt;  \n  &lt;FullAddress&gt;  \n    &lt;Address&gt;2732 Baker Blvd.&lt;/Address&gt;  \n    &lt;City&gt;Eugene&lt;/City&gt;  \n    &lt;Region&gt;OR&lt;/Region&gt;  \n    &lt;PostalCode&gt;97403&lt;/PostalCode&gt;  \n    &lt;Country&gt;USA&lt;/Country&gt;  \n  &lt;/FullAddress&gt;  \n  &lt;Orders /&gt;  \n&lt;/Customer&gt;  \n&lt;Customer CustomerID=&quot;HUNGC&quot;&gt;  \n  &lt;CompanyName&gt;Hungry Coyote Import Store&lt;/CompanyName&gt;  \n  &lt;ContactName&gt;Yoshi Latimer&lt;/ContactName&gt;  \n  &lt;ContactTitle&gt;Sales Representative&lt;/ContactTitle&gt;  \n  &lt;Phone&gt;(503) 555-6874&lt;/Phone&gt;  \n  &lt;Fax&gt;(503) 555-2376&lt;/Fax&gt;  \n  &lt;FullAddress&gt;  \n    &lt;Address&gt;City Center Plaza 516 Main St.&lt;/Address&gt;  \n    &lt;City&gt;Elgin&lt;/City&gt;  \n    &lt;Region&gt;OR&lt;/Region&gt;  \n    &lt;PostalCode&gt;97827&lt;/PostalCode&gt;  \n    &lt;Country&gt;USA&lt;/Country&gt;  \n  &lt;/FullAddress&gt;  \n  &lt;Orders /&gt;  \n&lt;/Customer&gt;  \n. . .  \n</code></pre><h2 id=\"example-1\">Example</h2>\n<p> This example renames some elements and converts some attributes to elements.  </p>\n<p> The code calls <code>ConvertAddress</code>, which returns a list of <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xelement\" data-linktype=\"relative-path\">XElement</a> objects. The argument to the method is a query that determines the <code>Address</code> complex element where the <code>Type</code> attribute has a value of <code>&quot;Shipping&quot;</code>.  </p>\n<p> This example uses the following XML document: <a href=\"sample-xml-file-typical-purchase-order-linq-to-xml\" data-linktype=\"relative-path\">Sample XML File: Typical Purchase Order (LINQ to XML)</a>.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Function ConvertAddress(ByVal add As XElement) As IEnumerable(Of XElement)  \n    Dim fragment = New List(Of XElement)  \n    fragment.Add(&lt;NAME&gt;&lt;%= add.&lt;Name&gt;.Value %&gt;&lt;/NAME&gt;)  \n    fragment.Add(&lt;STREET&gt;&lt;%= add.&lt;Street&gt;.Value %&gt;&lt;/STREET&gt;)  \n    fragment.Add(&lt;CITY&gt;&lt;%= add.&lt;City&gt;.Value %&gt;&lt;/CITY&gt;)  \n    fragment.Add(&lt;ST&gt;&lt;%= add.&lt;State&gt;.Value %&gt;&lt;/ST&gt;)  \n    fragment.Add(&lt;POSTALCODE&gt;&lt;%= add.&lt;Zip&gt;.Value %&gt;&lt;/POSTALCODE&gt;)  \n    fragment.Add(&lt;COUNTRY&gt;&lt;%= add.&lt;Country&gt;.Value %&gt;&lt;/COUNTRY&gt;)  \n    Return fragment  \nEnd Function  \n\nSub Main()  \n    Dim po As XElement = XElement.Load(&quot;PurchaseOrder.xml&quot;)  \n    Dim newPo As XElement = _  \n        &lt;PO&gt;  \n            &lt;ID&gt;&lt;%= po.@PurchaseOrderNumber %&gt;&lt;/ID&gt;  \n            &lt;DATE&gt;&lt;%= CDate(po.@OrderDate) %&gt;&lt;/DATE&gt;  \n            &lt;%= _  \n                ConvertAddress( _  \n                (From el In po.&lt;Address&gt; _  \n                Where el.@Type = &quot;Shipping&quot; _  \n                Select el) _  \n                .First() _  \n                ) _  \n            %&gt;  \n        &lt;/PO&gt;  \n    Console.WriteLine(newPo)  \nEnd Sub  \n</code></pre><p> This code produces the following output:  </p>\n<pre class=\"loading\"><code class=\"lang-xml\">&lt;PO&gt;  \n  &lt;ID&gt;99503&lt;/ID&gt;  \n  &lt;DATE&gt;1999-10-20T00:00:00&lt;/DATE&gt;  \n  &lt;NAME&gt;Ellen Adams&lt;/NAME&gt;  \n  &lt;STREET&gt;123 Maple Street&lt;/STREET&gt;  \n  &lt;CITY&gt;Mill Valley&lt;/CITY&gt;  \n  &lt;ST&gt;CA&lt;/ST&gt;  \n  &lt;POSTALCODE&gt;10999&lt;/POSTALCODE&gt;  \n  &lt;COUNTRY&gt;USA&lt;/COUNTRY&gt;  \n&lt;/PO&gt;  \n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"projections-and-transformations-linq-to-xml\" data-linktype=\"relative-path\">Projections and Transformations (LINQ to XML) (Visual Basic)</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-all/api/toc2.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.tgt_pltfrm\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"84b60854-48b2-452c-87f2-77d53e1d653a\">\r\n<meta name=\"caps.latest.revision\" content=\"3\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/how-to-transform-the-shape-of-an-xml-tree.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/linq/how-to-transform-the-shape-of-an-xml-tree.md\">\r\n<meta name=\"document_id\" content=\"16775ad1-a11b-7342-be5d-aca6f5c026fa\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"How to: Transform the Shape of an XML Tree (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.tgt_pltfrm":"","ms.assetid":"84b60854-48b2-452c-87f2-77d53e1d653a","caps.latest.revision":3,"ms.topic":"article","dev_langs":["vb"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/linq/how-to-transform-the-shape-of-an-xml-tree.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/linq/how-to-transform-the-shape-of-an-xml-tree.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/concepts/linq/how-to-transform-the-shape-of-an-xml-tree.md","document_id":"16775ad1-a11b-7342-be5d-aca6f5c026fa","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/concepts/linq/how-to-transform-the-shape-of-an-xml-tree","toc_asset_id":"articles/visual-basic/programming-guide/concepts/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"How to: Transform the Shape of an XML Tree (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":560,"_op_rawTitle":"<h1 id=\"how-to-transform-the-shape-of-an-xml-tree-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/concepts/linq/how-to-transform-the-shape-of-an-xml-tree.md\" sourcestartlinenumber=\"20\" sourceendlinenumber=\"20\">How to: Transform the Shape of an XML Tree (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/visual-basic/programming-guide/concepts/linq/how-to-transform-the-shape-of-an-xml-tree","fileRelativePath":"articles/visual-basic/programming-guide/concepts/linq/how-to-transform-the-shape-of-an-xml-tree.html"},"themesRelativePathToOutputRoot":"_themes/"}