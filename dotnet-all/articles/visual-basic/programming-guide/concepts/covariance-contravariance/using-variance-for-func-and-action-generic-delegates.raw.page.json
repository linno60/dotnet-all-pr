{"content":"<div><div class=\"content\">\n<p>These examples demonstrate how to use covariance and contravariance in the <code>Func</code> and <code>Action</code> generic delegates to enable reuse of methods and provide more flexibility in your code.  </p>\n<p> For more information about covariance and contravariance, see <a href=\"variance-in-delegates\" data-linktype=\"relative-path\">Variance in Delegates (Visual Basic)</a>.  </p>\n<h2 id=\"using-delegates-with-covariant-type-parameters\">Using Delegates with Covariant Type Parameters</h2>\n<p> The following example illustrates the benefits of covariance support in the generic <code>Func</code> delegates. The <code>FindByTitle</code> method takes a parameter of the <code>String</code> type and returns an object of the <code>Employee</code> type. However, you can assign this method to the <code>Func(Of String, Person)</code> delegate because <code>Employee</code> inherits <code>Person</code>.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">&#39; Simple hierarchy of classes.  \nPublic Class Person  \nEnd Class  \n\nPublic Class Employee  \n    Inherits Person  \nEnd Class  \n\nClass Finder  \n    Public Shared Function FindByTitle(  \n        ByVal title As String) As Employee  \n        &#39; This is a stub for a method that returns  \n        &#39; an employee that has the specified title.  \n        Return New Employee  \n    End Function  \n\n    Sub Test()  \n        &#39; Create an instance of the delegate without using variance.  \n        Dim findEmployee As Func(Of String, Employee) =  \n            AddressOf FindByTitle  \n\n        &#39; The delegate expects a method to return Person,  \n        &#39; but you can assign it a method that returns Employee.  \n        Dim findPerson As Func(Of String, Person) =  \n            AddressOf FindByTitle  \n\n        &#39; You can also assign a delegate   \n        &#39; that returns a more derived type to a delegate   \n        &#39; that returns a less derived type.  \n        findPerson = findEmployee  \n    End Sub  \nEnd Class  \n</code></pre><h2 id=\"using-delegates-with-contravariant-type-parameters\">Using Delegates with Contravariant Type Parameters</h2>\n<p> The following example illustrates the benefits of contravariance support in the generic <code>Action</code> delegates. The <code>AddToContacts</code> method takes a parameter of the <code>Person</code> type. However, you can assign this method to the <code>Action(Of Employee)</code> delegate because <code>Employee</code> inherits <code>Person</code>.  </p>\n<pre class=\"loading\"><code class=\"lang-vb\">Public Class Person  \nEnd Class  \n\nPublic Class Employee  \n    Inherits Person  \nEnd Class  \n\nClass AddressBook  \n    Shared Sub AddToContacts(ByVal person As Person)  \n        &#39; This method adds a Person object  \n        &#39; to a contact list.  \n    End Sub  \n\n    Sub Test()  \n        &#39; Create an instance of the delegate without using variance.  \n        Dim addPersonToContacts As Action(Of Person) =  \n            AddressOf AddToContacts  \n\n        &#39; The Action delegate expects   \n        &#39; a method that has an Employee parameter,  \n        &#39; but you can assign it a method that has a Person parameter  \n        &#39; because Employee derives from Person.  \n        Dim addEmployeeToContacts As Action(Of Employee) =  \n            AddressOf AddToContacts  \n\n        &#39; You can also assign a delegate   \n        &#39; that accepts a less derived parameter   \n        &#39; to a delegate that accepts a more derived parameter.  \n        addEmployeeToContacts = addPersonToContacts  \n    End Sub  \nEnd Class  \n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"covariance-and-contravariance\" data-linktype=\"relative-path\">Covariance and Contravariance (Visual Basic)</a><br> <a href=\"https://msdn.microsoft.com/library/ms172192\" data-linktype=\"external\">Generics</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"uhfHeaderId\" content=\"MSDocsHeader-DotNet\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.tgt_pltfrm\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"36c3012f-b39c-493b-b90f-079b5912ac1b\">\r\n<meta name=\"caps.latest.revision\" content=\"3\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"translation.priority.mt\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.mt\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.mt\" content=\"pt-br\">\r\n<meta name=\"translation.priority.mt\" content=\"tr-tr\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-visual-basic\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates.md\">\r\n<meta name=\"document_id\" content=\"e86ef59e-70ec-c5d0-283d-4ab540fad337\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","uhfHeaderId":"MSDocsHeader-DotNet","title":"Using Variance for Func and Action Generic Delegates (Visual Basic) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.tgt_pltfrm":"","ms.assetid":"36c3012f-b39c-493b-b90f-079b5912ac1b","caps.latest.revision":3,"ms.topic":"article","dev_langs":["vb"],"translation.priority.mt":["cs-cz","pl-pl","pt-br","tr-tr"],"ms.date":"2015-07-20","ms.technology":["devlang-visual-basic"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/visual-basic/programming-guide/concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/visual-basic/programming-guide/concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/visual-basic/programming-guide/concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates.md","document_id":"e86ef59e-70ec-c5d0-283d-4ab540fad337","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates","toc_asset_id":"articles/visual-basic/programming-guide/concepts/covariance-contravariance/toc.json","toc_rel":"toc.json","_op_ogTitle":"Using Variance for Func and Action Generic Delegates (Visual Basic)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":406,"_op_rawTitle":"<h1 id=\"using-variance-for-func-and-action-generic-delegates-visual-basic\" sourcefile=\"docs/visual-basic/programming-guide/concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates.md\" sourcestartlinenumber=\"25\" sourceendlinenumber=\"25\">Using Variance for Func and Action Generic Delegates (Visual Basic)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/visual-basic/programming-guide/concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates","fileRelativePath":"articles/visual-basic/programming-guide/concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates.html"},"themesRelativePathToOutputRoot":"_themes/"}