{"content":"<div><div class=\"content\">\n<p>In many applications, a date and time value is intended to unambiguously identify a single point in time. This topic shows how to save and restore a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value, and a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value so that the restored value identifies the same time as the saved value.</p>\n<h2 id=\"to-round-trip-a-datetime-value\">To round-trip a DateTime value</h2>\n<ol>\n<li><p>Convert the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value to its string representation by calling the <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_ToString_System_String_\" data-linktype=\"relative-path\">DateTime.ToString(String)</a> method with the &quot;o&quot; format specifier.</p>\n</li>\n<li><p>Save the string representation of the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value to a file, or pass it across a process, application domain, or machine boundary.</p>\n</li>\n<li><p>Retrieve the string that represents the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value.</p>\n</li>\n<li><p>Call the <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Parse_System_String_System_IFormatProvider_System_Globalization_DateTimeStyles_\" data-linktype=\"relative-path\">DateTime.Parse(String, IFormatProvider, DateTimeStyles)</a> method, and pass <a class=\"xref\" href=\"../../../api/system.globalization.datetimestyles#System_Globalization_DateTimeStyles_RoundtripKind\" data-linktype=\"relative-path\">DateTimeStyles.RoundtripKind</a> as the value of the <em>DateTimeStyles</em> parameter.</p>\n</li>\n</ol>\n<p>The following example illustrates how to round-trip a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">const string fileName = @&quot;.\\DateFile.txt&quot;;\n\nStreamWriter outFile = new StreamWriter(fileName);\n\n// Save DateTime value.\nDateTime dateToSave = DateTime.SpecifyKind(new DateTime(2008, 6, 12, 18, 45, 15), \n                                           DateTimeKind.Local);\nstring dateString = dateToSave.ToString(&quot;o&quot;);      \nConsole.WriteLine(&quot;Converted {0} ({1}) to {2}.&quot;, \n                  dateToSave.ToString(), \n                  dateToSave.Kind.ToString(), \n                  dateString);      \noutFile.WriteLine(dateString);\nConsole.WriteLine(&quot;Wrote {0} to {1}.&quot;, dateString, fileName);\noutFile.Close();\n\n// Restore DateTime value.\nDateTime restoredDate;\n\nStreamReader inFile = new StreamReader(fileName);\ndateString = inFile.ReadLine();\ninFile.Close();\nrestoredDate = DateTime.Parse(dateString, null, DateTimeStyles.RoundtripKind);\nConsole.WriteLine(&quot;Read {0} ({2}) from {1}.&quot;, restoredDate.ToString(), \n                                              fileName, \n                                              restoredDate.Kind.ToString());\n// The example displays the following output:\n//    Converted 6/12/2008 6:45:15 PM (Local) to 2008-06-12T18:45:15.0000000-05:00.\n//    Wrote 2008-06-12T18:45:15.0000000-05:00 to .\\DateFile.txt.\n//    Read 6/12/2008 6:45:15 PM (Local) from .\\DateFile.txt.\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Const fileName As String = &quot;.\\DateFile.txt&quot;\n\nDim outFile As New StreamWriter(fileName)\n\n&#39; Save DateTime value.\nDim dateToSave As Date = DateTime.SpecifyKind(#06/12/2008 6:45:15 PM#, _\n                                              DateTimeKind.Local)\nDim dateString As String = dateToSave.ToString(&quot;o&quot;)      \nConsole.WriteLine(&quot;Converted {0} ({1}) to {2}.&quot;, dateToSave.ToString(), _\n                  dateToSave.Kind.ToString(), dateString)      \noutFile.WriteLine(dateString)\nConsole.WriteLine(&quot;Wrote {0} to {1}.&quot;, dateString, fileName)\noutFile.Close()   \n\n&#39; Restore DateTime value.\nDim restoredDate As Date\n\nDim inFile As New StreamReader(fileName)\ndateString = inFile.ReadLine()\ninFile.Close()\nrestoredDate = DateTime.Parse(dateString, Nothing, DateTimeStyles.RoundTripKind)\nConsole.WriteLine(&quot;Read {0} ({2}) from {1}.&quot;, restoredDate.ToString(), _\n                  fileName, restoredDAte.Kind.ToString())\n&#39; The example displays the following output:\n&#39;    Converted 6/12/2008 6:45:15 PM (Local) to 2008-06-12T18:45:15.0000000-05:00.\n&#39;    Wrote 2008-06-12T18:45:15.0000000-05:00 to .\\DateFile.txt.\n&#39;    Read 6/12/2008 6:45:15 PM (Local) from .\\DateFile.txt.\n</code></pre><p>When round-tripping a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value, this technique successfully preserves the time for all local and universal times. For example, if a local <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value is saved on a system in the U.S. Pacific Standard Time zone and is restored on a system in the U.S. Central Standard Time zone, the restored date and time will be two hours later than the original time, which reflects the time difference between the two time zones. However, this technique is not necessarily accurate for unspecified times. All <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> values whose <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property is <a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Unspecified\" data-linktype=\"relative-path\">Unspecified</a> are treated as if they are local times. If this is not the case, the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> will not successfully identify the correct point in time. The workaround for this limitation is to tightly couple a date and time value with its time zone for the save and restore operation.</p>\n<h2 id=\"to-round-trip-a-datetimeoffset-value\">To round-trip a DateTimeOffset value</h2>\n<p>Convert the <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value to its string representation by calling the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_ToString_System_String_\" data-linktype=\"relative-path\">DateTimeOffset.ToString(String)</a> method with the &quot;o&quot; format specifier.</p>\n<ol>\n<li><p>Save the string representation of the <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value to a file, or pass it across a process, application domain, or machine boundary.</p>\n</li>\n<li><p>Retrieve the string that represents the <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value.</p>\n</li>\n<li><p>Call the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_Parse_System_String_System_IFormatProvider_System_Globalization_DateTimeStyles_\" data-linktype=\"relative-path\">DateTimeOffset.Parse(String, IFormatProvider, DateTimeStyles)</a> method, and pass <a class=\"xref\" href=\"../../../api/system.globalization.datetimestyles#System_Globalization_DateTimeStyles_RoundtripKind\" data-linktype=\"relative-path\">DateTimeStyles.RoundtripKind</a> as the value of the <em>styles</em> parameter.</p>\n</li>\n</ol>\n<p>The following example illustrates how to round-trip a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">const string fileName = @&quot;.\\DateOff.txt&quot;;\n\nStreamWriter outFile = new StreamWriter(fileName);\n\n// Save DateTime value.\nDateTimeOffset dateToSave = new DateTimeOffset(2008, 6, 12, 18, 45, 15, \n                                               new TimeSpan(7, 0, 0));\nstring dateString = dateToSave.ToString(&quot;o&quot;);      \nConsole.WriteLine(&quot;Converted {0} to {1}.&quot;, dateToSave.ToString(), \n                  dateString);      \noutFile.WriteLine(dateString);\nConsole.WriteLine(&quot;Wrote {0} to {1}.&quot;, dateString, fileName);\noutFile.Close();\n\n// Restore DateTime value.\nDateTimeOffset restoredDateOff;\n\nStreamReader inFile = new StreamReader(fileName);\ndateString = inFile.ReadLine();\ninFile.Close();\nrestoredDateOff = DateTimeOffset.Parse(dateString, null, \n                                       DateTimeStyles.RoundtripKind);\nConsole.WriteLine(&quot;Read {0} from {1}.&quot;, restoredDateOff.ToString(), \n                  fileName);\n// The example displays the following output:\n//    Converted 6/12/2008 6:45:15 PM +07:00 to 2008-06-12T18:45:15.0000000+07:00.\n//    Wrote 2008-06-12T18:45:15.0000000+07:00 to .\\DateOff.txt.\n//    Read 6/12/2008 6:45:15 PM +07:00 from .\\DateOff.txt.\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Const fileName As String = &quot;.\\DateOff.txt&quot;\n\nDim outFile As New StreamWriter(fileName)\n\n&#39; Save DateTime value.\nDim dateToSave As New DateTimeOffset(2008, 6, 12, 18, 45, 15, _\n                                     New TimeSpan(7, 0, 0))\nDim dateString As String = dateToSave.ToString(&quot;o&quot;)      \nConsole.WriteLine(&quot;Converted {0} to {1}.&quot;, dateToSave.ToString(), dateString)      \noutFile.WriteLine(dateString)\nConsole.WriteLine(&quot;Wrote {0} to {1}.&quot;, dateString, fileName)\noutFile.Close()   \n\n&#39; Restore DateTime value.\nDim restoredDateOff As DateTimeOffset\n\nDim inFile As New StreamReader(fileName)\ndateString = inFile.ReadLine()\ninFile.Close()\nrestoredDateOff = DateTimeOffset.Parse(dateString, Nothing, DateTimeStyles.RoundTripKind)\nConsole.WriteLine(&quot;Read {0} from {1}.&quot;, restoredDateOff.ToString(), fileName)\n&#39; The example displays the following output:\n&#39;    Converted 6/12/2008 6:45:15 PM +07:00 to 2008-06-12T18:45:15.0000000+07:00.\n&#39;    Wrote 2008-06-12T18:45:15.0000000+07:00 to .\\DateOff.txt.\n&#39;    Read 6/12/2008 6:45:15 PM +07:00 from .\\DateOff.txt.\n</code></pre><p>This technique always unambiguously identifies a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value as a single point in time. The value can then be converted to Coordinated Universal Time (UTC) by calling the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_ToUniversalTime\" data-linktype=\"relative-path\">DateTimeOffset.ToUniversalTime</a> method, or it can be converted to the time in a particular time zone by calling the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_ToOffset_System_TimeSpan_\" data-linktype=\"relative-path\">DateTimeOffset.ToOffset</a> or [TimeZoneInfo.ConvertTime(DateTimeOffset, TimeZoneInfo)](xref:System.TimeZoneInfo.ConvertTime(System.DateTime,System.TimeZoneInfo) method. The major limitation of this technique is that date and time arithmetic, when performed on a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value that represents the time in a particular time zone, may not produce accurate results for that time zone. This is because when a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value is instantiated, it is disassociated from its time zone. Therefore, that time zone&#39;s adjustment rules can no longer be applied when you perform date and time calculations. You can work around this problem by defining a custom type that includes both a date and time value and its accompanying time zone.</p>\n<h2 id=\"see-also\">See Also</h2>\n<p><a href=\"performing-formatting-operations\" data-linktype=\"relative-path\">Performing formatting operations</a></p>\n<p><a href=\"standard-datetime\" data-linktype=\"relative-path\">Standard date and time format strings</a></p>\n</div></div>","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"toc2.json\">\r\n<meta name=\"ms.devlang\" content=\"dotnet\">\r\n<meta name=\"ms.assetid\" content=\"15690f18-1bb9-4bb8-bc11-0b737e2f0859\">\r\n<meta name=\"description\" content=\"How to round-trip date and time values\">\r\n<meta name=\"keywords\" content=\".NET, .NET Core\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"07/26/2016\">\r\n<meta name=\"ms.technology\" content=\"dotnet-standard\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/standard/base-types/roundtrip.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/standard/base-types/roundtrip.md\">\r\n<meta name=\"document_id\" content=\"00977efa-2088-79bc-1423-63b9123206ac\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"How to: round-trip date and time values | Microsoft Docs","ms.devlang":"dotnet","ms.assetid":"15690f18-1bb9-4bb8-bc11-0b737e2f0859","description":"How to round-trip date and time values","keywords":".NET, .NET Core","ms.topic":"article","ms.date":"07/26/2016","ms.technology":"dotnet-standard","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Porting base type docs take 4 (#1053)","commit_sha":"fb00da6505c9edb6a49d2003ae9bcb8e74c11d6c","commit_date":"2016-10-06 10:32:59 -0700"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/standard/base-types/roundtrip.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/standard/base-types/roundtrip.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/standard/base-types/roundtrip.md","document_id":"00977efa-2088-79bc-1423-63b9123206ac","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/standard/base-types/roundtrip","toc_asset_id":"articles/toc.json","toc_rel":"../../toc.json","_op_ogTitle":"How to: round-trip date and time values","_op_displayDate":"2016-7-26","_op_displayDate_source":"2016-07-26T00:00:00Z","_op_wordCount":909,"_op_rawTitle":"<h1 id=\"how-to-round-trip-date-and-time-values\" sourcefile=\"docs/standard/base-types/roundtrip.md\" sourcestartlinenumber=\"15\" sourceendlinenumber=\"15\">How to: round-trip date and time values</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/standard/base-types/roundtrip","fileRelativePath":"articles/standard/base-types/roundtrip.html"},"themesRelativePathToOutputRoot":"_themes/"}