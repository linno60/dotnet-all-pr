{"content":"<div><div class=\"content\">\n<p>The following example searches an input string and displays all the href=&quot;…&quot; values and their locations in the string. </p>\n<h2 id=\"the-regex-object\">The Regex Object</h2>\n<p>Because the <code>DumpHRefs</code> method can be called multiple times from user code, it uses the <code>static</code> <a class=\"xref\" href=\"../../../api/system.text.regularexpressions.regex#System_Text_RegularExpressions_Regex_Match_System_String_System_String_System_Text_RegularExpressions_RegexOptions_\" data-linktype=\"relative-path\">Regex.Match(String, String, RegexOptions)</a> method. This enables the regular expression engine to cache the regular expression and avoids the overhead of instantiating a new <a class=\"xref\" href=\"../../../api/system.text.regularexpressions.regex\" data-linktype=\"relative-path\">Regex</a> object each time the method is called. A <a class=\"xref\" href=\"../../../api/system.text.regularexpressions.match\" data-linktype=\"relative-path\">Match</a> object is then used to iterate through all matches in the string. </p>\n<pre class=\"loading\"><code class=\"lang-csharp\">private static void DumpHRefs(string inputString) \n{\n   Match m;\n   string HRefPattern = &quot;href\\\\s*=\\\\s*(?:[\\&quot;&#39;](?&lt;1&gt;[^\\&quot;&#39;]*)[\\&quot;&#39;]|(?&lt;1&gt;\\\\S+))&quot;;\n\n   try {\n      m = Regex.Match(inputString, HRefPattern, \n                      RegexOptions.IgnoreCase | RegexOptions.Compiled, \n                      TimeSpan.FromSeconds(1));\n      while (m.Success)\n      {\n         Console.WriteLine(&quot;Found href &quot; + m.Groups[1] + &quot; at &quot; \n            + m.Groups[1].Index);\n         m = m.NextMatch();\n      }   \n   }\n   catch (RegexMatchTimeoutException) {\n      Console.WriteLine(&quot;The matching operation timed out.&quot;);\n   }\n}\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Private Sub DumpHRefs(inputString As String) \n   Dim m As Match\n   Dim HRefPattern As String = &quot;href\\s*=\\s*(?:[&quot;&quot;&#39;](?&lt;1&gt;[^&quot;&quot;&#39;]*)[&quot;&quot;&#39;]|(?&lt;1&gt;\\S+))&quot;\n\n   Try\n      m = Regex.Match(inputString, HRefPattern, _ \n                      RegexOptions.IgnoreCase Or RegexOptions.Compiled,\n                      TimeSpan.FromSeconds(1))\n      Do While m.Success\n         Console.WriteLine(&quot;Found href {0} at {1}.&quot;, _\n                           m.Groups(1), m.Groups(1).Index)\n         m = m.NextMatch()\n      Loop   \n   Catch e As RegexMatchTimeoutException\n      Console.WriteLine(&quot;The matching operation timed out.&quot;)\n   End Try\nEnd Sub\n</code></pre><p>The following example then illustrates a call to the <code>DumpHRefs</code> method.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">public static void Main()\n{\n   string inputString = &quot;My favorite web sites include:&lt;/P&gt;&quot; +\n                        &quot;&lt;A HREF=\\&quot;http://msdn2.microsoft.com\\&quot;&gt;&quot; +\n                        &quot;MSDN Home Page&lt;/A&gt;&lt;/P&gt;&quot; +\n                        &quot;&lt;A HREF=\\&quot;http://www.microsoft.com\\&quot;&gt;&quot; +\n                        &quot;Microsoft Corporation Home Page&lt;/A&gt;&lt;/P&gt;&quot; +\n                        &quot;&lt;A HREF=\\&quot;http://blogs.msdn.com/bclteam\\&quot;&gt;&quot; +\n                        &quot;.NET Base Class Library blog&lt;/A&gt;&lt;/P&gt;&quot;;\n   DumpHRefs(inputString);                     \n\n}\n// The example displays the following output:\n//       Found href http://msdn2.microsoft.com at 43\n//       Found href http://www.microsoft.com at 102\n//       Found href http://blogs.msdn.com/bclteam at 176\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Public Sub Main()\n   Dim inputString As String = &quot;My favorite web sites include:&lt;/P&gt;&quot; &amp; _\n                               &quot;&lt;A HREF=&quot;&quot;http://msdn2.microsoft.com&quot;&quot;&gt;&quot; &amp; _\n                               &quot;MSDN Home Page&lt;/A&gt;&lt;/P&gt;&quot; &amp; _\n                               &quot;&lt;A HREF=&quot;&quot;http://www.microsoft.com&quot;&quot;&gt;&quot; &amp; _\n                               &quot;Microsoft Corporation Home Page&lt;/A&gt;&lt;/P&gt;&quot; &amp; _\n                               &quot;&lt;A HREF=&quot;&quot;http://blogs.msdn.com/bclteam&quot;&quot;&gt;&quot; &amp; _\n                               &quot;.NET Base Class Library blog&lt;/A&gt;&lt;/P&gt;&quot;\n   DumpHRefs(inputString)                     \nEnd Sub\n&#39; The example displays the following output:\n&#39;       Found href http://msdn2.microsoft.com at 43\n&#39;       Found href http://www.microsoft.com at 102\n&#39;       Found href http://blogs.msdn.com/bclteam/) at 176\n</code></pre><p>The regular expression pattern <code>href\\s*=\\s*(?:[&quot;&#39;]&amp;#40;?&lt;1&gt;[^&quot;&#39;]*)[&quot;&#39;]|(?&lt;1&gt;\\S+))</code> is interpreted as shown in the following table.</p>\n<table>\n<thead>\n<tr>\n<th>Pattern</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>href</code></td>\n<td>Match the literal string &quot;href&quot;. The match is case-insensitive.</td>\n</tr>\n<tr>\n<td><code>\\s*</code></td>\n<td>Match zero or more white-space characters.</td>\n</tr>\n<tr>\n<td><code>=</code></td>\n<td>`Match the equals sign.</td>\n</tr>\n<tr>\n<td><code>\\s*</code></td>\n<td>Match zero or more white-space characters.</td>\n</tr>\n<tr>\n<td><code>(?:[&quot;&#39;]&amp;#40;?&lt;1&gt;[^&quot;&#39;]*)&quot;&amp;#124;(?&lt;1&gt;\\S+))</code></td>\n<td>Match one of the following without assigning the result to a captured group: A quotation mark or apostrophe, followed by zero or more occurrences of any character other than a quotation mark or apostrophe, followed by a quotation mark or apostrophe. The group named <code>1</code> is included in this pattern. -or- One or more non-white-space characters. The group named <code>1</code> is included in this pattern.</td>\n</tr>\n<tr>\n<td><code>(?&lt;1&gt;[^&quot;&#39;]*)</code></td>\n<td>Assign zero or more occurrences of any character other than a quotation mark or apostrophe to the capturing group named <code>1</code>.</td>\n</tr>\n<tr>\n<td><code>&quot;(?&lt;1&gt;\\S+)</code></td>\n<td>Assign one or more non-white-space characters to the capturing group named <code>1</code>.</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"match-result-class\">Match Result Class</h2>\n<p>The results of a search are stored in the <a class=\"xref\" href=\"../../../api/system.text.regularexpressions.match\" data-linktype=\"relative-path\">Match</a> class, which provides access to all the substrings extracted by the search. It also remembers the string being searched and the regular expression being used, so it can call the <a class=\"xref\" href=\"../../../api/system.text.regularexpressions.match#System_Text_RegularExpressions_Match_NextMatch\" data-linktype=\"relative-path\">Match.NextMatch</a> method to perform another search starting where the last one ended.</p>\n<h2 id=\"explicitly-named-captures\">Explicitly Named Captures</h2>\n<p>In traditional regular expressions, capturing parentheses are automatically numbered sequentially. This leads to two problems. First, if a regular expression is modified by inserting or removing a set of parentheses, all code that refers to the numbered captures must be rewritten to reflect the new numbering. Second, because different sets of parentheses often are used to provide two alternative expressions for an acceptable match, it might be difficult to determine which of the two expressions actually returned a result.</p>\n<p>To address these problems, the <a class=\"xref\" href=\"../../../api/system.text.regularexpressions.regex\" data-linktype=\"relative-path\">Regex</a> class supports the syntax <code>(?&lt;name&gt;…)</code> for capturing a match into a specified slot (the slot can be named using a string or an integer; integers can be recalled more quickly). Thus, alternative matches for the same string all can be directed to the same place. In case of a conflict, the last match dropped into a slot is the successful match. (However, a complete list of multiple matches for a single slot is available. See the <a class=\"xref\" href=\"../../../api/system.text.regularexpressions.group#System_Text_RegularExpressions_Group_Captures\" data-linktype=\"relative-path\">Group.Captures</a> collection for details.)</p>\n<h2 id=\"see-also\">See Also</h2>\n<p><a href=\"regular-expressions\" data-linktype=\"relative-path\">.NET regular expressions</a></p>\n<p><a href=\"regex-examples\" data-linktype=\"relative-path\">Regular expression examples</a></p>\n</div></div>","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-all/api/toc2.json\">\r\n<meta name=\"ms.devlang\" content=\"dotnet\">\r\n<meta name=\"ms.assetid\" content=\"d6484880-bdac-47cd-b5e5-9419c9ed14cd\">\r\n<meta name=\"description\" content=\"Regular expression example scanning for HREFs\">\r\n<meta name=\"keywords\" content=\".NET, .NET Core\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"07/28/2016\">\r\n<meta name=\"ms.technology\" content=\"dotnet-standard\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/standard/base-types/scanning.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/standard/base-types/scanning.md\">\r\n<meta name=\"document_id\" content=\"a49df512-0bbc-6c70-633a-55a83ee5bb0e\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Regular expression example: scanning for HREFs | Microsoft Docs","ms.devlang":"dotnet","ms.assetid":"d6484880-bdac-47cd-b5e5-9419c9ed14cd","description":"Regular expression example scanning for HREFs","keywords":".NET, .NET Core","ms.topic":"article","ms.date":"07/28/2016","ms.technology":"dotnet-standard","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Porting base type docs take 4 (#1053)","commit_sha":"fb00da6505c9edb6a49d2003ae9bcb8e74c11d6c","commit_date":"2016-10-06 10:32:59 -0700"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/standard/base-types/scanning.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/standard/base-types/scanning.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/standard/base-types/scanning.md","document_id":"a49df512-0bbc-6c70-633a-55a83ee5bb0e","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/standard/base-types/scanning","toc_asset_id":"articles/toc.json","toc_rel":"../../toc.json","_op_ogTitle":"Regular expression example: scanning for HREFs","_op_displayDate":"2016-7-28","_op_displayDate_source":"2016-07-28T00:00:00Z","_op_wordCount":707,"_op_rawTitle":"<h1 id=\"regular-expression-example-scanning-for-hrefs\" sourcefile=\"docs/standard/base-types/scanning.md\" sourcestartlinenumber=\"15\" sourceendlinenumber=\"15\">Regular expression example: scanning for HREFs</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/standard/base-types/scanning","fileRelativePath":"articles/standard/base-types/scanning.html"},"themesRelativePathToOutputRoot":"_themes/"}