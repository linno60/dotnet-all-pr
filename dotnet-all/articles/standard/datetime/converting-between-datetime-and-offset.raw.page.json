{"content":"<div><div class=\"content\">\n<p>Although the <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">System.DateTimeOffset</a> structure provides a greater degree of time zone awareness than the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">System.DateTime</a> structure, <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> parameters are used more commonly in method calls. Because of this, the ability to convert <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> values to <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> values and vice versa is particularly important. This article shows how to perform these conversions in a way that preserves as much time zone information as possible.</p>\n<div class=\"NOTE\"><h5>Note</h5><p>Both the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> and the <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> types have some limitations when representing times in time zones. With its <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property, <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> is able to reflect only Coordinated Universal Time (UTC) and the system&#39;s local time zone. <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> reflects a time&#39;s offset from UTC, but it does not reflect the actual time zone to which that offset belongs. For details about time values and support for time zones, see <a href=\"choosing-between-datetime\" data-linktype=\"relative-path\">Choosing between DateTime, DateTimeOffset, TimeSpan, and TimeZoneInfo</a>.</p>\n</div>\n<h2 id=\"conversions-from-datetime-to-datetimeoffset\">Conversions from DateTime to DateTimeOffset</h2>\n<p>The <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> structure provides two equivalent ways to perform <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> to <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> conversion that are suitable for most conversions:</p>\n<ul>\n<li><p>The <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset(DateTime)</a> constructor, which creates a new <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> object based on a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value.</p>\n</li>\n<li><p>The implicit conversion operator, which allows you to assign a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value to a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> object.</p>\n</li>\n</ul>\n<p>For UTC and local <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> values, the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_Offset\" data-linktype=\"relative-path\">DateTimeOffset.Offset</a> property of the resulting <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value accurately reflects the UTC or local time zone offset. For example, the following code converts a UTC time to its equivalent <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value. </p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTime utcTime1 = new DateTime(2008, 6, 19, 7, 0, 0);\nutcTime1 = DateTime.SpecifyKind(utcTime1, DateTimeKind.Utc);\nDateTimeOffset utcTime2 = utcTime1;\nConsole.WriteLine(&quot;Converted {0} {1} to a DateTimeOffset value of {2}&quot;, \n                  utcTime1, \n                  utcTime1.Kind.ToString(), \n                  utcTime2);\n// This example displays the following output to the console:\n//    Converted 6/19/2008 7:00:00 AM Utc to a DateTimeOffset value of 6/19/2008 7:00:00 AM +00:00\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim utcTime1 As Date = Date.SpecifyKind(#06/19/2008 7:00AM#, _\n                                        DateTimeKind.Utc)\nDim utcTime2 As DateTimeOffset = utcTime1\nConsole.WriteLine(&quot;Converted {0} {1} to a DateTimeOffset value of {2}&quot;, _\n                  utcTime1, _\n                  utcTime1.Kind.ToString(), _\n                  utcTime2)\n&#39; This example displays the following output to the console:\n&#39;    Converted 6/19/2008 7:00:00 AM Utc to a DateTimeOffset value of 6/19/2008 7:00:00 AM  +00:00\n</code></pre><p>In this case, the offset of the <code>utcTime2</code> variable is 00:00. Similarly, the following code converts a local time to its equivalent <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTime localTime1 = new DateTime(2008, 6, 19, 7, 0, 0);\nlocalTime1 = DateTime.SpecifyKind(localTime1, DateTimeKind.Local);\nDateTimeOffset localTime2 = localTime1;\nConsole.WriteLine(&quot;Converted {0} {1} to a DateTimeOffset value of {2}&quot;, \n                  localTime1, \n                  localTime1.Kind.ToString(), \n                  localTime2);\n// This example displays the following output to the console:\n//    Converted 6/19/2008 7:00:00 AM Local to a DateTimeOffset value of 6/19/2008 7:00:00 AM -07:00\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim localTime1 As Date = Date.SpecifyKind(#06/19/2008 7:00AM#, DateTimeKind.Local)\nDim localTime2 As DateTimeOffset = localTime1\nConsole.WriteLine(&quot;Converted {0} {1} to a DateTimeOffset value of {2}&quot;, _\n                  localTime1, _\n                  localTime1.Kind.ToString(), _\n                  localTime2)\n&#39; This example displays the following output to the console:\n&#39;    Converted 6/19/2008 7:00:00 AM Local to a DateTimeOffset value of 6/19/2008 7:00:00 AM -07:00\n</code></pre><p>However, for <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> values whose <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property is <a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Unspecified\" data-linktype=\"relative-path\">DateTimeKind.Unspecified</a>, these two conversion methods produce a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value whose offset is that of the local time zone. This is shown in the following example, which is run in the U.S. Pacific Standard Time zone.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTime time1 = new DateTime(2008, 6, 19, 7, 0, 0);  // Kind is DateTimeKind.Unspecified\nDateTimeOffset time2 = time1;\nConsole.WriteLine(&quot;Converted {0} {1} to a DateTimeOffset value of {2}&quot;, \n                  time1, \n                  time1.Kind.ToString(), \n                  time2);\n// This example displays the following output to the console:\n//    Converted 6/19/2008 7:00:00 AM Unspecified to a DateTimeOffset value of 6/19/2008 7:00:00 AM -07:00\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim time1 As Date = #06/19/2008 7:00AM#      &#39; Kind is DateTimeKind.Unspecified\nDim time2 As DateTimeOffset = time1\nConsole.WriteLine(&quot;Converted {0} {1} to a DateTimeOffset value of {2}&quot;, _\n                  time1, _\n                  time1.Kind.ToString(), _\n                  time2)\n&#39; This example displays the following output to the console:\n&#39;    Converted 6/19/2008 7:00:00 AM Unspecified to a DateTimeOffset value of 6/19/2008 7:00:00 AM -07:00\n</code></pre><p>If the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value reflects the date and time in something other than the local time zone or UTC, you can convert it to a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value and preserve its time zone information by calling the overloaded <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset(DateTime, TimeSpan)</a> constructor. For example, the following example instantiates a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> object that reflects Central Standard Time.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTime time1 = new DateTime(2008, 6, 19, 7, 0, 0);     // Kind is DateTimeKind.Unspecified\ntry\n{\n   DateTimeOffset time2 = new DateTimeOffset(time1, \n                  TimeZoneInfo.FindSystemTimeZoneById(&quot;Central Standard Time&quot;).GetUtcOffset(time1)); \n   Console.WriteLine(&quot;Converted {0} {1} to a DateTime value of {2}&quot;, \n                     time1, \n                     time1.Kind.ToString(), \n                     time2);\n}\n// Handle exception if time zone is not defined in registry\ncatch (TimeZoneNotFoundException)\n{\n   Console.WriteLine(&quot;Unable to identify target time zone for conversion.&quot;);\n}\n// This example displays the following output to the console:\n//    Converted 6/19/2008 7:00:00 AM Unspecified to a DateTime value of 6/19/2008 7:00:00 AM -05:00\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim time1 As Date = #06/19/2008 7:00AM#      &#39; Kind is DateTimeKind.Unspecified\nTry\n   Dim time2 As New DateTimeOffset(time1, _\n                    TimeZoneInfo.FindSystemTimeZoneById(&quot;Central Standard Time&quot;).GetUtcOffset(time1)) \n   Console.WriteLine(&quot;Converted {0} {1} to a DateTime value of {2}&quot;, _\n                     time1, _\n                     time1.Kind.ToString(), _\n                     time2)\n&#39; Handle exception if time zone is not defined in registry\nCatch e As TimeZoneNotFoundException\n   Console.WriteLine(&quot;Unable to identify target time zone for conversion.&quot;)\nEnd Try\n&#39; This example displays the following output to the console:\n&#39;    Converted 6/19/2008 7:00:00 AM Unspecified to a DateTime value of 6/19/2008 7:00:00 AM -05:00\n</code></pre><p>The second parameter to this constructor overload, a <a class=\"xref\" href=\"../../../api/system.timespan\" data-linktype=\"relative-path\">System.TimeSpan</a> object that represents the time&#39;s offset from UTC, should be retrieved by calling the <a class=\"xref\" href=\"../../../api/system.timezoneinfo\" data-linktype=\"relative-path\">TimeZoneInfo.GetUtcOffset(DateTime)</a> method of the time&#39;s corresponding time zone. The method&#39;s single parameter is the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value that represents the date and time to be converted. If the time zone supports daylight saving time, this parameter allows the method to determine the appropriate offset for that particular date and time.</p>\n<h2 id=\"conversions-from-datetimeoffset-to-datetime\">Conversions from DateTimeOffset to DateTime</h2>\n<p>The <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> property is most commonly used to perform <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> to <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> conversion. However, it returns a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value whose <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property is <a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Unspecified\" data-linktype=\"relative-path\">DateTimeKind.Unspecified</a>, as the following example illustrates. </p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTime baseTime = new DateTime(2008, 6, 19, 7, 0, 0);\nDateTimeOffset sourceTime;\nDateTime targetTime;\n\n// Convert UTC to DateTime value\nsourceTime = new DateTimeOffset(baseTime, TimeSpan.Zero);\ntargetTime = sourceTime.DateTime;\nConsole.WriteLine(&quot;{0} converts to {1} {2}&quot;, \n                  sourceTime, \n                  targetTime, \n                  targetTime.Kind.ToString());\n\n// Convert local time to DateTime value\nsourceTime = new DateTimeOffset(baseTime, \n                                TimeZoneInfo.Local.GetUtcOffset(baseTime));\ntargetTime = sourceTime.DateTime;\nConsole.WriteLine(&quot;{0} converts to {1} {2}&quot;, \n                  sourceTime, \n                  targetTime, \n                  targetTime.Kind.ToString());\n\n// Convert Central Standard Time to a DateTime value\ntry\n{\n   TimeSpan offset = TimeZoneInfo.FindSystemTimeZoneById(&quot;Central Standard Time&quot;).GetUtcOffset(baseTime);\n   sourceTime = new DateTimeOffset(baseTime, offset);\n   targetTime = sourceTime.DateTime;\n   Console.WriteLine(&quot;{0} converts to {1} {2}&quot;, \n                     sourceTime, \n                     targetTime, \n                     targetTime.Kind.ToString());\n}\ncatch (TimeZoneNotFoundException)\n{\n   Console.WriteLine(&quot;Unable to create DateTimeOffset based on U.S. Central Standard Time.&quot;);\n} \n// This example displays the following output to the console:\n//    6/19/2008 7:00:00 AM +00:00 converts to 6/19/2008 7:00:00 AM Unspecified\n//    6/19/2008 7:00:00 AM -07:00 converts to 6/19/2008 7:00:00 AM Unspecified\n//    6/19/2008 7:00:00 AM -05:00 converts to 6/19/2008 7:00:00 AM Unspecified \n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Const baseTime As Date = #06/19/2008 7:00AM#\nDim sourceTime As DateTimeOffset\nDim targetTime As Date\n\n&#39; Convert UTC to DateTime value\nsourceTime = New DateTimeOffset(baseTime, TimeSpan.Zero)\ntargetTime = sourceTime.DateTime\nConsole.WriteLine(&quot;{0} converts to {1} {2}&quot;, _\n                  sourceTime, _\n                  targetTime, _\n                  targetTime.Kind.ToString())\n\n&#39; Convert local time to DateTime value\nsourceTime = New DateTimeOffset(baseTime, _\n                                TimeZoneInfo.Local.GetUtcOffset(baseTime))\ntargetTime = sourceTime.DateTime\nConsole.WriteLine(&quot;{0} converts to {1} {2}&quot;, _\n                  sourceTime, _\n                  targetTime, _\n                  targetTime.Kind.ToString())\n\n&#39; Convert Central Standard Time to a DateTime value\nTry\n   Dim offset As TimeSpan = TimeZoneInfo.FindSystemTimeZoneById(&quot;Central Standard Time&quot;).GetUtcOffset(baseTime)\n   sourceTime = New DateTimeOffset(baseTime, offset)\n   targetTime = sourceTime.DateTime\nConsole.WriteLine(&quot;{0} converts to {1} {2}&quot;, _\n                  sourceTime, _\n                  targetTime, _\n                  targetTime.Kind.ToString())\nCatch e As TimeZoneNotFoundException\n   Console.WriteLine(&quot;Unable to create DateTimeOffset based on U.S. Central Standard Time.&quot;)\nEnd Try \n&#39; This example displays the following output to the console:\n&#39;    6/19/2008 7:00:00 AM +00:00 converts to 6/19/2008 7:00:00 AM Unspecified\n&#39;    6/19/2008 7:00:00 AM -07:00 converts to 6/19/2008 7:00:00 AM Unspecified\n&#39;    6/19/2008 7:00:00 AM -05:00 converts to 6/19/2008 7:00:00 AM Unspecified \n</code></pre><p>This means that any information about the <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value&#39;s relationship to UTC is lost by the conversion when the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> property is used. This affects <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> values that correspond to UTC time or to the system&#39;s local time because the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> structure reflects only those two time zones in its <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property.</p>\n<p>To preserve as much time zone information as possible when converting a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> to a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value, you can use the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_UtcDateTime\" data-linktype=\"relative-path\">DateTimeOffset.UtcDateTime</a> and <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_LocalDateTime\" data-linktype=\"relative-path\">DateTimeOffset.LocalDateTime</a> properties. </p>\n<h2 id=\"converting-a-utc-time\">Converting a UTC Time</h2>\n<p>To indicate that a converted <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value is the UTC time, you can retrieve the value of the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_UtcDateTime\" data-linktype=\"relative-path\">DateTimeOffset.UtcDateTime</a> property. It differs from the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_DateTime\" data-linktype=\"relative-path\">DateTimeOffset.DateTime</a> property in two ways:</p>\n<ul>\n<li><p>It returns a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value whose <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property is <a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Utc\" data-linktype=\"relative-path\">DateTimeKind.Utc</a>.</p>\n</li>\n<li><p>If the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_Offset\" data-linktype=\"relative-path\">DateTimeOffset.Offset</a> property value does not equal <a class=\"xref\" href=\"../../../api/system.timespan#System_TimeSpan_Zero\" data-linktype=\"relative-path\">TimeSpan.Zero</a>, it converts the time to UTC.</p>\n</li>\n</ul>\n<div class=\"NOTE\"><h5>Note</h5><p>If your application requires that converted <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> values unambiguously identify a single point in time, you should consider using the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_UtcDateTime\" data-linktype=\"relative-path\">DateTimeOffset.UtcDateTime</a> property to handle all <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> to <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> conversions.</p>\n</div>\n<p>The following code uses the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_UtcDateTime\" data-linktype=\"relative-path\">UtcDateTime</a> property to convert a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value whose offset equals <a class=\"xref\" href=\"../../../api/system.timespan#System_TimeSpan_Zero\" data-linktype=\"relative-path\">TimeSpan.Zero</a> to a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTimeOffset utcTime1 = new DateTimeOffset(2008, 6, 19, 7, 0, 0, TimeSpan.Zero);\nDateTime utcTime2 = utcTime1.UtcDateTime;\nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, \n                  utcTime1, \n                  utcTime2, \n                  utcTime2.Kind.ToString());\n// The example displays the following output to the console:\n//   6/19/2008 7:00:00 AM +00:00 converted to 6/19/2008 7:00:00 AM Utc\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim utcTime1 As New DateTimeOffset(#06/19/2008 7:00AM#, TimeSpan.Zero)\nDim utcTime2 As Date = utcTime1.UtcDateTime\nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, _\n                  utcTime1, _\n                  utcTime2, _\n                  utcTime2.Kind.ToString())\n&#39; The example displays the following output to the console:\n&#39;   6/19/2008 7:00:00 AM +00:00 converted to 6/19/2008 7:00:00 AM Utc\n</code></pre><p>The following code uses the UtcDateTime property to perform both a time zone conversion and a type conversion on a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTimeOffset originalTime = new DateTimeOffset(2008, 6, 19, 7, 0, 0, new TimeSpan(5, 0, 0));\nDateTime utcTime = originalTime.UtcDateTime;\nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, \n                  originalTime, \n                  utcTime, \n                  utcTime.Kind.ToString());\n// The example displays the following output to the console:\n//       6/19/2008 7:00:00 AM +05:00 converted to 6/19/2008 2:00:00 AM Utc\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim originalTime As New DateTimeOffset(#6/19/2008 7:00AM#, _\n                                       New TimeSpan(5, 0, 0))\nDim utcTime As Date = originalTime.UtcDateTime\nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, _ \n                  originalTime, _\n                  utcTime, _\n                  utcTime.Kind.ToString())\n&#39; The example displays the following output to the console:\n&#39;       6/19/2008 7:00:00 AM +05:00 converted to 6/19/2008 2:00:00 AM Utc\n</code></pre><h2 id=\"converting-a-local-time\">Converting a Local Time</h2>\n<p>To indicate that a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value represents the local time, you can pass the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value returned by the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_DateTime\" data-linktype=\"relative-path\">DateTimeOffset.DateTime</a> property to the static <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_SpecifyKind_System_DateTime_System_DateTimeKind_\" data-linktype=\"relative-path\">DateTime.SpecifyKind(DateTime, DateTimeKind)</a> method. The method returns the date and time passed to it as its first parameter, but sets the <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property to the value specified by its second parameter. The following code uses the <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_SpecifyKind_System_DateTime_System_DateTimeKind_\" data-linktype=\"relative-path\">SpecifyKind(DateTime, DateTimeKind)</a> method when converting a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value whose offset corresponds to that of the local time zone.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTime sourceDate = new DateTime(2008, 6, 19, 7, 0, 0);\nDateTimeOffset utcTime1 = new DateTimeOffset(sourceDate, \n                          TimeZoneInfo.Local.GetUtcOffset(sourceDate));\nDateTime utcTime2 = utcTime1.DateTime;\nif (utcTime1.Offset.Equals(TimeZoneInfo.Local.GetUtcOffset(utcTime1.DateTime))) \n   utcTime2 = DateTime.SpecifyKind(utcTime2, DateTimeKind.Local);\n\nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, \n                  utcTime1, \n                  utcTime2, \n                  utcTime2.Kind.ToString());\n// The example displays the following output to the console:\n//   6/19/2008 7:00:00 AM -07:00 converted to 6/19/2008 7:00:00 AM Local\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim sourceDate As Date = #06/19/2008 7:00AM#\nDim utcTime1 As New DateTimeOffset(sourceDate, _\n                                   TimeZoneInfo.Local.GetUtcOffset(sourceDate))\nDim utcTime2 As Date = utcTime1.DateTime\nIf utcTime1.Offset.Equals(TimeZoneInfo.Local.GetUtcOffset(utcTime1.DateTime)) Then\n   utcTime2 = DateTime.SpecifyKind(utcTime2, DateTimeKind.Local)\nEnd If   \nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, _\n                  utcTime1, _\n                  utcTime2, _\n                  utcTime2.Kind.ToString())\n&#39; The example displays the following output to the console:\n&#39;   6/19/2008 7:00:00 AM -07:00 converted to 6/19/2008 7:00:00 AM Local\n</code></pre><p>You can also use the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_LocalDateTime\" data-linktype=\"relative-path\">DateTimeOffset.LocalDateTime</a> property to convert a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value to a local <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value. The <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property of the returned <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value is <a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Local\" data-linktype=\"relative-path\">DateTimeKind.Local</a>. The following code uses the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_LocalDateTime\" data-linktype=\"relative-path\">DateTimeOffset.LocalDateTime</a> property when converting a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value whose offset corresponds to that of the local time zone.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTime sourceDate = new DateTime(2008, 6, 19, 7, 0, 0);\nDateTimeOffset localTime1 = new DateTimeOffset(sourceDate, \n                          TimeZoneInfo.Local.GetUtcOffset(sourceDate));\nDateTime localTime2 = localTime1.LocalDateTime;\n\nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, \n                  localTime1, \n                  localTime2, \n                  localTime2.Kind.ToString());\n// The example displays the following output to the console:\n//   6/19/2008 7:00:00 AM -07:00 converted to 6/19/2008 7:00:00 AM Local\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim sourceDate As Date = #06/19/2008 7:00AM#\nDim localTime1 As New DateTimeOffset(sourceDate, _\n                                   TimeZoneInfo.Local.GetUtcOffset(sourceDate))\nDim localTime2 As Date = localTime1.LocalDateTime\nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, _\n                  localTime1, _\n                  localTime2, _\n                  localTime2.Kind.ToString())\n&#39; The example displays the following output to the console:\n&#39;   6/19/2008 7:00:00 AM -07:00 converted to 6/19/2008 7:00:00 AM Local \n</code></pre><p>When you retrieve a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value using the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_LocalDateTime\" data-linktype=\"relative-path\">DateTimeOffset.LocalDateTime</a> property, the property&#39;s <code>get</code> accessor first converts the <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value to UTC, then converts it to local time by calling the <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset.ToLocalTime</a> method. This means that you can retrieve a value from the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_LocalDateTime\" data-linktype=\"relative-path\">DateTimeOffset.LocalDateTime</a> property to perform a time zone conversion at the same time that you perform a type conversion. It also means that the local time zone&#39;s adjustment rules are applied in performing the conversion. The following code illustrates the use of the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_LocalDateTime\" data-linktype=\"relative-path\">DateTimeOffset.LocalDateTime</a> property to perform both a type and a time zone conversion.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTimeOffset originalDate;\nDateTime localDate;\n\n// Convert time originating in a different time zone\noriginalDate = new DateTimeOffset(2008, 6, 18, 7, 0, 0, \n                                  new TimeSpan(-5, 0, 0));\nlocalDate = originalDate.LocalDateTime;\nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, \n                  originalDate, \n                  localDate, \n                  localDate.Kind.ToString());\n// Convert time originating in a different time zone \n// so local time zone&#39;s adjustment rules are applied\noriginalDate = new DateTimeOffset(2007, 11, 4, 4, 0, 0, \n                                  new TimeSpan(-5, 0, 0));\nlocalDate = originalDate.LocalDateTime;\nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, \n                  originalDate, \n                  localDate, \n                  localDate.Kind.ToString());\n// The example displays the following output to the console:\n//       6/19/2008 7:00:00 AM -05:00 converted to 6/19/2008 5:00:00 AM Local\n//       11/4/2007 4:00:00 AM -05:00 converted to 11/4/2007 1:00:00 AM Local\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim originalDate As DateTimeOffset\nDim localDate As Date\n\n&#39; Convert time originating in a different time zone\noriginalDate = New DateTimeOffset(#06/19/2008 7:00AM#, _\n                                  New TimeSpan(-5, 0, 0))\nlocalDate = originalDate.LocalDateTime\nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, _\n                  originalDate, _\n                  localDate, _\n                  localDate.Kind.ToString())\n&#39; Convert time originating in a different time zone \n&#39; so local time zone&#39;s adjustment rules are applied\noriginalDate = New DateTimeOffset(#11/04/2007 4:00AM#, _\n                                  New TimeSpan(-5, 0, 0))\nlocalDate = originalDate.LocalDateTime\nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, _\n                  originalDate, _\n                  localDate, _\n                  localDate.Kind.ToString())\n&#39; The example displays the following output to the console:\n&#39;       6/19/2008 7:00:00 AM -05:00 converted to 6/19/2008 5:00:00 AM Local\n&#39;       11/4/2007 4:00:00 AM -05:00 converted to 11/4/2007 1:00:00 AM Local\n</code></pre><h2 id=\"a-general-purpose-conversion-method\">A General-Purpose Conversion Method</h2>\n<p>The following example defines a method named <code>ConvertFromDateTimeOffset</code> that converts <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> values to <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> values. Based on its offset, it determines whether the <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> value is a UTC time, a local time, or some other time, and defines the returned date and time value&#39;s <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property accordingly. </p>\n<pre class=\"loading\"><code class=\"lang-csharp\">static DateTime ConvertFromDateTimeOffset(DateTimeOffset dateTime)\n{\n   if (dateTime.Offset.Equals(TimeSpan.Zero))\n      return dateTime.UtcDateTime;\n   else if (dateTime.Offset.Equals(TimeZoneInfo.Local.GetUtcOffset(dateTime.DateTime)))\n      return DateTime.SpecifyKind(dateTime.DateTime, DateTimeKind.Local);\n   else\n      return dateTime.DateTime;   \n}\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Function ConvertFromDateTimeOffset(dateTime As DateTimeOffset) As Date\n   If dateTime.Offset.Equals(TimeSpan.Zero) Then\n      Return dateTime.UtcDateTime\n   ElseIf dateTime.Offset.Equals(TimeZoneInfo.Local.GetUtcOffset(dateTime.DateTime))\n      Return Date.SpecifyKind(dateTime.DateTime, DateTimeKind.Local)\n   Else\n      Return dateTime.DateTime   \n   End If\n</code></pre><p>The follow example calls the <code>ConvertFromDateTimeOffset</code> method to convert <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> values that represent a UTC time, a local time, and a time in the U.S. Central Standard Time zone.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTime timeComponent = new DateTime(2008, 6, 19, 7, 0, 0);\nDateTime returnedDate; \n\n// Convert UTC time\nDateTimeOffset utcTime = new DateTimeOffset(timeComponent, TimeSpan.Zero);\nreturnedDate = ConvertFromDateTimeOffset(utcTime); \nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, \n                  utcTime, \n                  returnedDate, \n                  returnedDate.Kind.ToString());\n\n// Convert local time\nDateTimeOffset localTime = new DateTimeOffset(timeComponent, \n                           TimeZoneInfo.Local.GetUtcOffset(timeComponent)); \nreturnedDate = ConvertFromDateTimeOffset(localTime);                                          \nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, \n                  localTime, \n                  returnedDate, \n                  returnedDate.Kind.ToString());\n\n// Convert Central Standard Time\nDateTimeOffset cstTime = new DateTimeOffset(timeComponent, \n               TimeZoneInfo.FindSystemTimeZoneById(&quot;Central Standard Time&quot;).GetUtcOffset(timeComponent));\nreturnedDate = ConvertFromDateTimeOffset(cstTime);\nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, \n                  cstTime, \n                  returnedDate, \n                  returnedDate.Kind.ToString());\n// The example displays the following output to the console:\n//    6/19/2008 7:00:00 AM +00:00 converted to 6/19/2008 7:00:00 AM Utc\n//    6/19/2008 7:00:00 AM -07:00 converted to 6/19/2008 7:00:00 AM Local\n//    6/19/2008 7:00:00 AM -05:00 converted to 6/19/2008 7:00:00 AM Unspecified\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim timeComponent As Date = #06/19/2008 7:00AM#\nDim returnedDate As Date \n\n&#39; Convert UTC time\nDim utcTime As New DateTimeOffset(timeComponent, TimeSpan.Zero)\nreturnedDate = ConvertFromDateTimeOffset(utcTime) \nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, _\n                  utcTime, _\n                  returnedDate, _\n                  returnedDate.Kind.ToString())\n\n&#39; Convert local time\nDim localTime As New DateTimeOffset(timeComponent, _\n                                    TimeZoneInfo.Local.GetUtcOffset(timeComponent)) \nreturnedDate = ConvertFromDateTimeOffset(localTime)                                                                  \nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, _\n                  localTime, _\n                  returnedDate, _\n                  returnedDate.Kind.ToString())\n\n&#39; Convert Central Standard Time\nDim cstTime As New DateTimeOffset(timeComponent, _\n               TimeZoneInfo.FindSystemTimeZoneById(&quot;Central Standard Time&quot;).GetUtcOffset(timeComponent))\nreturnedDate = ConvertFromDateTimeOffset(cstTime)                                                                  \nConsole.WriteLine(&quot;{0} converted to {1} {2}&quot;, _\n                  cstTime, _\n                  returnedDate, _\n                  returnedDate.Kind.ToString())\n&#39; The example displays the following output to the console:\n&#39;    6/19/2008 7:00:00 AM +00:00 converted to 6/19/2008 7:00:00 AM Utc\n&#39;    6/19/2008 7:00:00 AM -07:00 converted to 6/19/2008 7:00:00 AM Local\n&#39;    6/19/2008 7:00:00 AM -05:00 converted to 6/19/2008 7:00:00 AM Unspecified\n</code></pre><p>Note that this code makes two assumptions that, depending on the application and the source of its date and time values, may not always be valid:</p>\n<ul>\n<li><p>It assumes that a date and time value whose offset is <a class=\"xref\" href=\"../../../api/system.timespan#System_TimeSpan_Zero\" data-linktype=\"relative-path\">TimeSpan.Zero</a> represents UTC. In fact, UTC is not a time in a particular time zone, but the time in relation to which the times in the world&#39;s time zones are standardized. Time zones can also have an offset of <a class=\"xref\" href=\"../../../api/system.timespan#System_TimeSpan_Zero\" data-linktype=\"relative-path\">Zero</a>.</p>\n</li>\n<li><p>It assumes that a date and time whose offset equals that of the local time zone represents the local time zone. Because date and time values are disassociated from their original time zone, this may not be the case; the date and time can have originated in another time zone with the same offset.</p>\n</li>\n</ul>\n<h2 id=\"see-also\">See Also</h2>\n<p><a href=\"index\" data-linktype=\"relative-path\">Dates, times, and time zones</a></p>\n</div></div>","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"toc2.json\">\r\n<meta name=\"ms.devlang\" content=\"dotnet\">\r\n<meta name=\"ms.assetid\" content=\"fab3af5b-5d0f-4384-a40a-1b5d99b30dd1\">\r\n<meta name=\"description\" content=\"Converting between DateTime and DateTimeOffset\">\r\n<meta name=\"keywords\" content=\".NET, .NET Core\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"08/15/2016\">\r\n<meta name=\"ms.technology\" content=\"dotnet-standard\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/standard/datetime/converting-between-datetime-and-offset.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/standard/datetime/converting-between-datetime-and-offset.md\">\r\n<meta name=\"document_id\" content=\"ed7e3a84-de72-1d8a-8b95-53914bd764a6\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Converting between DateTime and DateTimeOffset | Microsoft Docs","ms.devlang":"dotnet","ms.assetid":"fab3af5b-5d0f-4384-a40a-1b5d99b30dd1","description":"Converting between DateTime and DateTimeOffset","keywords":".NET, .NET Core","ms.topic":"article","ms.date":"08/15/2016","ms.technology":"dotnet-standard","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Porting date and time topics from MSDN (#992)","commit_sha":"c40c28da09e8a122b542463c197196c82c81dd19","commit_date":"2016-09-06 10:55:51 -0700"},{"author_name":"Maira Wenzel","author_email":"mairaw@users.noreply.github.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Revert \"Bringing back essentials topics\" (#661)","commit_sha":"6d10e1507a2a8040743da29184fa4981ddbf7af3","commit_date":"2016-06-26 17:59:39 -0700"},{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Bringing back essentials topics (#659)","commit_sha":"5f3ebe05f34a44b449412c6334e47a9861b36c79","commit_date":"2016-06-26 17:27:32 -0700"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/standard/datetime/converting-between-datetime-and-offset.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/standard/datetime/converting-between-datetime-and-offset.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/standard/datetime/converting-between-datetime-and-offset.md","document_id":"ed7e3a84-de72-1d8a-8b95-53914bd764a6","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/standard/datetime/converting-between-datetime-and-offset","toc_asset_id":"articles/toc.json","toc_rel":"../../toc.json","_op_ogTitle":"Converting between DateTime and DateTimeOffset","_op_displayDate":"2016-8-15","_op_displayDate_source":"2016-08-15T00:00:00Z","_op_wordCount":2841,"_op_rawTitle":"<h1 id=\"converting-between-datetime-and-datetimeoffset\" sourcefile=\"docs/standard/datetime/converting-between-datetime-and-offset.md\" sourcestartlinenumber=\"15\" sourceendlinenumber=\"15\">Converting between DateTime and DateTimeOffset</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/standard/datetime/converting-between-datetime-and-offset","fileRelativePath":"articles/standard/datetime/converting-between-datetime-and-offset.html"},"themesRelativePathToOutputRoot":"_themes/"}