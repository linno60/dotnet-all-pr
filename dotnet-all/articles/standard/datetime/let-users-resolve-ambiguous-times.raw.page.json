{"content":"<div><div class=\"content\">\n<p>An ambiguous time is a time that maps to more than one Coordinated Universal Time (UTC). It occurs when the clock time is adjusted back in time, such as during the transition from a time zone&#39;s daylight saving time to its standard time. When handling an ambiguous time, you can do one of the following:</p>\n<ul>\n<li><p>If the ambiguous time is an item of data entered by the user, you can leave it to the user to resolve the ambiguity.</p>\n</li>\n<li><p>Make an assumption about how the time maps to UTC. For example, you can assume that an ambiguous time is always expressed in the time zone&#39;s standard time.</p>\n</li>\n</ul>\n<p>This article shows how to let a user resolve an ambiguous time.</p>\n<h2 id=\"to-let-a-user-resolve-an-ambiguous-time\">To let a user resolve an ambiguous time</h2>\n<ol>\n<li><p>Get the date and time input by the user.</p>\n</li>\n<li><p>Call the <a class=\"xref\" href=\"../../../api/system.timezoneinfo#System_TimeZoneInfo_IsAmbiguousTime_System_DateTime_\" data-linktype=\"relative-path\">IsAmbiguousTime(DateTime)</a> or <a class=\"xref\" href=\"../../../api/system.timezoneinfo#System_TimeZoneInfo_IsAmbiguousTime_System_DateTimeOffset_\" data-linktype=\"relative-path\">IsAmbiguousTime(DateTimeOffset)</a> method to determine whether the time is ambiguous.</p>\n</li>\n<li><p>Let the user select the desired offset.</p>\n</li>\n<li><p>Get the UTC date and time by subtracting the offset selected by the user from the local time.</p>\n</li>\n<li><p>Call the <code>static</code> (<code>Shared</code> in Visual Basic ) <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_SpecifyKind_System_DateTime_System_DateTimeKind_\" data-linktype=\"relative-path\">SpecifyKind</a> method to set the UTC date and time value&#39;s <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property to <a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Utc\" data-linktype=\"relative-path\">DateTimeKind.Utc</a>.</p>\n</li>\n</ol>\n<h2 id=\"example\">Example</h2>\n<p>The following example prompts the user to enter a date and time and, if it is ambiguous, lets the user select the UTC time that the ambiguous time maps to. The example uses a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> object; you can substitute a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> object if desired.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">private void GetUserDateInput()\n{\n   // Get date and time from user\n   DateTime inputDate = GetUserDateTime();\n   DateTime utcDate;\n\n   // Exit if date has no significant value\n   if (inputDate == DateTime.MinValue) return;\n\n   if (TimeZoneInfo.Local.IsAmbiguousTime(inputDate))\n   {\n      Console.WriteLine(&quot;The date you&#39;ve entered is ambiguous.&quot;);\n      Console.WriteLine(&quot;Please select the correct offset from Universal Coordinated Time:&quot;);\n      TimeSpan[] offsets = TimeZoneInfo.Local.GetAmbiguousTimeOffsets(inputDate);\n      for (int ctr = 0; ctr &lt; offsets.Length; ctr++)\n      {\n         Console.WriteLine(&quot;{0}.) {1} hours, {2} minutes&quot;, ctr, offsets[ctr].Hours, offsets[ctr].Minutes);\n      }\n      Console.Write(&quot;&gt; &quot;);\n      int selection = Convert.ToInt32(Console.ReadLine());\n\n      // Convert local time to UTC, and set Kind property to DateTimeKind.Utc\n      utcDate = DateTime.SpecifyKind(inputDate - offsets[selection], DateTimeKind.Utc);\n\n      Console.WriteLine(&quot;{0} local time corresponds to {1} {2}.&quot;, inputDate, utcDate, utcDate.Kind.ToString());\n   }\n   else\n   {\n      utcDate = inputDate.ToUniversalTime();\n      Console.WriteLine(&quot;{0} local time corresponds to {1} {2}.&quot;, inputDate, utcDate, utcDate.Kind.ToString());    \n   }\n}\n\nprivate DateTime GetUserDateTime() \n{\n   bool exitFlag = false;             // flag to exit loop if date is valid\n   string dateString;  \n   DateTime inputDate = DateTime.MinValue;\n\n   Console.Write(&quot;Enter a local date and time: &quot;);\n   while (! exitFlag)\n   {\n      dateString = Console.ReadLine();\n      if (dateString.ToUpper() == &quot;E&quot;)\n         exitFlag = true;\n\n      if (DateTime.TryParse(dateString, out inputDate))\n         exitFlag = true;\n      else\n         Console.Write(&quot;Enter a valid date and time, or enter &#39;e&#39; to exit: &quot;);\n   }\n\n   return inputDate;        \n}\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Private Sub GetUserDateInput()\n   &#39; Get date and time from user\n   Dim inputDate As Date = GetUserDateTime()\n   Dim utcDate As Date\n\n   &#39; Exit if date has no significant value\n   If inputDate = Date.MinValue Then Exit Sub\n\n   If TimeZoneInfo.Local.IsAmbiguousTime(inputDate) Then\n      Console.WriteLine(&quot;The date you&#39;ve entered is ambiguous.&quot;)\n      Console.WriteLine(&quot;Please select the correct offset from Universal Coordinated Time:&quot;)\n      Dim offsets() As TimeSpan = TimeZoneInfo.Local.GetAmbiguousTimeOffsets(inputDate)\n      For ctr As Integer = 0 to offsets.Length - 1\n         Dim zoneDescription As String\n         If offsets(ctr).Equals(TimeZoneInfo.Local.BaseUtcOffset) Then \n            zoneDescription = TimeZoneInfo.Local.StandardName\n         Else\n            zoneDescription = TimeZoneInfo.Local.DaylightName\n         End If\n         Console.WriteLine(&quot;{0}.) {1} hours, {2} minutes ({3})&quot;, _\n                           ctr, offsets(ctr).Hours, offsets(ctr).Minutes, zoneDescription)\n      Next         \n      Console.Write(&quot;&gt; &quot;)\n      Dim selection As Integer = CInt(Console.ReadLine())\n\n      &#39; Convert local time to UTC, and set Kind property to DateTimeKind.Utc\n      utcDate = Date.SpecifyKind(inputDate - offsets(selection), DateTimeKind.Utc)\n\n      Console.WriteLine(&quot;{0} local time corresponds to {1} {2}.&quot;, inputDate, utcDate, utcDate.Kind.ToString())\n   Else\n      utcDate = inputDate.ToUniversalTime()\n      Console.WriteLine(&quot;{0} local time corresponds to {1} {2}.&quot;, inputDate, utcDate, utcDate.Kind.ToString())    \n   End If\nEnd Sub\n\nPrivate Function GetUserDateTime() As Date\n   Dim exitFlag As Boolean = False            &#39; flag to exit loop if date is valid\n   Dim dateString As String \n   Dim inputDate As Date = Date.MinValue\n\n   Console.Write(&quot;Enter a local date and time: &quot;)\n   Do While Not exitFlag\n      dateString = Console.ReadLine()\n      If dateString.ToUpper = &quot;E&quot; Then exitFlag = True\n      If Date.TryParse(dateString, inputDate) Then\n         exitFlag = true\n      Else   \n         Console.Write(&quot;Enter a valid date and time, or enter &#39;e&#39; to exit: &quot;)\n      End If\n   Loop\n\n   Return inputDate        \nEnd Function\n</code></pre><p>The core of the example code uses an array of <a class=\"xref\" href=\"../../../api/system.timespan\" data-linktype=\"relative-path\">TimeSpan</a> objects to indicate possible offsets of the ambiguous time from UTC. However, these offsets are unlikely to be meaningful to the user. To clarify the meaning of the offsets, the code also notes whether an offset represents the local time zone&#39;s standard time or its daylight saving time. The code determines which time is standard and which time is daylight by comparing the offset with the value of the <a class=\"xref\" href=\"../../../api/system.timezoneinfo#System_TimeZoneInfo_BaseUtcOffset\" data-linktype=\"relative-path\">BaseUtcOffset</a> property. This property indicates the difference between the UTC and the time zone&#39;s standard time.</p>\n<p>In this example, all references to the local time zone are made through the <a class=\"xref\" href=\"../../../api/system.timezoneinfo#System_TimeZoneInfo_Local\" data-linktype=\"relative-path\">TimeZoneInfo.Local</a> property; the local time zone is never assigned to an object variable. This is a recommended practice because another call could clear the cached data and invalidate any objects that the local time zone is assigned to.</p>\n<h2 id=\"see-also\">See Also</h2>\n<p><a href=\"index\" data-linktype=\"relative-path\">Dates, times, and time zones</a></p>\n<p><a href=\"resolve-ambiguous-times\" data-linktype=\"relative-path\">How to: resolve ambiguous times</a></p>\n</div></div>","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"toc2.json\">\r\n<meta name=\"ms.devlang\" content=\"dotnet\">\r\n<meta name=\"ms.assetid\" content=\"d6858a5c-02ab-4367-9e08-fa22c051c38d\">\r\n<meta name=\"description\" content=\"How to let users resolve ambiguous times\">\r\n<meta name=\"keywords\" content=\".NET, .NET Core\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"08/15/2016\">\r\n<meta name=\"ms.technology\" content=\"dotnet-standard\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/standard/datetime/let-users-resolve-ambiguous-times.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/standard/datetime/let-users-resolve-ambiguous-times.md\">\r\n<meta name=\"document_id\" content=\"8e725af2-03db-9734-9148-8f16d7ec5e3c\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","title":"How to: let users resolve ambiguous times | Microsoft Docs","ms.devlang":"dotnet","ms.assetid":"d6858a5c-02ab-4367-9e08-fa22c051c38d","description":"How to let users resolve ambiguous times","keywords":".NET, .NET Core","ms.topic":"article","ms.date":"08/15/2016","ms.technology":"dotnet-standard","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Porting date and time topics from MSDN (#992)","commit_sha":"c40c28da09e8a122b542463c197196c82c81dd19","commit_date":"2016-09-06 10:55:51 -0700"},{"author_name":"Maira Wenzel","author_email":"mairaw@users.noreply.github.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Revert \"Bringing back essentials topics\" (#661)","commit_sha":"6d10e1507a2a8040743da29184fa4981ddbf7af3","commit_date":"2016-06-26 17:59:39 -0700"},{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Bringing back essentials topics (#659)","commit_sha":"5f3ebe05f34a44b449412c6334e47a9861b36c79","commit_date":"2016-06-26 17:27:32 -0700"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/standard/datetime/let-users-resolve-ambiguous-times.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/standard/datetime/let-users-resolve-ambiguous-times.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/standard/datetime/let-users-resolve-ambiguous-times.md","document_id":"8e725af2-03db-9734-9148-8f16d7ec5e3c","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/standard/datetime/let-users-resolve-ambiguous-times","toc_asset_id":"articles/toc.json","toc_rel":"../../toc.json","_op_ogTitle":"How to: let users resolve ambiguous times","_op_displayDate":"2016-8-15","_op_displayDate_source":"2016-08-15T00:00:00Z","_op_wordCount":820,"_op_rawTitle":"<h1 id=\"how-to-let-users-resolve-ambiguous-times\" sourcefile=\"docs/standard/datetime/let-users-resolve-ambiguous-times.md\" sourcestartlinenumber=\"15\" sourceendlinenumber=\"15\">How to: let users resolve ambiguous times</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/standard/datetime/let-users-resolve-ambiguous-times","fileRelativePath":"articles/standard/datetime/let-users-resolve-ambiguous-times.html"},"themesRelativePathToOutputRoot":"_themes/"}