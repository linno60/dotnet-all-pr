{"content":"<div><div class=\"content\">\n<p>It is becoming increasingly important for any application that works with dates and times to handle differences between time zones. An application can no longer assume that all times can be expressed in the local time, which is the time available from the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">System.DateTime</a> structure. For example, a Web page that displays the current time in the eastern part of the United States will lack credibility to a customer in eastern Asia. This topic explains how to convert times from one time zone to another, as well as how to convert <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">System.DateTimeOffset</a> values that have limited time zone awareness.</p>\n<h2 id=\"converting-to-coordinated-universal-time\">Converting to Coordinated Universal Time</h2>\n<p>Coordinated Universal Time (UTC) is a high-precision, atomic time standard. The worldâ€™s time zones are expressed as positive or negative offsets from UTC. Thus, UTC provides a kind of time-zone free or time-zone neutral time. The use of UTC time is recommended when a date and time&#39;s portability across computers is important. Converting individual time zones to UTC makes time comparisons easy.</p>\n<div class=\"NOTE\"><h5>Note</h5><p>You can also serialize a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> structure to unambiguously represent a single point in time. Because <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> objects store a date and time value along with its offset from UTC, they always represent a particular point in time in relationship to UTC.</p>\n</div>\n<p>The easiest way to convert a time to UTC is to call the <code>static</code> (<code>Shared</code> in Visual Basic) <a href=\"https://msdn.microsoft.com/library/bb381744(v=vs.110).aspx\" data-linktype=\"external\">TimeZoneInfo.ConvertTimeToUtc(DateTime)</a> method. </p>\n<div class=\"IMPORTANT\"><h5>Important</h5><p>The <code>TimeZoneInfo.ConvertTimeToUtc(DateTime)</code> method isn&#39;t currently available in .NET Core. </p>\n</div>\n<p>The exact conversion performed by the method depends on the value of the <code>DateTime</code> parameter&#39;s <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property, as the following table shows.</p>\n<table>\n<thead>\n<tr>\n<th><a class=\"xref\" href=\"../../../api/system.datetimekind\" data-linktype=\"relative-path\">DateTime.Kind</a> property</th>\n<th>Conversion</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Local\" data-linktype=\"relative-path\">DateTimeKind.Local</a></td>\n<td>Converts local time to UTC.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Unspecified\" data-linktype=\"relative-path\">DateTimeKind.Unspecified</a></td>\n<td>Assumes the <code>DateTime</code> parameter is local time and converts local time to UTC.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Utc\" data-linktype=\"relative-path\">DateTimeKind.Utc</a></td>\n<td>Returns the <code>DateTime</code> parameter unchanged.</td>\n</tr>\n</tbody>\n</table>\n<p>The following code converts the current local time to UTC and displays the result to the console.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTime dateNow = DateTime.Now;\nConsole.WriteLine(&quot;The date and time are {0} UTC.&quot;, \n                   TimeZoneInfo.ConvertTimeToUtc(dateNow));\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim dateNow As Date = Date.Now      \nConsole.WriteLine(&quot;The date and time are {0} UTC.&quot;, _\n                  TimeZoneInfo.ConvertTimeToUtc(dateNow))\n</code></pre><div class=\"NOTE\"><h5>Note</h5><p>The <a href=\"https://msdn.microsoft.com/library/bb381744(v=vs.110).aspx\" data-linktype=\"external\">TimeZoneInfo.ConvertTimeToUtc(DateTime)</a> method does not necessarily produce results that are identical to the <a href=\"https://msdn.microsoft.com/library/System.TimeZone.ToUniversalTime(v=vs.110).aspx\" data-linktype=\"external\">TimeZone.ToUniversalTime</a> and <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_ToUniversalTime\" data-linktype=\"relative-path\">DateTime.ToUniversalTime</a> methods. If the host system&#39;s local time zone includes multiple adjustment rules, <a href=\"https://msdn.microsoft.com/library/System.TimeZone.ConvertTimeToUtc(v=vs.110).aspx\" data-linktype=\"external\">TimeZoneInfo.ConvertTimeToUtc(DateTime)</a> applies the appropriate rule to a particular date and time. The other two methods always apply the latest adjustment rule.</p>\n</div>\n<p>If the date and time value does not represent either the local time or UTC, the <a href=\"https://msdn.microsoft.com/library/System.TimeZone.ToUniversalTime(v=vs.110).aspx\" data-linktype=\"external\">ToUniversalTime</a> method will likely return an erroneous result. However, you can use the <a href=\"https://msdn.microsoft.com/library/bb381744(v=vs.110).aspx\" data-linktype=\"external\">TimeZoneInfo.ConvertTimeToUtc</a> method to convert the date and time from a specified time zone. (For details on retrieving a TimeZoneInfo object that represents the destination time zone, see <a href=\"finding-the-time-zones-on-local-system\" data-linktype=\"relative-path\">Finding the time zones defined on a local system</a>. The following code uses the <a href=\"https://msdn.microsoft.com/library/bb381744(v=vs.110).aspx\" data-linktype=\"external\">TimeZoneInfo.ConvertTimeToUtc</a> method to convert Eastern Standard Time to UTC.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTime easternTime = new DateTime(2007, 01, 02, 12, 16, 00);\nstring easternZoneId = &quot;Eastern Standard Time&quot;;\ntry\n{\n   TimeZoneInfo easternZone = TimeZoneInfo.FindSystemTimeZoneById(easternZoneId);\n   Console.WriteLine(&quot;The date and time are {0} UTC.&quot;, \n                     TimeZoneInfo.ConvertTimeToUtc(easternTime, easternZone));\n}\ncatch (TimeZoneNotFoundException)\n{\n   Console.WriteLine(&quot;Unable to find the {0} zone in the registry.&quot;, \n                     easternZoneId);\n}                           \ncatch (InvalidTimeZoneException)\n{\n   Console.WriteLine(&quot;Registry data on the {0} zone has been corrupted.&quot;, \n                     easternZoneId);\n}\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim easternTime As New Date(2007, 01, 02, 12, 16, 00)\nDim easternZoneId As String = &quot;Eastern Standard Time&quot;\nTry\n   Dim easternZone As TimeZoneInfo = TimeZoneInfo.FindSystemTimeZoneById(easternZoneId)\n   Console.WriteLine(&quot;The date and time are {0} UTC.&quot;, _ \n                     TimeZoneInfo.ConvertTimeToUtc(easternTime, easternZone))\nCatch e As TimeZoneNotFoundException\n   Console.WriteLine(&quot;Unable to find the {0} zone in the registry.&quot;, _\n                     easternZoneId)\nCatch e As InvalidTimeZoneException\n   Console.WriteLine(&quot;Registry data on the {0} zone has been corrupted.&quot;, _ \n                     easternZoneId)\nEnd Try    \n</code></pre><p>Note that this method throws an <a class=\"xref\" href=\"../../../api/system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a> if the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> object&#39;s <a class=\"xref\" href=\"../../../api/system.datetimekind\" data-linktype=\"relative-path\">Kind</a> property and the time zone are mismatched. A mismatch occurs if the Kind property is <a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Local\" data-linktype=\"relative-path\">DateTimeKind.Local</a> but the <a class=\"xref\" href=\"../../../api/system.timezoneinfo\" data-linktype=\"relative-path\">TimeZoneInfo</a> object does not represent the local time zone, or if the Kind property is <a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Utc\" data-linktype=\"relative-path\">DateTimeKind.Utc</a> but the <a class=\"xref\" href=\"../../../api/system.timezoneinfo\" data-linktype=\"relative-path\">TimeZoneInfo</a> object does not equal <a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Utc\" data-linktype=\"relative-path\">DateTimeKind.Utc</a>.</p>\n<p>All of these methods take <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> values as parameters and return a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value. For <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> values, the <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">DateTimeOffset</a> structure has a <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_ToUniversalTime\" data-linktype=\"relative-path\">ToUniversalTime</a> instance method that converts the date and time of the current instance to UTC. The following example calls the <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_ToUniversalTime\" data-linktype=\"relative-path\">ToUniversalTime</a> method to convert a local time and several other times to Coordinated Universal Time (UTC).</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTimeOffset localTime, otherTime, universalTime;\n\n// Define local time in local time zone\nlocalTime = new DateTimeOffset(new DateTime(2007, 6, 15, 12, 0, 0));\nConsole.WriteLine(&quot;Local time: {0}&quot;, localTime);\nConsole.WriteLine();\n\n// Convert local time to offset 0 and assign to otherTime\notherTime = localTime.ToOffset(TimeSpan.Zero);\nConsole.WriteLine(&quot;Other time: {0}&quot;, otherTime);\nConsole.WriteLine(&quot;{0} = {1}: {2}&quot;, \n                  localTime, otherTime, \n                  localTime.Equals(otherTime));\nConsole.WriteLine(&quot;{0} exactly equals {1}: {2}&quot;, \n                  localTime, otherTime, \n                  localTime.EqualsExact(otherTime));\nConsole.WriteLine();\n\n// Convert other time to UTC\nuniversalTime = localTime.ToUniversalTime(); \nConsole.WriteLine(&quot;Universal time: {0}&quot;, universalTime);\nConsole.WriteLine(&quot;{0} = {1}: {2}&quot;, \n                  otherTime, universalTime, \n                  universalTime.Equals(otherTime));\nConsole.WriteLine(&quot;{0} exactly equals {1}: {2}&quot;, \n                  otherTime, universalTime, \n                  universalTime.EqualsExact(otherTime));\nConsole.WriteLine();\n// The example produces the following output to the console:\n//    Local time: 6/15/2007 12:00:00 PM -07:00\n//    \n//    Other time: 6/15/2007 7:00:00 PM +00:00\n//    6/15/2007 12:00:00 PM -07:00 = 6/15/2007 7:00:00 PM +00:00: True\n//    6/15/2007 12:00:00 PM -07:00 exactly equals 6/15/2007 7:00:00 PM +00:00: False\n//    \n//    Universal time: 6/15/2007 7:00:00 PM +00:00\n//    6/15/2007 7:00:00 PM +00:00 = 6/15/2007 7:00:00 PM +00:00: True\n//    6/15/2007 7:00:00 PM +00:00 exactly equals 6/15/2007 7:00:00 PM +00:00: True \n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim localTime, otherTime, universalTime As DateTimeOffset\n\n&#39; Define local time in local time zone\nlocalTime = New DateTimeOffset(#6/15/2007 12:00:00PM#)\nConsole.WriteLine(&quot;Local time: {0}&quot;, localTime)\nConsole.WriteLine()\n\n&#39; Convert local time to offset 0 and assign to otherTime\notherTime = localTime.ToOffset(TimeSpan.Zero)\nConsole.WriteLine(&quot;Other time: {0}&quot;, otherTime)\nConsole.WriteLine(&quot;{0} = {1}: {2}&quot;, _\n                  localTime, otherTime, _\n                  localTime.Equals(otherTime))\nConsole.WriteLine(&quot;{0} exactly equals {1}: {2}&quot;, _ \n                  localTime, otherTime, _\n                  localTime.EqualsExact(otherTime))\nConsole.WriteLine()\n\n&#39; Convert other time to UTC\nuniversalTime = localTime.ToUniversalTime() \nConsole.WriteLine(&quot;Universal time: {0}&quot;, universalTime)\nConsole.WriteLine(&quot;{0} = {1}: {2}&quot;, _\n                  otherTime, universalTime, _ \n                  universalTime.Equals(otherTime))\nConsole.WriteLine(&quot;{0} exactly equals {1}: {2}&quot;, _ \n                  otherTime, universalTime, _\n                  universalTime.EqualsExact(otherTime))\nConsole.WriteLine()\n&#39; The example produces the following output to the console:\n&#39;    Local time: 6/15/2007 12:00:00 PM -07:00\n&#39;    \n&#39;    Other time: 6/15/2007 7:00:00 PM +00:00\n&#39;    6/15/2007 12:00:00 PM -07:00 = 6/15/2007 7:00:00 PM +00:00: True\n&#39;    6/15/2007 12:00:00 PM -07:00 exactly equals 6/15/2007 7:00:00 PM +00:00: False\n&#39;    \n&#39;    Universal time: 6/15/2007 7:00:00 PM +00:00\n&#39;    6/15/2007 7:00:00 PM +00:00 = 6/15/2007 7:00:00 PM +00:00: True\n&#39;    6/15/2007 7:00:00 PM +00:00 exactly equals 6/15/2007 7:00:00 PM +00:00: True \n</code></pre><h2 id=\"converting-utc-to-a-designated-time-zone\">Converting UTC to a designated time zone</h2>\n<p>To convert UTC to local time, see the <a href=\"#converting-utc-to-local-time\" data-linktype=\"self-bookmark\">Converting UTC to local time</a> section that follows. </p>\n<p>To convert UTC to the time in any time zone that you designate, call the <a href=\"https://msdn.microsoft.com/library/System.TimeZoneInfo.converttimefromutc(v=vs.110).aspx\" data-linktype=\"external\">ConvertTimeFromUtc</a> method. </p>\n<div class=\"IMPORTANT\"><h5>Important</h5><p>The `TimeZoneInfo.ConvertTimeFromUtc&#39; method isn&#39;t currently available in .NET Core. </p>\n</div>\n<p>The method takes two parameters:</p>\n<ul>\n<li><p>The UTC to convert. This must be a <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value whose <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property is set to <a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Utc\" data-linktype=\"relative-path\">DateTimeKind.Utc</a> or <a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Unspecified\" data-linktype=\"relative-path\">DateTimeKind.Unspecified</a>. </p>\n</li>\n<li><p>The time zone to convert the UTC to. </p>\n</li>\n</ul>\n<p>The following code converts UTC to Central Standard Time.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTime timeUtc = DateTime.UtcNow;\ntry\n{\n   TimeZoneInfo cstZone = TimeZoneInfo.FindSystemTimeZoneById(&quot;Central Standard Time&quot;);\n   DateTime cstTime = TimeZoneInfo.ConvertTimeFromUtc(timeUtc, cstZone);\n   Console.WriteLine(&quot;The date and time are {0} {1}.&quot;, \n                     cstTime, \n                     cstZone.IsDaylightSavingTime(cstTime) ?\n                             cstZone.DaylightName : cstZone.StandardName);\n}\ncatch (TimeZoneNotFoundException)\n{\n   Console.WriteLine(&quot;The registry does not define the Central Standard Time zone.&quot;);\n}                           \ncatch (InvalidTimeZoneException)\n{\n   Console.WriteLine(&quot;Registry data on the Central Standard Time zone has been corrupted.&quot;);\n}\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim timeUtc As Date = Date.UtcNow\nTry\n   Dim cstZone As TimeZoneInfo = TimeZoneInfo.FindSystemTimeZoneById(&quot;Central Standard Time&quot;)\n   Dim cstTime As Date = TimeZoneInfo.ConvertTimeFromUtc(timeUtc, cstZone)\n   Console.WriteLine(&quot;The date and time are {0} {1}.&quot;, _\n                     cstTime, _\n                     IIf(cstZone.IsDaylightSavingTime(cstTime), _\n                         cstZone.DaylightName, cstZone.StandardName))\nCatch e As TimeZoneNotFoundException\n   Console.WriteLine(&quot;The registry does not define the Central Standard Time zone.&quot;)\nCatch e As InvalidTimeZoneException\n   Console.WriteLine(&quot;Registry data on the Central Standard Time zone has been corrupted.&quot;)\nEnd Try\n</code></pre><h2 id=\"converting-utc-to-local-time\">Converting UTC to local time</h2>\n<p>To convert UTC to local time, call the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime.ToLocalTime</a> method of the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> object whose time you want to convert. The exact behavior of the method depends on the value of the objectâ€™s <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property, as the following table shows.</p>\n<table>\n<thead>\n<tr>\n<th><a class=\"xref\" href=\"../../../api/system.datetimekind\" data-linktype=\"relative-path\">DateTime.Kind</a> property</th>\n<th>Conversion</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Local\" data-linktype=\"relative-path\">DateTimeKind.Local</a></td>\n<td>Returns the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value unchanged.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Unspecified\" data-linktype=\"relative-path\">DateTimeKind.Unspecified</a></td>\n<td>Assumes that the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value is UTC and converts the UTC to local time.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Utc\" data-linktype=\"relative-path\">DateTimeKind.Utc</a></td>\n<td>Converts the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value to local time.</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"converting-between-any-two-time-zones\">Converting between any two time zones</h2>\n<p>You can convert between any two time zones by using the static <a class=\"xref\" href=\"../../../api/system.timezoneinfo#System_TimeZoneInfo_ConvertTime_System_DateTime_System_TimeZoneInfo_\" data-linktype=\"relative-path\">TimeZoneInfo.ConvertTime</a> method. This method&#39;s parameters are the <a class=\"xref\" href=\"../../../api/system.datetime\" data-linktype=\"relative-path\">DateTime</a> value to convert, a <a class=\"xref\" href=\"../../../api/system.timezoneinfo\" data-linktype=\"relative-path\">TimeZoneInfo</a> object that represents the time zone of the date and time value, and a <a class=\"xref\" href=\"../../../api/system.timezoneinfo\" data-linktype=\"relative-path\">TimeZoneInfo</a> object that represents the time zone to convert the date and time value to.</p>\n<p>The method requires that the <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property of the date and time value to convert and the <a class=\"xref\" href=\"../../../api/system.timezoneinfo\" data-linktype=\"relative-path\">TimeZoneInfo</a> object or time zone identifier that represents its time zone correspond to one another. Otherwise, an <a class=\"xref\" href=\"../../../api/system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a> is thrown. For example, if the <a class=\"xref\" href=\"../../../api/system.datetime#System_DateTime_Kind\" data-linktype=\"relative-path\">Kind</a> property of the date and time value is <a class=\"xref\" href=\"../../../api/system.datetimekind#System_DateTimeKind_Local\" data-linktype=\"relative-path\">DateTimeKind.Local</a>, an exception is thrown if the <a class=\"xref\" href=\"../../../api/system.timezoneinfo\" data-linktype=\"relative-path\">TimeZoneInfo</a> object passed as a parameter to the method is not equal to <a class=\"xref\" href=\"../../../api/system.timezoneinfo#System_TimeZoneInfo_Local\" data-linktype=\"relative-path\">TimeZoneInfo.Local</a>. An exception is also thrown if the identifier passed as a parameter to the method is not equal to <a class=\"xref\" href=\"../../../api/system.timezoneinfo#System_TimeZoneInfo_Id\" data-linktype=\"relative-path\">TimeZoneInfo.Id</a>.</p>\n<p>The following example uses the <a class=\"xref\" href=\"../../../api/system.timezoneinfo#System_TimeZoneInfo_ConvertTime_System_DateTime_System_TimeZoneInfo_\" data-linktype=\"relative-path\">ConvertTime</a> method to convert from Hawaiian Standard Time to local time.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">DateTime hwTime = new DateTime(2007, 02, 01, 08, 00, 00);\ntry\n{\n   TimeZoneInfo hwZone = TimeZoneInfo.FindSystemTimeZoneById(&quot;Hawaiian Standard Time&quot;);\n   Console.WriteLine(&quot;{0} {1} is {2} local time.&quot;, \n           hwTime, \n           hwZone.IsDaylightSavingTime(hwTime) ? hwZone.DaylightName : hwZone.StandardName, \n           TimeZoneInfo.ConvertTime(hwTime, hwZone, TimeZoneInfo.Local));\n}\ncatch (TimeZoneNotFoundException)\n{\n   Console.WriteLine(&quot;The registry does not define the Hawaiian Standard Time zone.&quot;);\n}                           \ncatch (InvalidTimeZoneException)\n{\n   Console.WriteLine(&quot;Registry data on the Hawaiian STandard Time zone has been corrupted.&quot;);\n}\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Dim hwTime As Date = #2/01/2007 8:00:00 AM#\nTry\n   Dim hwZone As TimeZoneInfo = TimeZoneInfo.FindSystemTimeZoneById(&quot;Hawaiian Standard Time&quot;)\n   Console.WriteLine(&quot;{0} {1} is {2} local time.&quot;, _\n                     hwTime, _\n                     IIf(hwZone.IsDaylightSavingTime(hwTime), hwZone.DaylightName, hwZone.StandardName), _\n                     TimeZoneInfo.ConvertTime(hwTime, hwZone, TimeZoneInfo.Local))\nCatch e As TimeZoneNotFoundException\n   Console.WriteLine(&quot;The registry does not define the Hawaiian Standard Time zone.&quot;)\nCatch e As InvalidTimeZoneException\n   Console.WriteLine(&quot;Registry data on the Hawaiian Standard Time zone has been corrupted.&quot;)\nEnd Try\n</code></pre><h2 id=\"converting-datetimeoffset-values\">Converting DateTimeOffset values</h2>\n<p>Date and time values represented by <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">System.DateTimeOffset</a> objects are not fully time-zone aware because the object is disassociated from its time zone at the time it is instantiated. However, in many cases an application simply needs to convert a date and time based on two different offsets from UTC rather than on the time in particular time zones. To perform this conversion, you can call the current instance&#39;s <a class=\"xref\" href=\"../../../api/system.datetimeoffset#System_DateTimeOffset_ToOffset_System_TimeSpan_\" data-linktype=\"relative-path\">ToOffset</a> method. The method&#39;s single parameter is <a class=\"xref\" href=\"../../../api/system.timespan\" data-linktype=\"relative-path\">TimeSpan</a> representing the offset of the new date and time value that the method is to return.  </p>\n<p>For example, if the date and time of a user request for a Web page is known and is serialized as a string in the format MM/dd/yyyy hh:mm:ss zzzz, the following <code>ReturnTimeOnServer</code> method converts this date and time value to the date and time on the Web server.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">public DateTimeOffset ReturnTimeOnServer(string clientString)\n{\n   string format = @&quot;M/d/yyyy H:m:s zzz&quot;;\n   TimeSpan serverOffset = TimeZoneInfo.Local.GetUtcOffset(DateTimeOffset.Now);\n\n   try\n   {      \n      DateTimeOffset clientTime = DateTimeOffset.ParseExact(clientString, format, CultureInfo.InvariantCulture);\n      DateTimeOffset serverTime = clientTime.ToOffset(serverOffset);\n      return serverTime;\n   }\n   catch (FormatException)\n   {\n      return DateTimeOffset.MinValue;\n   }\n}\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Public Function ReturnTimeOnServer(clientString As String) As DateTimeOffset\n   Dim format As String = &quot;M/d/yyyy H:m:s zzz&quot;\n   Dim serverOffset As TimeSpan = TimeZoneInfo.Local.GetUtcOffset(DateTimeOffset.Now)\n\n   Try      \n      Dim clientTime As DateTimeOffset = DateTimeOffset.ParseExact(clientString, format, CultureInfo.InvariantCulture)\n      Dim serverTime As DateTimeOffset = clientTime.ToOffset(serverOffset)\n      Return serverTime\n   Catch e As FormatException\n      Return DateTimeOffset.MinValue\n   End Try    \nEnd Function\n</code></pre><p>If the method is passed the string &quot;9/1/2007 5:32:07 -05:00&quot;, which represents the date and time in a time zone five hours earlier than UTC, it returns 9/1/2007 3:32:07 AM -07:00 for a server located in the U.S. Pacific Standard Time zone.</p>\n<p>The <a class=\"xref\" href=\"../../../api/system.timezoneinfo\" data-linktype=\"relative-path\">TimeZoneInfo</a> class also includes an overloaded <a class=\"xref\" href=\"../../../api/system.timezoneinfo#System_TimeZoneInfo_ConvertTime_System_DateTimeOffset_System_TimeZoneInfo_\" data-linktype=\"relative-path\">TimeZoneInfo.ConvertTime(DateTimeOffset,â€‚TimeZoneInfo)</a> method that performs time zone conversions with <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">System.DateTimeOffset</a> values. The method&#39;s parameters are a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">System.DateTimeOffset</a> value and a reference to the time zone to which the time is to be converted. The method call returns a <a class=\"xref\" href=\"../../../api/system.datetimeoffset\" data-linktype=\"relative-path\">System.DateTimeOffset</a> value. For example, the <code>ReturnTimeOnServer</code> method in the previous example could be rewritten as follows to call the <a class=\"xref\" href=\"../../../api/system.timezoneinfo#System_TimeZoneInfo_ConvertTime_System_DateTimeOffset_System_TimeZoneInfo_\" data-linktype=\"relative-path\">ConvertTime(DateTimeOffset,â€‚TimeZoneInfo)</a> method.</p>\n<pre class=\"loading\"><code class=\"lang-csharp\">public DateTimeOffset ReturnTimeOnServer(string clientString)\n{\n   string format = @&quot;M/d/yyyy H:m:s zzz&quot;;\n\n   try\n   {      \n      DateTimeOffset clientTime = DateTimeOffset.ParseExact(clientString, format, \n                                  CultureInfo.InvariantCulture);\n      DateTimeOffset serverTime = TimeZoneInfo.ConvertTime(clientTime, \n                                  TimeZoneInfo.Local);\n      return serverTime;\n   }\n   catch (FormatException)\n   {\n      return DateTimeOffset.MinValue;\n   }\n}\n</code></pre><pre class=\"loading\"><code class=\"lang-vb\">Public Function ReturnTimeOnServer(clientString As String) As DateTimeOffset\n   Dim format As String = &quot;M/d/yyyy H:m:s zzz&quot;\n\n   Try      \n      Dim clientTime As DateTimeOffset = DateTimeOffset.ParseExact(clientString, format, CultureInfo.InvariantCulture)\n      Dim serverTime As DateTimeOffset = TimeZoneInfo.ConvertTime(clientTime, TimeZoneInfo.Local)\n      Return serverTime\n   Catch e As FormatException\n      Return DateTimeOffset.MinValue\n   End Try    \nEnd Function\n</code></pre><h2 id=\"see-also\">See also</h2>\n<p><a class=\"xref\" href=\"../../../api/system.timezoneinfo\" data-linktype=\"relative-path\">TimeZoneInfo</a></p>\n<p><a href=\"index\" data-linktype=\"relative-path\">Dates, times, and time zones</a></p>\n<p><a href=\"finding-the-time-zones-on-local-system\" data-linktype=\"relative-path\">Finding the time zones defined on a local system</a></p>\n</div></div>","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc2.json\">\r\n<meta name=\"ms.devlang\" content=\"dotnet\">\r\n<meta name=\"ms.assetid\" content=\"bf8f74e6-e7f2-4c2a-a04c-57db0e28dd36\">\r\n<meta name=\"description\" content=\"Converting times between time zones\">\r\n<meta name=\"keywords\" content=\".NET, .NET Core\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"08/15/2016\">\r\n<meta name=\"ms.technology\" content=\"dotnet-standard\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-21 01:42 AM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/standard/datetime/converting-between-time-zones.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/standard/datetime/converting-between-time-zones.md\">\r\n<meta name=\"document_id\" content=\"a8efab3b-c521-b8ab-e5ec-d39f4902c996\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Converting times between time zones | Microsoft Docs","ms.devlang":"dotnet","ms.assetid":"bf8f74e6-e7f2-4c2a-a04c-57db0e28dd36","description":"Converting times between time zones","keywords":".NET, .NET Core","ms.topic":"article","ms.date":"08/15/2016","ms.technology":"dotnet-standard","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Absolute urls and other fixes (#1281)","commit_sha":"f7dffe4885b331cec8d37f3cc5c9163f69c3b4c9","commit_date":"2016-11-22 12:57:26 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"fixed broken anchors (#1194)","commit_sha":"b20713600d7c3ddc31be5885733a1e8910ede8c6","commit_date":"2016-11-02 20:45:13 -0700"},{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Porting date and time topics from MSDN (#992)","commit_sha":"c40c28da09e8a122b542463c197196c82c81dd19","commit_date":"2016-09-06 10:55:51 -0700"},{"author_name":"Maira Wenzel","author_email":"mairaw@users.noreply.github.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Revert \"Bringing back essentials topics\" (#661)","commit_sha":"6d10e1507a2a8040743da29184fa4981ddbf7af3","commit_date":"2016-06-26 17:59:39 -0700"},{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Bringing back essentials topics (#659)","commit_sha":"5f3ebe05f34a44b449412c6334e47a9861b36c79","commit_date":"2016-06-26 17:27:32 -0700"}],"updated_at":"2017-03-21 01:42 AM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"3/21/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/standard/datetime/converting-between-time-zones.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/standard/datetime/converting-between-time-zones.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/standard/datetime/converting-between-time-zones.md","document_id":"a8efab3b-c521-b8ab-e5ec-d39f4902c996","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/standard/datetime/converting-between-time-zones","toc_asset_id":"articles/toc.json","toc_rel":"../../toc.json","_op_ogTitle":"Converting times between time zones","_op_displayDate":"2016-8-15","_op_displayDate_source":"2016-08-15T00:00:00Z","_op_wordCount":2059,"_op_rawTitle":"<h1 id=\"converting-times-between-time-zones\" sourcefile=\"docs/standard/datetime/converting-between-time-zones.md\" sourcestartlinenumber=\"15\" sourceendlinenumber=\"15\">Converting times between time zones</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/standard/datetime/converting-between-time-zones","fileRelativePath":"articles/standard/datetime/converting-between-time-zones.html"},"themesRelativePathToOutputRoot":"_themes/"}