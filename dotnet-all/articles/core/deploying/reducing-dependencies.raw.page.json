{"content":"<div><div class=\"content\">\n<p>This article covers what you need to know about reducing your package dependencies when authoring <code>project.json</code> libraries. By the end of this article, you will learn how to compose your library such that it only uses the dependencies it needs. </p>\n<h2 id=\"why-its-important\">Why it&#39;s Important</h2>\n<p>.NET Core is a product made up of NuGet packages.  An essential package is the <a href=\"https://www.nuget.org/packages/NETStandard.Library\" data-linktype=\"external\">.NET Standard Library metapackage</a>, which is a NuGet package composed of other packages.  It provides you with the set of packages that are guaranteed to work on multiple .NET implementations, such as .NET Framework, .NET Core and Xamarin/Mono.</p>\n<p>However, there&#39;s a good chance that your library won&#39;t use every single package it contains.  When authoring a library and distributing it over NuGet, it&#39;s a best practice to &quot;trim&quot; your dependencies down to only the packages you actually use.  This results in a smaller overall footprint for NuGet packages.</p>\n<h2 id=\"how-to-do-it\">How to do it</h2>\n<p>Currently, there is no official <code>dotnet</code> command which trims package references.  Instead, you&#39;ll have to do it manually.  The general process looks like the following:</p>\n<ol>\n<li>Reference <code>NETStandard.Library</code> version <code>1.6.0</code> in a <code>dependencies</code> section of your <code>project.json</code>.</li>\n<li>Restore packages with <code>dotnet restore</code> from the command line.</li>\n<li>Inspect the <code>project.lock.json</code> file and find the <code>NETSTandard.Library</code> section.  It&#39;s near the beginning of the file.</li>\n<li>Copy all of the listed packages under <code>dependencies</code>.</li>\n<li>Remove the <code>.NETStandard.Library</code> reference and replace it with the copied packages.</li>\n<li>Remove references to packages you don&#39;t need.</li>\n</ol>\n<p>You can find out which packages you don&#39;t need by one of the following ways:</p>\n<ol>\n<li>Trial and error.  This involves removing a package, restoring, seeing if your library still compiles, and repeating this process.</li>\n<li>Using a tool such as <a href=\"http://ilspy.net\" data-linktype=\"external\">ILSpy</a> or <a href=\"http://www.red-gate.com/products/dotnet-development/reflector\" data-linktype=\"external\">.NET Reflector</a> to peek at references to see what your code is actually using.  You can then remove packages which don&#39;t correspond to types you&#39;re using.</li>\n</ol>\n<h2 id=\"example\">Example</h2>\n<p>Imagine that you wrote a library which provided additional functionality to generic collection types.  Such a library would need to depend on packages such as <code>System.Collections</code>, but may not at all depend on packages such as <code>System.Net.Http</code>.  As such, it would be good to trim package dependencies down to only what this library required!</p>\n<p>To trim this library, you start with the <code>project.json</code> file and add a reference to <code>NETStandard.Library</code> version <code>1.6.0</code>.</p>\n<pre class=\"loading\"><code class=\"lang-json\">{\n    &quot;version&quot;:&quot;1.0.0&quot;,\n    &quot;dependencies&quot;:{\n        &quot;NETStandard.Library&quot;:&quot;1.6.0&quot;\n    },\n    &quot;frameworks&quot;: {\n        &quot;netstandard1.0&quot;: {}\n     }\n}\n</code></pre><p>Next, you restore packages with <code>dotnet restore</code>, inspect the <code>project.lock.json</code> file, and find all the packages restored for <code>NETSTandard.Library</code>.</p>\n<p>Here&#39;s what the relevant section in the <code>project.lock.json</code> file looks like when targeting <code>netstandard1.0</code>:</p>\n<pre class=\"loading\"><code class=\"lang-json\">&quot;NETStandard.Library/1.6.0&quot;:{\n    &quot;type&quot;: &quot;package&quot;,\n    &quot;dependencies&quot;: {\n        &quot;Microsoft.NETCore.Platforms&quot;: &quot;1.0.1&quot;,\n        &quot;Microsoft.NETCore.Runtime&quot;: &quot;1.0.2&quot;,\n        &quot;System.Collections&quot;: &quot;4.0.11&quot;,\n        &quot;System.Diagnostics.Debug&quot;: &quot;4.0.11&quot;,\n        &quot;System.Diagnostics.Tools&quot;: &quot;4.0.1&quot;,\n        &quot;System.Globalization&quot;: &quot;4.0.11&quot;,\n        &quot;System.IO&quot;: &quot;4.1.0&quot;,\n        &quot;System.Linq&quot;: &quot;4.1.0&quot;,\n        &quot;System.Net.Primitives&quot;: &quot;4.0.11&quot;,\n        &quot;System.ObjectModel&quot;: &quot;4.0.12&quot;,\n        &quot;System.Reflection&quot;: &quot;4.1.0&quot;,\n        &quot;System.Reflection.Extensions&quot;: &quot;4.0.1&quot;,\n        &quot;System.Reflection.Primitives&quot;: &quot;4.0.1&quot;,\n        &quot;System.Resources.ResourceManager&quot;: &quot;4.0.1&quot;,\n        &quot;System.Runtime&quot;: &quot;4.1.0&quot;,\n        &quot;System.Runtime.Extensions&quot;: &quot;4.1.0&quot;,\n        &quot;System.Text.Encoding&quot;: &quot;4.0.11&quot;,\n        &quot;System.Text.Encoding.Extensions&quot;: &quot;4.0.11&quot;,\n        &quot;System.Text.RegularExpressions&quot;: &quot;4.1.0&quot;,\n        &quot;System.Threading&quot;: &quot;4.0.11&quot;,\n        &quot;System.Threading.Tasks&quot;: &quot;4.0.11&quot;,\n        &quot;System.Xml.ReaderWriter&quot;: &quot;4.0.11&quot;,\n        &quot;System.Xml.XDocument&quot;: &quot;4.0.11&quot;\n    }\n}\n</code></pre><p>Next, copy over the package references into the <code>dependencies</code> section of the library&#39;s <code>project.json</code> file, replacing the <code>NETStandard.Library</code> reference:</p>\n<pre class=\"loading\"><code class=\"lang-json\">{\n    &quot;version&quot;:&quot;1.0.0&quot;,\n    &quot;dependencies&quot;:{\n        &quot;Microsoft.NETCore.Platforms&quot;: &quot;1.0.1&quot;,\n        &quot;Microsoft.NETCore.Runtime&quot;: &quot;1.0.2&quot;,\n        &quot;System.Collections&quot;: &quot;4.0.11&quot;,\n        &quot;System.Diagnostics.Debug&quot;: &quot;4.0.11&quot;,\n        &quot;System.Diagnostics.Tools&quot;: &quot;4.0.1&quot;,\n        &quot;System.Globalization&quot;: &quot;4.0.11&quot;,\n        &quot;System.IO&quot;: &quot;4.1.0&quot;,\n        &quot;System.Linq&quot;: &quot;4.1.0&quot;,\n        &quot;System.Net.Primitives&quot;: &quot;4.0.11&quot;,\n        &quot;System.ObjectModel&quot;: &quot;4.0.12&quot;,\n        &quot;System.Reflection&quot;: &quot;4.1.0&quot;,\n        &quot;System.Reflection.Extensions&quot;: &quot;4.0.1&quot;,\n        &quot;System.Reflection.Primitives&quot;: &quot;4.0.1&quot;,\n        &quot;System.Resources.ResourceManager&quot;: &quot;4.0.1&quot;,\n        &quot;System.Runtime&quot;: &quot;4.1.0&quot;,\n        &quot;System.Runtime.Extensions&quot;: &quot;4.1.0&quot;,\n        &quot;System.Text.Encoding&quot;: &quot;4.0.11&quot;,\n        &quot;System.Text.Encoding.Extensions&quot;: &quot;4.0.11&quot;,\n        &quot;System.Text.RegularExpressions&quot;: &quot;4.1.0&quot;,\n        &quot;System.Threading&quot;: &quot;4.0.11&quot;,\n        &quot;System.Threading.Tasks&quot;: &quot;4.0.11&quot;,\n        &quot;System.Xml.ReaderWriter&quot;: &quot;4.0.11&quot;,\n        &quot;System.Xml.XDocument&quot;: &quot;4.0.11&quot;\n    },\n    &quot;frameworks&quot;:{\n        &quot;netstandard1.0&quot;: {}\n    }\n}\n</code></pre><p>That&#39;s quite a lot of packages, many of which which certainly aren&#39;t necessary for extending collection types.  You can either remove packages manually or use a tool such as <a href=\"http://ilspy.net\" data-linktype=\"external\">ILSpy</a> or <a href=\"http://www.red-gate.com/products/dotnet-development/reflector\" data-linktype=\"external\">.NET Reflector</a> to identify which packages your code actually uses.</p>\n<p>Here&#39;s what a trimmed package could look like:</p>\n<pre class=\"loading\"><code class=\"lang-json\">{\n    &quot;dependencies&quot;:{\n        &quot;Microsoft.NETCore.Platforms&quot;: &quot;1.0.1&quot;,\n        &quot;Microsoft.NETCore.Runtime&quot;: &quot;1.0.2&quot;,\n        &quot;System.Collections&quot;: &quot;4.0.11&quot;,\n        &quot;System.Linq&quot;: &quot;4.1.0&quot;,\n        &quot;System.Runtime&quot;: &quot;4.1.0&quot;,\n        &quot;System.Runtime.Extensions&quot;: &quot;4.1.0&quot;,\n        &quot;System.Runtime.Handles&quot;: &quot;4.0.1&quot;,\n        &quot;System.Runtime.InteropServices&quot;: &quot;4.1.0&quot;,\n        &quot;System.Runtime.InteropServices.RuntimeInformation&quot;: &quot;4.0.0&quot;,\n        &quot;System.Threading.Tasks&quot;: &quot;4.0.11&quot;\n    },\n    &quot;frameworks&quot;:{\n        &quot;netstandard1.0&quot;: {}\n     }\n}\n</code></pre><p>Now, it has a smaller footprint than if it had depended on the <code>NETStandard.Library</code> metapackage.</p>\n</div></div>","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"author\" content=\"cartermp\">\r\n<meta name=\"ms.author\" content=\"mairaw\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"toc2.json\">\r\n<meta name=\"ms.devlang\" content=\"dotnet\">\r\n<meta name=\"ms.assetid\" content=\"916251e3-87f9-4eee-81ec-94076215e6fa\">\r\n<meta name=\"description\" content=\"Reducing Package Dependencies with project.json\">\r\n<meta name=\"keywords\" content=\".NET, .NET Core\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"06/20/2016\">\r\n<meta name=\"ms.prod\" content=\".net-core\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/core/deploying/reducing-dependencies.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/core/deploying/reducing-dependencies.md\">\r\n<meta name=\"document_id\" content=\"ea3dbef1-6269-4864-8342-61ceb0369cc1\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../toc2.json\">\r\n","rawMetadata":{"author":"cartermp","ms.author":"mairaw","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","title":"Reducing Package Dependencies with project.json | Microsoft Docs","ms.devlang":"dotnet","ms.assetid":"916251e3-87f9-4eee-81ec-94076215e6fa","description":"Reducing Package Dependencies with project.json","keywords":".NET, .NET Core","ms.topic":"article","ms.date":"06/20/2016","ms.prod":".net-core","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Tom Dykstra","author_email":"tdykstra@microsoft.com","committer_name":"Rich Lander","comitter_email":"rlander@microsoft.com","message":"fix broken links (#651)","commit_sha":"62fdb3e60b206728d86220076867eb8fd68af82e","commit_date":"2016-06-26 10:58:55 -0700"},{"author_name":"Phillip Carter","author_email":"phillip.carter@outlook.com","committer_name":"Rich Lander","comitter_email":"rlander@microsoft.com","message":"Libraries changes (#643)","commit_sha":"e438bc76184dd28b8405d9aee104f3631f9b8c54","commit_date":"2016-06-25 23:24:47 -0700"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/cartermp","display_name":"Phillip Carter","id":"6309070"},"contributors":[{"profile_url":"https://github.com/cartermp","display_name":"Phillip Carter"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"},{"profile_url":"https://github.com/tdykstra","display_name":"Tom Dykstra","id":"1569635"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/core/deploying/reducing-dependencies.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/core/deploying/reducing-dependencies.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/core/deploying/reducing-dependencies.md","document_id":"ea3dbef1-6269-4864-8342-61ceb0369cc1","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/core/deploying/reducing-dependencies","toc_asset_id":"articles/toc.json","toc_rel":"../../toc.json","_op_ogTitle":"Reducing Package Dependencies with project.json","_op_displayDate":"2016-6-20","_op_displayDate_source":"2016-06-20T00:00:00Z","_op_wordCount":640,"_op_rawTitle":"<h1 id=\"reducing-package-dependencies-with-projectjson\" sourcefile=\"docs/core/deploying/reducing-dependencies.md\" sourcestartlinenumber=\"14\" sourceendlinenumber=\"14\">Reducing Package Dependencies with project.json</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/core/deploying/reducing-dependencies","fileRelativePath":"articles/core/deploying/reducing-dependencies.html"},"themesRelativePathToOutputRoot":"_themes/"}