{"content":"<div><div class=\"content\">\n<div class=\"NOTE\"><h5>Note</h5><p>This guide was written for F# 3.0 and will be updated.  See <a href=\"http://fsharp.github.io/FSharp.Data/\" data-linktype=\"external\">FSharp.Data</a> for up-to-date, cross-platform type providers.</p>\n</div>\n<div class=\"NOTE\"><h5>Note</h5><p>The API reference links will take you to MSDN.  The docs.microsoft.com API reference is not complete.</p>\n</div>\n<p>This walkthrough for F# 3.0 shows you how to create types for data that is represented by the Entity Data Model (EDM), the schema for which is specified in an .edmx file. This walkthrough also shows how to use the EdmxFile type provider. Before you begin, consider whether a SqlEntityConnection type provider is a more appropriate type provider option. The SqlEntityConnection type provider works best for scenarios where you have a live database that you can connect to during the development phase of your project, and you do not mind specifying the connection string at compile time. However, this type provider is also limited in that it doesn&#39;t expose as much database functionality as the EdmxFile type provider. Also, if you don&#39;t have a live database connection for a database project that uses the Entity Data Model, you can use the .edmx file to code against the database. When you use the EdmxFile type provider, the F# compiler runs EdmGen.exe to generate the types that it provides.</p>\n<p>This walkthrough illustrates the following tasks, which you must perform in this order for the walkthrough to succeed:</p>\n<ul>\n<li><p>Creating an EDMX file\n<br></p>\n</li>\n<li><p>Creating the project\n<br></p>\n</li>\n<li><p>Finding or creating the entity data model connection string\n<br></p>\n</li>\n<li><p>Configuring the type provider\n<br></p>\n</li>\n<li><p>Querying the data\n<br></p>\n</li>\n<li><p>Calling a stored procedure\n<br></p>\n</li>\n</ul>\n<h2 id=\"prerequisites\">Prerequisites</h2>\n<h2 id=\"creating-an-edmx-file\">Creating an EDMX file</h2>\n<p>If you already have an EDMX file, you can skip this step.</p>\n<h4 id=\"to-create-an-edmx-file\">To create an EDMX file</h4>\n<ul>\n<li>If you don&#39;t already have an EDMX file, you can follow the instructions at the end of this walkthrough in the step <a href=\"generating-fsharp-types-from-edmx#configuring-the-entity-data-model\" data-linktype=\"relative-path\">Configuring the Entity Data Model</a>.\n<br></li>\n</ul>\n<h2 id=\"creating-the-project\">Creating the project</h2>\n<p>In this step, you create a project and add appropriate references to it to use the EDMX type provider.</p>\n<h4 id=\"to-create-and-set-up-an-f-project\">To create and set up an F# project</h4>\n<ol>\n<li><p>Close the previous project, create another project, and name it SchoolEDM.\n<br></p>\n</li>\n<li><p>In <strong>Solution Explorer</strong>, open the shortcut menu for <strong>References</strong>, and then choose <strong>Add Reference</strong>.\n<br></p>\n</li>\n<li><p>In the <strong>Assemblies</strong> area, choose the <strong>Framework</strong> node.\n<br></p>\n</li>\n<li><p>In the list of available assemblies, choose the <strong>System.Data.Entity</strong> and <strong>System.Data.Linq</strong> assemblies, and then choose the <strong>Add</strong> button to add references to these assemblies to your project.\n<br></p>\n</li>\n<li><p>In the <strong>Assemblies</strong> area, select the <strong>Extensions</strong> node.\n<br></p>\n</li>\n<li><p>In the  list of available extensions, add a reference to the FSharp.Data.TypeProviders assembly.\n<br></p>\n</li>\n<li><p>Add the following code to open the appropriate namespaces.\n<br></p>\n</li>\n</ol>\n<pre class=\"loading\"><code class=\"lang-fsharp\">open System.Data.Linq\nopen System.Data.Entity\nopen Microsoft.FSharp.Data.TypeProviders\n</code></pre><h2 id=\"finding-or-creating-the-connection-string-for-the-entity-data-model\">Finding or creating the connection string for the Entity Data Model</h2>\n<p>The connection string for the Entity Data Model (EDMX connection string) includes not only the connection string for the database provider but also additional information. For example, EDMX connection string for a simple SQL Server database resembles the following code.</p>\n<pre class=\"loading\"><code class=\"lang-fsharp\">let edmConnectionString = &quot;metadata=res://*/;provider=System.Data.SqlClient;Provider Connection String=&#39;Server=SERVER\\Instance;Initial Catalog=DatabaseName;Integrated Security=SSPI;&#39;&quot;\n</code></pre><p>For more information about EDMX connection strings, see <a href=\"https://msdn.microsoft.com/library/ms254494.aspx\" data-linktype=\"external\">Connection Strings</a>.</p>\n<h4 id=\"to-find-or-create-the-connection-string-for-the-entity-data-model\">To find or create the connection string for the Entity Data Model</h4>\n<ol>\n<li>EDMX connection strings can be difficult to generate by hand, so you can save time by generating it programmatically. If you know your EDMX connection string, you can bypass this step and simply use that string in the next step. If not, use the following code to generate the EDMX connection string from a database connection string that you provide.\n<br></li>\n</ol>\n<pre class=\"loading\"><code class=\"lang-fsharp\">open System\nopen System.Data\nopen System.Data.SqlClient\nopen System.Data.EntityClient\nopen System.Data.Metadata.Edm\n\nlet getEDMConnection(dbConnectionString) =\n  let dbConnection = new SqlConnection(dbConnectionString)\n  let resourceArray = [| &quot;res://*/&quot; |]\n  let assemblyList = [| System.Reflection.Assembly.GetCallingAssembly() |]\n  let metaData = MetadataWorkspace(resourceArray, assemblyList)\n  new EntityConnection(metaData, dbConnection)\n</code></pre><h2 id=\"configuring-the-type-provider\">Configuring the type provider</h2>\n<p>In this step, you create and configure the type provider with the EDMX connection string, and you generate types for the schema that&#39;s defined in the .edmx file.</p>\n<h4 id=\"to-configure-the-type-provider-and-generate-types\">To configure the type provider and generate types</h4>\n<ol>\n<li><p>Copy the .edmx file that you generated in the first step of this walkthrough to your project folder.\n<br></p>\n</li>\n<li><p>Open the shortcut menu for the project node in your F# project, choose <strong>Add Existing Item</strong>, and then choose the .edmx file to add it to your project.\n<br></p>\n</li>\n<li><p>Enter the following code to activate the type provider for your .edmx file. Replace <em>Server</em>*Instance* with the name of your server that&#39;s running SQL Server and the name of your instance, and use the name of your .edmx file from the first step in this walkthrough.\n<br></p>\n</li>\n</ol>\n<pre class=\"loading\"><code class=\"lang-fsharp\">type edmx = EdmxFile&lt;&quot;Model1.edmx&quot;, ResolutionFolder = @&quot;&lt;path-tofolder-that-containsyour.edmx-file&gt;&quot;&gt;\n\nuse edmConnection =\n  getEDMConnection(&quot;Data Source=SERVER\\instance;Initial Catalog=School;Integrated Security=true;&quot;)\nuse context = new edmx.SchoolModel.SchoolEntities(edmConnection)\n</code></pre><h2 id=\"querying-the-data\">Querying the data</h2>\n<p>In this step, you use F# query expressions to query the database.</p>\n<h4 id=\"to-query-the-data\">To query the data</h4>\n<ul>\n<li>Enter the following code to query the data in the entity data model.\n<br></li>\n</ul>\n<pre class=\"loading\"><code class=\"lang-fsharp\">query { \n  for course in context.Courses do\n  select course \n} |&gt; Seq.iter (fun course -&gt; printfn &quot;%s&quot; course.Title)\n\nquery { \n  for person in context.Person do\n  select person \n} |&gt; Seq.iter (fun person -&gt; printfn &quot;%s %s&quot; person.FirstName person.LastName)\n\n// Add a where clause to filter results\nquery { \n  for course in context.Courses do\n  where (course.DepartmentID = 1)\n  select course\n} |&gt; Seq.iter (fun course -&gt; printfn &quot;%s&quot; course.Title)\n\n// Join two tables\nquery { \n  for course in context.Courses do\n  join dept in context.Departments on (course.DepartmentID = dept.DepartmentID)\n  select (course, dept.Name) \n} |&gt; Seq.iter (fun (course, deptName) -&gt; printfn &quot;%s %s&quot; course.Title deptName)\n</code></pre><h2 id=\"calling-a-stored-procedure\">Calling a stored procedure</h2>\n<p>You can call stored procedures by using the EDMX type provider. In the following procedure, the School database contains a stored procedure, <strong>UpdatePerson</strong>, which updates a record, given new values for the columns. You can use this stored procedure because it&#39;s exposed as a method on the DataContext type.</p>\n<h4 id=\"to-call-a-stored-procedure\">To call a stored procedure</h4>\n<ul>\n<li>Add the following code to update records.\n<br></li>\n</ul>\n<pre class=\"loading\"><code class=\"lang-fsharp\">// Call a stored procedure.\nlet nullable value = new System.Nullable&lt;_&gt;(value)\n\n// Assume now that you must correct someone&#39;s hire date.\n// Throw an exception if more than one matching person is found.\nlet changeHireDate(lastName, firstName, hireDate) =\n\n  query { \n    for person in context.People do\n    where (person.LastName = lastName &amp;&amp;\n           person.FirstName = firstName)\n    exactlyOne \n  } |&gt; (fun person -&gt;\n            context.UpdatePerson(nullable person.PersonID, person.LastName, person.FirstName, nullable hireDate, person.EnrollmentDate))\n\nchangeHireDate(&quot;Abercrombie&quot;, &quot;Kim&quot;, DateTime.Parse(&quot;1/12/1998&quot;))\n|&gt; printfn &quot;Result: %d&quot;\n</code></pre><p>The result is 1 if you succeed. Notice that <strong>exactlyOne</strong> is used in the query expression to ensure that only one result is returned; otherwise, an exception is thrown. Also, to work with nullable values more easily, you can use the simple <strong>nullable</strong> function that&#39;s defined in this code to create a nullable value out of an ordinary value.</p>\n<p><br></p>\n<h2 id=\"configuring-the-entity-data-model\">Configuring the Entity Data Model</h2>\n<p>You should complete this procedure only if you want to know how to generate a full Entity Data Model from a database and you don&#39;t have a database with which to test.</p>\n<h4 id=\"to-configure-the-entity-data-model\">To configure the Entity Data Model</h4>\n<ol>\n<li><p>On the menu bar, choose <strong>SQL</strong>, <strong>Transact-SQL Editor</strong>, <strong>New Query</strong> to create a database. If prompted, specify your database server and instance.\n<br></p>\n</li>\n<li><p>Copy and paste the contents of the database script that creates the Student database, as described in the <a href=\"http://msdn.microsoft.com/data/JJ614587.aspx\" data-linktype=\"external\">Entity Framework documentation</a> in the Data Developer Center.\n<br></p>\n</li>\n<li><p>Run the SQL script by choosing the toolbar button with the triangle symbol or choosing the Ctrl+Q keys.\n<br></p>\n</li>\n<li><p>In <strong>Server Explorer</strong>, open the shortcut menu for <strong>Data Connections</strong>, choose <strong>Add Connection</strong>, and then enter the name of the database server, the name of the instance name, and the School database.\n<br></p>\n</li>\n<li><p>Create a C# or Visual Basic Console Application project, open its shortcut menu, choose <strong>Add New Item</strong>, and then choose <strong>ADO.NET Entity Data Model</strong>.\n<br>  The Entity Data Model Wizard opens. By using this wizard, you can choose how you want to create the Entity Data Model.\n<br></p>\n</li>\n<li><p>Under <strong>Choose Model Contents</strong>, select the <strong>Generate from database</strong> check box.\n<br></p>\n</li>\n<li><p>On the next page, choose your newly created School database as the data connection.\n<br>  This connection should resemble <strong>&lt;servername&gt;.&lt;instancename&gt;.School.dbo</strong>.\n<br></p>\n</li>\n<li><p>Copy your entity connection string to the Clipboard because that string might be important later.\n<br></p>\n</li>\n<li><p>Make sure the check box to save the entity connection string to the <strong>App.Config</strong> file is selected, and make note of the string value in the text box, which should help you locate the connection string later, if needed.\n<br></p>\n</li>\n<li><p>On the next page, choose <strong>Tables</strong> and <strong>Stored Procedures and Functions</strong>.\n<br>  By choosing these top-level nodes, you choose all tables, stored procedures, and functions. You can also choose these individually, if you want.\n<br></p>\n</li>\n<li><p>Make sure that the check boxes for the other settings are selected.\n<br>  The first <strong>Pluralize or singularize generated object names</strong> check box indicates whether to change singular forms to plural to match conventions in naming objects that represent database tables. The <strong>Include foreign key columns in the model</strong> check box determines whether to include fields for which the purpose is to join to other fields in the object types that are generated for the database schema. The third check box indicates whether to include stored procedures and functions in the model.\n<br></p>\n</li>\n<li><p>Select the <strong>Finish</strong> button to generate an .edmx file that contains an Entity Data Model that&#39;s based on the School database.\n<br>  A file, <strong>Model1.edmx</strong>, is added to your project, and a database diagram appears.\n<br></p>\n</li>\n<li><p>On the menu bar, choose <strong>View</strong>, <strong>Other Windows</strong>, <strong>Entity Data Model Browser</strong> to view all the details of the model or <strong>Entity Data Model Mapping Details</strong> to open a window that shows how the generated object model maps onto database tables and columns.\n<br></p>\n</li>\n</ol>\n<h2 id=\"next-steps\">Next Steps</h2>\n<p>Explore other queries by looking at the available query operators as listed in <a href=\"../../language-reference/query-expressions\" data-linktype=\"relative-path\">Query Expressions</a>.</p>\n<h2 id=\"see-also\">See Also</h2>\n<p><a href=\"index\" data-linktype=\"relative-path\">Type Providers</a></p>\n<p><a href=\"https://msdn.microsoft.com/visualfsharpdocs/conceptual/edmxfile-type-provider-%5bfsharp%5d\" data-linktype=\"external\">EdmxFile Type Provider</a></p>\n<p><a href=\"accessing-a-sql-database-entities\" data-linktype=\"relative-path\">Walkthrough: Accessing a SQL Database by Using Type Providers and Entities</a></p>\n<p><a href=\"http://msdn.microsoft.com/data/ef\" data-linktype=\"external\">Entity Framework</a></p>\n<p><a href=\"https://msdn.microsoft.com/library/f4c8e7ce-1db6-417e-9759-15f8b55155d4\" data-linktype=\"external\">.edmx File Overview</a></p>\n<p><a href=\"https://msdn.microsoft.com/library/bb387165\" data-linktype=\"external\">EDM Generator &#40;EdmGen.exe&#41;</a></p>\n</div></div>","outputRootRelativePath":"../../../../","pageMetadata":"<meta name=\"author\" content=\"cartermp\">\r\n<meta name=\"ms.author\" content=\"phcart\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-all/api/toc2.json\">\r\n<meta name=\"ms.devlang\" content=\"fsharp\">\r\n<meta name=\"ms.assetid\" content=\"81adb2eb-625f-4ad8-aeaa-8f672a6d79a2\">\r\n<meta name=\"description\" content=\"Walkthrough: Generating F# Types from an EDMX Schema File (F#)\">\r\n<meta name=\"keywords\" content=\"visual f#, f#, functional programming\">\r\n<meta name=\"ms.topic\" content=\"language-reference\">\r\n<meta name=\"ms.date\" content=\"05/16/2016\">\r\n<meta name=\"ms.technology\" content=\"devlang-fsharp\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/fsharp/tutorials/type-providers/generating-fsharp-types-from-edmx.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/fsharp/tutorials/type-providers/generating-fsharp-types-from-edmx.md\">\r\n<meta name=\"document_id\" content=\"99c1fa8d-3a63-6254-049d-0bdc92c45e4f\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../../toc2.json\">\r\n","rawMetadata":{"author":"cartermp","ms.author":"phcart","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Walkthrough: Generating F# Types from an EDMX Schema File (F#) | Microsoft Docs","ms.devlang":"fsharp","ms.assetid":"81adb2eb-625f-4ad8-aeaa-8f672a6d79a2","description":"Walkthrough: Generating F# Types from an EDMX Schema File (F#)","keywords":"visual f#, f#, functional programming","ms.topic":"language-reference","ms.date":"05/16/2016","ms.technology":"devlang-fsharp","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Jason Nguyen","author_email":"gofightnguyen@hotmail.com","committer_name":"Phillip Carter","comitter_email":"phillip.carter@outlook.com","message":"Patch 1 (#1147)","commit_sha":"d0b7b9e58c764e3764bc4fa27b1fa96550af8be7","commit_date":"2016-10-13 11:06:48 -0700"},{"author_name":"Jason Nguyen","author_email":"gofightnguyen@hotmail.com","committer_name":"Phillip Carter","comitter_email":"phillip.carter@outlook.com","message":"Update generating-fsharp-types-from-edmx.md (#1137)","commit_sha":"8c21f9b562a0cee650c90a3897040eb1b5165857","commit_date":"2016-10-12 15:06:21 -0700"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"fixed absolute and msdn links (#1001)","commit_sha":"de0dab146fc811e895dc32f98f877db5e757f82b","commit_date":"2016-09-06 10:59:39 -0700"},{"author_name":"Petr Onderka","author_email":"gsvick@gmail.com","committer_name":"Maira Wenzel","comitter_email":"mairaw@microsoft.com","message":"Improve titles of some F# articles (#1003)","commit_sha":"d18cfd736f1dbd61ab9e209de4aaa878a88162cd","commit_date":"2016-09-03 11:22:59 -0700"},{"author_name":"Phillip Carter","author_email":"phillip.carter@outlook.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"F# Docs: Update intro, move files, rename language reference for better URLS (#902)","commit_sha":"70a10b9c3e21291c96d927d13f8710d9e0738d4c","commit_date":"2016-08-13 11:22:39 -0700"},{"author_name":"Phillip Carter","author_email":"phillip.carter@outlook.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Add Visual F# Conceptual Content (#900)","commit_sha":"c27bed7dbad6b24c55734fcab0333bd3a1de85d6","commit_date":"2016-08-12 17:06:05 -0700"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/cartermp","display_name":"Phillip Carter","id":"6309070"},"contributors":[{"profile_url":"https://github.com/cartermp","display_name":"Phillip Carter"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"},{"profile_url":"https://github.com/GoFightNguyen","display_name":"Jason Nguyen","id":"6308176"},{"profile_url":"https://github.com/svick","display_name":"Petr Onderka","id":"287848"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/fsharp/tutorials/type-providers/generating-fsharp-types-from-edmx.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/fsharp/tutorials/type-providers/generating-fsharp-types-from-edmx.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/fsharp/tutorials/type-providers/generating-fsharp-types-from-edmx.md","document_id":"99c1fa8d-3a63-6254-049d-0bdc92c45e4f","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/fsharp/tutorials/type-providers/generating-fsharp-types-from-edmx","toc_asset_id":"articles/toc.json","toc_rel":"../../../toc.json","_op_ogTitle":"Walkthrough: Generating F# Types from an EDMX Schema File (F#)","_op_displayDate":"2016-5-16","_op_displayDate_source":"2016-05-16T00:00:00Z","_op_wordCount":1600,"_op_rawTitle":"<h1 id=\"walkthrough-generating-f-types-from-an-edmx-schema-file\" sourcefile=\"docs/fsharp/tutorials/type-providers/generating-fsharp-types-from-edmx.md\" sourcestartlinenumber=\"15\" sourceendlinenumber=\"15\">Walkthrough: Generating F# Types from an EDMX Schema File</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/fsharp/tutorials/type-providers/generating-fsharp-types-from-edmx","fileRelativePath":"articles/fsharp/tutorials/type-providers/generating-fsharp-types-from-edmx.html"},"themesRelativePathToOutputRoot":"_themes/"}