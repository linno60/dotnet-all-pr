{"content":"<div><div class=\"content\">\n<div class=\"NOTE\"><h5>Note</h5><p>This guide was written for F# 3.0 and will be updated.  See <a href=\"http://fsharp.github.io/FSharp.Data/\" data-linktype=\"external\">FSharp.Data</a> for up-to-date, cross-platform type providers.</p>\n</div>\n<div class=\"NOTE\"><h5>Note</h5><p>The API reference links will take you to MSDN.  The docs.microsoft.com API reference is not complete.</p>\n</div>\n<p>This walkthrough for F# 3.0 describes how to create types for data from a database when you have schema information encoded in a .dbml file. LINQ to SQL uses this file format to represent database schema. You can generate a LINQ to SQL schema file in Visual Studio by using the Object Relational (O/R) Designer. For more information, see <a href=\"https://msdn.microsoft.com/library/bb384511.aspx\" data-linktype=\"external\">O/R Designer Overview</a> and <a href=\"https://msdn.microsoft.com/library/bb386976\" data-linktype=\"external\">Code Generation in LINQ to SQL</a>.</p>\n<p>The Database Markup Language (DBML) type provider allows you to write code that uses types based on a database schema without requiring you to specify a static connection string at compile time. That can be useful if you need to allow for the possibility that the final application will use a different database, different credentials, or a different connection string than the one you use to develop the application. If you have a direct database connection that you can use at compile time and this is the same database and credentials that you will eventually use in your built application, you can also use the SQLDataConnection type provider. For more information, see <a href=\"accessing-a-sql-database\" data-linktype=\"relative-path\">Walkthrough: Accessing a SQL Database by Using Type Providers</a>.</p>\n<p>This walkthrough illustrates the following tasks. They should be completed in this order for the walkthrough to succeed:</p>\n<ul>\n<li><p>Creating a .dbml file\n<br></p>\n</li>\n<li><p>Creating and setting up an F# project\n<br></p>\n</li>\n<li><p>Configuring the type provider and generating the types\n<br></p>\n</li>\n<li><p>Querying the database\n<br></p>\n</li>\n</ul>\n<h2 id=\"prerequisites\">Prerequisites</h2>\n<h2 id=\"creating-a-dbml-file\">Creating a .dbml file</h2>\n<p>If you do not have a database to test on, create one by following the instructions at the bottom of <a href=\"accessing-a-sql-database\" data-linktype=\"relative-path\">Walkthrough: Accessing a SQL Database by Using Type Providers</a>. If you follow these instructions, you will create a database called MyDatabase that contains a few simple tables and stored procedures on your SQL Server.</p>\n<p>If you already have a .dbml file, you can skip to the section, <strong>Create and Set Up an F# Project</strong>. Otherwise, you can create a .dbml file given an existing SQL database and by using the command-line tool SqlMetal.exe.</p>\n<h4 id=\"to-create-a-dbml-file-by-using-sqlmetalexe\">To create a .dbml file by using SqlMetal.exe</h4>\n<ol>\n<li><p>Open a <strong>Developer Command Prompt</strong>.\n<br></p>\n</li>\n<li><p>Ensure that you have access to SqlMetal.exe by entering <code>SqlMetal.exe /?</code> at the command prompt. SqlMetal.exe is typically installed under the <strong>Microsoft SDKs</strong> folder in <strong>Program Files</strong> or <strong>Program Files (x86)</strong>.\n<br></p>\n</li>\n<li><p>Run SqlMetal.exe with the following command-line options. Substitute an appropriate path in place of <code>c:\\destpath</code> to create the .dbml file, and insert appropriate values for the database server, instance name, and database name.\n<br></p>\n</li>\n</ol>\n<pre class=\"loading\"><code>  SqlMetal.exe /sprocs /dbml:C:\\destpath\\MyDatabase.dbml /server:SERVER\\INSTANCE /database:MyDatabase\n</code></pre><div class=\"NOTE\"><h5>Note</h5><p>If SqlMetal.exe has trouble creating the file due to permissions issues, change the current directory to a folder that you have write access to.</p>\n</div>\n<ol start=\"4\">\n<li>You can also look at the other available command-line options. For example, there are options you can use if you want views and SQL functions included in the generated types. For more information, see <a href=\"https://msdn.microsoft.com/library/bb386987\" data-linktype=\"external\">SqlMetal.exe &#40;Code Generation Tool&#41;</a>.\n<br></li>\n</ol>\n<h2 id=\"creating-and-setting-up-an-f-project\">Creating and setting up an F# project</h2>\n<p>In this step, you create a project and add appropriate references to use the DBML type provider.</p>\n<h4 id=\"to-create-and-set-up-an-f-project\">To create and set up an F# project</h4>\n<ol>\n<li><p>Add a new F# Console Application project to your solution.\n<br></p>\n</li>\n<li><p>In <strong>Solution Explorer</strong>, open the shortcut menu for <strong>References</strong>, and then choose <strong>Add Reference</strong>.\n<br></p>\n</li>\n<li><p>In the <strong>Assemblies</strong> area, choose the <strong>Framework</strong> node, and then, in the list of available assemblies, choose the <strong>System.Data</strong> and <strong>System.Data.Linq</strong> assemblies.\n<br></p>\n</li>\n<li><p>In the <strong>Assemblies</strong> area, choose <strong>Extensions</strong>, and then, in the list of available assemblies, choose <strong>FSharp.Data.TypeProviders</strong>.\n<br></p>\n</li>\n<li><p>Choose the <strong>OK</strong> button to add references to these assemblies to your project.\n<br></p>\n</li>\n<li><p>(Optional). Copy the .dbml file that you created in the previous step, and paste the file in the main folder for your project. This folder contains the project file (.fsproj) and code files. On the menu bar, choose <strong>Project</strong>, <strong>Add Existing Item</strong>, and then specify the .dbml file to add it to your project. If you complete these steps, you can omit the ResolutionFolder static parameter in the next step.\n<br></p>\n</li>\n</ol>\n<h2 id=\"configuring-the-type-provider\">Configuring the type provider</h2>\n<p>In this section, you create a type provider and generate types from the schema thatâ€™s described in the .dbml file.</p>\n<h4 id=\"to-configure-the-type-provider-and-generate-the-types\">To configure the type provider and generate the types</h4>\n<ul>\n<li>Add code that opens the <strong>TypeProviders</strong> namespace and instantiates the type provider for the .dbml file that you want to use. If you added the .dbml file to your project, you can omit the ResolutionFolder static parameter.\n<br></li>\n</ul>\n<pre class=\"loading\"><code class=\"lang-fsharp\">open Microsoft.FSharp.Data.TypeProviders\n\n\ntype dbml = DbmlFile&lt;&quot;MyDatabase.dbml&quot;, ResolutionFolder = @&quot;&lt;path-to-folder-that-contains-.dbml-file&gt;&quot;&gt;\n\n// This connection string can be specified at run time.\nlet connectionString = &quot;Data Source=MYSERVER\\INSTANCE;Initial Catalog=MyDatabase;Integrated Security=SSPI;&quot;\nlet dataContext = new dbml.Mydatabase(connectionString)\n</code></pre><p>The DataContext type provides access to all the generated types and inherits from <code>System.Data.Linq.DataContext</code>. The DbmlFile type provider has various static parameters that you can set. For example, you can use a different name for the DataContext type by specifying <code>DataContext=MyDataContext</code>. In that case, your code resembles the following example:\n<br></p>\n<pre class=\"loading\"><code class=\"lang-fsharp\">open Microsoft.FSharp.Data.TypeProviders\n\n\ntype dbml = DbmlFile&lt;&quot;MyDatabase.dbml&quot;, ContextTypeName = &quot;MyDataContext&quot;&gt;\n\n// This connection string can be specified at run time.\nlet connectionString = &quot;Data Source=MYSERVER\\INSTANCE;Initial Catalog=MyDatabase;Integrated Security=SSPI;&quot;\nlet db = new dbml.MyDataContext(connectionString)\n</code></pre><h2 id=\"querying-the-database\">Querying the database</h2>\n<p>In this section, you use F# query expressions to query the database.</p>\n<h4 id=\"to-query-the-data\">To query the data</h4>\n<ul>\n<li>Add code to query the database.\n<br></li>\n</ul>\n<pre class=\"loading\"><code class=\"lang-fsharp\">  query {\n    for row in db.Table1 do\n    where (row.TestData1 &gt; 2)\n    select row\n  } |&gt; Seq.iter (fun row -&gt; printfn &quot;%d %s&quot; row.TestData1 row.Name)\n</code></pre><h2 id=\"next-steps\">Next Steps</h2>\n<p>You can proceed to use other query expressions, or get a database connection from the data context and perform normal ADO.NET data operations. For additional steps, see the sections after &quot;Query the Data&quot; in <a href=\"accessing-a-sql-database\" data-linktype=\"relative-path\">Walkthrough: Accessing a SQL Database by Using Type Providers</a>.</p>\n<h2 id=\"see-also\">See Also</h2>\n<p><a href=\"https://msdn.microsoft.com/visualfsharpdocs/conceptual/dbmlfile-type-provider-%5bfsharp%5d\" data-linktype=\"external\">DbmlFile Type Provider</a></p>\n<p><a href=\"index\" data-linktype=\"relative-path\">Type Providers</a></p>\n<p><a href=\"accessing-a-sql-database\" data-linktype=\"relative-path\">Walkthrough: Accessing a SQL Database by Using Type Providers</a></p>\n<p><a href=\"https://msdn.microsoft.com/library/bb386987\" data-linktype=\"external\">SqlMetal.exe &#40;Code Generation Tool&#41;</a></p>\n<p><a href=\"../../language-reference/query-expressions\" data-linktype=\"relative-path\">Query Expressions</a></p>\n</div></div>","outputRootRelativePath":"../../../../","pageMetadata":"<meta name=\"author\" content=\"cartermp\">\r\n<meta name=\"ms.author\" content=\"phcart\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc1.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.devlang\" content=\"fsharp\">\r\n<meta name=\"ms.assetid\" content=\"6fbb6ccc-248f-4226-95e9-f6f99541dbe4\">\r\n<meta name=\"description\" content=\"Walkthrough: Generating F# Types from a DBML File (F#)\">\r\n<meta name=\"keywords\" content=\"visual f#, f#, functional programming\">\r\n<meta name=\"ms.topic\" content=\"language-reference\">\r\n<meta name=\"ms.date\" content=\"05/16/2016\">\r\n<meta name=\"ms.technology\" content=\"devlang-fsharp\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/fsharp/tutorials/type-providers/generating-fsharp-types-from-dbml.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/fsharp/tutorials/type-providers/generating-fsharp-types-from-dbml.md\">\r\n<meta name=\"document_id\" content=\"405376ee-de58-6300-2ff8-971e1ce5281e\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../../toc1.json\">\r\n","rawMetadata":{"author":"cartermp","ms.author":"phcart","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","title":"Walkthrough: Generating F# Types from a DBML File (F#) | Microsoft Docs","ms.devlang":"fsharp","ms.assetid":"6fbb6ccc-248f-4226-95e9-f6f99541dbe4","description":"Walkthrough: Generating F# Types from a DBML File (F#)","keywords":"visual f#, f#, functional programming","ms.topic":"language-reference","ms.date":"05/16/2016","ms.technology":"devlang-fsharp","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Absolute urls and other fixes (#1281)","commit_sha":"f7dffe4885b331cec8d37f3cc5c9163f69c3b4c9","commit_date":"2016-11-22 12:57:26 -0800"},{"author_name":"Jason Nguyen","author_email":"gofightnguyen@hotmail.com","committer_name":"Maira Wenzel","comitter_email":"mairaw@microsoft.com","message":"Update generating-fsharp-types-from-dbml.md (#1132)","commit_sha":"a90d74813653a985cc1451297e7a171fafbb5ef5","commit_date":"2016-10-11 12:25:57 -0700"},{"author_name":"Petr Onderka","author_email":"gsvick@gmail.com","committer_name":"Maira Wenzel","comitter_email":"mairaw@microsoft.com","message":"Fixed broken links (#1045)","commit_sha":"d10ce6a283195b4e24228e860505533a047afa45","commit_date":"2016-09-20 09:53:56 -0700"},{"author_name":"Petr Onderka","author_email":"gsvick@gmail.com","committer_name":"Maira Wenzel","comitter_email":"mairaw@microsoft.com","message":"Improve titles of some F# articles (#1003)","commit_sha":"d18cfd736f1dbd61ab9e209de4aaa878a88162cd","commit_date":"2016-09-03 11:22:59 -0700"},{"author_name":"Phillip Carter","author_email":"phillip.carter@outlook.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"F# Docs: Update intro, move files, rename language reference for better URLS (#902)","commit_sha":"70a10b9c3e21291c96d927d13f8710d9e0738d4c","commit_date":"2016-08-13 11:22:39 -0700"},{"author_name":"Phillip Carter","author_email":"phillip.carter@outlook.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Add Visual F# Conceptual Content (#900)","commit_sha":"c27bed7dbad6b24c55734fcab0333bd3a1de85d6","commit_date":"2016-08-12 17:06:05 -0700"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/cartermp","display_name":"Phillip Carter","id":"6309070"},"contributors":[{"profile_url":"https://github.com/cartermp","display_name":"Phillip Carter"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"},{"profile_url":"https://github.com/GoFightNguyen","display_name":"Jason Nguyen","id":"6308176"},{"profile_url":"https://github.com/svick","display_name":"Petr Onderka","id":"287848"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/fsharp/tutorials/type-providers/generating-fsharp-types-from-dbml.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/fsharp/tutorials/type-providers/generating-fsharp-types-from-dbml.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/fsharp/tutorials/type-providers/generating-fsharp-types-from-dbml.md","document_id":"405376ee-de58-6300-2ff8-971e1ce5281e","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/fsharp/tutorials/type-providers/generating-fsharp-types-from-dbml","toc_asset_id":"articles/toc.json","toc_rel":"../../../toc.json","_op_ogTitle":"Walkthrough: Generating F# Types from a DBML File (F#)","_op_displayDate":"2016-5-16","_op_displayDate_source":"2016-05-16T00:00:00Z","_op_wordCount":984,"_op_rawTitle":"<h1 id=\"walkthrough-generating-f-types-from-a-dbml-file\" sourcefile=\"docs/fsharp/tutorials/type-providers/generating-fsharp-types-from-dbml.md\" sourcestartlinenumber=\"15\" sourceendlinenumber=\"15\">Walkthrough: Generating F# Types from a DBML File</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/fsharp/tutorials/type-providers/generating-fsharp-types-from-dbml","fileRelativePath":"articles/fsharp/tutorials/type-providers/generating-fsharp-types-from-dbml.html"},"themesRelativePathToOutputRoot":"_themes/"}