{"content":"<div><div class=\"content\">\n<p>This topic describes the keyword <code>use</code> and the <code>using</code> function, which can control the initialization and release of resources.</p>\n<h2 id=\"resources\">Resources</h2>\n<p>The term <em>resource</em> is used in more than one way. Yes, resources can be data that an application uses, such as strings, graphics, and the like, but in this context, <em>resources</em> refers to software or operating system resources, such as graphics device contexts, file handles, network and database connections, concurrency objects such as wait handles, and so on. The use of these resources by applications involves the acquisition of the resource from the operating system or other resource provider, followed by the later release of the resource to the pool so that it can be provided to another application. Problems occur when applications do not release resources back to the common pool.</p>\n<h2 id=\"managing-resources\">Managing Resources</h2>\n<p>To efficiently and responsibly manage resources in an application, you must release resources promptly and in a predictable manner. The .NET Framework helps you do this by providing the <code>System.IDisposable</code> interface. A type that implements <code>System.IDisposable</code> has the <code>System.IDisposable.Dispose</code> method, which correctly frees resources. Well-written applications guarantee that <code>System.IDisposable.Dispose</code> is called promptly when any object that holds a limited resource is no longer needed. Fortunately, most .NET languages provide support to make this easier, and F# is no exception. There are two useful language constructs that support the dispose pattern: the <code>use</code> binding and the <code>using</code> function.</p>\n<h2 id=\"use-binding\">use Binding</h2>\n<p>The <code>use</code> keyword has a form that resembles that of the <code>let</code> binding:</p>\n<p>use <em>value</em> = <em>expression</em></p>\n<p>It provides the same functionality as a <code>let</code> binding but adds a call to <code>Dispose</code> on the value when the value goes out of scope. Note that the compiler inserts a null check on the value, so that if the value is <code>null</code>, the call to <code>Dispose</code> is not attempted.</p>\n<p>The following example shows how to close a file automatically by using the <code>use</code> keyword.</p>\n<pre><code class=\"lang-fsharp\" name=\"Main\">open System.IO\n\nlet writetofile filename obj =\n   use file1 = File.CreateText(filename)\n   file1.WriteLine(&quot;{0}&quot;, obj.ToString() )\n   // file1.Dispose() is called implicitly here.\n\nwritetofile &quot;abc.txt&quot; &quot;Humpty Dumpty sat on a wall.&quot;\n</code></pre><div class=\"NOTE\"><h5>Note</h5><p>You can use <code>use</code> in computation expressions, in which case a customized version of the <code>use</code> expression is used. For more information, see <a href=\"sequences\" data-linktype=\"relative-path\">Sequences</a>, <a href=\"asynchronous-workflows\" data-linktype=\"relative-path\">Asynchronous Workflows</a>, and <a href=\"computation-expressions\" data-linktype=\"relative-path\">Computation Expressions</a>.</p>\n</div>\n<h2 id=\"using-function\">using Function</h2>\n<p>The <code>using</code> function has the following form:</p>\n<p><code>using</code> (<em>expression1</em>) <em>function-or-lambda</em></p>\n<p>In a <code>using</code> expression, <em>expression1</em> creates the object that must be disposed. The result of <em>expression1</em> (the object that must be disposed) becomes an argument, <em>value</em>, to <em>function-or-lambda</em>, which is either a function that expects a single remaining argument of a type that matches the value produced by <em>expression1</em>, or a lambda expression that expects an argument of that type. At the end of the execution of the function, the runtime calls <code>Dispose</code> and frees the resources (unless the value is <code>null</code>, in which case the call to Dispose is not attempted).</p>\n<p>The following example demonstrates the <code>using</code> expression with a lambda expression.</p>\n<pre><code class=\"lang-fsharp\" name=\"Main\">open System.IO\n\nlet writetofile2 filename obj =\n    using (System.IO.File.CreateText(filename)) ( fun file1 -&gt;\n        file1.WriteLine(&quot;{0}&quot;, obj.ToString() )\n    )\n\nwritetofile2 &quot;abc2.txt&quot; &quot;The quick sly fox jumped over the lazy brown dog.&quot;\n</code></pre><p>The next example shows the <code>using</code> expression with a function.</p>\n<pre><code class=\"lang-fsharp\" name=\"Main\">let printToFile (file1 : System.IO.StreamWriter) =\n    file1.WriteLine(&quot;Test output&quot;);\n\nusing (System.IO.File.CreateText(&quot;test.txt&quot;)) printToFile\n</code></pre><p>Note that the function could be a function that has some arguments applied already. The following code example demonstrates this. It creates a file that contains the string <code>XYZ</code>.</p>\n<pre><code class=\"lang-fsharp\" name=\"Main\">let printToFile2 obj (file1 : System.IO.StreamWriter) =\n    file1.WriteLine(obj.ToString())\n\nusing (System.IO.File.CreateText(&quot;test.txt&quot;)) (printToFile2 &quot;XYZ&quot;)\n</code></pre><p>The <code>using</code> function and the <code>use</code> binding are nearly equivalent ways to accomplish the same thing. The <code>using</code> keyword provides more control over when <code>Dispose</code> is called. When you use <code>using</code>, <code>Dispose</code> is called at the end of the function or lambda expression; when you use the <code>use</code> keyword, <code>Dispose</code> is called at the end of the containing code block. In general, you should prefer to use <code>use</code> instead of the <code>using</code> function.</p>\n<h2 id=\"see-also\">See Also</h2>\n<p><a href=\"index\" data-linktype=\"relative-path\">F# Language Reference</a></p>\n</div></div>","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"author\" content=\"cartermp\">\r\n<meta name=\"ms.author\" content=\"phcart\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc.json\">\r\n<meta name=\"ms.devlang\" content=\"fsharp\">\r\n<meta name=\"ms.assetid\" content=\"00c3040e-859f-4dad-a7b5-7b8d44dc232c\">\r\n<meta name=\"description\" content=\"Resource Management: The use Keyword (F#)\">\r\n<meta name=\"keywords\" content=\"visual f#, f#, functional programming\">\r\n<meta name=\"ms.topic\" content=\"language-reference\">\r\n<meta name=\"ms.date\" content=\"05/16/2016\">\r\n<meta name=\"ms.technology\" content=\"devlang-fsharp\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-21 01:42 AM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/fsharp/language-reference/resource-management-the-use-keyword.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/fsharp/language-reference/resource-management-the-use-keyword.md\">\r\n<meta name=\"document_id\" content=\"c0b5ae43-ae1d-b3a1-824a-55c8badcbd37\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../../toc.json\">\r\n","rawMetadata":{"author":"cartermp","ms.author":"phcart","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Resource Management: The use Keyword (F#) | Microsoft Docs","ms.devlang":"fsharp","ms.assetid":"00c3040e-859f-4dad-a7b5-7b8d44dc232c","description":"Resource Management: The use Keyword (F#)","keywords":"visual f#, f#, functional programming","ms.topic":"language-reference","ms.date":"05/16/2016","ms.technology":"devlang-fsharp","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Petr Onderka","author_email":"gsvick@gmail.com","committer_name":"Maira Wenzel","comitter_email":"mairaw@microsoft.com","message":"Improve titles of some F# articles (#1003)","commit_sha":"d18cfd736f1dbd61ab9e209de4aaa878a88162cd","commit_date":"2016-09-03 11:22:59 -0700"},{"author_name":"Phillip Carter","author_email":"phillip.carter@outlook.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Move snippets to snippets folder, now with some F# (#904)","commit_sha":"37fe2b89d590509e8eb14342da988f15862a9e2b","commit_date":"2016-08-13 16:40:56 -0700"},{"author_name":"Phillip Carter","author_email":"phillip.carter@outlook.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Reorganize F# snippets (#903)","commit_sha":"6ea1cf8f3779532a9ed8fbdac32592fbb809443c","commit_date":"2016-08-13 15:14:41 -0700"},{"author_name":"Phillip Carter","author_email":"phillip.carter@outlook.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"F# Docs: Update intro, move files, rename language reference for better URLS (#902)","commit_sha":"70a10b9c3e21291c96d927d13f8710d9e0738d4c","commit_date":"2016-08-13 11:22:39 -0700"}],"updated_at":"2017-03-21 01:42 AM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/cartermp","display_name":"Phillip Carter","id":"6309070"},"contributors":[{"profile_url":"https://github.com/cartermp","display_name":"Phillip Carter"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"},{"profile_url":"https://github.com/svick","display_name":"Petr Onderka","id":"287848"}],"update_at":"3/21/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/fsharp/language-reference/resource-management-the-use-keyword.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/fsharp/language-reference/resource-management-the-use-keyword.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/fsharp/language-reference/resource-management-the-use-keyword.md","document_id":"c0b5ae43-ae1d-b3a1-824a-55c8badcbd37","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/fsharp/language-reference/resource-management-the-use-keyword","toc_asset_id":"articles/toc.json","toc_rel":"../../toc.json","_op_ogTitle":"Resource Management: The use Keyword (F#)","_op_displayDate":"2016-5-16","_op_displayDate_source":"2016-05-16T00:00:00Z","_op_wordCount":651,"_op_rawTitle":"<h1 id=\"resource-management-the-use-keyword\" sourcefile=\"docs/fsharp/language-reference/resource-management-the-use-keyword.md\" sourcestartlinenumber=\"15\" sourceendlinenumber=\"15\">Resource Management: The use Keyword</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/fsharp/language-reference/resource-management-the-use-keyword","fileRelativePath":"articles/fsharp/language-reference/resource-management-the-use-keyword.html"},"themesRelativePathToOutputRoot":"_themes/"}