{"content":"<div><div class=\"content\">\n<p><a href=\"expression-trees-explained\" data-linktype=\"relative-path\">Previous -- Expression Trees Explained</a></p>\n<p>There is a large list of classes in the .NET Core framework that work with Expression Trees.\nYou can see the full\nlist <a href=\"https://docs.microsoft.com/dotnet/core/api/System.Linq.Expressions\" data-linktype=\"external\">here</a>.\nRather than run through the full list, let&#39;s understand how the framework classes have been designed.</p>\n<p>In language design, an expression is a body of code that evaluates and returns a value. Expressions\nmay be very simple: the constant expression <code>1</code> returns the constant value of 1. They may be more\ncomplicated: The expression <code>(-B + Math.Sqrt(B*B + 4 * A * C)) / (2 * A)</code> returns one root for a\nquadratic equation (in the case where the equation has a solution).  </p>\n<h2 id=\"it-all-starts-with-systemlinqexpression\">It all starts with System.Linq.Expression</h2>\n<p>One of the complexities of working with expression trees is that many different\nkinds of expressions are valid in many places in programs. Consider an assignment\nexpression. The right hand side of an assignment could be a constant value, a variable,\na method call expression, or others. That language flexibility means that you may encounter\nmany different expression types anywhere in the nodes of a tree when you traverse an\nexpression tree. Therefore, when you can work with the base expression type, that&#39;s\nthe simplest way to work. However, sometimes you need to know more.\nThe base Expression class contains a <code>NodeType</code> property for this purpose.\nIt returns an <code>ExpressionType</code> which is an enumeration of possible expression types.\nOnce you know the type of the node, you can cast it to that type, and perform\nspecific actions knowing the type of the expression node. You can search for certain\nnode types, and then work with the specific properties of that kind of expression.</p>\n<p>For example, this code will print the name of a variable for a variable access\nexpression. I&#39;ve followed the practice of checking the node type, then\ncasting to a variable access expression and then checking the properties of\nthe specific expression type:</p>\n<pre class=\"loading\"><code class=\"lang-cs\">Expression&lt;Func&lt;int, int&gt;&gt; addFive = (num) =&gt; num + 5;\n\nif (addFive.NodeType == ExpressionType.Lambda)\n{\n    var lambdaExp = (LambdaExpression)addFive;\n\n    var parameter = lambdaExp.Parameters.First();\n\n    Console.WriteLine(parameter.Name);\n    Console.WriteLine(parameter.Type);\n}\n</code></pre><h2 id=\"creating-expression-trees\">Creating Expression Trees</h2>\n<p>The <code>System.Linq.Expression</code> class also contains many static methods to create expressions. These\nmethods create an expression node using the arguments supplied for its children. In this way,\nyou build an expression up from its leaf nodes. For example, this code builds an Add expression:</p>\n<pre class=\"loading\"><code class=\"lang-cs\">// Addition is an add expression for &quot;1 + 2&quot;\nvar one = Expression.Constant(1, typeof(int));\nvar two = Expression.Constant(2, typeof(int));\nvar addition = Expression.Add(one, two);\n</code></pre><p>You can see from this simple example that many types are involved in creating and working\nwith expression trees. That complexity is necessary to provide the capabilities of\nthe rich vocabulary provided by the C# language.</p>\n<h2 id=\"navigating-the-apis\">Navigating the APIs</h2>\n<p>There are Expression node types that map to almost all of the syntax elements of the\nC# language. Each type has specific methods for that type of language element. It&#39;s a lot\nto keep in your head at one time. Rather than try to memorize everything, here are the techniques\nI use to work with Expression trees:</p>\n<ol>\n<li>Look at the members of the <code>ExpressionType</code> enum to determine possible nodes you should be\nexamining. This really helps when you want to traverse and understand an expression tree.</li>\n<li>Look at the static members of the <code>Expression</code> class to build an expression. Those methods\ncan build any expression type from a set of its child nodes.</li>\n<li>Look at the <code>ExpressionVisitor</code> class to build a modified expression tree.</li>\n</ol>\n<p>You&#39;ll find more as you look at each of those three areas. Invariably, you will find what you need when\nyou start with one of those three steps.</p>\n<p> <a href=\"expression-trees-execution\" data-linktype=\"relative-path\">Next -- Executing Expression Trees</a></p>\n</div></div>","outputRootRelativePath":"../../","pageMetadata":"<meta name=\"author\" content=\"BillWagner\">\r\n<meta name=\"ms.author\" content=\"wiwagn\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc1.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.devlang\" content=\"csharp\">\r\n<meta name=\"ms.assetid\" content=\"e9c85021-0d36-48af-91b7-aaaa66f22654\">\r\n<meta name=\"description\" content=\"Framework Types Supporting Expression Trees\">\r\n<meta name=\"keywords\" content=\".NET, .NET Core\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"06/20/2016\">\r\n<meta name=\"ms.technology\" content=\"devlang-csharp\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/csharp/expression-classes.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/csharp/expression-classes.md\">\r\n<meta name=\"document_id\" content=\"c4ee5065-6c65-98d5-1bae-31976de58d63\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"../toc1.json\">\r\n","rawMetadata":{"author":"BillWagner","ms.author":"wiwagn","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","title":"Framework Types Supporting Expression Trees | Microsoft Docs","ms.devlang":"csharp","ms.assetid":"e9c85021-0d36-48af-91b7-aaaa66f22654","description":"Framework Types Supporting Expression Trees","keywords":".NET, .NET Core","ms.topic":"article","ms.date":"06/20/2016","ms.technology":"devlang-csharp","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Bill Wagner","author_email":"wiwagn@microsoft.com","committer_name":"Rich Lander","comitter_email":"rlander@microsoft.com","message":"Promote csharp from languages (#644)","commit_sha":"2d44b7e04c0fe2ca136ba6dfa9fc3a4368365ec8","commit_date":"2016-06-26 08:30:56 -0700"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/BillWagner","display_name":"Bill Wagner","id":"493969"},"contributors":[{"profile_url":"https://github.com/BillWagner","display_name":"Bill Wagner"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/csharp/expression-classes.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/csharp/expression-classes.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/csharp/expression-classes.md","document_id":"c4ee5065-6c65-98d5-1bae-31976de58d63","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/csharp/expression-classes","toc_asset_id":"articles/toc.json","toc_rel":"../toc.json","_op_ogTitle":"Framework Types Supporting Expression Trees","_op_displayDate":"2016-6-20","_op_displayDate_source":"2016-06-20T00:00:00Z","_op_wordCount":615,"_op_rawTitle":"<h1 id=\"framework-types-supporting-expression-trees\" sourcefile=\"docs/csharp/expression-classes.md\" sourcestartlinenumber=\"15\" sourceendlinenumber=\"15\">Framework Types Supporting Expression Trees</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/csharp/expression-classes","fileRelativePath":"articles/csharp/expression-classes.html"},"themesRelativePathToOutputRoot":"_themes/"}