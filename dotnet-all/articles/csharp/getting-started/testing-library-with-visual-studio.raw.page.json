{"content":"<div><div class=\"content\">\n<p>In <a href=\"library-with-visual-studio-2017\" data-linktype=\"relative-path\">Building a class library with C# and .NET Core in Visual Studio 2017</a>, we created a simple class library that adds an extension method to the <a class=\"xref\" href=\"../../../api/system.string\" data-linktype=\"relative-path\">String</a> class. Now, we&#39;ll create a unit test to make sure that it works as expected. We&#39;ll add our unit test project to the solution we created in the previous topic.</p>\n<h2 id=\"creating-a-unit-test-project\">Creating a unit test project</h2>\n<p>To create the unit test project, do the following:</p>\n<ol>\n<li><p>In Solution Explorer, open the context menu for the <strong>ClassLibraryProject</strong> solution node, and choose <strong>Add</strong>, <strong>New Project</strong>.</p>\n<!-- Need a VS 2017 version  [!NOTE] In addition to a Unit Test project, you can also use Visual Studio to create an XUnit test project for .NET Core. For a walkthrough that includes an XUnit test project, see [Getting started with .NET Core on Windows, using Visual Studio 2015](../../core/tutorials/using-on-windows.md). --> \n</li>\n<li><p>In the <strong>Add New Project</strong> dialog box, expand the <strong>Visual C#</strong> node and the <strong>.NET Core</strong> node, then choose the <strong>Unit Test Project (.NET Core)</strong> project template and name it <code>StringLibraryTest</code>, as the following figure shows.</p>\n<p><img src=\"media/testproject.jpg\" alt=\"Image\" data-linktype=\"relative-path\"></p>\n</li>\n<li><p>Choose the <strong>OK</strong> button to create the project. Visual Studio creates the project and opens the <code>UnitTest1.cs</code> file in the code window, as the following figure shows.</p>\n<p><img src=\"media/unit_test_code_window.jpg\" alt=\"Image\" data-linktype=\"relative-path\"></p>\n<p>The source code created by the unit test template does the following:</p>\n<ul>\n<li><p>It imports the <a href=\"https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.aspx\" data-linktype=\"external\">Microsoft.VisualStudio.TestTools.UnitTesting</a> namespace, which contains the types used for unit testing.</p>\n</li>\n<li><p>It applies the <a href=\"https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx\" data-linktype=\"external\">[TestClass]</a> attribute to the <code>UnitTest1</code> class. Each test method in a test class tagged with the [TestMethod] attribute will be executed automatically when the unit test is run.</p>\n</li>\n<li><p>It applies the <a href=\"https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx\" data-linktype=\"external\">[TestMethod]</a> attribute to define <code>TestMethod1</code> as a test method to be automatically executed when the unit test is run.</p>\n</li>\n</ul>\n</li>\n<li><p>In Solution Explorer, open the context menu for the <strong>Dependencies</strong> node of the <strong>StringLibraryTest</strong> project and choose <strong>Add Reference</strong>. This adds a reference to our class library project, <code>StringLibrary</code>. </p>\n</li>\n<li><p>In the <strong>Reference Manager</strong> dialog, expand the <strong>Projects</strong> node and choose <strong>Solution</strong>, and then check the box next to <strong>StringLibrary</strong>, as the following figure shows. Adding a reference to the <code>StringLibrary</code> assembly allows the compiler to resolve calls to <strong>StringLibrary</strong> methods.</p>\n<p><img src=\"media/add_reference.jpg\" alt=\"Image\" data-linktype=\"relative-path\"></p>\n</li>\n<li><p>Click the <strong>OK</strong> button to close the <strong>Reference Manager</strong> dialog.</p>\n</li>\n</ol>\n<h2 id=\"adding-and-running-unit-test-methods\">Adding and running unit test methods</h2>\n<p>When Visual Studio runs a unit test, it executes each method marked with the <a href=\"https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx\" data-linktype=\"external\">[TestMethod]</a> attribute in a unit test class (the class to which the  <a href=\"https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx\" data-linktype=\"external\">[TestClass]</a> attribute is applied. A test method ends when the first failure is encountered, or when all tests contained in the method have succeeded.</p>\n<p>The most common tests call members of the <a href=\"https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.assert.aspx\" data-linktype=\"external\">Assert</a> class. Many assert methods include at least two parameters, one of which is the expected test result and the other of which is the actual test result. Some of its most frequently called methods include:</p>\n<ul>\n<li><p><code>Assert.AreEqual</code>, which verifies that two values or objects are equal. The assert fails if the values or objects are not equal.</p>\n</li>\n<li><p><code>Assert.AreSame</code>, which verifies that two object variables refer to the same object. The assert fails if the variables refer to different objects.</p>\n</li>\n<li><p><code>Assert.IsFalse</code>, which verifies that a condition is False. The assert fails if the condition is True.</p>\n</li>\n<li><p><code>Assert.IsNotNull</code>, which verifies that an object is not <code>null</code>. The assert fails if the object is <code>null</code>.</p>\n</li>\n</ul>\n<p>In addition, the <a href=\"https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.expectedexceptionattribute.aspx\" data-linktype=\"external\">[ExpectedException]</a> attribute can be used to indicate the type of exception a test method is expected to throw. You use it to test conditions that should result in an exception. The test fails if the specified exception is not thrown.</p>\n<p>In testing the <code>StringLibrary.StartsWithUpper</code> method, we want to provide a number of strings that begin with an uppercase character. We expect the method to return <code>True</code> in these cases, so we can call the <a href=\"https://msdn.microsoft.com/library/ms243754.aspx\" data-linktype=\"external\">Assert.IsTrue(Boolean, String)</a> method. Similarly, we want to provide a number of strings that begin with something other than an uppercase character. We expect the method to return False in these cases, so we can call the <a href=\"https://msdn.microsoft.com/library/ms243805.aspx\" data-linktype=\"external\">Assert.IsFalse(Boolean, String)</a> method.</p>\n<p>Since our library method handles strings, we also want to make sure that it successfully handles an <a class=\"xref\" href=\"../../../api/system.string#System_String_Empty\" data-linktype=\"relative-path\">empty string</a> (a valid string that has no characters and whose <a class=\"xref\" href=\"../../../api/system.string#System_String_Length\" data-linktype=\"relative-path\">Length</a> is 0) and a <code>null</code> string (a string that has not been initialized). If <code>StartsWithUpper</code> is called as an extension method on a <a class=\"xref\" href=\"../../../api/system.string\" data-linktype=\"relative-path\">String</a> instance, it cannot be passed a <code>null</code> string. However, it can also be called directly as a static method and passed a single <a class=\"xref\" href=\"../../../api/system.string\" data-linktype=\"relative-path\">String</a> argument.</p>\n<p>We&#39;ll define three methods, each of which calls its <a href=\"https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.assert.aspx\" data-linktype=\"external\">Assert</a> method repeatedly for each element in a string array. Because the test method fails as soon as it encounters the first failure, we&#39;ll call a method overload that allows us to pass a string that indicates the string value used in the method call.</p>\n<p>To create the the test methods:</p>\n<ol>\n<li><p>Replace the code in the code window with the following code:</p>\n<pre><code class=\"lang-csharp\" name=\"Test#1\">[TestMethod]\npublic void TestStartsWithUpper()\n{\n    // Tests that we expect to return true.\n    string[] words = { &quot;Alphabet&quot;, &quot;Zebra&quot;, &quot;ABC&quot;, &quot;Αθήνα&quot;, &quot;Москва&quot; };\n    foreach (var word in words)\n    {\n        bool result = word.StartsWithUpper();\n        Assert.IsTrue(result,\n               String.Format(&quot;Expected for &#39;{0}&#39;: true; Actual: {1}&quot;,\n                             word, result));\n    }\n}\n\n[TestMethod]\npublic void TestDoesNotStartWithUpper()\n{\n    // Tests that we expect to return false.\n    string[] words = { &quot;alphabet&quot;, &quot;zebra&quot;, &quot;abc&quot;, &quot;αυτοκινητοβιομηχανία&quot;, &quot;государство&quot;,\n                       &quot;1234&quot;, &quot;.&quot;, &quot;;&quot;, &quot; &quot; };\n    foreach (var word in words)\n    {\n        bool result = word.StartsWithUpper();\n        Assert.IsFalse(result,\n               String.Format(&quot;Expected for &#39;{0}&#39;: false; Actual: {1}&quot;,\n                             word, result));\n    }\n}\n\n[TestMethod]\npublic void DirectCallWithNullOrEmpty()\n{\n    // Tests that we expect to return false.\n    string[] words = { string.Empty, null };\n    foreach (var word in words)\n    {\n        bool result = StringLibrary.StartsWithUpper(word);\n        Assert.IsFalse(result,\n               String.Format(&quot;Expected for &#39;{0}&#39;: false; Actual: {1}&quot;,\n                             word == null ? &quot;&lt;null&gt;&quot; : word, result));\n    }\n}\n</code></pre><p>Note that our test of uppercase characters in the <code>TestStartsWithUpper</code> method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the <code>TestDoesNotStartWithUpper</code> method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).</p>\n</li>\n<li><p>On the menu bar, choose <strong>File</strong>, <strong>Save UnitTest1.cs As...</strong>. In the <strong>File Save As</strong> dialog, choose the arrow beside the <strong>Save</strong> button, and then choose <strong>Save with Encoding...</strong>*.</p>\n</li>\n<li><p>In the Confirm Save As dialog, choose the <strong>Yes</strong> button to save the file.</p>\n</li>\n<li><p>From the <strong>Encoding</strong> drop-down list of the <strong>Advanced Save Options</strong> dialog, choose <strong>Unicode (UTF-8 with signature) - Codepage 65001</strong>, and then choose <strong>OK</strong>.</p>\n<p>If you fail to save your source code in a UTF8-encoded file, Visual Studio may save it as an ASCII file. In that case, the runtime will not accurately decode characters outside the ASCII range, and the test results will not be accurate.</p>\n</li>\n<li><p>On the menu bar, choose <strong>Test</strong>, <strong>Run</strong>, <strong>All Tests</strong>. The <strong>Test Explorer</strong> window should open and show that both tests have run successfully, as the following figure shows. Note that the three tests are listed in the <strong>Passed Tests</strong> section, and the <strong>Summary</strong> section reports the result of the test run.</p>\n<p><img src=\"media/first_test.jpg\" alt=\"Image\" data-linktype=\"relative-path\"></p>\n</li>\n</ol>\n<h2 id=\"handling-test-failures\">Handling test failures</h2>\n<p>Our test run had no failures, so let&#39;s change it slightly so that one of the test methods fails:</p>\n<ol>\n<li><p>Modify the <code>words</code> array in the <code>TestDoesNotStartWithUpper</code> method to include the string &quot;Error&quot;, so that the statement reads as follows:</p>\n<pre class=\"loading\"><code class=\"lang-cs\">string[] words = { &quot;alphabet&quot;, &quot;Error&quot;, &quot;zebra&quot;, &quot;abc&quot;, &quot;αυτοκινητοβιομηχανία&quot;, &quot;государство&quot;,\n                   &quot;1234&quot;, &quot;.&quot;, &quot;;&quot;, &quot; &quot; };\n</code></pre></li>\n<li><p>Run the test by choosing <strong>Test</strong>, <strong>Run</strong>, <strong>All Tests</strong>. The <strong>Test Explorer</strong> window now indicates that two tests have succeeded and one failed, as the following figure shows.</p>\n<p><img src=\"media/failed_test.jpg\" alt=\"Image\" data-linktype=\"relative-path\"></p>\n</li>\n<li><p>Choose the failed test, <code>TestDoesNotStartWith</code>, in the <strong>Failed Tests</strong> section. The lower pane of the <strong>Test Explorer</strong> displays the message produced by the assert: &quot;Assert.IsFalse failed. Expected for &#39;Error&#39;: false; actual: True&quot;, as the following figure of <strong>Test Explorer</strong> shows. Because of the failure, all strings in the array after &quot;Error&quot; were not tested.</p>\n<p><img src=\"media/failed_test2.jpg\" alt=\"Image\" data-linktype=\"relative-path\"></p>\n</li>\n<li><p>Remove the code that was added (<code>&quot;Error&quot;,</code>) and rerun the test. It should now pass.</p>\n</li>\n</ol>\n<h2 id=\"testing-the-release-version-of-the-library\">Testing the Release version of the library</h2>\n<p>We&#39;ve been running our tests against the Debug version of the library. Now that our tests have all passed and we&#39;ve adequately tested our library, we should run the tests an additional time against the Release build of the library. A number of factors, including compiler optimizations, can sometimes produce different behavior between Debug and Release builds.</p>\n<p>To test the Release build:</p>\n<ol>\n<li><p>In the Visual Studio toolbar, change the build configuration from <strong>Debug</strong> to <strong>Release</strong>. The following figure shows a portion of the toolbar.</p>\n<p><img src=\"media/lib_release.jpg\" alt=\"Image\" data-linktype=\"relative-path\"></p>\n</li>\n<li><p>In <strong>Solution Explorer</strong>, open the context menu for the <strong>StringLibrary</strong> project node and choose <strong>Build</strong> to recompile the library.</p>\n</li>\n<li><p>Re-run the unit tests by choosing <strong>Test</strong>, <strong>Run</strong>, <strong>All Tests</strong> from the Visual Studio menu. The tests should all pass.</p>\n</li>\n</ol>\n<p>Now that you&#39;ve finished testing your library, the next step is to make it available to callers. You can bundle it with one or more applications, or you can distribute it as a NuGet package. For information about how to do this, see <a href=\"consuming-library-with-visual-studio-2017\" data-linktype=\"relative-path\">Consuming a .NET Standard Class Library</a>.</p>\n</div></div>","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"shoag\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc1.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.devlang\" content=\"csharp\">\r\n<meta name=\"ms.assetid\" content=\"069ad711-3eaa-45c6-94d7-b40249cc8b99\">\r\n<meta name=\"description\" content=\"Learn how to test a class library written in C# using Visual Studio 2017\">\r\n<meta name=\"keywords\" content=\".NET Core, .NET Standard class library, Visual Studio 2017, unit testing\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"11/16/2016\">\r\n<meta name=\"ms.technology\" content=\"devlang-csharp\">\r\n<meta name=\"ms.prod\" content=\".net-core\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-15 06:14 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/594f8bfc6ab944d56d0249d05b99bb6fc209666c/docs/csharp/getting-started/testing-library-with-visual-studio.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/csharp/getting-started/testing-library-with-visual-studio.md\">\r\n<meta name=\"document_id\" content=\"b134dcde-9014-847c-b536-06490a10078c\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc1.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"shoag","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","title":"Testing a class library with .NET Core in Visual Studio 2017 | Microsoft Docs","ms.devlang":"csharp","ms.assetid":"069ad711-3eaa-45c6-94d7-b40249cc8b99","description":"Learn how to test a class library written in C# using Visual Studio 2017","keywords":".NET Core, .NET Standard class library, Visual Studio 2017, unit testing","ms.topic":"article","ms.date":"11/16/2016","ms.technology":"devlang-csharp","ms.prod":".net-core","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Maira Wenzel","comitter_email":"mairaw@microsoft.com","message":"bringing changes back","commit_sha":"594f8bfc6ab944d56d0249d05b99bb6fc209666c","commit_date":"2017-03-06 12:01:31 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"reverting merge (#1447)","commit_sha":"a8019c9fc25ef458aa555743e61cd83a3beb11ed","commit_date":"2017-01-24 07:04:28 -0800"},{"author_name":"rpetrusha","author_email":"ronpet@microsoft.com","committer_name":"rpetrusha","comitter_email":"ronpet@microsoft.com","message":"Removed RC from Visual Studio 2017 product name","commit_sha":"21de50320db3399a80602b4e862cb54c71043e0d","commit_date":"2017-01-18 12:58:36 -0800"},{"author_name":"jfaustino","author_email":"jfaustino5@outlook.com","committer_name":"Maira Wenzel","comitter_email":"mairaw@microsoft.com","message":"Change class reference to match image (#1400)","commit_sha":"74304e0dc9ce7ea78197fda39ead2ced27e929a3","commit_date":"2017-01-10 01:03:30 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Absolute urls and other fixes (#1281)","commit_sha":"f7dffe4885b331cec8d37f3cc5c9163f69c3b4c9","commit_date":"2016-11-22 12:57:26 -0800"},{"author_name":"Bill Wagner","author_email":"wiwagn@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Fix broken connect links (#1250)","commit_sha":"d6ce9e3dd3c1189f35d147d140bb45095b3d77a5","commit_date":"2016-11-16 16:00:06 -0500"},{"author_name":"Bill Wagner","author_email":"wiwagn@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":"fix the link URL for a code snippet","commit_sha":"80bc3935a9c51b6141945a4cd76acd970f0bef1e","commit_date":"2016-11-16 09:43:33 -0500"},{"author_name":"Bill Wagner","author_email":"wiwagn@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":"fix one build error.","commit_sha":"b3477c5453164a3e4783f5914e9474e6aaa4e4b8","commit_date":"2016-11-16 09:43:33 -0500"},{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":"Updated for final RC build (#2)","commit_sha":"edbec6c5f9a0b75e7be5a7f9737a3b91ea6c73a2","commit_date":"2016-11-16 09:43:33 -0500"},{"author_name":"rpetrusha","author_email":"ronpet@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":"Checkin for class library tutorial.","commit_sha":"d422fafa307910a7f4fdd34530aed75dd1cf2867","commit_date":"2016-11-16 09:43:33 -0500"}],"updated_at":"2017-03-15 06:14 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"},{"profile_url":"https://github.com/rpetrusha","display_name":"rpetrusha","id":"10886961"},{"profile_url":"https://github.com/jfaustino","display_name":"jfaustino","id":"6244917"},{"profile_url":"https://github.com/BillWagner","display_name":"Bill Wagner","id":"493969"}],"update_at":"3/15/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/594f8bfc6ab944d56d0249d05b99bb6fc209666c/docs/csharp/getting-started/testing-library-with-visual-studio.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/csharp/getting-started/testing-library-with-visual-studio.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/csharp/getting-started/testing-library-with-visual-studio.md","document_id":"b134dcde-9014-847c-b536-06490a10078c","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/csharp/getting-started/testing-library-with-visual-studio","toc_asset_id":"articles/csharp/getting-started/toc.json","toc_rel":"toc.json","_op_ogTitle":"Testing a class library with .NET Core in Visual Studio 2017","_op_displayDate":"2016-11-16","_op_displayDate_source":"2016-11-16T00:00:00Z","_op_wordCount":1479,"_op_rawTitle":"<h1 id=\"testing-a-class-library-with-net-core-in-visual-studio-2017\" sourcefile=\"docs/csharp/getting-started/testing-library-with-visual-studio.md\" sourcestartlinenumber=\"15\" sourceendlinenumber=\"15\">Testing a class library with .NET Core in Visual Studio 2017</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/csharp/getting-started/testing-library-with-visual-studio","fileRelativePath":"articles/csharp/getting-started/testing-library-with-visual-studio.html"},"themesRelativePathToOutputRoot":"_themes/"}