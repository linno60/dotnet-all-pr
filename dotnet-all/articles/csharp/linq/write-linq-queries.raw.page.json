{"content":"<div><div class=\"content\">\n<p>This topic shows the three ways in which you can write a LINQ query in C#:  </p>\n<ol>\n<li><p>Use query syntax.  </p>\n</li>\n<li><p>Use method syntax.  </p>\n</li>\n<li><p>Use a combination of query syntax and method syntax.  </p>\n<p>The following examples demonstrate some simple LINQ queries by using each approach listed previously. In general, the rule is to use (1) whenever possible, and use (2) and (3) whenever necessary.  </p>\n</li>\n</ol>\n<div class=\"NOTE\"><h5>Note</h5><p> These queries operate on simple in-memory collections; however, the basic syntax is identical to that used in LINQ to Entities and LINQ to XML.  </p>\n</div>\n<h2 id=\"example\">Example</h2>\n<h2 id=\"query-syntax\">Query syntax</h2>\n<p> The recommended way to write most queries is to use <em>query syntax</em> to create <em>query expressions</em>. The following example shows three query expressions. The first query expression demonstrates how to filter or restrict results by applying conditions with a <code>where</code> clause. It returns all elements in the source sequence whose values are greater than 7 or less than 3. The second expression demonstrates how to order the returned results. The third expression demonstrates how to group results according to a key. This query returns two groups based on the first letter of the word.  </p>\n<pre><code class=\"lang-cs\" name=\"csProgGuideLINQ#5\">            // Query #1.\n            List&lt;int&gt; numbers = new List&lt;int&gt;() { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };\n\n            // The query variable can also be implicitly typed by using var\n            IEnumerable&lt;int&gt; filteringQuery =\n                from num in numbers\n                where num &lt; 3 || num &gt; 7\n                select num;\n\n            // Query #2.\n            IEnumerable&lt;int&gt; orderingQuery =\n                from num in numbers\n                where num &lt; 3 || num &gt; 7\n                orderby num ascending\n                select num;\n\n            // Query #3.\n            string[] groupingQuery = { &quot;carrots&quot;, &quot;cabbage&quot;, &quot;broccoli&quot;, &quot;beans&quot;, &quot;barley&quot; };\n            IEnumerable&lt;IGrouping&lt;char, string&gt;&gt; queryFoodGroups =\n                from item in groupingQuery\n                group item by item[0];\n</code></pre><p> Note that the type of the queries is <a class=\"xref\" href=\"../../../api/system.collections.generic.ienumerable-1\" data-linktype=\"relative-path\">IEnumerable&lt;T&gt;</a>. All of these queries could be written using <code>var</code> as shown in the following example:  </p>\n<p> <code>var query = from num in numbers...</code>  </p>\n<p> In each previous example, the queries do not actually execute until you iterate over the query variable in a <code>foreach</code> statement or other statement. For more information, see <a href=\"../programming-guide/concepts/linq/introduction-to-linq-queries\" data-linktype=\"relative-path\">Introduction to LINQ Queries</a>.  </p>\n<h2 id=\"example-1\">Example</h2>\n<h2 id=\"method-syntax\">Method syntax</h2>\n<p> Some query operations must be expressed as a method call. The most common such methods are those that return singleton numeric values, such as <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/bb345537(v=vs.110).aspx\" data-linktype=\"external\">Sum</a>, <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/bb343284(v=vs.110).aspx\" data-linktype=\"external\">Max</a>, <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/bb361228(v=vs.110).aspx\" data-linktype=\"external\">Min</a>, <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/bb298366(v=vs.110).aspx\" data-linktype=\"external\">Average</a>, and so on. These methods must always be called last in any query because they represent only a single value and cannot serve as the source for an additional query operation. The following example shows a method call in a query expression:  </p>\n<pre><code class=\"lang-cs\" name=\"csProgGuideLINQ#6\">            List&lt;int&gt; numbers1 = new List&lt;int&gt;() { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };\n            List&lt;int&gt; numbers2 = new List&lt;int&gt;() { 15, 14, 11, 13, 19, 18, 16, 17, 12, 10 };\n            // Query #4.\n            double average = numbers1.Average();\n\n            // Query #5.\n            IEnumerable&lt;int&gt; concatenationQuery = numbers1.Concat(numbers2);\n</code></pre><h2 id=\"example-2\">Example</h2>\n<p> If the method has  Action or Func parameters, these are provided in the form of a <a href=\"../programming-guide/statements-expressions-operators/lambda-expressions\" data-linktype=\"relative-path\">lambda</a> expression, as shown in the following example:  </p>\n<pre><code class=\"lang-cs\" name=\"csProgGuideLINQ#7\">            // Query #6.\n            IEnumerable&lt;int&gt; largeNumbersQuery = numbers2.Where(c =&gt; c &gt; 15);\n</code></pre><p> In the previous queries, only Query #4 executes immediately. This is because it returns a single value, and not a generic <a class=\"xref\" href=\"../../../api/system.collections.generic.ienumerable-1\" data-linktype=\"relative-path\">IEnumerable&lt;T&gt;</a> collection. The method itself has to use <code>foreach</code> in order to compute its value.  </p>\n<p> Each of the previous queries can be written by using implicit typing with <a href=\"../language-reference/keywords/var\" data-linktype=\"relative-path\">var</a>, as shown in the following example:  </p>\n<pre><code class=\"lang-cs\" name=\"csProgGuideLINQ#8\">            // var is used for convenience in these queries\n            var average = numbers1.Average();\n            var concatenationQuery = numbers1.Concat(numbers2);\n            var largeNumbersQuery = numbers2.Where(c =&gt; c &gt; 15);\n</code></pre><h2 id=\"example-3\">Example</h2>\n<h2 id=\"mixed-query-and-method-syntax\">Mixed query and method syntax</h2>\n<p> This example shows how to use method syntax on the results of a query clause. Just enclose the query expression in parentheses, and then apply the dot operator and call the method. In the following example, query #7 returns a count of the numbers whose value is between 3 and 7. In general, however, it is better to use a second variable to store the result of the method call. In this manner, the query is less likely to be confused with the results of the query.  </p>\n<pre><code class=\"lang-cs\" name=\"csProgGuideLINQ#9\">            // Query #7.\n\n            // Using a query expression with method syntax\n            int numCount1 =\n                (from num in numbers1\n                 where num &lt; 3 || num &gt; 7\n                 select num).Count();\n\n            // Better: Create a new variable to store\n            // the method call result\n            IEnumerable&lt;int&gt; numbersQuery =\n                from num in numbers1\n                where num &lt; 3 || num &gt; 7\n                select num;\n\n            int numCount2 = numbersQuery.Count();\n</code></pre><p> Because Query #7 returns a single value and not a collection, the query executes immediately.  </p>\n<p> The previous query can be written by using implicit typing with <code>var</code>, as follows:  </p>\n<pre class=\"loading\"><code class=\"lang-cs\">var numCount = (from num in numbers...  \n</code></pre><p> It can be written in method syntax as follows:  </p>\n<pre class=\"loading\"><code class=\"lang-cs\">var numCount = numbers.Where(n =&gt; n &lt; 3 || n &gt; 7).Count();  \n</code></pre><p> It can be written by using explicit typing, as follows:  </p>\n<pre class=\"loading\"><code class=\"lang-cs\">int numCount = numbers.Where(n =&gt; n &lt; 3 || n &gt; 7).Count();  \n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p>  <a href=\"../programming-guide/concepts/linq/walkthrough-writing-queries-linq\" data-linktype=\"relative-path\">Walkthrough: Writing Queries in C#</a><br> <a href=\"index\" data-linktype=\"relative-path\">LINQ Query Expressions</a><br> <a href=\"../language-reference/keywords/where-clause\" data-linktype=\"relative-path\">where clause</a></p>\n</div></div>","outputRootRelativePath":"../../../","pageMetadata":"<meta name=\"author\" content=\"stevehoag\">\r\n<meta name=\"ms.author\" content=\"wiwagn\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc2.json\">\r\n<meta name=\"ms.devlang\" content=\"dotnet\">\r\n<meta name=\"ms.assetid\" content=\"30703f79-cf3a-4d02-b892-c95d58a1d9ed\">\r\n<meta name=\"description\" content=\"How to write queries.\">\r\n<meta name=\"keywords\" content=\".NET, .NET Core, C#\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"12/1/2016\">\r\n<meta name=\"ms.technology\" content=\".net-core-technologies\">\r\n<meta name=\"ms.prod\" content=\".net-core\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-21 01:42 AM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/97a29e60f5d861d848b85ef1e8ed8b1988f9ced1/docs/csharp/linq/write-linq-queries.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/csharp/linq/write-linq-queries.md\">\r\n<meta name=\"document_id\" content=\"3a2b70d7-eb03-4fea-1657-5e4bb0bc5793\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"stevehoag","ms.author":"wiwagn","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Write LINQ queries in C# | Microsoft Docs","ms.devlang":"dotnet","ms.assetid":"30703f79-cf3a-4d02-b892-c95d58a1d9ed","description":"How to write queries.","keywords":".NET, .NET Core, C#","ms.topic":"article","ms.date":"12/1/2016","ms.technology":".net-core-technologies","ms.prod":".net-core","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Steve Hoag","author_email":"shoag@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Updated LINQ topics for C# Concepts section (#1302)","commit_sha":"97a29e60f5d861d848b85ef1e8ed8b1988f9ced1","commit_date":"2016-12-12 09:02:31 -0800"}],"updated_at":"2017-03-21 01:42 AM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag","id":"13489215"},"contributors":[{"profile_url":"https://github.com/stevehoag","display_name":"Steve Hoag"}],"update_at":"3/21/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/97a29e60f5d861d848b85ef1e8ed8b1988f9ced1/docs/csharp/linq/write-linq-queries.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/csharp/linq/write-linq-queries.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/csharp/linq/write-linq-queries.md","document_id":"3a2b70d7-eb03-4fea-1657-5e4bb0bc5793","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/csharp/linq/write-linq-queries","toc_asset_id":"articles/csharp/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"Write LINQ queries in C#","_op_displayDate":"2016-12-1","_op_displayDate_source":"2016-12-01T00:00:00Z","_op_wordCount":822,"_op_rawTitle":"<h1 id=\"write-linq-queries-in-c\" sourcefile=\"docs/csharp/linq/write-linq-queries.md\" sourcestartlinenumber=\"16\" sourceendlinenumber=\"16\">Write LINQ queries in C</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/csharp/linq/write-linq-queries","fileRelativePath":"articles/csharp/linq/write-linq-queries.html"},"themesRelativePathToOutputRoot":"_themes/"}