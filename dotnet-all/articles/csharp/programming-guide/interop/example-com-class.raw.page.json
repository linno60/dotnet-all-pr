{"content":"<div><div class=\"content\">\n<p>The following is an example of a class that you would expose as a COM object. After this code has been placed in a .cs file and added to your project, set the <strong>Register for COM Interop</strong> property to <strong>True</strong>. For more information, see <a href=\"http://msdn.microsoft.com/en-us/4de7d474-56e8-4027-994d-d47ca4725c5e\" data-linktype=\"external\">NIB: How to: Register a Component for COM Interop</a>.  </p>\n<p> Exposing Visual C# objects to COM requires declaring a class interface, an events interface if it is required, and the class itself. Class members must follow these rules to be visible to COM:  </p>\n<ul>\n<li><p>The class must be public.  </p>\n</li>\n<li><p>Properties, methods, and events must be public.  </p>\n</li>\n<li><p>Properties and methods must be declared on the class interface.  </p>\n</li>\n<li><p>Events must be declared in the event interface.  </p>\n<p>Other public members in the class that are not declared in these interfaces will not be visible to COM, but they will be visible to other .NET Framework objects.  </p>\n<p>To expose properties and methods to COM, you must declare them on the class interface and mark them with a <code>DispId</code> attribute, and implement them in the class. The order in which the members are declared in the interface is the order used for the COM vtable.  </p>\n<p>To expose events from your class, you must declare them on the events interface and mark them with a <code>DispId</code> attribute. The class should not implement this interface.  </p>\n<p>The class implements the class interface; it can implement more than one interface, but the first implementation will be the default class interface. Implement the methods and properties exposed to COM here. They must be marked public and must match the declarations in the class interface. Also, declare the events raised by the class here. They must be marked public and must match the declarations in the events interface.  </p>\n</li>\n</ul>\n<h2 id=\"example\">Example</h2>\n<pre><code class=\"lang-cs\" name=\"csProgGuideInterop#8\">using System.Runtime.InteropServices;\n\nnamespace project_name\n{\n    [Guid(&quot;EAA4976A-45C3-4BC5-BC0B-E474F4C3C83F&quot;)]\n    public interface ComClass1Interface\n    {\n    }\n\n    [Guid(&quot;7BD20046-DF8C-44A6-8F6B-687FAA26FA71&quot;), \n        InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]\n    public interface ComClass1Events \n    {\n    }\n\n    [Guid(&quot;0D53A3E8-E51A-49C7-944E-E72A2064F938&quot;),\n        ClassInterface(ClassInterfaceType.None),\n        ComSourceInterfaces(typeof(ComClass1Events))]\n    public class ComClass1 : ComClass1Interface\n    {\n    }\n}\n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"../index\" data-linktype=\"relative-path\">C# Programming Guide</a><br> <a href=\"index\" data-linktype=\"relative-path\">Interoperability</a><br> <a href=\"https://docs.microsoft.com/visualstudio/ide/reference/build-page-project-designer-csharp\" data-linktype=\"external\">Build Page, Project Designer (C#)</a></p>\n</div></div>","outputRootRelativePath":"../../../../","pageMetadata":"<meta name=\"author\" content=\"BillWagner\">\r\n<meta name=\"ms.author\" content=\"wiwagn\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc2.json\">\r\n<meta name=\"ms.assetid\" content=\"6504dea9-ad1c-4993-a794-830fec5270af\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"17\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-csharp\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-15 06:14 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/3115359729431ecbcc16058612da59b85621fa0f/docs/csharp/programming-guide/interop/example-com-class.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/csharp/programming-guide/interop/example-com-class.md\">\r\n<meta name=\"document_id\" content=\"a0a526a1-3c05-ce99-5f44-b3828d1768d6\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"BillWagner","ms.author":"wiwagn","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Example COM Class (C# Programming Guide) | Microsoft Docs","ms.assetid":"6504dea9-ad1c-4993-a794-830fec5270af","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":17,"ms.topic":"article","dev_langs":["csharp"],"helpviewer_keywords":["examples [C#], COM classes","COM, exposing Visual C# objects to"],"ms.date":"2015-07-20","ms.technology":["devlang-csharp"],"ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Bill Wagner","author_email":"wiwagn@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Reorganize the C# Guide TOC (#1318)","commit_sha":"3115359729431ecbcc16058612da59b85621fa0f","commit_date":"2017-01-23 23:20:14 -0500"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Absolute urls and other fixes (#1281)","commit_sha":"f7dffe4885b331cec8d37f3cc5c9163f69c3b4c9","commit_date":"2016-11-22 12:57:26 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2017-03-15 06:14 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/BillWagner","display_name":"Bill Wagner","id":"493969"},"contributors":[{"profile_url":"https://github.com/BillWagner","display_name":"Bill Wagner"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"3/15/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/3115359729431ecbcc16058612da59b85621fa0f/docs/csharp/programming-guide/interop/example-com-class.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/csharp/programming-guide/interop/example-com-class.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/csharp/programming-guide/interop/example-com-class.md","document_id":"a0a526a1-3c05-ce99-5f44-b3828d1768d6","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/csharp/programming-guide/interop/example-com-class","toc_asset_id":"articles/csharp/programming-guide/interop/toc.json","toc_rel":"toc.json","_op_ogTitle":"Example COM Class (C# Programming Guide)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":329,"_op_rawTitle":"<h1 id=\"example-com-class-c-programming-guide\" sourcefile=\"docs/csharp/programming-guide/interop/example-com-class.md\" sourcestartlinenumber=\"37\" sourceendlinenumber=\"37\">Example COM Class (C# Programming Guide)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/csharp/programming-guide/interop/example-com-class","fileRelativePath":"articles/csharp/programming-guide/interop/example-com-class.html"},"themesRelativePathToOutputRoot":"_themes/"}