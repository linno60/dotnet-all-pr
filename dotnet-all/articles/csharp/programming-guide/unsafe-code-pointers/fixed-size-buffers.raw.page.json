{"content":"<div><div class=\"content\">\n<p>In C#, you can use the <a href=\"../../language-reference/keywords/fixed-statement\" data-linktype=\"relative-path\">fixed</a> statement to create a buffer with a fixed size array in a data structure. This is useful when you are working with existing code, such as code written in other languages, pre-existing DLLs or COM projects. The fixed array can take any attributes or modifiers that are allowed for regular struct members. The only restriction is that the array type must be <code>bool</code>, <code>byte</code>, <code>char</code>, <code>short</code>, <code>int</code>, <code>long</code>, <code>sbyte</code>, <code>ushort</code>, <code>uint</code>, <code>ulong</code>, <code>float</code>, or <code>double</code>.  </p>\n<pre class=\"loading\"><code>private fixed char name[30];  \n</code></pre><h2 id=\"remarks\">Remarks</h2>\n<p> In early versions of C#, declaring a C++ style fixed-size structure was difficult because a C# struct that contains an array does not contain the array elements. Instead, the struct contains a reference to the elements.  </p>\n<p> C# 2.0 added the ability to embed an array of fixed size in a <a href=\"../../language-reference/keywords/struct\" data-linktype=\"relative-path\">struct</a> when it is used in an <a href=\"../../language-reference/keywords/unsafe\" data-linktype=\"relative-path\">unsafe</a> code block.  </p>\n<p> For example, before C# 2.0, the following <code>struct</code> would be 8 bytes in size. The <code>pathName</code> array is a reference to the heap-allocated array:  </p>\n<pre><code class=\"lang-cs\" name=\"csProgGuidePointers#19\">\tpublic struct MyArray\n\t{\n        public char[] pathName;\n        private int reserved;\n\t}\n</code></pre><p> Beginning with C# 2.0, a <code>struct</code> can contain an embedded array. In the following example, the <code>fixedBuffer</code> array has a fixed size. To access the elements of the array, you use a <code>fixed</code> statement to establish a pointer to the first element. The <code>fixed</code> statement pins an instance of <code>fixedBuffer</code> to a specific location in memory.  </p>\n<pre><code class=\"lang-cs\" name=\"csProgGuidePointers#20\">namespace FixedSizeBuffers\n{\n    internal unsafe struct MyBuffer\n    {\n        public fixed char fixedBuffer[128];\n    }\n\n    internal unsafe class MyClass\n    {\n        public MyBuffer myBuffer = default(MyBuffer);\n    }\n\n    internal class Program\n    {\n        static void Main()\n        {\n            MyClass myC = new MyClass();\n\n            unsafe\n            {\n                // Pin the buffer to a fixed location in memory.\n                fixed (char* charPtr = myC.myBuffer.fixedBuffer)\n                {\n                    *charPtr = &#39;A&#39;;\n                }\n            }\n        }\n    }\n}\n</code></pre><p> The size of the 128 element <code>char</code> array is 256 bytes. Fixed size <a href=\"../../language-reference/keywords/char\" data-linktype=\"relative-path\">char</a> buffers always take two bytes per character, regardless of the encoding. This is true even when char buffers are marshaled to API methods or structs with <code>CharSet = CharSet.Auto</code> or <code>CharSet = CharSet.Ansi</code>. For more information, see <a class=\"xref\" href=\"../../../../api/system.runtime.interopservices.charset\" data-linktype=\"relative-path\">CharSet</a>.  </p>\n<p> Another common fixed-size array is the <a href=\"../../language-reference/keywords/bool\" data-linktype=\"relative-path\">bool</a> array. The elements in a <code>bool</code> array are always one byte in size. <code>bool</code> arrays are not appropriate for creating bit arrays or buffers.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> Except for memory created by using <a href=\"../../language-reference/keywords/stackalloc\" data-linktype=\"relative-path\">stackalloc</a>, the C# compiler and the common language runtime (CLR) do not perform any security buffer overrun checks. As with all unsafe code, use caution.  </p>\n</div>\n<p> Unsafe buffers differ from regular arrays in the following ways:  </p>\n<ul>\n<li><p>You can only use unsafe buffers in an unsafe context.  </p>\n</li>\n<li><p>Unsafe buffers are always vectors, or one-dimensional arrays.  </p>\n</li>\n<li><p>The declaration of the array should include a count, such as <code>char id[8]</code>. You cannot use <code>char id[]</code> instead.  </p>\n</li>\n<li><p>Unsafe buffers can only be instance fields of structs in an unsafe context.  </p>\n</li>\n</ul>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"../index\" data-linktype=\"relative-path\">C# Programming Guide</a><br> <a href=\"index\" data-linktype=\"relative-path\">Unsafe Code and Pointers</a><br> <a href=\"../../language-reference/keywords/fixed-statement\" data-linktype=\"relative-path\">fixed Statement</a><br> <a href=\"../interop/index\" data-linktype=\"relative-path\">Interoperability</a></p>\n</div></div>","outputRootRelativePath":"../../../../","pageMetadata":"<meta name=\"author\" content=\"BillWagner\">\r\n<meta name=\"ms.author\" content=\"wiwagn\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"toc2.json\">\r\n<meta name=\"ms.assetid\" content=\"6220d454-947c-4977-ac9d-9308c6ed5051\">\r\n<meta name=\"translation.priority.ht\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.ht\" content=\"de-de\">\r\n<meta name=\"translation.priority.ht\" content=\"es-es\">\r\n<meta name=\"translation.priority.ht\" content=\"fr-fr\">\r\n<meta name=\"translation.priority.ht\" content=\"it-it\">\r\n<meta name=\"translation.priority.ht\" content=\"ja-jp\">\r\n<meta name=\"translation.priority.ht\" content=\"ko-kr\">\r\n<meta name=\"translation.priority.ht\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.ht\" content=\"pt-br\">\r\n<meta name=\"translation.priority.ht\" content=\"ru-ru\">\r\n<meta name=\"translation.priority.ht\" content=\"tr-tr\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-cn\">\r\n<meta name=\"translation.priority.ht\" content=\"zh-tw\">\r\n<meta name=\"caps.latest.revision\" content=\"31\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-csharp\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-15 06:14 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/3115359729431ecbcc16058612da59b85621fa0f/docs/csharp/programming-guide/unsafe-code-pointers/fixed-size-buffers.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/csharp/programming-guide/unsafe-code-pointers/fixed-size-buffers.md\">\r\n<meta name=\"document_id\" content=\"56502687-585b-e44d-cb07-90932c77db0a\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc2.json\">\r\n","rawMetadata":{"author":"BillWagner","ms.author":"wiwagn","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Fixed Size Buffers (C# Programming Guide) | Microsoft Docs","ms.assetid":"6220d454-947c-4977-ac9d-9308c6ed5051","translation.priority.ht":["cs-cz","de-de","es-es","fr-fr","it-it","ja-jp","ko-kr","pl-pl","pt-br","ru-ru","tr-tr","zh-cn","zh-tw"],"caps.latest.revision":31,"ms.topic":"article","dev_langs":["csharp"],"helpviewer_keywords":["fixed size buffers [C#]","unsafe buffers [C#]","unsafe code [C#], fixed size buffers"],"ms.date":"2015-07-20","ms.technology":["devlang-csharp"],"ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Bill Wagner","author_email":"wiwagn@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Reorganize the C# Guide TOC (#1318)","commit_sha":"3115359729431ecbcc16058612da59b85621fa0f","commit_date":"2017-01-23 23:20:14 -0500"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2017-03-15 06:14 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/BillWagner","display_name":"Bill Wagner","id":"493969"},"contributors":[{"profile_url":"https://github.com/BillWagner","display_name":"Bill Wagner"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"3/15/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/3115359729431ecbcc16058612da59b85621fa0f/docs/csharp/programming-guide/unsafe-code-pointers/fixed-size-buffers.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/csharp/programming-guide/unsafe-code-pointers/fixed-size-buffers.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/csharp/programming-guide/unsafe-code-pointers/fixed-size-buffers.md","document_id":"56502687-585b-e44d-cb07-90932c77db0a","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/csharp/programming-guide/unsafe-code-pointers/fixed-size-buffers","toc_asset_id":"articles/csharp/programming-guide/unsafe-code-pointers/toc.json","toc_rel":"toc.json","_op_ogTitle":"Fixed Size Buffers (C# Programming Guide)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":487,"_op_rawTitle":"<h1 id=\"fixed-size-buffers-c-programming-guide\" sourcefile=\"docs/csharp/programming-guide/unsafe-code-pointers/fixed-size-buffers.md\" sourcestartlinenumber=\"38\" sourceendlinenumber=\"38\">Fixed Size Buffers (C# Programming Guide)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/csharp/programming-guide/unsafe-code-pointers/fixed-size-buffers","fileRelativePath":"articles/csharp/programming-guide/unsafe-code-pointers/fixed-size-buffers.html"},"themesRelativePathToOutputRoot":"_themes/"}