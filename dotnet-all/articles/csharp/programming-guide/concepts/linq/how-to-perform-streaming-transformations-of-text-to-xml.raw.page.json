{"content":"<div><div class=\"content\">\n<p>One approach to processing a text file is to write an extension method that streams the text file a line at a time using the <code>yield return</code> construct. You then can write a LINQ query that processes the text file in a lazy deferred fashion. If you then use <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xstreamingelement\" data-linktype=\"relative-path\">XStreamingElement</a> to stream output, you then can create a transformation from the text file to XML that uses a minimal amount of memory, regardless of the size of the source text file.  </p>\n<p> There are some caveats regarding streaming transformations. A streaming transformation is best applied in situations where you can process the entire file once, and if you can process the lines in the order that they occur in the source document. If you have to process the file more than once, or if you have to sort the lines before you can process them, you will lose many of the benefits of using a streaming technique.  </p>\n<h2 id=\"example\">Example</h2>\n<p> The following text file, People.txt, is the source for this example.  </p>\n<pre class=\"loading\"><code>#This is a comment  \n1,Tai,Yee,Writer  \n2,Nikolay,Grachev,Programmer  \n3,David,Wright,Inventor  \n</code></pre><p> The following code contains an extension method that streams the lines of the text file in a deferred fashion.  </p>\n<pre class=\"loading\"><code class=\"lang-cs\">public static class StreamReaderSequence  \n{  \n    public static IEnumerable&lt;string&gt; Lines(this StreamReader source)  \n    {  \n        String line;  \n\n        if (source == null)  \n            throw new ArgumentNullException(&quot;source&quot;);  \n        while ((line = source.ReadLine()) != null)  \n        {  \n            yield return line;  \n        }  \n    }  \n}  \n\nclass Program  \n{  \n    static void Main(string[] args)  \n    {  \n        StreamReader sr = new StreamReader(&quot;People.txt&quot;);  \n        XStreamingElement xmlTree = new XStreamingElement(&quot;Root&quot;,  \n            from line in sr.Lines()  \n            let items = line.Split(&#39;,&#39;)  \n            where !line.StartsWith(&quot;#&quot;)  \n            select new XElement(&quot;Person&quot;,  \n                       new XAttribute(&quot;ID&quot;, items[0]),  \n                       new XElement(&quot;First&quot;, items[1]),  \n                       new XElement(&quot;Last&quot;, items[2]),  \n                       new XElement(&quot;Occupation&quot;, items[3])  \n                   )  \n        );  \n        Console.WriteLine(xmlTree);  \n        sr.Close();  \n    }  \n}  \n</code></pre><p> This example produces the following output:  </p>\n<pre class=\"loading\"><code class=\"lang-xml\">&lt;Root&gt;  \n  &lt;Person ID=&quot;1&quot;&gt;  \n    &lt;First&gt;Tai&lt;/First&gt;  \n    &lt;Last&gt;Yee&lt;/Last&gt;  \n    &lt;Occupation&gt;Writer&lt;/Occupation&gt;  \n  &lt;/Person&gt;  \n  &lt;Person ID=&quot;2&quot;&gt;  \n    &lt;First&gt;Nikolay&lt;/First&gt;  \n    &lt;Last&gt;Grachev&lt;/Last&gt;  \n    &lt;Occupation&gt;Programmer&lt;/Occupation&gt;  \n  &lt;/Person&gt;  \n  &lt;Person ID=&quot;3&quot;&gt;  \n    &lt;First&gt;David&lt;/First&gt;  \n    &lt;Last&gt;Wright&lt;/Last&gt;  \n    &lt;Occupation&gt;Inventor&lt;/Occupation&gt;  \n  &lt;/Person&gt;  \n&lt;/Root&gt;  \n</code></pre><h2 id=\"see-also\">See Also</h2>\n<p> <a class=\"xref\" href=\"../../../../../api/system.xml.linq.xstreamingelement\" data-linktype=\"relative-path\">XStreamingElement</a><br> <a href=\"advanced-query-techniques-linq-to-xml\" data-linktype=\"relative-path\">Advanced Query Techniques (LINQ to XML) (C#)</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"BillWagner\">\r\n<meta name=\"ms.author\" content=\"wiwagn\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc1.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"9b3bd941-d0ff-4f2d-ae41-7c3b81d8fae6\">\r\n<meta name=\"caps.latest.revision\" content=\"3\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-csharp\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2016-12-15 06:00 PM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/csharp/programming-guide/concepts/linq/how-to-perform-streaming-transformations-of-text-to-xml.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/docs/csharp/programming-guide/concepts/linq/how-to-perform-streaming-transformations-of-text-to-xml.md\">\r\n<meta name=\"document_id\" content=\"e05f9090-7d39-c586-82e4-c56e139f5098\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc1.json\">\r\n","rawMetadata":{"author":"BillWagner","ms.author":"wiwagn","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","title":"How to: Perform Streaming Transformations of Text to XML (C#) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"9b3bd941-d0ff-4f2d-ae41-7c3b81d8fae6","caps.latest.revision":3,"ms.topic":"article","dev_langs":["csharp"],"ms.date":"2015-07-20","ms.technology":["devlang-csharp"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2016-12-15 06:00 PM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/BillWagner","display_name":"Bill Wagner","id":"493969"},"contributors":[{"profile_url":"https://github.com/BillWagner","display_name":"Bill Wagner"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"}],"update_at":"12/15/2016"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/csharp/programming-guide/concepts/linq/how-to-perform-streaming-transformations-of-text-to-xml.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/master/docs/csharp/programming-guide/concepts/linq/how-to-perform-streaming-transformations-of-text-to-xml.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/csharp/programming-guide/concepts/linq/how-to-perform-streaming-transformations-of-text-to-xml.md","document_id":"e05f9090-7d39-c586-82e4-c56e139f5098","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet/articles/csharp/programming-guide/concepts/linq/how-to-perform-streaming-transformations-of-text-to-xml","toc_asset_id":"articles/csharp/programming-guide/concepts/linq/toc.json","toc_rel":"toc.json","_op_ogTitle":"How to: Perform Streaming Transformations of Text to XML (C#)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":309,"_op_rawTitle":"<h1 id=\"how-to-perform-streaming-transformations-of-text-to-xml-c\" sourcefile=\"docs/csharp/programming-guide/concepts/linq/how-to-perform-streaming-transformations-of-text-to-xml.md\" sourcestartlinenumber=\"20\" sourceendlinenumber=\"20\">How to: Perform Streaming Transformations of Text to XML (C#)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/articles/csharp/programming-guide/concepts/linq/how-to-perform-streaming-transformations-of-text-to-xml","fileRelativePath":"articles/csharp/programming-guide/concepts/linq/how-to-perform-streaming-transformations-of-text-to-xml.html"},"themesRelativePathToOutputRoot":"_themes/"}