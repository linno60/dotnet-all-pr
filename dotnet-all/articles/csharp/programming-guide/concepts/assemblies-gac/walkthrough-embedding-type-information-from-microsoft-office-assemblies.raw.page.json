{"content":"<div><div class=\"content\">\n<p>If you embed type information in an application that references COM objects, you can eliminate the need for a primary interop assembly (PIA). Additionally, the embedded type information enables you to achieve version independence for your application. That is, your program can be written to use types from multiple versions of a COM library without requiring a specific PIA for each version. This is a common scenario for applications that use objects from Microsoft Office libraries. Embedding type information enables the same build of a program to work with different versions of Microsoft Office on different computers without the need to redeploy either the program or the PIA for each version of Microsoft Office.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p>Your computer might show different names or locations for some of the Visual Studio user interface elements in the following instructions. The Visual Studio edition that you have and the settings that you use determine these elements. For more information, see <a href=\"https://docs.microsoft.com/visualstudio/ide/personalizing-the-visual-studio-ide\" data-linktype=\"external\">Personalizing the IDE</a>.</p>\n</div>\n<h2 id=\"prerequisites\">Prerequisites</h2>\n<p> This walkthrough requires the following:  </p>\n<ul>\n<li><p>A computer on which Visual Studio and Microsoft Excel are installed.  </p>\n</li>\n<li><p>A second computer on which the .NET Framework 4 or higher and a different version of Excel are installed.  </p>\n</li>\n</ul>\n<h2 id=\"a-namebkmkcreateappa-to-create-an-application-that-works-with-multiple-versions-of-microsoft-office\"><a name=\"BKMK_createapp\"></a> To create an application that works with multiple versions of Microsoft Office</h2>\n<ol>\n<li><p>Start Visual Studio on a computer on which Excel is installed.  </p>\n</li>\n<li><p>On the <strong>File</strong> menu, choose <strong>New</strong>, <strong>Project</strong>.  </p>\n</li>\n<li><p>In the <strong>New Project</strong> dialog box, in the <strong>Project Types</strong> pane, make sure that <strong>Windows</strong> is selected. Select <strong>Console Application</strong> in the <strong>Templates</strong> pane. In the <strong>Name</strong> box, enter <code>CreateExcelWorkbook</code>, and then choose the <strong>OK</strong> button. The new project is created.  </p>\n</li>\n<li><p>In <strong>Solution Explorer</strong>, open the shortcut menu for the <strong>References</strong> folder and then choose <strong>Add Reference</strong>.  </p>\n</li>\n<li><p>On the <strong>.NET</strong> tab, choose the most recent version of <code>Microsoft.Office.Interop.Excel</code>. For example, <strong>Microsoft.Office.Interop.Excel 14.0.0.0</strong>. Choose the <strong>OK</strong> button.  </p>\n</li>\n<li><p>In the list of references for the <strong>CreateExcelWorkbook</strong> project, select the reference for <code>Microsoft.Office.Interop.Excel</code> that you added in the previous step. In the <strong>Properties</strong> window, make sure that the <code>Embed Interop Types</code> property is set to <code>True</code>.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> The application created in this walkthrough runs with different versions of Microsoft Office because of the embedded interop type information. If the <code>Embed Interop Types</code> property is set to <code>False</code>, you must include a PIA for each version of Microsoft Office that the application will run with.  </p>\n</div>\n</li>\n<li><p>Open the <strong>Program.cs</strong> file. Replace the code in the file with the following code:  </p>\n<pre class=\"loading\"><code class=\"lang-cs\">using System;  \nusing System.Collections.Generic;  \nusing System.Linq;  \nusing System.Text;  \nusing System.IO;  \nusing Excel = Microsoft.Office.Interop.Excel;  \n\nnamespace CreateExcelWorkbook  \n{  \n    class Program  \n    {  \n        static void Main(string[] args)  \n        {  \n            int[] values = {4, 6, 18, 2, 1, 76, 0, 3, 11};  \n\n            CreateWorkbook(values, @&quot;C:\\SampleFolder\\SampleWorkbook.xls&quot;);  \n        }  \n\n        static void CreateWorkbook(int[] values, string filePath)  \n        {  \n            Excel.Application excelApp = null;  \n            Excel.Workbook wkbk;  \n            Excel.Worksheet sheet;  \n\n            try  \n            {  \n                    // Start Excel and create a workbook and worksheet.  \n                    excelApp = new Excel.Application();  \n                    wkbk = excelApp.Workbooks.Add();  \n                    sheet = wkbk.Sheets.Add() as Excel.Worksheet;  \n                    sheet.Name = &quot;Sample Worksheet&quot;;  \n\n                    // Write a column of values.  \n                    // In the For loop, both the row index and array index start at 1.  \n                    // Therefore the value of 4 at array index 0 is not included.  \n                    for (int i = 1; i &lt; values.Length; i++)  \n                    {  \n                        sheet.Cells[i, 1] = values[i];  \n                    }  \n\n                    // Suppress any alerts and save the file. Create the directory   \n                    // if it does not exist. Overwrite the file if it exists.  \n                    excelApp.DisplayAlerts = false;  \n                    string folderPath = Path.GetDirectoryName(filePath);  \n                    if (!Directory.Exists(folderPath))  \n                    {  \n                        Directory.CreateDirectory(folderPath);  \n                    }  \n                    wkbk.SaveAs(filePath);  \n            }  \n            catch  \n            {  \n            }  \n            finally  \n            {  \n                sheet = null;  \n                wkbk = null;  \n\n                // Close Excel.  \n                excelApp.Quit();  \n                excelApp = null;  \n            }  \n        }  \n    }  \n}  \n</code></pre></li>\n<li><p>Save the project.  </p>\n</li>\n<li><p>Press CTRL+F5 to build and run the project. Verify that an Excel workbook has been created at the location specified in the example code: C:\\SampleFolder\\SampleWorkbook.xls.  </p>\n</li>\n</ol>\n<h2 id=\"a-namebkmkpublishappa-to-publish-the-application-to-a-computer-on-which-a-different-version-of-microsoft-office-is-installed\"><a name=\"BKMK_publishapp\"></a> To publish the application to a computer on which a different version of Microsoft Office is installed</h2>\n<ol>\n<li><p>Open the project created by this walkthrough in Visual Studio.  </p>\n</li>\n<li><p>On the <strong>Build</strong> menu, choose <strong>Publish CreateExcelWorkbook</strong>. Follow the steps of the Publish Wizard to create an installable version of the application. For more information, see <a href=\"https://msdn.microsoft.com/library/bb625071\" data-linktype=\"external\">Publish Wizard (Office Development in Visual Studio)</a>.  </p>\n</li>\n<li><p>Install the application on a computer on which the .NET Framework 4 or higher and a different version of Excel are installed.  </p>\n</li>\n<li><p>When the installation is finished, run the installed program.  </p>\n</li>\n<li><p>Verify that an Excel workbook has been created at the location specified in the sample code: C:\\SampleFolder\\SampleWorkbook.xls.  </p>\n</li>\n</ol>\n<h2 id=\"see-also\">See Also</h2>\n<p> <a href=\"walkthrough-embedding-types-from-managed-assemblies-in-visual-studio\" data-linktype=\"relative-path\">Walkthrough: Embedding Types from Managed Assemblies in Visual Studio (C#)</a><br> <a href=\"../../../language-reference/compiler-options/link-compiler-option\" data-linktype=\"relative-path\">/link (C# Compiler Options)</a></p>\n</div></div>","outputRootRelativePath":"../../../../../","pageMetadata":"<meta name=\"author\" content=\"BillWagner\">\r\n<meta name=\"ms.author\" content=\"wiwagn\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-internal/toc.json\">\r\n<meta name=\"ms.suite\" content=\"\">\r\n<meta name=\"ms.custom\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"3320e866-01f1-4b7f-8932-049a7b2d2a9b\">\r\n<meta name=\"caps.latest.revision\" content=\"3\">\r\n<meta name=\"ms.topic\" content=\"article\">\r\n<meta name=\"translation.priority.mt\" content=\"cs-cz\">\r\n<meta name=\"translation.priority.mt\" content=\"pl-pl\">\r\n<meta name=\"translation.priority.mt\" content=\"pt-br\">\r\n<meta name=\"translation.priority.mt\" content=\"tr-tr\">\r\n<meta name=\"ms.date\" content=\"2015-07-20\">\r\n<meta name=\"ms.technology\" content=\"devlang-csharp\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"ms.reviewer\" content=\"\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"updated_at\" content=\"2017-03-21 01:42 AM\">\r\n<meta name=\"gitcommit\" content=\"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/csharp/programming-guide/concepts/assemblies-gac/walkthrough-embedding-type-information-from-microsoft-office-assemblies.md\">\r\n<meta name=\"original_content_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/csharp/programming-guide/concepts/assemblies-gac/walkthrough-embedding-type-information-from-microsoft-office-assemblies.md\">\r\n<meta name=\"document_id\" content=\"3c500d32-cd45-3a0d-ece4-3f4c24c55c50\">\r\n<meta name=\"pagetype\" content=\"Conceptual\">\r\n<meta name=\"toc_rel\" content=\"toc.json\">\r\n","rawMetadata":{"author":"BillWagner","ms.author":"wiwagn","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","title":"Walkthrough: Embedding Type Information from Microsoft Office Assemblies in Visual Studio (C#) | Microsoft Docs","ms.suite":"","ms.custom":"","ms.assetid":"3320e866-01f1-4b7f-8932-049a7b2d2a9b","caps.latest.revision":3,"ms.topic":"article","dev_langs":["csharp"],"translation.priority.mt":["cs-cz","pl-pl","pt-br","tr-tr"],"ms.date":"2015-07-20","ms.technology":["devlang-csharp"],"ms.prod":".net","ms.reviewer":"","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitCommitHistory":[{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Metadata updates (#1313)","commit_sha":"90fe68f7f3c4b46502b5d3770b1a2d57c6af748a","commit_date":"2016-12-09 12:40:41 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"GitHub","comitter_email":"noreply@github.com","message":"Absolute urls and other fixes (#1281)","commit_sha":"f7dffe4885b331cec8d37f3cc5c9163f69c3b4c9","commit_date":"2016-11-22 12:57:26 -0800"},{"author_name":"Petr Onderka","author_email":"gsvick@gmail.com","committer_name":"Maira Wenzel","comitter_email":"mairaw@microsoft.com","message":"Fixed included notes (#1275)","commit_sha":"eca9acb54f87a9c5d6ba0f632a222d43318e74c3","commit_date":"2016-11-19 17:12:50 -0800"},{"author_name":"Maira Wenzel","author_email":"mairaw@microsoft.com","committer_name":"Bill Wagner","comitter_email":"wiwagn@microsoft.com","message":":books: migration changes (#1235)","commit_sha":"b828bb1d6c8fb750ad9ef34f8a7a1b7d2574f4c6","commit_date":"2016-11-15 15:08:11 -0500"}],"updated_at":"2017-03-21 01:42 AM","_op_gitContributorInformation":{"author":{"profile_url":"https://github.com/BillWagner","display_name":"Bill Wagner","id":"493969"},"contributors":[{"profile_url":"https://github.com/BillWagner","display_name":"Bill Wagner"},{"profile_url":"https://github.com/mairaw","display_name":"Maira Wenzel","id":"12971179"},{"profile_url":"https://github.com/svick","display_name":"Petr Onderka","id":"287848"}],"update_at":"3/21/2017"},"gitcommit":"https://github.com/dotnet/docs-internal/blob/90fe68f7f3c4b46502b5d3770b1a2d57c6af748a/docs/csharp/programming-guide/concepts/assemblies-gac/walkthrough-embedding-type-information-from-microsoft-office-assemblies.md","original_content_git_url":"https://github.com/dotnet/docs-internal/blob/tianzhXamarin/docs/csharp/programming-guide/concepts/assemblies-gac/walkthrough-embedding-type-information-from-microsoft-office-assemblies.md","open_to_public_contributors":false,"content_git_url":"https://github.com/dotnet/docs/blob/master/docs/csharp/programming-guide/concepts/assemblies-gac/walkthrough-embedding-type-information-from-microsoft-office-assemblies.md","document_id":"3c500d32-cd45-3a0d-ece4-3f4c24c55c50","layout":"Conceptual","pagetype":"Conceptual","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/articles/csharp/programming-guide/concepts/assemblies-gac/walkthrough-embedding-type-information-from-microsoft-office-assemblies","toc_asset_id":"articles/csharp/programming-guide/concepts/assemblies-gac/toc.json","toc_rel":"toc.json","_op_ogTitle":"Walkthrough: Embedding Type Information from Microsoft Office Assemblies in Visual Studio (C#)","_op_displayDate":null,"_op_displayDate_source":null,"_op_wordCount":742,"_op_rawTitle":"<h1 id=\"walkthrough-embedding-type-information-from-microsoft-office-assemblies-in-visual-studio-c\" sourcefile=\"docs/csharp/programming-guide/concepts/assemblies-gac/walkthrough-embedding-type-information-from-microsoft-office-assemblies.md\" sourcestartlinenumber=\"25\" sourceendlinenumber=\"25\">Walkthrough: Embedding Type Information from Microsoft Office Assemblies in Visual Studio (C#)</h1>","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/articles/csharp/programming-guide/concepts/assemblies-gac/walkthrough-embedding-type-information-from-microsoft-office-assemblies","fileRelativePath":"articles/csharp/programming-guide/concepts/assemblies-gac/walkthrough-embedding-type-information-from-microsoft-office-assemblies.html"},"themesRelativePathToOutputRoot":"_themes/"}