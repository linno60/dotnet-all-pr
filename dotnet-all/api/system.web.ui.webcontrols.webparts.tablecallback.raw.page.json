{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">TableCallback</span>\r\n      Delegate\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>References the method to call when retrieving table data from a provider.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public delegate void TableCallback(ICollection tableData);</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.delegate\" data-linktype=\"relative-path\">Delegate</a></span></div><span class=\"lang-csharp\">TableCallback</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following code example contains a Web Parts control named <code>TableProviderWebPart</code> that serves as a provider of data in the form of a table. The control includes an implementation of the <a class=\"xref\" href=\"system.web.ui.webcontrols.webparts.iwebparttable#System_Web_UI_WebControls_WebParts_IWebPartTable_GetTableData_\" data-linktype=\"relative-path\">GetTableData</a> method, which receives a parameter of type TableCallback. This method calls the method represented by the TableCallback delegate passing the table data.  </p>\n<pre><code class=\"lang-vb\" name=\"WebParts_TableCallback_Overview#1\">Imports System\nImports System.Collections\nImports System.ComponentModel\nImports System.Data\nImports System.Reflection\nImports System.Web.UI\nImports System.Web.UI.WebControls\nImports System.Web.UI.WebControls.WebParts\n\n&#39;This sample code creates a Web Parts control that acts as a provider of table data.\nNamespace Samples.AspNet.VB.Controls\n\n    Public NotInheritable Class TableProviderWebPart\n        Inherits WebPart\n        Implements IWebPartTable\n\n        Private _table As DataTable\n\n\n        Public Sub New()\n            _table = New DataTable()\n\n            Dim col As New DataColumn()\n            col.DataType = GetType(String)\n            col.ColumnName = &quot;Name&quot;\n            _table.Columns.Add(col)\n\n            col = New DataColumn()\n            col.DataType = GetType(String)\n            col.ColumnName = &quot;Address&quot;\n            _table.Columns.Add(col)\n\n            col = New DataColumn()\n            col.DataType = GetType(Integer)\n            col.ColumnName = &quot;ZIP Code&quot;\n            _table.Columns.Add(col)\n\n            Dim row As DataRow = _table.NewRow()\n            row(&quot;Name&quot;) = &quot;John Q. Public&quot;\n            row(&quot;Address&quot;) = &quot;123 Main Street&quot;\n            row(&quot;ZIP Code&quot;) = 98000\n            _table.Rows.Add(row)\n\n        End Sub &#39;New\n\n        &lt;ConnectionProvider(&quot;Table&quot;)&gt; _\n        Public Function GetConnectionInterface() As IWebPartTable\n            Return New TableProviderWebPart()\n\n        End Function &#39;GetConnectionInterface\n\n        Public ReadOnly Property Schema() As PropertyDescriptorCollection _\n            Implements IWebPartTable.Schema\n            Get\n                Return TypeDescriptor.GetProperties(_table.DefaultView(0))\n            End Get\n        End Property\n\n        Public Property ConnectionPointEnabled() As Boolean\n            Get\n                Dim o As Object\n                o = ViewState(&quot;ConnectionPointEnabled&quot;)\n                If Not (o Is Nothing) Then\n                    Return CBool(o)\n                Else\n                    Return True\n                End If\n\n            End Get\n            Set(ByVal value As Boolean)\n                ViewState(&quot;ConnectionPointEnabled&quot;) = value\n            End Set\n        End Property\n\n        Public Sub GetTableData(ByVal callback As TableCallback) _\n            Implements IWebPartTable.GetTableData\n            callback(_table.Rows)\n\n        End Sub &#39;GetTableData\n    End Class &#39;TableProviderWebPart           \n\nEnd Namespace\n</code></pre><pre><code class=\"lang-cs\" name=\"WebParts_TableCallback_Overview#1\">using System;\nusing System.Collections;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Reflection;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing System.Web.UI.WebControls.WebParts;\n//This sample code creates a Web Parts control that acts as a provider of table data.\nnamespace Samples.AspNet.CS.Controls\n{\n    public sealed class TableProviderWebPart : WebPart, IWebPartTable\n    {\n        DataTable _table;\n\n        public TableProviderWebPart()\n        {\n            _table = new DataTable();\n\n            DataColumn col = new DataColumn();\n            col.DataType = typeof(string);\n            col.ColumnName = &quot;Name&quot;;\n            _table.Columns.Add(col);\n\n            col = new DataColumn();\n            col.DataType = typeof(string);\n            col.ColumnName = &quot;Address&quot;;\n            _table.Columns.Add(col);\n\n            col = new DataColumn();\n            col.DataType = typeof(int);\n            col.ColumnName = &quot;ZIP Code&quot;;\n            _table.Columns.Add(col);\n\n            DataRow row = _table.NewRow();\n            row[&quot;Name&quot;] = &quot;John Q. Public&quot;;\n            row[&quot;Address&quot;] = &quot;123 Main Street&quot;;\n            row[&quot;ZIP Code&quot;] = 98000;\n            _table.Rows.Add(row);\n        }\n\n        public PropertyDescriptorCollection Schema\n        {\n            get\n            {\n                return TypeDescriptor.GetProperties(_table.DefaultView[0]);\n            }\n        }\n        \n        public void GetTableData(TableCallback callback)\n        {\n            callback(_table.Rows);\n        }\n        \n\n        public bool ConnectionPointEnabled\n        {\n            get\n            {\n                object o = ViewState[&quot;ConnectionPointEnabled&quot;];\n                return (o != null) ? (bool)o : true;\n            }\n            set\n            {\n                ViewState[&quot;ConnectionPointEnabled&quot;] = value;\n            }\n        }\n\n        [ConnectionProvider(&quot;Table&quot;)]\n        public IWebPartTable GetConnectionInterface()\n        {\n            return new TableProviderWebPart();\n        }\n\n        \n        public class TableProviderConnectionPoint : ProviderConnectionPoint\n        {\n            public TableProviderConnectionPoint(MethodInfo callbackMethod, \n                Type interfaceType, Type controlType,\n                string name, string id, bool allowsMultipleConnections)\n                : base(callbackMethod, interfaceType, controlType,\n                    name, id, allowsMultipleConnections)\n            {\n            }\n            \n            \n            public override bool GetEnabled(Control control)\n            {\n                return ((TableProviderWebPart)control).ConnectionPointEnabled;\n            }\n            \n        }\n    }\n}\n</code></pre><p> In the <code>OnPreRender</code> method, the consumer calls <code>GetTableData</code> in <code>TableProviderWebPart</code> and passes its <code>GetTableData</code> method as the delegate to call with the table data, as shown in the following code example.  </p>\n<pre><code class=\"lang-cs\" name=\"WebParts_TableCallback_Overview#2\">namespace Samples.AspNet.CS.Controls\n{\n    using System;\n    using System.ComponentModel;\n    using System.Data;\n    using System.Data.SqlClient;\n    using System.Reflection;\n    using System.Web.UI;\n    using System.Web.UI.WebControls;\n    using System.Web.UI.WebControls.WebParts;\n    using System.Collections;\n\n    \n    public class TableConsumer : WebPart\n    {\n        private IWebPartTable _provider;\n        private ICollection _tableData;\n\n        private void GetTableData(object tableData)\n        {\n            _tableData = (ICollection)tableData;\n        }\n\n        protected override void OnPreRender(EventArgs e)\n        {\n            if (_provider != null)\n            {\n                _provider.GetTableData(new TableCallback(GetTableData));\n            }\n        }\n\n        protected override void RenderContents(HtmlTextWriter writer)\n        {\n            if (_provider != null)\n            {\n                PropertyDescriptorCollection props = _provider.Schema;\n                int count = 0;\n                if (props != null &amp;&amp; props.Count &gt; 0 &amp;&amp; _tableData != null)\n                {\n                    foreach (PropertyDescriptor prop in props)\n                    {\n                        foreach (DataRow o in _tableData)\n                        {\n                            writer.Write(prop.DisplayName + &quot;: &quot; + o[count]);\n                        }\n                        writer.WriteBreak();\n                        writer.WriteLine();\n                        count = count + 1;\n                    }\n                }\n                else\n                {\n                    writer.Write(&quot;No data&quot;);\n                }\n            }\n            else\n            {\n                writer.Write(&quot;Not connected&quot;);\n            }\n        }\n\n        [ConnectionConsumer(&quot;Table&quot;)]\n        public void SetConnectionInterface(IWebPartTable provider)\n        {\n            _provider = provider;\n        }\n    }\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"WebParts_TableCallback_Overview#2\">Imports System\nImports System.ComponentModel\nImports System.Reflection\nImports System.Collections\nImports System.Data\nImports System.Web.UI\nImports System.Web.UI.WebControls\nImports System.Web.UI.WebControls.WebParts\n\nNamespace Samples.AspNet.VB.Controls\n\n    Public Class TableConsumerWebPart\n        Inherits WebPart\n\n        Private _provider As IWebPartTable\n        Private _tableData As ICollection\n\n        Private Sub GetTableData(ByVal tableData As ICollection)\n            _tableData = CType(tableData, ICollection)\n\n        End Sub &#39;GetTableValue\n\n        Protected Overrides Sub OnPreRender(ByVal e As EventArgs)\n            If Not (_provider Is Nothing) Then\n                _provider.GetTableData((New TableCallback(AddressOf GetTableData)))\n            End If\n            &#39;MyBase.OnPreRender(e)\n\n        End Sub &#39;OnPreRender\n\n        Protected Overrides Sub RenderContents(ByVal writer As HtmlTextWriter)\n\n            If Not (_provider Is Nothing) Then\n                Dim props As PropertyDescriptorCollection = _provider.Schema\n                Dim count As Integer = 0\n\n                If Not (props Is Nothing) AndAlso props.Count &gt; 0 _\n                  AndAlso Not (_tableData Is Nothing) Then\n                    For Each prop As PropertyDescriptor In props\n                        For Each o As DataRow In _tableData\n                            writer.Write(prop.DisplayName &amp; &quot;: &quot; &amp; o(count).ToString())\n                        Next\n                        writer.WriteBreak()\n                        writer.WriteLine()\n                        count = count + 1\n                    Next\n                Else\n                    writer.Write(&quot;No data&quot;)\n                End If\n            Else\n                writer.Write(&quot;Not connected&quot;)\n            End If\n\n        End Sub &#39;RenderContents\n\n        &lt;ConnectionConsumer(&quot;Table&quot;)&gt; _\n        Public Sub SetConnectionInterface(ByVal provider As IWebPartTable)\n            _provider = provider\n\n        End Sub &#39;SetConnectionInterface\n\n        Private Class TableConsumerConnectionPoint\n            Inherits ConsumerConnectionPoint\n\n            Public Sub New(ByVal callbackMethod As MethodInfo, _\n              ByVal interfaceType As Type, ByVal controlType As Type, _\n              ByVal name As String, ByVal id As String, _\n              ByVal allowsMultipleConnections As Boolean)\n                MyBase.New(callbackMethod, interfaceType, controlType, _\n                  name, id, allowsMultipleConnections)\n\n            End Sub &#39;New\n        End Class &#39;TableConsumerConnectionPoint \n    End Class &#39;TableConsumerWebPart\n\nEnd Namespace\n</code></pre><p> The two controls and the connection are included in a Web page, as shown in the following example.  </p>\n<pre><code class=\"lang-cs\" name=\"WebParts_TableCallback_Overview#3\">&lt;%@ page language=&quot;C#&quot; %&gt;\n&lt;%@ Register tagprefix=&quot;wp&quot; Namespace=&quot;Samples.AspNet.CS.Controls&quot;  %&gt;\n\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head id=&quot;Head1&quot; runat=&quot;server&quot;&gt;\n    &lt;title&gt;ITable Test Page&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;\n    &lt;div&gt;\n        &lt;!-- A static or dynamic connection is required to link two\n             Web Parts controls. ---&gt;\n        &lt;asp:webpartmanager id=&quot;WebPartManager1&quot; runat=&quot;server&quot;&gt;\n            &lt;StaticConnections&gt;\n                &lt;asp:WebPartConnection id=&quot;wp1&quot; ProviderID=&quot;provider1&quot; \n                   ConsumerID=&quot;consumer1&quot;&gt;\n                &lt;/asp:WebPartConnection&gt;\n            &lt;/StaticConnections&gt;\n        &lt;/asp:webpartmanager&gt;\n        &lt;asp:webpartzone id=&quot;WebPartZone1&quot; runat=&quot;server&quot;&gt;\n            &lt;zoneTemplate&gt;\n            &lt;!-- The following two lines define the \n              two connected controls. ---&gt;\n            &lt;wp:TableProviderWebPart ID=&quot;provider1&quot; runat=&quot;server&quot; \n               title=&quot;Web Parts Table Provider Control&quot; /&gt;\n            &lt;wp:TableConsumer ID=&quot;consumer1&quot; runat=&quot;server&quot; \n               title=&quot;Web Parts Table Consumer Control&quot;/&gt;\n            &lt;/zoneTemplate&gt;\n        &lt;/asp:webpartzone&gt;\n    &lt;/div&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-vb\" name=\"WebParts_TableCallback_Overview#3\">&lt;%@ Page Language=&quot;VB&quot; %&gt;\n&lt;%@ Register tagprefix=&quot;wp&quot; Namespace=&quot;Samples.AspNet.VB.Controls&quot;  %&gt;\n\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head id=&quot;Head1&quot; runat=&quot;server&quot;&gt;\n    &lt;title&gt;ITable Test Page&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;\n    &lt;div&gt;\n        &lt;!-- A static or dynamic connection is required to \n             link two Web Parts controls. ---&gt;\n        &lt;asp:webpartmanager id=&quot;WebPartManager1&quot; runat=&quot;server&quot;&gt;\n            &lt;StaticConnections&gt;\n                &lt;asp:WebPartConnection id=&quot;wp1&quot; ProviderID=&quot;provider1&quot; \n                   ConsumerID=&quot;consumer1&quot;&gt;\n                &lt;/asp:WebPartConnection&gt;\n            &lt;/StaticConnections&gt;\n        &lt;/asp:webpartmanager&gt;\n        &lt;asp:webpartzone id=&quot;WebPartZone1&quot; runat=&quot;server&quot;&gt;\n            &lt;zoneTemplate&gt;\n            &lt;!-- The following two lines define the two \n                 connected controls. ---&gt;\n            &lt;wp:TableProviderWebPart ID=&quot;provider1&quot; runat=&quot;server&quot; \n               title=&quot;Web Parts Table Provider Control&quot; /&gt;\n            &lt;wp:TableConsumerWebPart ID=&quot;consumer1&quot; runat=&quot;server&quot; \n               title=&quot;Web Parts Table Consumer Control&quot;/&gt;\n            &lt;/zoneTemplate&gt;\n        &lt;/asp:webpartzone&gt;\n    &lt;/div&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>When a Web Parts control implements the <a class=\"xref\" href=\"system.web.ui.webcontrols.webparts.iwebparttable\" data-linktype=\"relative-path\">IWebPartTable</a> interface and serves as a provider in a Web Parts connection, the consumer or transformer must retrieve and process the table data from the provider. The TableCallback delegate represents the method to call for processing the provider data.  </p>\n<p> The <a class=\"xref\" href=\"system.web.ui.webcontrols.webparts.iwebparttable#System_Web_UI_WebControls_WebParts_IWebPartTable_GetTableData_\" data-linktype=\"relative-path\">GetTableData</a> method contains a TableCallback delegate parameter.</p>\n\r\n  \r\n  \r\n  \r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.Web.UI.WebControls.WebParts.TableCallback.yml\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.WebParts.TableCallback\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.WebParts.TableCallback..ctor\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.WebParts.TableCallback.Invoke\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.WebParts.TableCallback.BeginInvoke\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.WebParts.TableCallback.EndInvoke\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-28 03:03 AM\">\r\n<meta name=\"document_id\" content=\"a22f645e-6f5e-017a-b7ee-efa4e52b5c30\">\r\n<meta name=\"internalonly\" content=\"false\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"References the method to call when retrieving table data from a provider.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.web.ui.webcontrols.webparts/toc2.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Web.UI.WebControls.WebParts.TableCallback\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.Web.UI.WebControls.WebParts.TableCallback.yml","open_to_public_contributors":false,"api_name":["System.Web.UI.WebControls.WebParts.TableCallback","System.Web.UI.WebControls.WebParts.TableCallback..ctor","System.Web.UI.WebControls.WebParts.TableCallback.Invoke","System.Web.UI.WebControls.WebParts.TableCallback.BeginInvoke","System.Web.UI.WebControls.WebParts.TableCallback.EndInvoke"],"api_location":[],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Web.UI.WebControls.WebParts.TableCallback","System::Web::UI::WebControls::WebParts::TableCallback"],"dev_langs":["csharp"],"updated_at":"2017-03-28 03:03 AM","document_id":"a22f645e-6f5e-017a-b7ee-efa4e52b5c30","content_git_url":"https://github.com/dotnet/docs/blob/master/xml/System.Web.UI.WebControls.WebParts/TableCallback.xml","internalonly":false,"layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"TableCallback delegate | Microsoft Docs","_op_ogTitle":"TableCallback delegate","description":"References the method to call when retrieving table data from a provider.\n","toc_asset_id":"api/_splitted/System.Web.UI.WebControls.WebParts/toc.json","toc_rel":"_splitted/System.Web.UI.WebControls.WebParts/toc.json","source_url":"","ms.assetid":"System.Web.UI.WebControls.WebParts.TableCallback","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.webcontrols.webparts.tablecallback","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.webcontrols.webparts.tablecallback","fileRelativePath":"api/System.Web.UI.WebControls.WebParts.TableCallback.html"},"themesRelativePathToOutputRoot":"_themes/"}