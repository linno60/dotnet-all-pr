{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">DataGridViewRowContextMenuStripNeededEventArgs</span>\r\n    \t\t\t\tClass\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Provides data for the <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_RowContextMenuStripNeeded\" data-linktype=\"relative-path\">RowContextMenuStripNeeded</a> event.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public class DataGridViewRowContextMenuStripNeededEventArgs : EventArgs</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.eventargs\" data-linktype=\"relative-path\">EventArgs</a></span></div><span class=\"lang-csharp\">DataGridViewRowContextMenuStripNeededEventArgs</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \t<h3 class=\"accented\">Inherited Members</h3>\r\n  \t<h4 class=\"accented\"></h4>\r\n  \t<div class=\"cdlHolder\">\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.eventargs#System_EventArgs_Empty\" data-linktype=\"relative-path\">Empty</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a></span></div>\r\n  \t</div>\r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following code example handles the <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_RowContextMenuStripNeeded\" data-linktype=\"relative-path\">RowContextMenuStripNeeded</a> event to provide a <a class=\"xref\" href=\"system.windows.forms.contextmenustrip\" data-linktype=\"relative-path\">ContextMenuStrip</a> based on the title of the employee. In this example, there are two shortcut menus, one for managers and one for all other employees.  </p>\n<pre><code class=\"lang-cs\" name=\"System.Windows.Forms.DataGridView_NeededEvents#00\">#region Using directives\n\nusing System;\nusing System.Data;\nusing System.Data.SqlClient;\nusing System.Drawing;\nusing System.Windows.Forms;\n\n#endregion\n\nclass Form1 : Form\n{\n    private DataGridView dataGridView1 = new DataGridView();\n    private ContextMenuStrip employeeMenuStrip = new ContextMenuStrip();\n    private ContextMenuStrip managerMenuStrip = new ContextMenuStrip();\n    private ToolStripMenuItem toolStripMenuItem1 = new ToolStripMenuItem();\n    private ToolStripMenuItem toolStripMenuItem2 = new ToolStripMenuItem();\n    private ToolStripMenuItem toolStripMenuItem3 = new ToolStripMenuItem();\n\n    private int contextMenuRowIndex;\n\n    public Form1()\n    {\n        // Initialize the form.\n        // This code can be replaced with designer generated code.\n        this.Size = new Size(700, 300);\n        this.Controls.Add(dataGridView1);\n\n        toolStripMenuItem1.Text = &quot;View Employee Sales Report&quot;;\n        toolStripMenuItem2.Text = &quot;View Team Sales Report&quot;;\n        toolStripMenuItem3.Text = &quot;View Company Sales Team Ranking Report&quot;;\n    }\n\n    protected override void OnLoad(EventArgs e)\n    {\n        dataGridView1.DataBindingComplete +=\n            new DataGridViewBindingCompleteEventHandler(\n            dataGridView1_DataBindingComplete);\n        dataGridView1.CellToolTipTextNeeded +=\n            new DataGridViewCellToolTipTextNeededEventHandler(\n            dataGridView1_CellToolTipTextNeeded);\n        dataGridView1.RowContextMenuStripNeeded +=\n            new DataGridViewRowContextMenuStripNeededEventHandler(\n            dataGridView1_RowContextMenuStripNeeded);\n        toolStripMenuItem1.Click +=\n            new EventHandler(toolStripMenuItem1_Click);\n        toolStripMenuItem2.Click +=\n            new EventHandler(toolStripMenuItem2_Click);\n        toolStripMenuItem3.Click +=\n            new EventHandler(toolStripMenuItem3_Click);\n\n        employeeMenuStrip.Items.Add(toolStripMenuItem1);\n\n        managerMenuStrip.Items.Add(toolStripMenuItem2);\n        managerMenuStrip.Items.Add(toolStripMenuItem3);\n\n        PopulateDataGridView();\n\n        base.OnLoad(e);\n    }\n\n    // Establish the main entry point for the application.\n    [STAThreadAttribute()]\n    public static void Main()\n    {\n        Application.Run(new Form1());\n    }\n\n    // Replace this with your own code to populate the DataGridView.\n    private void PopulateDataGridView()\n    {\n        dataGridView1.Dock = DockStyle.Fill;\n        dataGridView1.AllowUserToAddRows = false;\n        dataGridView1.MultiSelect = false;\n        dataGridView1.ReadOnly = true;\n        dataGridView1.AllowUserToDeleteRows = false;\n\n        string query;\n        query = &quot;SELECT e1.*, e2.FirstName + &#39; &#39; + e2.LastName AS Manager &quot;\n            + &quot;FROM employees AS e1 LEFT JOIN employees AS e2 &quot;\n            + &quot;ON e1.ReportsTo = e2.EmployeeID&quot;;\n\n        // Connect to the database\n        SqlConnection sqlConnection1 = new SqlConnection(\n            &quot;Integrated Security=SSPI;Persist Security Info=False;&quot; +\n            &quot;Initial Catalog=Northwind;Data Source=localhost&quot;);\n        SqlDataAdapter sqlDataAdapter1 = new SqlDataAdapter(query,\n            sqlConnection1);\n\n        DataTable dataTable1 = new DataTable();\n        dataTable1.Locale = System.Globalization.CultureInfo.InvariantCulture;\n        sqlDataAdapter1.Fill(dataTable1);\n\n        dataGridView1.DataSource = dataTable1;\n    }\n\n    private void dataGridView1_DataBindingComplete(object sender,\n        DataGridViewBindingCompleteEventArgs e)\n    {\n        // Hide some of the columns.\n        dataGridView1.Columns[&quot;EmployeeID&quot;].Visible = false;\n        dataGridView1.Columns[&quot;Address&quot;].Visible = false;\n        dataGridView1.Columns[&quot;TitleOfCourtesy&quot;].Visible = false;\n        dataGridView1.Columns[&quot;BirthDate&quot;].Visible = false;\n        dataGridView1.Columns[&quot;HireDate&quot;].Visible = false;\n        dataGridView1.Columns[&quot;PostalCode&quot;].Visible = false;\n        dataGridView1.Columns[&quot;Photo&quot;].Visible = false;\n        dataGridView1.Columns[&quot;Notes&quot;].Visible = false;\n        dataGridView1.Columns[&quot;ReportsTo&quot;].Visible = false;\n        dataGridView1.Columns[&quot;PhotoPath&quot;].Visible = false;\n\n        // Disable sorting for the DataGridView.\n        foreach (DataGridViewColumn i in\n            dataGridView1.Columns)\n        {\n            i.SortMode = DataGridViewColumnSortMode.NotSortable;\n        }\n\n        dataGridView1.AutoResizeColumns();\n    }\n\n    void dataGridView1_RowContextMenuStripNeeded(object sender,\n        DataGridViewRowContextMenuStripNeededEventArgs e)\n    {\n        DataGridViewRow dataGridViewRow1 = dataGridView1.Rows[e.RowIndex];\n\n        toolStripMenuItem1.Enabled = true;\n\n        // Show the appropriate ContextMenuStrip based on the employees title.\n        if ((dataGridViewRow1.Cells[&quot;Title&quot;].Value.ToString() ==\n            &quot;Sales Manager&quot;) ||\n            (dataGridViewRow1.Cells[&quot;Title&quot;].Value.ToString() ==\n            &quot;Vice President, Sales&quot;))\n        {\n            e.ContextMenuStrip = managerMenuStrip;\n        }\n        else\n        {\n            e.ContextMenuStrip = employeeMenuStrip;\n        }\n\n        contextMenuRowIndex = e.RowIndex;\n    }\n\n    void dataGridView1_CellToolTipTextNeeded(object sender,\n        DataGridViewCellToolTipTextNeededEventArgs e)\n    {\n        string newLine = Environment.NewLine;\n        if (e.RowIndex &gt; -1)\n        {\n            DataGridViewRow dataGridViewRow1 = dataGridView1.Rows[e.RowIndex];\n\n            // Add the employee&#39;s ID to the ToolTipText.\n            e.ToolTipText = String.Format(&quot;EmployeeID {0}:{1}&quot;,\n                dataGridViewRow1.Cells[&quot;EmployeeID&quot;].Value, newLine);\n\n            // Add the employee&#39;s name to the ToolTipText.\n            e.ToolTipText += String.Format(&quot;{0} {1} {2}{3}&quot;,\n                dataGridViewRow1.Cells[&quot;TitleOfCourtesy&quot;].Value.ToString(),\n                dataGridViewRow1.Cells[&quot;FirstName&quot;].Value.ToString(),\n                dataGridViewRow1.Cells[&quot;LastName&quot;].Value.ToString(),\n                newLine);\n\n            // Add the employee&#39;s title to the ToolTipText.\n            e.ToolTipText += String.Format(&quot;{0}{1}{2}&quot;,\n                dataGridViewRow1.Cells[&quot;Title&quot;].Value.ToString(),\n                newLine, newLine);\n\n            // Add the employee&#39;s contact information to the ToolTipText.\n            e.ToolTipText += String.Format(&quot;{0}{1}{2}, &quot;,\n                dataGridViewRow1.Cells[&quot;Address&quot;].Value.ToString(), newLine,\n                dataGridViewRow1.Cells[&quot;City&quot;].Value.ToString());\n            if (!String.IsNullOrEmpty(\n                dataGridViewRow1.Cells[&quot;Region&quot;].Value.ToString()))\n            {\n                e.ToolTipText += String.Format(&quot;{0}, &quot;,\n                    dataGridViewRow1.Cells[&quot;Region&quot;].Value.ToString());\n            }\n            e.ToolTipText += String.Format(&quot;{0}, {1}{2}{3} EXT:{4}{5}{6}&quot;,\n                dataGridViewRow1.Cells[&quot;Country&quot;].Value.ToString(),\n                dataGridViewRow1.Cells[&quot;PostalCode&quot;].Value.ToString(),\n                newLine, dataGridViewRow1.Cells[&quot;HomePhone&quot;].Value.ToString(),\n                dataGridViewRow1.Cells[&quot;Extension&quot;].Value.ToString(),\n                newLine, newLine);\n\n            // Add employee information to the ToolTipText.\n            DateTime HireDate =\n                (DateTime)dataGridViewRow1.Cells[&quot;HireDate&quot;].Value;\n            e.ToolTipText +=\n                String.Format(&quot;Employee since: {0}/{1}/{2}{3}Manager: {4}&quot;,\n                HireDate.Month.ToString(), HireDate.Day.ToString(),\n                HireDate.Year.ToString(), newLine,\n                dataGridViewRow1.Cells[&quot;Manager&quot;].Value.ToString());\n        }\n    }\n\n    void toolStripMenuItem1_Click(object sender, EventArgs e)\n    {\n        DataGridViewRow dataGridViewRow1 =\n            dataGridView1.Rows[contextMenuRowIndex];\n\n        MessageBox.Show(String.Format(\n            &quot;Sales Report for {0} {1}{2}{3}Reporting not implemented.&quot;,\n            dataGridViewRow1.Cells[&quot;FirstName&quot;].Value.ToString(),\n            dataGridViewRow1.Cells[&quot;LastName&quot;].Value.ToString(),\n            Environment.NewLine, Environment.NewLine));\n    }\n\n    void toolStripMenuItem2_Click(object sender, EventArgs e)\n    {\n        DataGridViewRow dataGridViewRow1 =\n            dataGridView1.Rows[contextMenuRowIndex];\n        MessageBox.Show(String.Format(\n            &quot;Sales Report for {0} {1}&#39;s Team{2}{3}Reporting not implemented.&quot;,\n            dataGridViewRow1.Cells[&quot;FirstName&quot;].Value.ToString(),\n            dataGridViewRow1.Cells[&quot;LastName&quot;].Value.ToString(),\n            Environment.NewLine, Environment.NewLine));\n    }\n\n    void toolStripMenuItem3_Click(object sender, EventArgs e)\n    {\n        DataGridViewRow dataGridViewRow1 =\n            dataGridView1.Rows[contextMenuRowIndex];\n        MessageBox.Show(String.Format(\n            &quot;Company Sales Ranking Report:{0}{1}Reporting not implemented.&quot;,\n            Environment.NewLine, Environment.NewLine));\n    }\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Windows.Forms.DataGridView_NeededEvents#00\">Imports System\nImports System.Data\nImports System.Data.SqlClient\nImports System.Drawing\nImports System.Windows.Forms\n\nClass Form1\n    Inherits Form\n\n    Private WithEvents dataGridView1 As New DataGridView()\n    Private WithEvents employeeMenuStrip As New ContextMenuStrip()\n    Private WithEvents managerMenuStrip As New ContextMenuStrip()\n    Private WithEvents toolStripMenuItem1 As New ToolStripMenuItem()\n    Private WithEvents toolStripMenuItem2 As New ToolStripMenuItem()\n    Private WithEvents toolStripMenuItem3 As New ToolStripMenuItem()\n\n    Private contextMenuRowIndex As Integer\n\n    Public Sub New()\n        Me.Size = New Size(700, 300)\n        Me.Controls.Add(dataGridView1)\n\n        toolStripMenuItem1.Text = &quot;View Employee Sales Report&quot;\n        toolStripMenuItem2.Text = &quot;View Team Sales Report&quot;\n        toolStripMenuItem3.Text = &quot;View Company Sales Team Ranking Report&quot;\n\n        With employeeMenuStrip\n            .Items.Add(toolStripMenuItem1)\n        End With\n        With managerMenuStrip\n            .Items.Add(toolStripMenuItem2)\n            .Items.Add(toolStripMenuItem3)\n        End With\n\n        PopulateDataGridView()\n    End Sub\n\n    &#39; Establish the main entry point for the application.\n    &lt;STAThreadAttribute()&gt; _\n    Public Shared Sub Main()\n        Application.Run(New Form1())\n    End Sub\n\n    Private Sub PopulateDataGridView()\n\n        With dataGridView1\n            .Dock = DockStyle.Fill\n            .AllowUserToAddRows = False\n            .MultiSelect = False\n            .ReadOnly = True\n            .AllowUserToDeleteRows = False\n        End With\n\n        Dim query As String\n        query = &quot;SELECT e1.*, e2.FirstName + &#39; &#39; + e2.LastName AS Manager &quot;\n        query &amp;= &quot;FROM employees AS e1 LEFT JOIN employees AS e2 &quot;\n        query &amp;= &quot;ON e1.ReportsTo = e2.EmployeeID&quot;\n\n        &#39; Connect to the database\n        Dim sqlConnection1 As New SqlConnection( _\n            &quot;Integrated Security=SSPI;Persist Security Info=False;&quot; &amp; _\n            &quot;Initial Catalog=Northwind;Data Source=localhost&quot;)\n        Dim sqlDataAdapter1 As New SqlDataAdapter(query, _\n            sqlConnection1)\n\n        Dim dataTable1 As New System.Data.DataTable()\n        dataTable1.Locale = System.Globalization.CultureInfo.InvariantCulture\n        sqlDataAdapter1.Fill(dataTable1)\n\n        dataGridView1.DataSource = dataTable1\n    End Sub\n\n    Private Sub dataGridView1_DataBindingComplete(ByVal sender As Object, _\n    ByVal e As DataGridViewBindingCompleteEventArgs) _\n    Handles dataGridView1.DataBindingComplete\n\n        &#39; Hide some of the columns.\n        With dataGridView1\n            .Columns(&quot;EmployeeID&quot;).Visible = False\n            .Columns(&quot;Address&quot;).Visible = False\n            .Columns(&quot;TitleOfCourtesy&quot;).Visible = False\n            .Columns(&quot;BirthDate&quot;).Visible = False\n            .Columns(&quot;HireDate&quot;).Visible = False\n            .Columns(&quot;PostalCode&quot;).Visible = False\n            .Columns(&quot;Photo&quot;).Visible = False\n            .Columns(&quot;Notes&quot;).Visible = False\n            .Columns(&quot;ReportsTo&quot;).Visible = False\n            .Columns(&quot;PhotoPath&quot;).Visible = False\n        End With\n\n        &#39; Disable sorting for the DataGridView.\n        Dim i As DataGridViewColumn\n        For Each i In dataGridView1.Columns\n            i.SortMode = DataGridViewColumnSortMode.NotSortable\n        Next i\n\n        dataGridView1.AutoResizeColumns()\n\n    End Sub\n\n    Public Sub dataGridView1_RowContextMenuStripNeeded( _\n        ByVal sender As Object, _\n        ByVal e As DataGridViewRowContextMenuStripNeededEventArgs) _\n        Handles dataGridView1.RowContextMenuStripNeeded\n\n        Dim dataGridViewRow1 As DataGridViewRow = _\n        dataGridView1.Rows(e.RowIndex)\n\n        toolStripMenuItem1.Enabled = True\n\n        &#39; Show the appropriate ContextMenuStrip based on the employees title.\n        If dataGridViewRow1.Cells(&quot;Title&quot;).Value.ToString() = _\n            &quot;Sales Manager&quot; OrElse _\n            dataGridViewRow1.Cells(&quot;Title&quot;).Value.ToString() = _\n            &quot;Vice President, Sales&quot; Then\n\n            e.ContextMenuStrip = managerMenuStrip\n        Else\n            e.ContextMenuStrip = employeeMenuStrip\n        End If\n\n        contextMenuRowIndex = e.RowIndex\n    End Sub\n\n    Public Sub dataGridView1_CellToolTipTextNeeded(ByVal sender As Object, _\n        ByVal e As DataGridViewCellToolTipTextNeededEventArgs) _\n        Handles dataGridView1.CellToolTipTextNeeded\n\n        Dim newLine As String = Environment.NewLine\n        If e.RowIndex &gt; -1 Then\n            Dim dataGridViewRow1 As DataGridViewRow = _\n            dataGridView1.Rows(e.RowIndex)\n\n            &#39; Add the employee&#39;s ID to the ToolTipText.\n            e.ToolTipText = String.Format(&quot;EmployeeID {0}: {1}&quot;, _\n                dataGridViewRow1.Cells(&quot;EmployeeID&quot;).Value.ToString(), _\n                newLine)\n\n            &#39; Add the employee&#39;s name to the ToolTipText.\n            e.ToolTipText += String.Format(&quot;{0} {1} {2} {3}&quot;, _\n                dataGridViewRow1.Cells(&quot;TitleOfCourtesy&quot;).Value.ToString(), _\n                dataGridViewRow1.Cells(&quot;FirstName&quot;).Value.ToString(), _\n                dataGridViewRow1.Cells(&quot;LastName&quot;).Value.ToString(), _\n                newLine)\n\n            &#39; Add the employee&#39;s title to the ToolTipText.\n            e.ToolTipText += String.Format(&quot;{0}{1}{2}&quot;, _\n                dataGridViewRow1.Cells(&quot;Title&quot;).Value.ToString(), _\n                newLine, newLine)\n\n            &#39; Add the employee&#39;s contact information to the ToolTipText.\n            e.ToolTipText += String.Format(&quot;{0}{1}{2}, &quot;, _\n                dataGridViewRow1.Cells(&quot;Address&quot;).Value.ToString(), newLine, _\n                dataGridViewRow1.Cells(&quot;City&quot;).Value.ToString())\n            If Not String.IsNullOrEmpty( _\n                dataGridViewRow1.Cells(&quot;Region&quot;).Value.ToString())\n\n                e.ToolTipText += String.Format(&quot;{0}, &quot;, _\n                   dataGridViewRow1.Cells(&quot;Region&quot;).Value.ToString())\n            End If\n            e.ToolTipText += String.Format(&quot;{0}, {1}{2}{3} EXT:{4}{5}{6}&quot;, _\n                dataGridViewRow1.Cells(&quot;Country&quot;).Value.ToString(), _\n                dataGridViewRow1.Cells(&quot;PostalCode&quot;).Value.ToString(), _\n                newLine, _\n                dataGridViewRow1.Cells(&quot;HomePhone&quot;).Value.ToString(), _\n                dataGridViewRow1.Cells(&quot;Extension&quot;).Value.ToString(), _\n                newLine, newLine)\n\n            &#39; Add employee information to the ToolTipText.\n            Dim HireDate As DateTime = _\n                CType(dataGridViewRow1.Cells(&quot;HireDate&quot;).Value, DateTime)\n            e.ToolTipText += _\n                String.Format(&quot;Employee since: {0}/{1}/{2}{3}Manager: {4}&quot;, _\n                    HireDate.Month.ToString(), HireDate.Day.ToString(), _\n                    HireDate.Year.ToString(), newLine, _\n                    dataGridViewRow1.Cells(&quot;Manager&quot;).Value.ToString())\n        End If\n    End Sub\n\n    Public Sub toolStripMenuItem1_Click(ByVal sender As Object, _\n        ByVal e As EventArgs) Handles toolStripMenuItem1.Click\n\n        Dim dataGridViewRow1 As DataGridViewRow = _\n            dataGridView1.Rows(contextMenuRowIndex)\n\n        MessageBox.Show(String.Format( _\n            &quot;Sales Report for {0} {1}:{2}{3}Reporting Not Implemented&quot;, _\n            dataGridViewRow1.Cells(&quot;FirstName&quot;).Value.ToString(), _\n            dataGridViewRow1.Cells(&quot;LastName&quot;).Value.ToString(), _\n            Environment.NewLine, Environment.NewLine))\n    End Sub\n\n    Public Sub toolStripMenuItem2_Click(ByVal sender As Object, _\n        ByVal e As EventArgs) Handles toolStripMenuItem2.Click\n\n        Dim dataGridViewRow1 As DataGridViewRow = _\n            dataGridView1.Rows(contextMenuRowIndex)\n\n        MessageBox.Show(String.Format( _\n            &quot;Sales Report for {0} {1}:{2}{3}Reporting Not Implemented&quot;, _\n            dataGridViewRow1.Cells(&quot;FirstName&quot;).Value.ToString(), _\n            dataGridViewRow1.Cells(&quot;LastName&quot;).Value.ToString(), _\n            Environment.NewLine, Environment.NewLine))\n    End Sub\n\n    Public Sub toolStripMenuItem3_Click(ByVal sender As Object, _\n        ByVal e As EventArgs) Handles toolStripMenuItem3.Click\n\n        Dim dataGridViewRow1 As DataGridViewRow = _\n            dataGridView1.Rows(contextMenuRowIndex)\n\n        MessageBox.Show(String.Format( _\n          &quot;Company Sales Ranking Report:{0}{1}Reporting not implemented.&quot;, _\n            Environment.NewLine, Environment.NewLine))\n    End Sub\nEnd Class\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>The <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_RowContextMenuStripNeeded\" data-linktype=\"relative-path\">RowContextMenuStripNeeded</a> event occurs only when the <a class=\"xref\" href=\"system.windows.forms.datagridview\" data-linktype=\"relative-path\">DataGridView</a> control <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_DataSource_\" data-linktype=\"relative-path\">DataSource</a> property is set or its <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_VirtualMode_\" data-linktype=\"relative-path\">VirtualMode</a> property is <code>true</code>. Handling the <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_RowContextMenuStripNeeded\" data-linktype=\"relative-path\">RowContextMenuStripNeeded</a> event is useful when you want to display a shortcut menu determined by a row&#39;s current state or the values it contains.  </p>\n<p> When you handle the <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_RowContextMenuStripNeeded\" data-linktype=\"relative-path\">RowContextMenuStripNeeded</a> event, the shortcut menu that you specify in the handler is shown whenever the user right-clicks a row unless the <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_CellContextMenuStripNeeded\" data-linktype=\"relative-path\">CellContextMenuStripNeeded</a> event overrides the shortcut menu for the specific cell that was clicked.  </p>\n<p> The <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_RowContextMenuStripNeeded\" data-linktype=\"relative-path\">RowContextMenuStripNeeded</a> event also occurs whenever the value of the <a class=\"xref\" href=\"system.windows.forms.datagridviewrow#System_Windows_Forms_DataGridViewRow_ContextMenuStrip_\" data-linktype=\"relative-path\">ContextMenuStrip</a> property is retrieved, either programmatically or when the user right-clicks a row.  </p>\n<p> You can use the <a class=\"xref\" href=\"system.windows.forms.datagridviewrowcontextmenustripneededeventargs#System_Windows_Forms_DataGridViewRowContextMenuStripNeededEventArgs_RowIndex_\" data-linktype=\"relative-path\">RowIndex</a> property to determine the state of a row or the values it contains, and use this information to change or modify the <a class=\"xref\" href=\"system.windows.forms.datagridviewrowcontextmenustripneededeventargs#System_Windows_Forms_DataGridViewRowContextMenuStripNeededEventArgs_ContextMenuStrip_\" data-linktype=\"relative-path\">ContextMenuStrip</a> property. This property is initialized with the value of the row <a class=\"xref\" href=\"system.windows.forms.datagridviewrow#System_Windows_Forms_DataGridViewRow_ContextMenuStrip_\" data-linktype=\"relative-path\">ContextMenuStrip</a> property, which the event value overrides.  </p>\n<p> Handle the <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_RowContextMenuStripNeeded\" data-linktype=\"relative-path\">RowContextMenuStripNeeded</a> event when working with large amounts of data to avoid the performance penalties of setting the row <a class=\"xref\" href=\"system.windows.forms.datagridviewrow#System_Windows_Forms_DataGridViewRow_ContextMenuStrip_\" data-linktype=\"relative-path\">ContextMenuStrip</a> value for multiple rows. For more information, see <a href=\"../topic/best%20practices%20for%20scaling%20the%20windows%20forms%20datagridview%20control\" data-linktype=\"relative-path\">Best Practices for Scaling the Windows Forms DataGridView Control</a>.  </p>\n<p> For more information about handling events, see <a href=\"http://msdn.microsoft.com/en-us/01e4f1bc-e55e-413f-98c7-6588493e5f67\" data-linktype=\"external\">NIB: Consuming Events</a>.</p>\n\r\n  \r\n  \r\n  \t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Constructors\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t\t<a id=\"System_Windows_Forms_DataGridViewRowContextMenuStripNeededEventArgs__ctor_\"></a>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Windows_Forms_DataGridViewRowContextMenuStripNeededEventArgs__ctor_System_Int32_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">DataGridViewRowContextMenuStripNeededEventArgs(Int32)</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Initializes a new instance of the <a class=\"xref\" href=\"system.windows.forms.datagridviewrowcontextmenustripneededeventargs\" data-linktype=\"relative-path\">DataGridViewRowContextMenuStripNeededEventArgs</a> class.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public DataGridViewRowContextMenuStripNeededEventArgs (int rowIndex);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Parameters</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>rowIndex</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.int32\" data-linktype=\"relative-path\">Int32</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The index of the row.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Exceptions</div>\r\n  \t\t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentoutofrangeexception\" data-linktype=\"relative-path\">ArgumentOutOfRangeException</a></span>\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<p><code>rowIndex</code> is less than -1.</p>\n\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>This constructor uses the <code>rowIndex</code> parameter value to initialize the <a class=\"xref\" href=\"system.windows.forms.datagridviewrowcontextmenustripneededeventargs#System_Windows_Forms_DataGridViewRowContextMenuStripNeededEventArgs_RowIndex_\" data-linktype=\"relative-path\">RowIndex</a> property.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t</section>\t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Properties\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t\t<a id=\"System_Windows_Forms_DataGridViewRowContextMenuStripNeededEventArgs_ContextMenuStrip_\"></a>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Windows_Forms_DataGridViewRowContextMenuStripNeededEventArgs_ContextMenuStrip\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">ContextMenuStrip</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets or sets the shortcut menu for the row that raised the <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_RowContextMenuStripNeeded\" data-linktype=\"relative-path\">RowContextMenuStripNeeded</a> event.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public System.Windows.Forms.ContextMenuStrip ContextMenuStrip { get; set; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.forms.contextmenustrip\" data-linktype=\"relative-path\">ContextMenuStrip</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The <a class=\"xref\" href=\"system.windows.forms.contextmenustrip\" data-linktype=\"relative-path\">ContextMenuStrip</a> in use.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>This property initially contains the value of the <a class=\"xref\" href=\"system.windows.forms.datagridviewrow#System_Windows_Forms_DataGridViewRow_ContextMenuStrip_\" data-linktype=\"relative-path\">ContextMenuStrip</a> property if it has been set for a row.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t\t<a id=\"System_Windows_Forms_DataGridViewRowContextMenuStripNeededEventArgs_RowIndex_\"></a>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Windows_Forms_DataGridViewRowContextMenuStripNeededEventArgs_RowIndex\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">RowIndex</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets the index of the row that is requesting a shortcut menu.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public int RowIndex { get; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.int32\" data-linktype=\"relative-path\">Int32</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The zero-based index of the row that is requesting a shortcut menu.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>Use this property to retrieve additional information about the row.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t</section>\r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc1.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs.yml\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs..ctor\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs.ContextMenuStrip\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs.RowIndex\">\r\n<meta name=\"APILocation\" content=\"System.Windows.Forms.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-31 02:21 PM\">\r\n<meta name=\"document_id\" content=\"b57d3fab-4960-d6a6-e77d-3fec48c26dc1\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Provides data for the  event.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.windows.forms/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs.yml","open_to_public_contributors":false,"api_name":["System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs","System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs..ctor","System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs.ContextMenuStrip","System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs.RowIndex"],"api_location":["System.Windows.Forms.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs","System::Windows::Forms::DataGridViewRowContextMenuStripNeededEventArgs","System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs.#ctor","System::Windows::Forms::DataGridViewRowContextMenuStripNeededEventArgs::#ctor","System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs.ContextMenuStrip","System::Windows::Forms::DataGridViewRowContextMenuStripNeededEventArgs::ContextMenuStrip","System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs.RowIndex","System::Windows::Forms::DataGridViewRowContextMenuStripNeededEventArgs::RowIndex"],"dev_langs":["csharp"],"updated_at":"2017-03-31 02:21 PM","document_id":"b57d3fab-4960-d6a6-e77d-3fec48c26dc1","content_git_url":"https://github.com/dotnet/docs-internal/blob/master/xml/System.Windows.Forms/DataGridViewRowContextMenuStripNeededEventArgs.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"DataGridViewRowContextMenuStripNeededEventArgs class | Microsoft Docs","_op_ogTitle":"DataGridViewRowContextMenuStripNeededEventArgs class","description":"Provides data for the  event.\n","toc_asset_id":"api/_splitted/System.Windows.Forms/toc.json","toc_rel":"_splitted/System.Windows.Forms/toc.json","source_url":"","ms.assetid":"System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.datagridviewrowcontextmenustripneededeventargs","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.datagridviewrowcontextmenustripneededeventargs","fileRelativePath":"api/System.Windows.Forms.DataGridViewRowContextMenuStripNeededEventArgs.html"},"themesRelativePathToOutputRoot":"_themes/"}