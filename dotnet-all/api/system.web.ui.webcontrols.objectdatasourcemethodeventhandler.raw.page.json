{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">ObjectDataSourceMethodEventHandler</span>\r\n      Delegate\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Represents the method that will handle the <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource#System_Web_UI_WebControls_ObjectDataSource_Selecting\" data-linktype=\"relative-path\">Selecting</a>, <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource#System_Web_UI_WebControls_ObjectDataSource_Updating\" data-linktype=\"relative-path\">Updating</a>, <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource#System_Web_UI_WebControls_ObjectDataSource_Inserting\" data-linktype=\"relative-path\">Inserting</a>, or <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource#System_Web_UI_WebControls_ObjectDataSource_Deleting\" data-linktype=\"relative-path\">Deleting</a> event of the <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource\" data-linktype=\"relative-path\">ObjectDataSource</a> control.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public delegate void ObjectDataSourceMethodEventHandler(object sender, ObjectDataSourceMethodEventArgs e);</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.delegate\" data-linktype=\"relative-path\">Delegate</a></span></div><span class=\"lang-csharp\">ObjectDataSourceMethodEventHandler</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>This section contains two code examples. The first code example demonstrates how to use an <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource\" data-linktype=\"relative-path\">ObjectDataSource</a> control with a business object and a <a class=\"xref\" href=\"system.web.ui.webcontrols.detailsview\" data-linktype=\"relative-path\">DetailsView</a> control to insert data. The second code example provides an example middle-tier business object that is used by the first code example.  </p>\n<p> The following code example demonstrates how to use an <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource\" data-linktype=\"relative-path\">ObjectDataSource</a> control with a business object and a <a class=\"xref\" href=\"system.web.ui.webcontrols.detailsview\" data-linktype=\"relative-path\">DetailsView</a> control to insert data. Initially, the <a class=\"xref\" href=\"system.web.ui.webcontrols.detailsview\" data-linktype=\"relative-path\">DetailsView</a> displays a new <code>NorthwindEmployee</code> record, along with an automatically generated <strong>Insert</strong> button. After you enter data into the fields of the <a class=\"xref\" href=\"system.web.ui.webcontrols.detailsview\" data-linktype=\"relative-path\">DetailsView</a> control, click the <strong>Insert</strong> button, and the <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource#System_Web_UI_WebControls_ObjectDataSource_InsertMethod_\" data-linktype=\"relative-path\">InsertMethod</a> property will identify which method performs the <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource#System_Web_UI_WebControls_ObjectDataSource_Insert_\" data-linktype=\"relative-path\">Insert</a> action.  </p>\n<p> In this example, the <code>UpdateEmployeeInfo</code> method is used to perform an insert; however, it requires a <code>NorthwindEmployee</code> parameter to insert the data. For this reason, the collection of strings that the <a class=\"xref\" href=\"system.web.ui.webcontrols.detailsview\" data-linktype=\"relative-path\">DetailsView</a> control passes automatically is not sufficient. The <code>NorthwindEmployeeInserting</code> delegate is an ObjectDataSourceMethodEventHandler object that handles the <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource#System_Web_UI_WebControls_ObjectDataSource_Inserting\" data-linktype=\"relative-path\">Inserting</a> event and enables you to manipulate the input parameters before the <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource#System_Web_UI_WebControls_ObjectDataSource_Insert_\" data-linktype=\"relative-path\">Insert</a> operation proceeds. Because the <code>UpdateEmployeeInfo</code> method requires a <code>NorthwindEmployee</code> object as a parameter, one is created using the collection of strings and is added to the <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasourcemethodeventargs#System_Web_UI_WebControls_ObjectDataSourceMethodEventArgs_InputParameters_\" data-linktype=\"relative-path\">InputParameters</a> collection.  </p>\n<pre><code class=\"lang-vb\" name=\"System.Web.UI.WebControls.ObjectDataSource_4#1\">&lt;%@ Register TagPrefix=&quot;aspSample&quot; Namespace=&quot;Samples.AspNet.VB&quot; Assembly=&quot;Samples.AspNet.VB&quot; %&gt;\n&lt;%@ Import namespace=&quot;Samples.AspNet.VB&quot; %&gt;\n&lt;%@ Page language=&quot;vb&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\nPrivate Sub NorthwindEmployeeInserting(source As Object, e As ObjectDataSourceMethodEventArgs)\n\n  &#39; The GridView control passes an array of strings in the parameters\n  &#39; collection because that is the type it knows how to work with.\n  &#39; However, the business object expects a custom type. Build it\n  &#39; and add it to the parameters collection.\n  Dim paramsFromPage As IDictionary = e.InputParameters\n\n  Dim ne As New NorthwindEmployee()\n  ne.FirstName  = paramsFromPage(&quot;FirstName&quot;).ToString()\n  ne.LastName   = paramsFromPage(&quot;LastName&quot;).ToString()\n  ne.Title      = paramsFromPage(&quot;Title&quot;).ToString()\n  ne.Courtesy   = paramsFromPage(&quot;Courtesy&quot;).ToString()\n  ne.Supervisor = Int32.Parse(paramsFromPage(&quot;Supervisor&quot;).ToString())\n  \n  paramsFromPage.Clear()\n  paramsFromPage.Add(&quot;ne&quot;, ne)\nEnd Sub &#39; NorthwindEmployeeInserting\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n  &lt;head&gt;\n    &lt;title&gt;ObjectDataSource - VB Example&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;form id=&quot;Form1&quot; method=&quot;post&quot; runat=&quot;server&quot;&gt;\n\n        &lt;asp:detailsview\n          id=&quot;DetailsView1&quot;\n          runat=&quot;server&quot;\n          autogenerateinsertbutton=&quot;True&quot;\n          datasourceid=&quot;ObjectDataSource1&quot;&gt;\n        &lt;/asp:detailsview&gt;\n\n        &lt;asp:objectdatasource\n          id=&quot;ObjectDataSource1&quot;\n          runat=&quot;server&quot;\n          selectmethod=&quot;GetEmployee&quot;\n          insertmethod=&quot;UpdateEmployeeInfo&quot;\n          oninserting=&quot;NorthwindEmployeeInserting&quot;\n          typename=&quot;Samples.AspNet.VB.EmployeeLogic&quot; &gt;\n          &lt;selectparameters&gt;\n            &lt;asp:parameter name=&quot;anID&quot; defaultvalue=&quot;-1&quot; /&gt;\n          &lt;/selectparameters&gt;\n        &lt;/asp:objectdatasource&gt;\n\n    &lt;/form&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-cs\" name=\"System.Web.UI.WebControls.ObjectDataSource_4#1\">&lt;%@ Register TagPrefix=&quot;aspSample&quot; Namespace=&quot;Samples.AspNet.CS&quot; Assembly=&quot;Samples.AspNet.CS&quot; %&gt;\n&lt;%@ Import namespace=&quot;Samples.AspNet.CS&quot; %&gt;\n&lt;%@ Page language=&quot;c#&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\nprivate void NorthwindEmployeeInserting(object source, ObjectDataSourceMethodEventArgs e)\n{\n  // The business object expects a custom type. Build it\n  // and add it to the parameters collection.\n  \n  IDictionary paramsFromPage = e.InputParameters;\n\n  NorthwindEmployee ne = new NorthwindEmployee();\n\n  ne.FirstName  = paramsFromPage[&quot;FirstName&quot;].ToString();\n  ne.LastName   = paramsFromPage[&quot;LastName&quot;].ToString();\n  ne.Title      = paramsFromPage[&quot;Title&quot;].ToString();\n  ne.Courtesy   = paramsFromPage[&quot;Courtesy&quot;].ToString();\n  ne.Supervisor = Int32.Parse(paramsFromPage[&quot;Supervisor&quot;].ToString());\n\n  paramsFromPage.Clear();\n  paramsFromPage.Add(&quot;ne&quot;, ne);\n}\n\n&lt;/script&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n  &lt;head&gt;\n    &lt;title&gt;ObjectDataSource - C# Example&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;form id=&quot;Form1&quot; method=&quot;post&quot; runat=&quot;server&quot;&gt;\n\n        &lt;asp:detailsview\n          id=&quot;DetailsView1&quot;\n          runat=&quot;server&quot;\n          autogenerateinsertbutton=&quot;True&quot;\n          datasourceid=&quot;ObjectDataSource1&quot;&gt;\n        &lt;/asp:detailsview&gt;\n\n        &lt;asp:objectdatasource\n          id=&quot;ObjectDataSource1&quot;\n          runat=&quot;server&quot;\n          selectmethod=&quot;GetEmployee&quot;\n          insertmethod=&quot;UpdateEmployeeInfo&quot;\n          oninserting=&quot;NorthwindEmployeeInserting&quot;\n          typename=&quot;Samples.AspNet.CS.EmployeeLogic&quot;\n          &gt;\n          &lt;selectparameters&gt;\n            &lt;asp:parameter name=&quot;anID&quot; defaultvalue=&quot;-1&quot; /&gt;\n          &lt;/selectparameters&gt;\n        &lt;/asp:objectdatasource&gt;\n\n    &lt;/form&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre><p> The following code example provides the example middle-tier business object that the preceding code example uses. The code example consists of the following two basic classes and one additional class:  </p>\n<ul>\n<li><p>The <code>EmployeeLogic</code> class, which is a stateless class that encapsulates business logic.  </p>\n</li>\n<li><p>The <code>NorthwindEmployee</code> class, which is a model class that contains only the basic functionality that is required to load and persist data from the data tier.  </p>\n</li>\n<li><p>An additional <code>NorthwindDataException</code> class, which is provided as a convenience.  </p>\n</li>\n</ul>\n<p> This set of example classes works with the Northwind Traders database, which is an example database that is available with Microsoft SQL Server and Microsoft Access. For a complete working example, use these classes by placing them in the App_Code directory under the application root or by compiling them into a library and placing the resulting DLL in the Bin directory. The <code>UpdateEmployeeInfo</code> method is not completely implemented, so you will not insert data into the Northwind Traders database when you experiment with this example.  </p>\n<pre><code class=\"lang-vb\" name=\"System.Web.UI.WebControls.ObjectDataSource_4#2\">Imports System\nImports System.Collections\nImports System.Configuration\nImports System.Data\nImports System.Data.SqlClient\nImports System.Web.UI\nImports System.Web.UI.WebControls\n\nNamespace Samples.AspNet.VB\n\n&#39;\n&#39; EmployeeLogic is a stateless business object that encapsulates\n&#39; the operations you can perform on a NorthwindEmployee object.\n&#39;\nPublic Class EmployeeLogic\n\n   &#39; Returns a collection of NorthwindEmployee objects.\n   Public Shared Function GetAllEmployees() As ICollection\n\n      Dim al As New ArrayList()\n\n      Dim cts As ConnectionStringSettings = ConfigurationManager.ConnectionStrings(&quot;NorthwindConnection&quot;)\n\n      Dim sds As New SqlDataSource(cts.ConnectionString, &quot;SELECT EmployeeID FROM Employees&quot;)\n\n      Try\n         Dim IDs As IEnumerable = sds.Select(DataSourceSelectArguments.Empty)\n\n         &#39; Iterate through the Enumeration and create a\n         &#39; NorthwindEmployee object for each ID.\n         Dim enumerator As IEnumerator = IDs.GetEnumerator()\n         While enumerator.MoveNext()\n            &#39; The IEnumerable contains DataRowView objects.\n            Dim row As DataRowView = CType(enumerator.Current,DataRowView)\n            Dim id As String = row(&quot;EmployeeID&quot;).ToString()\n            Dim nwe As New NorthwindEmployee(id)\n            &#39; Add the NorthwindEmployee object to the collection.\n            al.Add(nwe)\n         End While\n      Finally\n         &#39; If anything strange happens, clean up.\n         sds.Dispose()\n      End Try\n\n      Return al\n   End Function &#39;GetAllEmployees\n\n\n   Public Shared Function GetEmployee(anID As Object) As NorthwindEmployee\n      If anID.Equals(&quot;-1&quot;) OrElse anID.Equals(DBNull.Value) Then\n         Return New NorthwindEmployee()\n      Else\n         Return New NorthwindEmployee(anID)\n      End If\n   End Function &#39;GetEmployee\n\n\n   Public Shared Sub UpdateEmployeeInfo(ne As NorthwindEmployee)\n      Dim retval As Boolean = ne.Save()\n      If Not retval Then\n         Throw New NorthwindDataException(&quot;UpdateEmployee failed.&quot;)\n      End If\n   End Sub &#39;UpdateEmployeeInfo\n\n   Public Shared Sub DeleteEmployee(ne As NorthwindEmployee)\n      Dim retval As Boolean = ne.Delete()\n      If Not retval Then\n         Throw New NorthwindDataException(&quot;DeleteEmployee failed.&quot;)\n      End If\n   End Sub &#39;DeleteEmployee\n\n   &#39; And so on...\n\nEnd Class &#39;EmployeeLogic\n\n\nPublic Class NorthwindEmployee\n\n\n   Public Sub New()\n      ID = DBNull.Value\n      lastName = &quot;&quot;\n      firstName = &quot;&quot;\n      title = &quot;&quot;\n      titleOfCourtesy = &quot;&quot;\n      reportsTo = - 1\n   End Sub &#39;New\n\n\n   Public Sub New(anID As Object)\n      Me.ID = anID\n\n      Dim cts As ConnectionStringSettings = ConfigurationManager.ConnectionStrings(&quot;NorthwindConnection&quot;)\n\n      Dim conn As New SqlConnection(cts.ConnectionString)\n\n      Dim sc As New SqlCommand(&quot; SELECT FirstName,LastName,Title,TitleOfCourtesy,ReportsTo &quot; &amp; _\n                               &quot; FROM Employees &quot; &amp; _\n                               &quot; WHERE EmployeeID = @empId&quot;, conn)\n\n      &#39; Add the employee ID parameter and set its value.\n      sc.Parameters.Add(New SqlParameter(&quot;@empId&quot;, SqlDbType.Int)).Value = Int32.Parse(anID.ToString())\n      Dim sdr As SqlDataReader = Nothing\n\n      Try\n         conn.Open()\n         sdr = sc.ExecuteReader()\n\n         &#39; Only loop once.\n         If Not (sdr Is Nothing) AndAlso sdr.Read() Then\n            &#39; The IEnumerable contains DataRowView objects.\n            Me.aFirstName = sdr(&quot;FirstName&quot;).ToString()\n            Me.aLastName = sdr(&quot;LastName&quot;).ToString()\n            Me.aTitle = sdr(&quot;Title&quot;).ToString()\n            Me.titleOfCourtesy = sdr(&quot;TitleOfCourtesy&quot;).ToString()\n            If Not sdr.IsDBNull(4) Then\n               Me.reportsTo = sdr.GetInt32(4)\n            End If\n         Else\n            Throw New NorthwindDataException(&quot;Data not loaded for employee id.&quot;)\n         End If\n      Finally\n         Try\n            If Not (sdr Is Nothing) Then\n               sdr.Close()\n            End If\n            conn.Close()\n         Catch se As SqlException\n            &#39; Log an event in the Application Event Log.\n            Throw\n         End Try\n      End Try\n   End Sub &#39;New\n\n   Private ID As Object\n   Public ReadOnly Property EmpID() As String\n      Get\n         Return ID.ToString()\n      End Get\n   End Property\n\n   Private aLastName As String\n   Public Property LastName() As String\n      Get\n         Return aLastName\n      End Get\n      Set\n         aLastName = value\n      End Set\n   End Property\n\n   Private aFirstName As String\n   Public Property FirstName() As String\n      Get\n         Return aFirstName\n      End Get\n      Set\n         aFirstName = value\n      End Set\n   End Property\n\n   Public ReadOnly Property FullName() As String\n      Get\n         Return FirstName &amp; &quot; &quot; &amp; LastName\n      End Get\n   End Property\n\n   Private aTitle As String\n   Public Property Title() As String\n      Get\n         Return aTitle\n      End Get\n      Set\n         aTitle = value\n      End Set\n   End Property\n\n   Private titleOfCourtesy As String\n   Public Property Courtesy() As String\n      Get\n         Return titleOfCourtesy\n      End Get\n      Set\n         titleOfCourtesy = value\n      End Set\n   End Property\n\n   Private reportsTo As Integer\n   Public Property Supervisor() As Integer\n      Get\n         Return reportsTo\n      End Get\n      Set\n         reportsTo = value\n      End Set\n   End Property\n\n   Public Function Save() As Boolean\n\n      &#39; Implement persistence logic.\n      Return True\n\n   End Function &#39;Save\n\n\n   Public Function Delete() As Boolean\n\n     &#39; Implement delete logic.\n     Return True\n\n   End Function &#39;Delete\nEnd Class &#39;NorthwindEmployee\n\n\nFriend Class NorthwindDataException\n   Inherits Exception\n\n   Public Sub New(msg As String)\n      MyBase.New(msg)\n   End Sub &#39;New\nEnd Class &#39;NorthwindDataException\n\nEnd Namespace\n</code></pre><pre><code class=\"lang-cs\" name=\"System.Web.UI.WebControls.ObjectDataSource_4#2\">namespace Samples.AspNet.CS {\n\nusing System;\nusing System.Collections;\nusing System.Configuration;\nusing System.Data;\nusing System.Data.SqlClient;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\n  //\n  // EmployeeLogic is a stateless business object that encapsulates\n  // the operations you can perform on a NorthwindEmployee object.\n  //\n  public class EmployeeLogic {\n\n    // Returns a collection of NorthwindEmployee objects.\n    public static ICollection GetAllEmployees () {\n      ArrayList al = new ArrayList();\n\n      ConnectionStringSettings cts = ConfigurationManager.ConnectionStrings[&quot;NorthwindConnection&quot;];\n\n      SqlDataSource sds\n        = new SqlDataSource(cts.ConnectionString,\n                            &quot;SELECT EmployeeID FROM Employees&quot;);\n      try {\n        IEnumerable IDs = sds.Select(DataSourceSelectArguments.Empty);\n\n        // Iterate through the Enumeration and create a\n        // NorthwindEmployee object for each ID.\n        IEnumerator enumerator = IDs.GetEnumerator();\n        while (enumerator.MoveNext()) {\n          // The IEnumerable contains DataRowView objects.\n          DataRowView row = enumerator.Current as DataRowView;\n          string id = row[&quot;EmployeeID&quot;].ToString();\n          NorthwindEmployee nwe = new NorthwindEmployee(id);\n          // Add the NorthwindEmployee object to the collection.\n          al.Add(nwe);\n        }\n      }\n      finally {\n        // If anything strange happens, clean up.\n        sds.Dispose();\n      }\n\n      return al;\n    }\n\n    public static NorthwindEmployee GetEmployee(object anID) {\n      if (anID.Equals(&quot;-1&quot;) ||\n          anID.Equals(DBNull.Value) ) {\n        return new NorthwindEmployee();\n      }\n      else {\n        return new NorthwindEmployee(anID);\n      }\n    }\n\n    public static void UpdateEmployeeInfo(NorthwindEmployee ne) {\n      bool retval = ne.Save();\n      if (! retval) { throw new NorthwindDataException(&quot;UpdateEmployee failed.&quot;); }\n    }\n\n    public static void DeleteEmployee(NorthwindEmployee ne) {\n      bool retval = ne.Delete();\n      if (! retval) { throw new NorthwindDataException(&quot;DeleteEmployee failed.&quot;); }\n    }\n\n    // And so on...\n  }\n\n  public class NorthwindEmployee {\n\n    public NorthwindEmployee () {\n      ID = DBNull.Value;\n      lastName = &quot;&quot;;\n      firstName = &quot;&quot;;\n      title=&quot;&quot;;\n      titleOfCourtesy = &quot;&quot;;\n      reportsTo = -1;\n    }\n\n    public NorthwindEmployee (object anID) {\n      this.ID = anID;\n\n      SqlConnection conn\n        = new SqlConnection (ConfigurationManager.ConnectionStrings[&quot;NorthwindConnection&quot;].ConnectionString);\n      SqlCommand sc =\n        new SqlCommand(&quot; SELECT FirstName,LastName,Title,TitleOfCourtesy,ReportsTo &quot; +\n                       &quot; FROM Employees &quot; +\n                       &quot; WHERE EmployeeID = @empId&quot;,\n                       conn);\n      // Add the employee ID parameter and set its value.\n      sc.Parameters.Add(new SqlParameter(&quot;@empId&quot;,SqlDbType.Int)).Value = Int32.Parse(anID.ToString());\n      SqlDataReader sdr = null;\n\n      try {\n        conn.Open();\n        sdr = sc.ExecuteReader();\n\n        // Only loop once.\n        if (sdr != null &amp;&amp; sdr.Read()) {\n          // The IEnumerable contains DataRowView objects.\n          this.firstName        = sdr[&quot;FirstName&quot;].ToString();\n          this.lastName         = sdr[&quot;LastName&quot;].ToString();\n          this.title            = sdr[&quot;Title&quot;].ToString();\n          this.titleOfCourtesy  = sdr[&quot;TitleOfCourtesy&quot;].ToString();\n          if (! sdr.IsDBNull(4)) {\n            this.reportsTo        = sdr.GetInt32(4);\n          }\n        }\n        else {\n          throw new NorthwindDataException(&quot;Data not loaded for employee id.&quot;);\n        }\n      }\n      finally {\n        try {\n          if (sdr != null) sdr.Close();\n          conn.Close();\n        }\n        catch (SqlException) {\n          // Log an event in the Application Event Log.\n          throw;\n        }\n      }\n    }\n\n    private object ID;\n    public string EmpID {\n      get { return ID.ToString();  }\n    }\n\n    private string lastName;\n    public string LastName {\n      get { return lastName; }\n      set { lastName = value; }\n    }\n\n    private string firstName;\n    public string FirstName {\n      get { return firstName; }\n      set { firstName = value;  }\n    }\n\n    public string FullName {\n      get { return FirstName + &quot; &quot; + LastName; }\n    }\n\n    private string title;\n    public String Title {\n      get { return title; }\n      set { title = value; }\n    }\n\n    private string titleOfCourtesy;\n    public string Courtesy {\n      get { return titleOfCourtesy; }\n      set { titleOfCourtesy = value; }\n    }\n\n    private int    reportsTo;\n    public int Supervisor {\n      get { return reportsTo; }\n      set { reportsTo = value; }\n    }\n\n    public bool Save () {\n      // Implement persistence logic.\n      return true;\n    }\n\n    public bool Delete () {\n      // Implement delete logic.\n      return true;\n    }\n  }\n\n  internal class NorthwindDataException: Exception {\n    public NorthwindDataException(string msg) : base (msg) { }\n  }\n}\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>The <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource#System_Web_UI_WebControls_ObjectDataSource_Selecting\" data-linktype=\"relative-path\">Selecting</a>, <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource#System_Web_UI_WebControls_ObjectDataSource_Updating\" data-linktype=\"relative-path\">Updating</a>, <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource#System_Web_UI_WebControls_ObjectDataSource_Inserting\" data-linktype=\"relative-path\">Inserting</a>, or <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource#System_Web_UI_WebControls_ObjectDataSource_Deleting\" data-linktype=\"relative-path\">Deleting</a> event of the <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource\" data-linktype=\"relative-path\">ObjectDataSource</a> control allows you to manipulate the parameters that are used to determine the method that is called by the <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasource\" data-linktype=\"relative-path\">ObjectDataSource</a> control. For more information, see <a class=\"xref\" href=\"system.web.ui.webcontrols.objectdatasourcemethodeventargs\" data-linktype=\"relative-path\">ObjectDataSourceMethodEventArgs</a>.  </p>\n<p> When you create an ObjectDataSourceMethodEventHandler delegate, you identify the method that will handle the event. To associate the event with your event handler, add an instance of the delegate to the event. The event handler is called whenever the event occurs, unless you remove the delegate. For more information about event handler delegates, see <a href=\"http://msdn.microsoft.com/en-us/01e4f1bc-e55e-413f-98c7-6588493e5f67\" data-linktype=\"external\">NIB: Consuming Events</a>.</p>\n\r\n  \r\n  \r\n  \r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler.yml\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler..ctor\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler.Invoke\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler.BeginInvoke\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler.EndInvoke\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-31 05:47 AM\">\r\n<meta name=\"document_id\" content=\"0e741bb5-4624-80ac-7220-d250180bdce8\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Represents the method that will handle the , , , or  event of the  control.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.web.ui.webcontrols/toc2.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler.yml","open_to_public_contributors":false,"api_name":["System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler","System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler..ctor","System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler.Invoke","System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler.BeginInvoke","System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler.EndInvoke"],"api_location":[],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler","System::Web::UI::WebControls::ObjectDataSourceMethodEventHandler"],"dev_langs":["csharp"],"updated_at":"2017-03-31 05:47 AM","document_id":"0e741bb5-4624-80ac-7220-d250180bdce8","content_git_url":"https://github.com/dotnet/docs-internal/blob/master/xml/System.Web.UI.WebControls/ObjectDataSourceMethodEventHandler.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"ObjectDataSourceMethodEventHandler delegate | Microsoft Docs","_op_ogTitle":"ObjectDataSourceMethodEventHandler delegate","description":"Represents the method that will handle the , , , or  event of the  control.\n","toc_asset_id":"api/_splitted/System.Web.UI.WebControls/toc.json","toc_rel":"_splitted/System.Web.UI.WebControls/toc.json","source_url":"","ms.assetid":"System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.webcontrols.objectdatasourcemethodeventhandler","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.webcontrols.objectdatasourcemethodeventhandler","fileRelativePath":"api/System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler.html"},"themesRelativePathToOutputRoot":"_themes/"}