{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">RightsManagementInformation</span>\r\n    \t\t\t\tClass\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Represents Digital Rights Management (DRM) information that is stored in an <a class=\"xref\" href=\"system.io.packaging.encryptedpackageenvelope\" data-linktype=\"relative-path\">EncryptedPackageEnvelope</a>.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public class RightsManagementInformation</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">System.Object</a></span></div><span class=\"lang-csharp\">RightsManagementInformation</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \t<h3 class=\"accented\">Inherited Members</h3>\r\n  \t<h4 class=\"accented\"></h4>\r\n  \t<div class=\"cdlHolder\">\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a></span></div>\r\n  \t</div>\r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following example shows how to initialize a RightsManagementInformation object for encryption.  </p>\n<pre><code class=\"lang-vb\" name=\"RightsManagedPackagePublish#RmPkgPubEncrypt\">WriteStatus(&quot;   Signing the UnsignedPublishLicense&quot; &amp; vbLf &amp; &quot;       to build the PublishLicense.&quot;)\n            Dim authorsUseLicense As UseLicense = Nothing\nDim publishLicense As PublishLicense = unsignedLicense.Sign(_secureEnv, authorsUseLicense)\n\nWriteStatus(&quot;   Binding the author&#39;s UseLicense and&quot;)\nWriteStatus(&quot;       obtaining the CryptoProvider.&quot;)\nDim cryptoProvider As CryptoProvider = authorsUseLicense.Bind(_secureEnv)\n\nWriteStatus(&quot;   Creating the EncryptedPackage.&quot;)\nDim packageStream As Stream = File.OpenRead(packageFile)\nDim ePackage As EncryptedPackageEnvelope = EncryptedPackageEnvelope.CreateFromPackage(encryptedFile, packageStream, publishLicense, cryptoProvider)\n\nWriteStatus(&quot;   Adding an author&#39;s UseLicense.&quot;)\nDim rmi As RightsManagementInformation = ePackage.RightsManagementInformation\nrmi.SaveUseLicense(author, authorsUseLicense)\n\nePackage.Close()\nWriteStatus(&quot;   Done - Package encryption complete.&quot;)\n\nWriteStatus(&quot;Verifying package encryption.&quot;)\nIf EncryptedPackageEnvelope.IsEncryptedPackageEnvelope(encryptedFile) Then\n\tWriteStatus(&quot;   Confirmed - &#39;&quot; &amp; encryptedFilename &amp; &quot;&#39; is encrypted.&quot;)\nElse\n\tMessageBox.Show(&quot;ERROR: &#39;&quot; &amp; encryptedFilename &amp; &quot;&#39; is NOT ENCRYPTED.&quot;, &quot;Encryption Error&quot;, MessageBoxButton.OK, MessageBoxImage.Error)\n\tWriteStatus(&quot;ERROR: &#39;&quot; &amp; encryptedFilename &amp; &quot;&#39; is NOT ENCRYPTED.&quot; &amp; vbLf)\n\tReturn False\nEnd If\n</code></pre><pre><code class=\"lang-cs\" name=\"RightsManagedPackagePublish#RmPkgPubEncrypt\">WriteStatus(&quot;   Signing the UnsignedPublishLicense\\n&quot; +\n            &quot;       to build the PublishLicense.&quot;);\nUseLicense authorsUseLicense;\nPublishLicense publishLicense =\n    unsignedLicense.Sign(_secureEnv, out authorsUseLicense);\n\nWriteStatus(&quot;   Binding the author&#39;s UseLicense and&quot;);\nWriteStatus(&quot;       obtaining the CryptoProvider.&quot;);\nCryptoProvider cryptoProvider = authorsUseLicense.Bind(_secureEnv);\n\nWriteStatus(&quot;   Creating the EncryptedPackage.&quot;);\nStream packageStream = File.OpenRead(packageFile);\nEncryptedPackageEnvelope ePackage =\n    EncryptedPackageEnvelope.CreateFromPackage(encryptedFile,\n        packageStream, publishLicense, cryptoProvider);\n\nWriteStatus(&quot;   Adding an author&#39;s UseLicense.&quot;);\nRightsManagementInformation rmi =\n    ePackage.RightsManagementInformation;\nrmi.SaveUseLicense(author, authorsUseLicense);\n\nePackage.Close();\nWriteStatus(&quot;   Done - Package encryption complete.&quot;);\n\nWriteStatus(&quot;Verifying package encryption.&quot;);\nif (EncryptedPackageEnvelope.IsEncryptedPackageEnvelope(encryptedFile))\n{\n    WriteStatus(&quot;   Confirmed - &#39;&quot; + encryptedFilename +\n                &quot;&#39; is encrypted.&quot;);\n}\nelse\n{\n    MessageBox.Show(&quot;ERROR: &#39;&quot; + encryptedFilename +\n        &quot;&#39; is NOT ENCRYPTED.&quot;, &quot;Encryption Error&quot;,\n        MessageBoxButton.OK, MessageBoxImage.Error);\n    WriteStatus(&quot;ERROR: &#39;&quot; + encryptedFilename +\n                &quot;&#39; is NOT ENCRYPTED.\\n&quot;);\n    return false;\n}\n</code></pre><p> The following example shows how to initialize a RightsManagementInformation object for decryption.  </p>\n<pre><code class=\"lang-vb\" name=\"RightsManagedPackageViewer#RmPkgViewOpenPkg\">ShowStatus(&quot;   Opening the encrypted Package.&quot;)\nDim ePackage As EncryptedPackageEnvelope = EncryptedPackageEnvelope.Open(xpsFile, FileAccess.ReadWrite)\nDim rmi As RightsManagementInformation = ePackage.RightsManagementInformation\n\nShowStatus(&quot;   Looking for an embedded UseLicense for user:&quot; &amp; vbLf &amp; &quot;       &quot; &amp; currentUserId &amp; &quot; [&quot; &amp; _authentication &amp; &quot;]&quot;)\nDim useLicense As UseLicense = rmi.LoadUseLicense(New ContentUser(currentUserId, _authentication))\n\nDim grants As ReadOnlyCollection(Of ContentGrant)\nIf useLicense Is Nothing Then\n\tShowStatus(&quot;   No Embedded UseLicense found.&quot; &amp; vbLf &amp; &quot;       &quot; &amp; &quot;Attempting to acqure UseLicnese&quot; &amp; vbLf &amp; &quot;       &quot; &amp; &quot;from the PublishLicense.&quot;)\n\tDim pubLicense As PublishLicense = rmi.LoadPublishLicense()\n\n\tShowStatus(&quot;   Referral information:&quot;)\n\n\tIf pubLicense.ReferralInfoName Is Nothing Then\n\t\tShowStatus(&quot;       Name: (null)&quot;)\n\tElse\n\t\tShowStatus(&quot;       Name: &quot; &amp; pubLicense.ReferralInfoName)\n\tEnd If\n\n\tIf pubLicense.ReferralInfoUri Is Nothing Then\n\t\tShowStatus(&quot;    Uri: (null)&quot;)\n\tElse\n\t\tShowStatus(&quot;    Uri: &quot; &amp; pubLicense.ReferralInfoUri.ToString())\n\tEnd If\n\n\tuseLicense = pubLicense.AcquireUseLicense(_secureEnv)\n\tIf useLicense Is Nothing Then\n\t\tShowStatus(&quot;   User DOES NOT HAVE RIGHTS&quot; &amp; vbLf &amp; &quot;       &quot; &amp; &quot;to access this document!&quot;)\n\t\tReturn False\n\tEnd If\nEnd If &#39; end:if (useLicense == null)\nShowStatus(&quot;   UseLicense acquired.&quot;)\n</code></pre><pre><code class=\"lang-cs\" name=\"RightsManagedPackageViewer#RmPkgViewOpenPkg\">ShowStatus(&quot;   Opening the encrypted Package.&quot;);\nEncryptedPackageEnvelope ePackage =\n    EncryptedPackageEnvelope.Open(xpsFile, FileAccess.ReadWrite);\nRightsManagementInformation rmi =\n    ePackage.RightsManagementInformation;\n\nShowStatus(&quot;   Looking for an embedded UseLicense for user:\\n       &quot; +\n           currentUserId + &quot; [&quot; + _authentication + &quot;]&quot;);\nUseLicense useLicense =\n    rmi.LoadUseLicense(\n        new ContentUser(currentUserId, _authentication));\n\nReadOnlyCollection&lt;ContentGrant&gt; grants;\nif (useLicense == null)\n{\n    ShowStatus(&quot;   No Embedded UseLicense found.\\n       &quot; +\n               &quot;Attempting to acqure UseLicnese\\n       &quot; +\n               &quot;from the PublishLicense.&quot;);\n    PublishLicense pubLicense = rmi.LoadPublishLicense();\n\n    ShowStatus(&quot;   Referral information:&quot;);\n\n    if (pubLicense.ReferralInfoName == null)\n        ShowStatus(&quot;       Name: (null)&quot;);\n    else\n        ShowStatus(&quot;       Name: &quot; + pubLicense.ReferralInfoName);\n\n    if (pubLicense.ReferralInfoUri == null)\n        ShowStatus(&quot;    Uri: (null)&quot;);\n    else\n        ShowStatus(&quot;    Uri: &quot; +\n            pubLicense.ReferralInfoUri.ToString());\n\n    useLicense = pubLicense.AcquireUseLicense(_secureEnv);\n    if (useLicense == null)\n    {\n        ShowStatus(&quot;   User DOES NOT HAVE RIGHTS\\n       &quot; +\n            &quot;to access this document!&quot;);\n        return false;\n    }\n}// end:if (useLicense == null)\nShowStatus(&quot;   UseLicense acquired.&quot;);\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>RightsManagementInformation provides access to the <a class=\"xref\" href=\"system.security.rightsmanagement.publishlicense\" data-linktype=\"relative-path\">PublishLicense</a> and <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> data stored in a rights managed protected <a class=\"xref\" href=\"system.io.packaging.package\" data-linktype=\"relative-path\">Package</a>.</p>\n\r\n  \r\n  \r\n  \t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Properties\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_IO_Packaging_RightsManagementInformation_CryptoProvider\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">CryptoProvider</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets or sets the <a class=\"xref\" href=\"system.security.rightsmanagement.cryptoprovider\" data-linktype=\"relative-path\">CryptoProvider</a> for accessing the package&#39;s encrypted rights management data stream.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public System.Security.RightsManagement.CryptoProvider CryptoProvider { get; set; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.rightsmanagement.cryptoprovider\" data-linktype=\"relative-path\">CryptoProvider</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The <a class=\"xref\" href=\"system.security.rightsmanagement.cryptoprovider\" data-linktype=\"relative-path\">CryptoProvider</a> for accessing the rights management information.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t  \r\n  \t\t</section>\t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Methods\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_IO_Packaging_RightsManagementInformation_DeleteUseLicense_System_Security_RightsManagement_ContentUser_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">DeleteUseLicense(ContentUser)</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Deletes the <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> for a specified user from the encrypted rights management data stream.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public void DeleteUseLicense (System.Security.RightsManagement.ContentUser userKey);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>userKey</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.rightsmanagement.contentuser\" data-linktype=\"relative-path\">ContentUser</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The user of the <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> to be deleted.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_IO_Packaging_RightsManagementInformation_GetEmbeddedUseLicenses\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">GetEmbeddedUseLicenses()</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Returns a dictionary collection of user and <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> key/value pairs from the encrypted rights management data stream.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public System.Collections.Generic.IDictionary&lt;System.Security.RightsManagement.ContentUser,System.Security.RightsManagement.UseLicense&gt; GetEmbeddedUseLicenses ();</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Returns</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.generic.idictionary-2\" data-linktype=\"relative-path\">IDictionary</a>&lt;<a class=\"xref\" href=\"system.security.rightsmanagement.contentuser\" data-linktype=\"relative-path\">ContentUser</a>,<a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a>&gt;</span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>A collection of user and <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> key/value pairs that are contained in the rights managed protected package.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>GetEmbeddedUseLicenses only returns those use licenses that are currently embedded in the package.  It does not include any other use licenses that the application might have acquired separately from a rights management server but that are not yet embedded in the package.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_IO_Packaging_RightsManagementInformation_LoadPublishLicense\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">LoadPublishLicense()</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Returns the embedded <a class=\"xref\" href=\"system.security.rightsmanagement.publishlicense\" data-linktype=\"relative-path\">PublishLicense</a> from the encrypted rights management data stream.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public System.Security.RightsManagement.PublishLicense LoadPublishLicense ();</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Returns</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.rightsmanagement.publishlicense\" data-linktype=\"relative-path\">PublishLicense</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The embedded <a class=\"xref\" href=\"system.security.rightsmanagement.publishlicense\" data-linktype=\"relative-path\">PublishLicense</a>; or <code>null</code>, if the package does not contain a <a class=\"xref\" href=\"system.security.rightsmanagement.publishlicense\" data-linktype=\"relative-path\">PublishLicense</a>.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Exceptions</div>\r\n  \t\t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.io.fileformatexception\" data-linktype=\"relative-path\">FileFormatException</a></span>\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<p>The rights management information in this package cannot be read by the current version of this class.</p>\n\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_IO_Packaging_RightsManagementInformation_LoadUseLicense_System_Security_RightsManagement_ContentUser_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">LoadUseLicense(ContentUser)</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Returns a specified user&#39;s embedded <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> from the encrypted rights management data stream.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public System.Security.RightsManagement.UseLicense LoadUseLicense (System.Security.RightsManagement.ContentUser userKey);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>userKey</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.rightsmanagement.contentuser\" data-linktype=\"relative-path\">ContentUser</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The user or user group to return the <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> for.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Returns</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> for the specified user; or <code>null</code>, if the package does not contain a <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> that matches the given <code>userKey</code>.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Exceptions</div>\r\n  \t\t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></span>\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<p>The <code>userKey</code> parameter is <code>null</code>.</p>\n\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<div class=\"propertyInfo stack\">\r\n  \t\t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.io.fileformatexception\" data-linktype=\"relative-path\">FileFormatException</a></span>\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<p>The rights management information in this package cannot be read by the current version of this class.</p>\n\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_IO_Packaging_RightsManagementInformation_SavePublishLicense_System_Security_RightsManagement_PublishLicense_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">SavePublishLicense(PublishLicense)</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Saves a given <a class=\"xref\" href=\"system.security.rightsmanagement.publishlicense\" data-linktype=\"relative-path\">PublishLicense</a> to the encrypted rights management data stream.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public void SavePublishLicense (System.Security.RightsManagement.PublishLicense publishLicense);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>publishLicense</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.rightsmanagement.publishlicense\" data-linktype=\"relative-path\">PublishLicense</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The publish license to store and embed in the package.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Exceptions</div>\r\n  \t\t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></span>\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<p>The <code>publishLicense</code> parameter is <code>null</code>.</p>\n\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<div class=\"propertyInfo stack\">\r\n  \t\t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.io.fileformatexception\" data-linktype=\"relative-path\">FileFormatException</a></span>\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<p>The rights management information in this package cannot be read by the current version of this class.</p>\n\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>Each <a class=\"xref\" href=\"system.io.packaging.encryptedpackageenvelope\" data-linktype=\"relative-path\">EncryptedPackageEnvelope</a> can contain only one <a class=\"xref\" href=\"system.security.rightsmanagement.publishlicense\" data-linktype=\"relative-path\">PublishLicense</a>.  Each call to SavePublishLicense will overwrite any prior <a class=\"xref\" href=\"system.security.rightsmanagement.publishlicense\" data-linktype=\"relative-path\">PublishLicense</a> contained in the <a class=\"xref\" href=\"system.io.packaging.encryptedpackageenvelope\" data-linktype=\"relative-path\">EncryptedPackageEnvelope</a>.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_IO_Packaging_RightsManagementInformation_SaveUseLicense_System_Security_RightsManagement_ContentUser_System_Security_RightsManagement_UseLicense_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">SaveUseLicense(ContentUser,UseLicense)</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Saves a given <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> for a specified user to the encrypted rights management data stream.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public void SaveUseLicense (System.Security.RightsManagement.ContentUser userKey, System.Security.RightsManagement.UseLicense useLicense);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>userKey</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.rightsmanagement.contentuser\" data-linktype=\"relative-path\">ContentUser</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The user of the <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a>.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>useLicense</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The use license to store and embed in the package.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Exceptions</div>\r\n  \t\t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentnullexception\" data-linktype=\"relative-path\">ArgumentNullException</a></span>\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<p>Either the <code>userKey</code> or <code>useLicense</code> parameter is <code>null</code>.</p>\n\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<div class=\"propertyInfo stack\">\r\n  \t\t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.io.fileformatexception\" data-linktype=\"relative-path\">FileFormatException</a></span>\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<p>The rights management information in this package cannot be read by the current version of this class.</p>\n\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>After the <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> for the specified user has been saved, it can be retrieved through the <a class=\"xref\" href=\"system.io.packaging.rightsmanagementinformation#System_IO_Packaging_RightsManagementInformation_LoadUseLicense_\" data-linktype=\"relative-path\">LoadUseLicense</a> method and from the collection returned by <a class=\"xref\" href=\"system.io.packaging.rightsmanagementinformation#System_IO_Packaging_RightsManagementInformation_GetEmbeddedUseLicenses_\" data-linktype=\"relative-path\">GetEmbeddedUseLicenses</a>.  </p>\n<p> A <a class=\"xref\" href=\"system.io.packaging.package\" data-linktype=\"relative-path\">Package</a> can store the <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> rights information for multiple content users.  Each ContentUser can have at most one <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a>.  If SaveUseLicense is called to store a new <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a> for a <a class=\"xref\" href=\"system.security.rightsmanagement.contentuser\" data-linktype=\"relative-path\">ContentUser</a> that already has a <a class=\"xref\" href=\"system.security.rightsmanagement.uselicense\" data-linktype=\"relative-path\">UseLicense</a>, the previous license will be overwritten with the new license.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t  \r\n  \t\t</section>\r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.IO.Packaging.RightsManagementInformation.yml\">\r\n<meta name=\"APIName\" content=\"System.IO.Packaging.RightsManagementInformation\">\r\n<meta name=\"APIName\" content=\"System.IO.Packaging.RightsManagementInformation.CryptoProvider\">\r\n<meta name=\"APIName\" content=\"System.IO.Packaging.RightsManagementInformation.DeleteUseLicense\">\r\n<meta name=\"APIName\" content=\"System.IO.Packaging.RightsManagementInformation.GetEmbeddedUseLicenses\">\r\n<meta name=\"APIName\" content=\"System.IO.Packaging.RightsManagementInformation.LoadPublishLicense\">\r\n<meta name=\"APIName\" content=\"System.IO.Packaging.RightsManagementInformation.LoadUseLicense\">\r\n<meta name=\"APIName\" content=\"System.IO.Packaging.RightsManagementInformation.SavePublishLicense\">\r\n<meta name=\"APIName\" content=\"System.IO.Packaging.RightsManagementInformation.SaveUseLicense\">\r\n<meta name=\"APILocation\" content=\"WindowsBase.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-24 01:41 AM\">\r\n<meta name=\"document_id\" content=\"0d20686b-672a-5def-0955-626bb2394016\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Represents Digital Rights Management (DRM) information that is stored in an .\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.io.packaging/toc2.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.IO.Packaging.RightsManagementInformation\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.IO.Packaging.RightsManagementInformation.yml","open_to_public_contributors":false,"api_name":["System.IO.Packaging.RightsManagementInformation","System.IO.Packaging.RightsManagementInformation.CryptoProvider","System.IO.Packaging.RightsManagementInformation.DeleteUseLicense","System.IO.Packaging.RightsManagementInformation.GetEmbeddedUseLicenses","System.IO.Packaging.RightsManagementInformation.LoadPublishLicense","System.IO.Packaging.RightsManagementInformation.LoadUseLicense","System.IO.Packaging.RightsManagementInformation.SavePublishLicense","System.IO.Packaging.RightsManagementInformation.SaveUseLicense"],"api_location":["WindowsBase.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.IO.Packaging.RightsManagementInformation","System::IO::Packaging::RightsManagementInformation","System.IO.Packaging.RightsManagementInformation.CryptoProvider","System::IO::Packaging::RightsManagementInformation::CryptoProvider","System.IO.Packaging.RightsManagementInformation.DeleteUseLicense","System::IO::Packaging::RightsManagementInformation::DeleteUseLicense","System.IO.Packaging.RightsManagementInformation.GetEmbeddedUseLicenses","System::IO::Packaging::RightsManagementInformation::GetEmbeddedUseLicenses","System.IO.Packaging.RightsManagementInformation.LoadPublishLicense","System::IO::Packaging::RightsManagementInformation::LoadPublishLicense","System.IO.Packaging.RightsManagementInformation.LoadUseLicense","System::IO::Packaging::RightsManagementInformation::LoadUseLicense","System.IO.Packaging.RightsManagementInformation.SavePublishLicense","System::IO::Packaging::RightsManagementInformation::SavePublishLicense","System.IO.Packaging.RightsManagementInformation.SaveUseLicense","System::IO::Packaging::RightsManagementInformation::SaveUseLicense"],"dev_langs":["csharp"],"updated_at":"2017-03-24 01:41 AM","document_id":"0d20686b-672a-5def-0955-626bb2394016","content_git_url":"https://github.com/dotnet/docs/blob/master/xml/System.IO.Packaging/RightsManagementInformation.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"RightsManagementInformation class | Microsoft Docs","_op_ogTitle":"RightsManagementInformation class","description":"Represents Digital Rights Management (DRM) information that is stored in an .\n","toc_asset_id":"api/_splitted/System.IO.Packaging/toc.json","toc_rel":"_splitted/System.IO.Packaging/toc.json","source_url":"","ms.assetid":"System.IO.Packaging.RightsManagementInformation","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.io.packaging.rightsmanagementinformation","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.io.packaging.rightsmanagementinformation","fileRelativePath":"api/System.IO.Packaging.RightsManagementInformation.html"},"themesRelativePathToOutputRoot":"_themes/"}