{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">TextRun</span>\r\n    \t\t\t\tClass\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Represents a sequence of characters that share a single property set.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public abstract class TextRun</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span></div><span class=\"lang-csharp\">TextRun</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \t<h3 class=\"accented\">Inherited Members</h3>\r\n  \t<h4 class=\"accented\"></h4>\r\n  \t<div class=\"cdlHolder\">\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a></span></div>\r\n  \t</div>\r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>In the following example, an override for the <a class=\"xref\" href=\"system.windows.media.textformatting.textsource#System_Windows_Media_TextFormatting_TextSource_GetTextRun_\" data-linktype=\"relative-path\">GetTextRun</a> method is implemented.  </p>\n<pre><code class=\"lang-cs\" name=\"TextFormattingSnippets#TextFormattingSnippet4\">// Retrieve the next formatted text run for the text source.\npublic override TextRun GetTextRun(int textSourceCharacterIndex)\n{\n    // Determine whether the text source index is in bounds.\n    if (textSourceCharacterIndex &lt; 0)\n    {\n        throw new ArgumentOutOfRangeException(&quot;textSourceCharacterIndex&quot;, &quot;Value must be greater than 0.&quot;);\n    }\n\n    // Determine whether the text source index has exceeded or equaled the text source length.\n    if (textSourceCharacterIndex &gt;= _text.Length)\n    {\n        // Return an end-of-paragraph indicator -- a TextEndOfParagraph object is a special type of text run.\n        return new TextEndOfParagraph(1);\n    }\n\n    // Create and return a TextCharacters object, which is formatted according to\n    // the current layout and rendering properties.\n    if (textSourceCharacterIndex &lt; _text.Length)\n    {\n        // The TextCharacters object is a special type of text run that contains formatted text.\n        return new TextCharacters(\n           _text,                                       // The text store\n           textSourceCharacterIndex,                    // The text store index\n           _text.Length - textSourceCharacterIndex,     // The text store length\n           new CustomTextRunProperties());              // The layout and rendering properties\n    }\n\n    // Return an end-of-paragraph indicator if there is no more text source.\n    return new TextEndOfParagraph(1);\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"TextFormattingSnippets#TextFormattingSnippet4\">&#39; Retrieve the next formatted text run for the text source.\nPublic Overrides Function GetTextRun(ByVal textSourceCharacterIndex As Integer) As TextRun\n\t&#39; Determine whether the text source index is in bounds.\n\tIf textSourceCharacterIndex &lt; 0 Then\n\t\tThrow New ArgumentOutOfRangeException(&quot;textSourceCharacterIndex&quot;, &quot;Value must be greater than 0.&quot;)\n\tEnd If\n\n\t&#39; Determine whether the text source index has exceeded or equaled the text source length.\n\tIf textSourceCharacterIndex &gt;= _text.Length Then\n\t\t&#39; Return an end-of-paragraph indicator -- a TextEndOfParagraph object is a special type of text run.\n\t\tReturn New TextEndOfParagraph(1)\n\tEnd If\n\n\t&#39; Create and return a TextCharacters object, which is formatted according to\n\t&#39; the current layout and rendering properties.\n\tIf textSourceCharacterIndex &lt; _text.Length Then\n\t\t&#39; The TextCharacters object is a special type of text run that contains formatted text.\n\t\tReturn New TextCharacters(_text, textSourceCharacterIndex, _text.Length - textSourceCharacterIndex, New CustomTextRunProperties()) &#39; The layout and rendering properties -  The text store length -  The text store index -  The text store\n\tEnd If\n\n\t&#39; Return an end-of-paragraph indicator if there is no more text source.\n\tReturn New TextEndOfParagraph(1)\nEnd Function\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>A text run is a sequence of characters sharing a single property set. Any change to the format, such as font style, foreground color, font family, or any other formatting effect, breaks the text run. The following example illustrates how changes in formatting to a text string results in a series of text runsâ€”each text run has a common set of formatting properties.  </p>\n<p> The TextRun class is the root of a type hierarchy representing several types of text content processed by <a class=\"xref\" href=\"system.windows.media.textformatting.textformatter\" data-linktype=\"relative-path\">TextFormatter</a>. Each class that is derived from TextRun represents a distinct type of text content.  </p>\n<table>\n<thead>\n<tr>\n<th>Class</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>TextRun</td>\n<td>Root of the hierarchy. Defines a group of characters that share the same set of character properties.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"system.windows.media.textformatting.textcharacters\" data-linktype=\"relative-path\">TextCharacters</a></td>\n<td>Defines a collection of character glyphs from a distinct physical typeface.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"system.windows.media.textformatting.textembeddedobject\" data-linktype=\"relative-path\">TextEmbeddedObject</a></td>\n<td>Defines a type of text content in which measuring, hit testing, and drawing of the entire content is done as a distinct entity. An example of this type of content is a button in the middle of the line of text.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"system.windows.media.textformatting.textendofline\" data-linktype=\"relative-path\">TextEndOfLine</a></td>\n<td>Defines a line-break character code.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"system.windows.media.textformatting.textendofparagraph\" data-linktype=\"relative-path\">TextEndOfParagraph</a></td>\n<td>Defines a paragraph-break character code. Derives from <a class=\"xref\" href=\"system.windows.media.textformatting.textendofline\" data-linktype=\"relative-path\">TextEndOfLine</a>.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"system.windows.media.textformatting.textendofsegment\" data-linktype=\"relative-path\">TextEndOfSegment</a></td>\n<td>Defines a segment break marker.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"system.windows.media.textformatting.texthidden\" data-linktype=\"relative-path\">TextHidden</a></td>\n<td>Defines a range of non-visible characters.</td>\n</tr>\n<tr>\n<td><a class=\"xref\" href=\"system.windows.media.textformatting.textmodifier\" data-linktype=\"relative-path\">TextModifier</a></td>\n<td>Defines the beginning of a modification scope.</td>\n</tr>\n</tbody>\n</table>\n\r\n  \r\n  \r\n  \t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Constructors\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Windows_Media_TextFormatting_TextRun__ctor\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">TextRun()</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Creates an instance of a <a class=\"xref\" href=\"system.windows.media.textformatting.textrun\" data-linktype=\"relative-path\">TextRun</a> object.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">protected TextRun ();</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t</section>\t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Properties\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Windows_Media_TextFormatting_TextRun_CharacterBufferReference\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">CharacterBufferReference</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets a reference to the text run character buffer.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public abstract System.Windows.Media.TextFormatting.CharacterBufferReference CharacterBufferReference { get; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.media.textformatting.characterbufferreference\" data-linktype=\"relative-path\">CharacterBufferReference</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>A <a class=\"xref\" href=\"system.windows.media.textformatting.characterbufferreference\" data-linktype=\"relative-path\">CharacterBufferReference</a> value representing the characters in the text run.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Windows_Media_TextFormatting_TextRun_Length\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Length</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets the number of characters in the text run.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public abstract int Length { get; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.int32\" data-linktype=\"relative-path\">Int32</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>An <a class=\"xref\" href=\"system.int32\" data-linktype=\"relative-path\">Int32</a> value that represents the number of characters.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Windows_Media_TextFormatting_TextRun_Properties\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Properties</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets the set of text properties that are shared by every character in the text run, such as typeface or foreground brush.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public abstract System.Windows.Media.TextFormatting.TextRunProperties Properties { get; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.media.textformatting.textrunproperties\" data-linktype=\"relative-path\">TextRunProperties</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>A <a class=\"xref\" href=\"system.windows.media.textformatting.textrunproperties\" data-linktype=\"relative-path\">TextRunProperties</a> value that represents the set of shared text properties.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t</section>\r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.Windows.Media.TextFormatting.TextRun.yml\">\r\n<meta name=\"APIName\" content=\"System.Windows.Media.TextFormatting.TextRun\">\r\n<meta name=\"APIName\" content=\"System.Windows.Media.TextFormatting.TextRun..ctor\">\r\n<meta name=\"APIName\" content=\"System.Windows.Media.TextFormatting.TextRun.CharacterBufferReference\">\r\n<meta name=\"APIName\" content=\"System.Windows.Media.TextFormatting.TextRun.Length\">\r\n<meta name=\"APIName\" content=\"System.Windows.Media.TextFormatting.TextRun.Properties\">\r\n<meta name=\"APILocation\" content=\"PresentationCore.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-28 03:03 AM\">\r\n<meta name=\"document_id\" content=\"e5ac00ec-c8ff-c2f1-d2c8-2270ed47a729\">\r\n<meta name=\"internalonly\" content=\"false\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Represents a sequence of characters that share a single property set.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.windows.media.textformatting/toc2.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Windows.Media.TextFormatting.TextRun\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.Windows.Media.TextFormatting.TextRun.yml","open_to_public_contributors":false,"api_name":["System.Windows.Media.TextFormatting.TextRun","System.Windows.Media.TextFormatting.TextRun..ctor","System.Windows.Media.TextFormatting.TextRun.CharacterBufferReference","System.Windows.Media.TextFormatting.TextRun.Length","System.Windows.Media.TextFormatting.TextRun.Properties"],"api_location":["PresentationCore.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Windows.Media.TextFormatting.TextRun","System::Windows::Media::TextFormatting::TextRun","System.Windows.Media.TextFormatting.TextRun.#ctor","System::Windows::Media::TextFormatting::TextRun::#ctor","System.Windows.Media.TextFormatting.TextRun.CharacterBufferReference","System::Windows::Media::TextFormatting::TextRun::CharacterBufferReference","System.Windows.Media.TextFormatting.TextRun.Length","System::Windows::Media::TextFormatting::TextRun::Length","System.Windows.Media.TextFormatting.TextRun.Properties","System::Windows::Media::TextFormatting::TextRun::Properties"],"dev_langs":["csharp"],"updated_at":"2017-03-28 03:03 AM","document_id":"e5ac00ec-c8ff-c2f1-d2c8-2270ed47a729","content_git_url":"https://github.com/dotnet/docs/blob/master/xml/System.Windows.Media.TextFormatting/TextRun.xml","internalonly":false,"layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"TextRun class | Microsoft Docs","_op_ogTitle":"TextRun class","description":"Represents a sequence of characters that share a single property set.\n","toc_asset_id":"api/_splitted/System.Windows.Media.TextFormatting/toc.json","toc_rel":"_splitted/System.Windows.Media.TextFormatting/toc.json","source_url":"","ms.assetid":"System.Windows.Media.TextFormatting.TextRun","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.textformatting.textrun","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.textformatting.textrun","fileRelativePath":"api/System.Windows.Media.TextFormatting.TextRun.html"},"themesRelativePathToOutputRoot":"_themes/"}