{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">ServiceProcessInstaller</span>\r\n    \t\t\t\tClass\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Installs an executable containing classes that extend <a class=\"xref\" href=\"system.serviceprocess.servicebase\" data-linktype=\"relative-path\">ServiceBase</a>. This class is called by installation utilities, such as InstallUtil.exe, when installing a service application.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public class ServiceProcessInstaller : System.Configuration.Install.ComponentInstaller</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.marshalbyrefobject\" data-linktype=\"relative-path\">MarshalByRefObject</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.component\" data-linktype=\"relative-path\">Component</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer\" data-linktype=\"relative-path\">Installer</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.componentinstaller\" data-linktype=\"relative-path\">System.Configuration.Install.ComponentInstaller</a></span></div><span class=\"lang-csharp\">ServiceProcessInstaller</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \t<h3 class=\"accented\">Inherited Members</h3>\r\n  \t<h4 class=\"accented\"></h4>\r\n  \t<div class=\"cdlHolder\">\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.component#System_ComponentModel_Component_CanRaiseEvents\" data-linktype=\"relative-path\">CanRaiseEvents</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.component#System_ComponentModel_Component_Container\" data-linktype=\"relative-path\">Container</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.component#System_ComponentModel_Component_DesignMode\" data-linktype=\"relative-path\">DesignMode</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.component#System_ComponentModel_Component_Dispose\" data-linktype=\"relative-path\">Dispose()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.component#System_ComponentModel_Component_Dispose_System_Boolean_\" data-linktype=\"relative-path\">Dispose(Boolean)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.component#System_ComponentModel_Component_Disposed\" data-linktype=\"relative-path\">Disposed</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.component#System_ComponentModel_Component_Events\" data-linktype=\"relative-path\">Events</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.component#System_ComponentModel_Component_GetService_System_Type_\" data-linktype=\"relative-path\">GetService(Type)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.component#System_ComponentModel_Component_Site\" data-linktype=\"relative-path\">Site</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.component#System_ComponentModel_Component_ToString\" data-linktype=\"relative-path\">ToString()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.componentinstaller#System_Configuration_Install_ComponentInstaller_IsEquivalentInstaller_System_Configuration_Install_ComponentInstaller_\" data-linktype=\"relative-path\">IsEquivalentInstaller(ComponentInstaller)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_AfterInstall\" data-linktype=\"relative-path\">AfterInstall</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_AfterRollback\" data-linktype=\"relative-path\">AfterRollback</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_AfterUninstall\" data-linktype=\"relative-path\">AfterUninstall</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_BeforeInstall\" data-linktype=\"relative-path\">BeforeInstall</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_BeforeRollback\" data-linktype=\"relative-path\">BeforeRollback</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_BeforeUninstall\" data-linktype=\"relative-path\">BeforeUninstall</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Commit_System_Collections_IDictionary_\" data-linktype=\"relative-path\">Commit(IDictionary)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Committed\" data-linktype=\"relative-path\">Committed</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Committing\" data-linktype=\"relative-path\">Committing</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Context\" data-linktype=\"relative-path\">Context</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Installers\" data-linktype=\"relative-path\">Installers</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_OnAfterInstall_System_Collections_IDictionary_\" data-linktype=\"relative-path\">OnAfterInstall(IDictionary)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_OnAfterRollback_System_Collections_IDictionary_\" data-linktype=\"relative-path\">OnAfterRollback(IDictionary)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_OnAfterUninstall_System_Collections_IDictionary_\" data-linktype=\"relative-path\">OnAfterUninstall(IDictionary)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_OnBeforeInstall_System_Collections_IDictionary_\" data-linktype=\"relative-path\">OnBeforeInstall(IDictionary)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_OnBeforeRollback_System_Collections_IDictionary_\" data-linktype=\"relative-path\">OnBeforeRollback(IDictionary)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_OnBeforeUninstall_System_Collections_IDictionary_\" data-linktype=\"relative-path\">OnBeforeUninstall(IDictionary)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_OnCommitted_System_Collections_IDictionary_\" data-linktype=\"relative-path\">OnCommitted(IDictionary)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_OnCommitting_System_Collections_IDictionary_\" data-linktype=\"relative-path\">OnCommitting(IDictionary)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Parent\" data-linktype=\"relative-path\">Parent</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Uninstall_System_Collections_IDictionary_\" data-linktype=\"relative-path\">Uninstall(IDictionary)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.marshalbyrefobject#System_MarshalByRefObject_CreateObjRef_System_Type_\" data-linktype=\"relative-path\">CreateObjRef(Type)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.marshalbyrefobject#System_MarshalByRefObject_GetLifetimeService\" data-linktype=\"relative-path\">GetLifetimeService()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.marshalbyrefobject#System_MarshalByRefObject_InitializeLifetimeService\" data-linktype=\"relative-path\">InitializeLifetimeService()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.marshalbyrefobject#System_MarshalByRefObject_MemberwiseClone_System_Boolean_\" data-linktype=\"relative-path\">MemberwiseClone(Boolean)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object,Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object,Object)</a></span></div>\r\n  \t</div>\r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following example creates a project installer called MyProjectInstaller, which inherits from <a class=\"xref\" href=\"system.configuration.install.installer\" data-linktype=\"relative-path\">Installer</a>. It is assumed there is a service executable that contains two services, &quot;Hello-World Service 1&quot; and &quot;Hello-World Service 2&quot;. Within the constructor for MyProjectInstaller (which would be called by the install utility), <a class=\"xref\" href=\"system.serviceprocess.serviceinstaller\" data-linktype=\"relative-path\">ServiceInstaller</a> objects are created for each service, and a ServiceProcessInstaller is created for the executable. For the install utility to recognize MyProjectInstaller as a valid installer, the <a class=\"xref\" href=\"system.componentmodel.runinstallerattribute\" data-linktype=\"relative-path\">RunInstallerAttribute</a> attribute is set to <code>true</code>.  </p>\n<p> Optional properties are set on the process installer and the service installers before the installers are added to the <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Installers_\" data-linktype=\"relative-path\">Installers</a> collection. When the install utility accesses MyProjectInstaller, the objects added to the <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Installers_\" data-linktype=\"relative-path\">Installers</a> collection through a call to <a class=\"xref\" href=\"system.configuration.install.installercollection#System_Configuration_Install_InstallerCollection_Add_\" data-linktype=\"relative-path\">Add</a> will be installed in turn. During the process, the installer maintains state information indicating which objects have been installed, so each object can be backed out in turn in case of an installation failure.  </p>\n<p> Normally, you would not instantiate your project installer class explicitly. You would create it and add the <a class=\"xref\" href=\"system.componentmodel.runinstallerattribute\" data-linktype=\"relative-path\">RunInstallerAttribute</a>, but the install utility actually calls, and therefore instantiates, the class.  </p>\n<pre><code class=\"lang-cpp\" name=\"Classic ServiceInstaller Example#1\">#using &lt;System.dll&gt;\n#using &lt;System.ServiceProcess.dll&gt;\n#using &lt;System.Configuration.Install.dll&gt;\n\nusing namespace System;\nusing namespace System::Collections;\nusing namespace System::Configuration::Install;\nusing namespace System::ServiceProcess;\nusing namespace System::ComponentModel;\n\n[RunInstaller(true)]\npublic ref class MyProjectInstaller : public Installer\n{\nprivate:\n    ServiceInstaller^ serviceInstaller1;\n    ServiceInstaller^ serviceInstaller2;\n    ServiceProcessInstaller^ processInstaller;\n\npublic:\n    MyProjectInstaller()\n    {\n        // Instantiate installers for process and services.\n        processInstaller = gcnew ServiceProcessInstaller;\n        serviceInstaller1 = gcnew ServiceInstaller;\n        serviceInstaller2 = gcnew ServiceInstaller;\n\n        // The services run under the system account.\n        processInstaller-&gt;Account = ServiceAccount::LocalSystem;\n\n        // The services are started manually.\n        serviceInstaller1-&gt;StartType = ServiceStartMode::Manual;\n        serviceInstaller2-&gt;StartType = ServiceStartMode::Manual;\n\n        // ServiceName must equal those on ServiceBase derived classes.\n        serviceInstaller1-&gt;ServiceName = &quot;Hello-World Service 1&quot;;\n        serviceInstaller2-&gt;ServiceName = &quot;Hello-World Service 2&quot;;\n\n        // Add installers to collection. Order is not important.\n        Installers-&gt;Add( serviceInstaller1 );\n        Installers-&gt;Add( serviceInstaller2 );\n        Installers-&gt;Add( processInstaller );\n    }\n\n    static void Main()\n    {\n        Console::WriteLine(&quot;Usage: InstallUtil.exe [&lt;service&gt;.exe]&quot;);\n    }\n};\n\nint main()\n{\n    MyProjectInstaller::Main();\n}\n</code></pre><pre><code class=\"lang-cs\" name=\"Classic ServiceInstaller Example#1\">using System;\nusing System.Collections;\nusing System.Configuration.Install;\nusing System.ServiceProcess;\nusing System.ComponentModel;\n\n[RunInstaller(true)]\npublic class MyProjectInstaller : Installer\n{\n    private ServiceInstaller serviceInstaller1;\n    private ServiceInstaller serviceInstaller2;\n    private ServiceProcessInstaller processInstaller;\n\n    public MyProjectInstaller()\n    {\n        // Instantiate installers for process and services.\n        processInstaller = new ServiceProcessInstaller();\n        serviceInstaller1 = new ServiceInstaller();\n        serviceInstaller2 = new ServiceInstaller();\n\n        // The services run under the system account.\n        processInstaller.Account = ServiceAccount.LocalSystem;\n\n        // The services are started manually.\n        serviceInstaller1.StartType = ServiceStartMode.Manual;\n        serviceInstaller2.StartType = ServiceStartMode.Manual;\n\n        // ServiceName must equal those on ServiceBase derived classes.\n        serviceInstaller1.ServiceName = &quot;Hello-World Service 1&quot;;\n        serviceInstaller2.ServiceName = &quot;Hello-World Service 2&quot;;\n\n        // Add installers to collection. Order is not important.\n        Installers.Add(serviceInstaller1);\n        Installers.Add(serviceInstaller2);\n        Installers.Add(processInstaller);\n    }\n\n    public static void Main()\n    {\n        Console.WriteLine(&quot;Usage: InstallUtil.exe [&lt;service&gt;.exe]&quot;);\n    }\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"Classic ServiceInstaller Example#1\">Imports System\nImports System.Collections\nImports System.Configuration.Install\nImports System.ServiceProcess\nImports System.ComponentModel\n\n&lt;RunInstallerAttribute(True)&gt; _\nPublic Class MyProjectInstaller\n    Inherits Installer\n    Private serviceInstaller1 As ServiceInstaller\n    Private serviceInstaller2 As ServiceInstaller\n    Private processInstaller As ServiceProcessInstaller    \n    \n    Public Sub New()\n        &#39; Instantiate installers for process and services.\n        processInstaller = New ServiceProcessInstaller()\n        serviceInstaller1 = New ServiceInstaller()\n        serviceInstaller2 = New ServiceInstaller()\n        \n        &#39; The services will run under the system account.\n        processInstaller.Account = ServiceAccount.LocalSystem\n        \n        &#39; The services will be started manually.\n        serviceInstaller1.StartType = ServiceStartMode.Manual\n        serviceInstaller2.StartType = ServiceStartMode.Manual\n        \n        &#39; ServiceName must equal those on ServiceBase derived classes.            \n        serviceInstaller1.ServiceName = &quot;Hello-World Service 1&quot;\n        serviceInstaller2.ServiceName = &quot;Hello-World Service 2&quot;\n        \n        &#39; Add installers to collection. Order is not important.\n        Installers.Add(serviceInstaller1)\n        Installers.Add(serviceInstaller2)\n        Installers.Add(processInstaller)\n    End Sub\n\n    Public Shared Sub Main()\n        Console.WriteLine(&quot;Usage: InstallUtil.exe [&lt;service&gt;.exe]&quot;)\n    End Sub\nEnd Class\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>The ServiceProcessInstaller does work common to all services in an executable. It is used by the installation utility to write registry values associated with services you want to install.  </p>\n<p> To install a service, create a project installer class that inherits from <a class=\"xref\" href=\"system.configuration.install.installer\" data-linktype=\"relative-path\">Installer</a>, and set the <a class=\"xref\" href=\"system.componentmodel.runinstallerattribute\" data-linktype=\"relative-path\">RunInstallerAttribute</a> on the class to <code>true</code>. Within your project, instantiate one ServiceProcessInstaller instance per service application, and one <a class=\"xref\" href=\"system.serviceprocess.serviceinstaller\" data-linktype=\"relative-path\">ServiceInstaller</a> instance for each service in the application. Finally, add the ServiceProcessInstaller instance and the <a class=\"xref\" href=\"system.serviceprocess.serviceinstaller\" data-linktype=\"relative-path\">ServiceInstaller</a> instances to your project installer class.  </p>\n<p> When InstallUtil.exe runs, the utility looks for classes in the service assembly with the <a class=\"xref\" href=\"system.componentmodel.runinstallerattribute\" data-linktype=\"relative-path\">RunInstallerAttribute</a> set to <code>true</code>. Add classes to the service assembly by adding them to the <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Installers_\" data-linktype=\"relative-path\">Installers</a> collection associated with your project installer. If <a class=\"xref\" href=\"system.componentmodel.runinstallerattribute\" data-linktype=\"relative-path\">RunInstallerAttribute</a> is <code>false</code>, the install utility ignores the project installer.  </p>\n<p> For an instance of ServiceProcessInstaller, properties you can modify include specifying that a service application run under an account other than the logged-on user. You can specify a particular <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Username_\" data-linktype=\"relative-path\">Username</a> and <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Password_\" data-linktype=\"relative-path\">Password</a> pair under which the service should run, or you can use <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Account_\" data-linktype=\"relative-path\">Account</a> to specify that the service run under the computer&#39;s System account, a local or network service account, or a user account.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> The computer&#39;s System account is not the same as the Administrator account.  </p>\n</div>\n<p> Normally, you do not call the methods on <a class=\"xref\" href=\"system.serviceprocess.serviceinstaller\" data-linktype=\"relative-path\">ServiceInstaller</a> within your code; they are generally called only by the install utility. The install utility automatically calls the <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Install_\" data-linktype=\"relative-path\">Install</a> and <a class=\"xref\" href=\"system.serviceprocess.serviceinstaller#System_ServiceProcess_ServiceInstaller_Install_\" data-linktype=\"relative-path\">Install</a> methods during the installation process. It backs out failures, if necessary, by calling <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Rollback_\" data-linktype=\"relative-path\">Rollback</a> (or <a class=\"xref\" href=\"system.serviceprocess.serviceinstaller#System_ServiceProcess_ServiceInstaller_Rollback_\" data-linktype=\"relative-path\">Rollback</a>) on all previously installed components.  </p>\n<p> An application&#39;s install routine maintains information automatically about the components already installed, using the project installer&#39;s <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Context_\" data-linktype=\"relative-path\">Context</a>. This state information is continuously updated as the ServiceProcessInstaller instance and each <a class=\"xref\" href=\"system.serviceprocess.serviceinstaller\" data-linktype=\"relative-path\">ServiceInstaller</a> instance is installed by the utility. It is usually unnecessary for your code to modify this state information explicitly.  </p>\n<p> Instantiating a ServiceProcessInstaller causes the base class constructor, <a class=\"xref\" href=\"system.configuration.install.componentinstaller#System_Configuration_Install_ComponentInstaller__ctor_\" data-linktype=\"relative-path\">ComponentInstaller</a>, to be called.</p>\n\r\n  \r\n  \r\n  \t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Constructors\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceProcess_ServiceProcessInstaller__ctor\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">ServiceProcessInstaller()</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Creates a new instance of the <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller\" data-linktype=\"relative-path\">ServiceProcessInstaller</a> class.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public ServiceProcessInstaller ();</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t  \r\n  \t\t</section>\t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Properties\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceProcess_ServiceProcessInstaller_Account\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Account</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets or sets the type of account under which to run this service application.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public System.ServiceProcess.ServiceAccount Account { get; set; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.serviceprocess.serviceaccount\" data-linktype=\"relative-path\">ServiceAccount</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>A <a class=\"xref\" href=\"system.serviceprocess.serviceaccount\" data-linktype=\"relative-path\">ServiceAccount</a> that defines the type of account under which the system runs this service. The default is <code>User</code>.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>When the Account property is <code>User</code>, the <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Username_\" data-linktype=\"relative-path\">Username</a> and <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Password_\" data-linktype=\"relative-path\">Password</a> properties are used to define an account under which the service application runs.  </p>\n<p> The <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Username_\" data-linktype=\"relative-path\">Username</a> and <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Password_\" data-linktype=\"relative-path\">Password</a> pair allows the service to run under an account other than the system account. This can, for example, allow the service to start automatically at reboot, when no user is logged on. If you leave either the <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Username_\" data-linktype=\"relative-path\">Username</a> or <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Password_\" data-linktype=\"relative-path\">Password</a> empty and set Account to <code>User</code>, you will be prompted for a valid user name and password at installation.  </p>\n<p> You can also specify that the service run under the local system account, or as a local or network service. See the <a class=\"xref\" href=\"system.serviceprocess.serviceaccount\" data-linktype=\"relative-path\">ServiceAccount</a> enumeration for details on types of accounts.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceProcess_ServiceProcessInstaller_HelpText\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">HelpText</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets help text displayed for service installation options.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public override string HelpText { get; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>Help text that provides a description of the steps for setting the user name and password in order to run the service under a particular account.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>This help text can be used when a service starts manually. It indicates to the user how to enter user name and password information.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceProcess_ServiceProcessInstaller_Password\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Password</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets or sets the password associated with the user account under which the service application runs.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public string Password { get; set; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The password associated with the account under which the service should run. The default is an empty string (&quot;&quot;). The property is not public, and is never serialized.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>The Password and <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Username_\" data-linktype=\"relative-path\">Username</a> pair allows the service to run under an account other than the system account. This can, for example, allow the service to start automatically at reboot, when no user is logged on.  </p>\n<p> Password and <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Username_\" data-linktype=\"relative-path\">Username</a> are handled in a secure manner in that they are never serialized or saved to the install state (the project installer&#39;s <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Context_\" data-linktype=\"relative-path\">Context</a>) or other location with public access.  </p>\n<p> Setting the <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Username_\" data-linktype=\"relative-path\">Username</a> and Password allows an account to be associated automatically with the service at install time. If you leave either the <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Username_\" data-linktype=\"relative-path\">Username</a> or Password empty and set <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Account_\" data-linktype=\"relative-path\">Account</a> to <code>User</code>, you will be prompted for a valid user name and password at installation.  </p>\n<p> Another option for running a service under a separate account is to use the computer&#39;s System account. That account, which is distinct from the Administrator account, requires no password. The System account&#39;s privileges may exceed those of the user currently logged in. Running under the System account rather than a user account avoids problems resulting from the user lacking a permission the service requires  </p>\n<p> If <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Account_\" data-linktype=\"relative-path\">Account</a> is any value other than <code>User</code>, the specifed account (local or network service, or local system) is used, even if the <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Username_\" data-linktype=\"relative-path\">Username</a> and Password properties are populated.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceProcess_ServiceProcessInstaller_Username\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Username</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets or sets the user account under which the service application will run.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public string Username { get; set; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The account under which the service should run. The default is an empty string (&quot;&quot;).</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>The Username and <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Password_\" data-linktype=\"relative-path\">Password</a> pair allows the service to run under an account other than the system account. This can, for example, allow the service to start automatically at reboot, when no user is logged on.  </p>\n<p> <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Password_\" data-linktype=\"relative-path\">Password</a> and Username are handled in a secure manner in that they are never serialized or saved to the install state (the project installer&#39;s <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Context_\" data-linktype=\"relative-path\">Context</a>) or other location with public access.  </p>\n<p> Setting the Username and <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Password_\" data-linktype=\"relative-path\">Password</a> allows an account to be associated automatically with the service at install time. If you leave either the Username or <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Password_\" data-linktype=\"relative-path\">Password</a> empty and set <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Account_\" data-linktype=\"relative-path\">Account</a> to <code>User</code>, you will be prompted for a valid user name and password at installation.  </p>\n<p> Another option for running a service under a separate account is to use the computer&#39;s System account. That account, which is distinct from the Administrator account, requires no password. The System account&#39;s privileges may exceed those of the user currently logged in. Running under the System account rather than a user account avoids problems resulting from the user lacking a permission the service requires  </p>\n<p> If <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Account_\" data-linktype=\"relative-path\">Account</a> is any value other than <code>User</code>, the specified account (local or network service, or local system) is used, even if the Username and <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Password_\" data-linktype=\"relative-path\">Password</a> properties are populated.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t  \r\n  \t\t</section>\t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Methods\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceProcess_ServiceProcessInstaller_CopyFromComponent_System_ComponentModel_IComponent_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">CopyFromComponent(IComponent)</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Implements the base class <span class=\"xref\">stem.Configuration.Install.ComponentInstaller.CopyFromComponent*</span> method with no <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller\" data-linktype=\"relative-path\">ServiceProcessInstaller</a> class-specific behavior.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public override void CopyFromComponent (System.ComponentModel.IComponent comp);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>comp</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.componentmodel.icomponent\" data-linktype=\"relative-path\">IComponent</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The <a class=\"xref\" href=\"system.componentmodel.icomponent\" data-linktype=\"relative-path\">IComponent</a> that represents the service process.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>This method should not be called within your code. The base class method on <a class=\"xref\" href=\"system.configuration.install.componentinstaller\" data-linktype=\"relative-path\">ComponentInstaller</a> is <code>abstract</code>, so it is implemented here on the derived class. However, there is no <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller\" data-linktype=\"relative-path\">ServiceProcessInstaller</a> class-specific processing in the method&#39;s implementation.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceProcess_ServiceProcessInstaller_Install_System_Collections_IDictionary_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Install(IDictionary)</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Writes service application information to the registry. This method is meant to be used by installation tools, which call the appropriate methods automatically.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public override void Install (System.Collections.IDictionary stateSaver);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>stateSaver</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.idictionary\" data-linktype=\"relative-path\">IDictionary</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>An <a class=\"xref\" href=\"system.collections.idictionary\" data-linktype=\"relative-path\">IDictionary</a> that contains the context information associated with the installation.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Exceptions</div>\r\n  \t\t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></span>\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<p>The <code>stateSaver</code> is <code>null</code>.</p>\n\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>Normally, you do not call the methods on <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller\" data-linktype=\"relative-path\">ServiceProcessInstaller</a> within your code; they are generally called only by the install utility. The install utility automatically calls the Install method during the installation process. It backs out failures, if necessary, by calling <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Rollback_\" data-linktype=\"relative-path\">Rollback</a> on all previously installed components. This method passes the installation to the base class <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Install_\" data-linktype=\"relative-path\">Install</a> method.  </p>\n<p> Normally, you will not call the methods on <a class=\"xref\" href=\"system.serviceprocess.serviceinstaller\" data-linktype=\"relative-path\">ServiceInstaller</a> within your code; they are generally called only by the install utility. The install utility automatically calls the Install and <a class=\"xref\" href=\"system.serviceprocess.serviceinstaller#System_ServiceProcess_ServiceInstaller_Install_\" data-linktype=\"relative-path\">Install</a> methods during the installation process. It backs out failures, if necessary, by calling <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Rollback_\" data-linktype=\"relative-path\">Rollback</a> (or <a class=\"xref\" href=\"system.serviceprocess.serviceinstaller#System_ServiceProcess_ServiceInstaller_Rollback_\" data-linktype=\"relative-path\">Rollback</a>) on all previously installed components  </p>\n<p> An application&#39;s install routine maintains information automatically about the components already installed, using the project installer&#39;s <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Context_\" data-linktype=\"relative-path\">Context</a>. This state information, passed into Install as the <code>stateSaver</code> parameter, is continuously updated as the <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller\" data-linktype=\"relative-path\">ServiceProcessInstaller</a> instance and each <a class=\"xref\" href=\"system.serviceprocess.serviceinstaller\" data-linktype=\"relative-path\">ServiceInstaller</a> instance is installed by the utility. It is usually unnecessary for your code to modify this state information explicitly.  </p>\n<p> Install passes to the calling method any exceptions thrown by base class methods or <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_BeforeInstall\" data-linktype=\"relative-path\">BeforeInstall</a> / <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_AfterInstall\" data-linktype=\"relative-path\">AfterInstall</a> event handlers.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceProcess_ServiceProcessInstaller_Rollback_System_Collections_IDictionary_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Rollback(IDictionary)</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Rolls back service application information written to the registry by the installation procedure. This method is meant to be used by installation tools, which process the appropriate methods automatically.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public override void Rollback (System.Collections.IDictionary savedState);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>savedState</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.idictionary\" data-linktype=\"relative-path\">IDictionary</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>An <a class=\"xref\" href=\"system.collections.idictionary\" data-linktype=\"relative-path\">IDictionary</a> that contains the context information associated with the installation.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Exceptions</div>\r\n  \t\t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.argumentexception\" data-linktype=\"relative-path\">ArgumentException</a></span>\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<p>The <code>savedState</code> is <code>null</code>.  </p>\n<p> -or-  </p>\n<p> The <code>savedState</code> is corrupted or non-existent.</p>\n\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>Normally, you do not call the methods on <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller\" data-linktype=\"relative-path\">ServiceProcessInstaller</a> within your code; they are generally called only by the install utility. The install utility automatically calls the <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller#System_ServiceProcess_ServiceProcessInstaller_Install_\" data-linktype=\"relative-path\">Install</a> method during the installation process. It backs out failures, if necessary, by calling Rollback on the object that generated the exception.  </p>\n<p> An application&#39;s install routine maintains information automatically about the components already installed, using the project installer&#39;s <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_Context_\" data-linktype=\"relative-path\">Context</a>. This state information, passed into Rollback as the <code>savedState</code> parameter, is continuously updated as the <a class=\"xref\" href=\"system.serviceprocess.serviceprocessinstaller\" data-linktype=\"relative-path\">ServiceProcessInstaller</a> instance and each <a class=\"xref\" href=\"system.serviceprocess.serviceinstaller\" data-linktype=\"relative-path\">ServiceInstaller</a> instance is installed by the utility. It is usually unnecessary for your code to modify this state information explicitly.  </p>\n<p> Rollback passes to the calling method any exceptions thrown by base class methods or <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_BeforeInstall\" data-linktype=\"relative-path\">BeforeInstall</a> / <a class=\"xref\" href=\"system.configuration.install.installer#System_Configuration_Install_Installer_AfterInstall\" data-linktype=\"relative-path\">AfterInstall</a> event handlers.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t  \r\n  \t\t</section>\r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.ServiceProcess.ServiceProcessInstaller.yml\">\r\n<meta name=\"APIName\" content=\"System.ServiceProcess.ServiceProcessInstaller\">\r\n<meta name=\"APIName\" content=\"System.ServiceProcess.ServiceProcessInstaller..ctor\">\r\n<meta name=\"APIName\" content=\"System.ServiceProcess.ServiceProcessInstaller.Account\">\r\n<meta name=\"APIName\" content=\"System.ServiceProcess.ServiceProcessInstaller.CopyFromComponent\">\r\n<meta name=\"APIName\" content=\"System.ServiceProcess.ServiceProcessInstaller.HelpText\">\r\n<meta name=\"APIName\" content=\"System.ServiceProcess.ServiceProcessInstaller.Install\">\r\n<meta name=\"APIName\" content=\"System.ServiceProcess.ServiceProcessInstaller.Password\">\r\n<meta name=\"APIName\" content=\"System.ServiceProcess.ServiceProcessInstaller.Rollback\">\r\n<meta name=\"APIName\" content=\"System.ServiceProcess.ServiceProcessInstaller.Username\">\r\n<meta name=\"APILocation\" content=\"System.ServiceProcess.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-24 01:41 AM\">\r\n<meta name=\"document_id\" content=\"9de47d95-78a7-eb8a-4977-b1c9e72bdaf6\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Installs an executable containing classes that extend . This class is called by installation utilities, such as InstallUtil.exe, when installing a service application.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.serviceprocess/toc2.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.ServiceProcess.ServiceProcessInstaller\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.ServiceProcess.ServiceProcessInstaller.yml","open_to_public_contributors":false,"api_name":["System.ServiceProcess.ServiceProcessInstaller","System.ServiceProcess.ServiceProcessInstaller..ctor","System.ServiceProcess.ServiceProcessInstaller.Account","System.ServiceProcess.ServiceProcessInstaller.CopyFromComponent","System.ServiceProcess.ServiceProcessInstaller.HelpText","System.ServiceProcess.ServiceProcessInstaller.Install","System.ServiceProcess.ServiceProcessInstaller.Password","System.ServiceProcess.ServiceProcessInstaller.Rollback","System.ServiceProcess.ServiceProcessInstaller.Username"],"api_location":["System.ServiceProcess.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.ServiceProcess.ServiceProcessInstaller","System::ServiceProcess::ServiceProcessInstaller","System.ServiceProcess.ServiceProcessInstaller.#ctor","System::ServiceProcess::ServiceProcessInstaller::#ctor","System.ServiceProcess.ServiceProcessInstaller.Account","System::ServiceProcess::ServiceProcessInstaller::Account","System.ServiceProcess.ServiceProcessInstaller.CopyFromComponent","System::ServiceProcess::ServiceProcessInstaller::CopyFromComponent","System.ServiceProcess.ServiceProcessInstaller.HelpText","System::ServiceProcess::ServiceProcessInstaller::HelpText","System.ServiceProcess.ServiceProcessInstaller.Install","System::ServiceProcess::ServiceProcessInstaller::Install","System.ServiceProcess.ServiceProcessInstaller.Password","System::ServiceProcess::ServiceProcessInstaller::Password","System.ServiceProcess.ServiceProcessInstaller.Rollback","System::ServiceProcess::ServiceProcessInstaller::Rollback","System.ServiceProcess.ServiceProcessInstaller.Username","System::ServiceProcess::ServiceProcessInstaller::Username"],"dev_langs":["csharp"],"updated_at":"2017-03-24 01:41 AM","document_id":"9de47d95-78a7-eb8a-4977-b1c9e72bdaf6","content_git_url":"https://github.com/dotnet/docs/blob/master/xml/System.ServiceProcess/ServiceProcessInstaller.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"ServiceProcessInstaller class | Microsoft Docs","_op_ogTitle":"ServiceProcessInstaller class","description":"Installs an executable containing classes that extend . This class is called by installation utilities, such as InstallUtil.exe, when installing a service application.\n","toc_asset_id":"api/_splitted/System.ServiceProcess/toc.json","toc_rel":"_splitted/System.ServiceProcess/toc.json","source_url":"","ms.assetid":"System.ServiceProcess.ServiceProcessInstaller","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.serviceprocess.serviceprocessinstaller","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.serviceprocess.serviceprocessinstaller","fileRelativePath":"api/System.ServiceProcess.ServiceProcessInstaller.html"},"themesRelativePathToOutputRoot":"_themes/"}