{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">RegistryHive</span>\r\n      Enum\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Represents the possible values for a top-level node on a foreign machine.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\r\n  \t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">[System.Runtime.InteropServices.ComVisible(true)]\npublic enum RegistryHive</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.valuetype\" data-linktype=\"relative-path\">ValueType</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.enum\" data-linktype=\"relative-path\">Enum</a></span></div><span class=\"lang-csharp\">RegistryHive</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Attributes</dt><dd>\r\n  \t\t<div class=\"cdlHolder\">\r\n  \t\t\t<span class=\"cdl\"><a class=\"xref\" href=\"system.runtime.interopservices.comvisibleattribute\" title=\"System.Runtime.InteropServices.ComVisibleAttribute\" data-linktype=\"relative-path\">ComVisibleAttribute</a></span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following code example shows how to open a registry key on a remote computer and enumerate the values of the key. The remote computer must be running the remote registry service. Specify the name of the remote computer as a command-line argument when invoking the program.  </p>\n<pre><code class=\"lang-cpp\" name=\"Microsoft.Win32.RegistryKey.OpenRemoteBaseKey#1\">using namespace System;\nusing namespace System::IO;\nusing namespace System::Security::Permissions;\nusing namespace Microsoft::Win32;\n\n\nint main( int argc, char *argv[] )\n{\n   RegistryKey ^ environmentKey;\n   \n   // Check that an argument was specified when the \n   // program was invoked.\n   if ( argc == 1 )\n   {\n      Console::WriteLine( &quot;Error: The name of the remote computer &quot;\n      &quot;must be specified as input on the command line.&quot; );\n      return  -1;\n   }\n\n   try\n   {\n      \n      // Open HKEY_CURRENT_USER\\Environment on a remote computer.\n      environmentKey = RegistryKey::OpenRemoteBaseKey( RegistryHive::CurrentUser, gcnew String(argv[ 1 ]) )-&gt;OpenSubKey( &quot;Environment&quot; );\n   }\n   catch ( IOException^ e ) \n   {\n      Console::WriteLine(  &quot;{0}: {1}&quot;, e-&gt;GetType()-&gt;Name, e-&gt;Message );\n      return  -1;\n   }\n\n   \n   // Print the values.\n   Console::WriteLine( &quot;\\nThere are {0} values for {1}.&quot;, environmentKey-&gt;ValueCount.ToString(), environmentKey-&gt;Name );\n   array&lt;String^&gt;^valueNames = environmentKey-&gt;GetValueNames();\n   for ( int i = 0; i &lt; environmentKey-&gt;ValueCount; i++ )\n   {\n      Console::WriteLine(  &quot;{0,-20}: {1}&quot;, valueNames[ i ], environmentKey-&gt;GetValue( valueNames[ i ] )-&gt;ToString() );\n\n   }\n   \n   // Close the registry key.\n   environmentKey-&gt;Close();\n}\n</code></pre><pre><code class=\"lang-cs\" name=\"Microsoft.Win32.RegistryKey.OpenRemoteBaseKey#1\">using System;\nusing System.IO;\nusing System.Security.Permissions;\nusing Microsoft.Win32;\n\n\nclass RemoteKey\n{\n    static void Main(string[] args)\n    {\n        RegistryKey environmentKey;\n        string remoteName;\n\n        // Check that an argument was specified when the \n        // program was invoked.\n        if(args.Length == 0)\n        {\n            Console.WriteLine(&quot;Error: The name of the remote &quot; +\n                &quot;computer must be specified when the program is &quot; +\n                &quot;invoked.&quot;);\n            return;\n        }\n        else\n        {\n            remoteName = args[0];\n        }\n\n        try\n        {\n            // Open HKEY_CURRENT_USER\\Environment \n            // on a remote computer.\n            environmentKey = RegistryKey.OpenRemoteBaseKey(\n                RegistryHive.CurrentUser, remoteName).OpenSubKey(\n                &quot;Environment&quot;);\n        }\n        catch(IOException e)\n        {\n            Console.WriteLine(&quot;{0}: {1}&quot;, \n                e.GetType().Name, e.Message);\n            return;\n        }\n\n        // Print the values.\n        Console.WriteLine(&quot;\\nThere are {0} values for {1}.&quot;, \n            environmentKey.ValueCount.ToString(), \n            environmentKey.Name);\n        foreach(string valueName in environmentKey.GetValueNames())\n        {\n            Console.WriteLine(&quot;{0,-20}: {1}&quot;, valueName, \n                environmentKey.GetValue(valueName).ToString());\n        }\n\n        // Close the registry key.\n        environmentKey.Close();\n    }\n}\n</code></pre><pre><code class=\"lang-vb\" name=\"Microsoft.Win32.RegistryKey.OpenRemoteBaseKey#1\">Imports Microsoft.VisualBasic\nImports System\nImports System.IO\nImports System.Security.Permissions\nImports Microsoft.Win32\n\n\nPublic Class RemoteKey\n\n    Shared Sub Main(commandLineArgs As String())\n    \n        Dim environmentKey As RegistryKey\n\n        &#39; Check that an argument was specified when the \n        &#39; program was invoked.\n        If commandLineArgs.Length = 0 Then\n            Console.WriteLine(&quot;Error: The name of the remote &quot; &amp; _\n                &quot;computer must be specified as input on the &quot; &amp; _\n                &quot;command line.&quot;)\n            Return\n        End If\n\n        Try\n            &#39; Open HKEY_CURRENT_USER\\Environment on a remote computer.\n            environmentKey = RegistryKey.OpenRemoteBaseKey( _\n                RegistryHive.CurrentUser, _\n                commandLineArgs(0)).OpenSubKey(&quot;Environment&quot;)\n        Catch ex As IOException\n            Console.WriteLine(&quot;{0}: {1}&quot;, _\n                ex.GetType().Name, ex.Message)\n            Return\n        End Try\n\n        &#39; Print the values.\n        Console.WriteLine(&quot;\\nThere are {0} values For {1}.&quot;, _\n            environmentKey.ValueCount.ToString(), environmentKey.Name)\n\n        For Each valueName As String In environmentKey.GetValueNames()\n            Console.WriteLine(&quot;{0,-20}: {1}&quot;, valueName, _\n                environmentKey.GetValue(valueName).ToString())\n        Next\n\n        &#39; Close the registry key.\n        environmentKey.Close()\n    \n    End Sub\nEnd Class\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p><code>RegistryHive</code> values are used by the <a class=\"xref\" href=\"microsoft.win32.registrykey#Microsoft_Win32_RegistryKey_OpenRemoteBaseKey_\" data-linktype=\"relative-path\">OpenRemoteBaseKey</a> method to represent the top-level node of a requested key on a foreign (remote) machine. The node that can be opened with the OpenRemoteBaseKey method must be one of these top-level <code>RegistryKeys</code>. Further access to the subkeys of the identified node is available using using methods in <a class=\"xref\" href=\"microsoft.win32.registrykey\" data-linktype=\"relative-path\">RegistryKey</a>, so long as the the user has appropriate permission.</p>\n\r\n  \r\n      \t<h2 class=\"accented\">Fields\r\n      </h2>\r\n      <table class=\"nameValue\">\r\n      \t<tr><td id=\"Microsoft_Win32_RegistryHive_ClassesRoot\">\r\n      \t\t\t<span class=\"lang-csharp\">ClassesRoot</span>\r\n      \t</td>\r\n      \t<td><p>Represents the HKEY_CLASSES_ROOT base key on another computer. This value can be passed to the <span class=\"xref\">crosoft.Win32.RegistryKey.OpenRemoteBaseKey*</span> method, to open this node remotely.</p>\n</td>\r\n      \t</tr>\r\n      \t<tr><td id=\"Microsoft_Win32_RegistryHive_CurrentConfig\">\r\n      \t\t\t<span class=\"lang-csharp\">CurrentConfig</span>\r\n      \t</td>\r\n      \t<td><p>Represents the HKEY_CURRENT_CONFIG base key on another computer. This value can be passed to the <span class=\"xref\">crosoft.Win32.RegistryKey.OpenRemoteBaseKey*</span> method, to open this node remotely.</p>\n</td>\r\n      \t</tr>\r\n      \t<tr><td id=\"Microsoft_Win32_RegistryHive_CurrentUser\">\r\n      \t\t\t<span class=\"lang-csharp\">CurrentUser</span>\r\n      \t</td>\r\n      \t<td><p>Represents the HKEY_CURRENT_USER base key on another computer. This value can be passed to the <span class=\"xref\">crosoft.Win32.RegistryKey.OpenRemoteBaseKey*</span> method, to open this node remotely.</p>\n</td>\r\n      \t</tr>\r\n      \t<tr><td id=\"Microsoft_Win32_RegistryHive_DynData\">\r\n      \t\t\t<span class=\"lang-csharp\">DynData</span>\r\n      \t</td>\r\n      \t<td><p>Represents the HKEY_DYN_DATA base key on another computer. This value can be passed to the <span class=\"xref\">crosoft.Win32.RegistryKey.OpenRemoteBaseKey*</span> method, to open this node remotely.</p>\n</td>\r\n      \t</tr>\r\n      \t<tr><td id=\"Microsoft_Win32_RegistryHive_LocalMachine\">\r\n      \t\t\t<span class=\"lang-csharp\">LocalMachine</span>\r\n      \t</td>\r\n      \t<td><p>Represents the HKEY_LOCAL_MACHINE base key on another computer. This value can be passed to the <span class=\"xref\">crosoft.Win32.RegistryKey.OpenRemoteBaseKey*</span> method, to open this node remotely.</p>\n</td>\r\n      \t</tr>\r\n      \t<tr><td id=\"Microsoft_Win32_RegistryHive_PerformanceData\">\r\n      \t\t\t<span class=\"lang-csharp\">PerformanceData</span>\r\n      \t</td>\r\n      \t<td><p>Represents the HKEY_PERFORMANCE_DATA base key on another computer. This value can be passed to the <span class=\"xref\">crosoft.Win32.RegistryKey.OpenRemoteBaseKey*</span> method, to open this node remotely.</p>\n</td>\r\n      \t</tr>\r\n      \t<tr><td id=\"Microsoft_Win32_RegistryHive_Users\">\r\n      \t\t\t<span class=\"lang-csharp\">Users</span>\r\n      \t</td>\r\n      \t<td><p>Represents the HKEY_USERS base key on another computer. This value can be passed to the <span class=\"xref\">crosoft.Win32.RegistryKey.OpenRemoteBaseKey*</span> method, to open this node remotely.</p>\n</td>\r\n      \t</tr>\r\n      </table>\r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"uhfHeaderId\" content=\"MSDocsHeader-DotNet\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/Microsoft.Win32.RegistryHive.yml\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.RegistryHive\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.RegistryHive.ClassesRoot\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.RegistryHive.CurrentConfig\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.RegistryHive.CurrentUser\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.RegistryHive.DynData\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.RegistryHive.LocalMachine\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.RegistryHive.PerformanceData\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.RegistryHive.Users\">\r\n<meta name=\"APILocation\" content=\"mscorlib.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-04-01 05:59 PM\">\r\n<meta name=\"document_id\" content=\"6f609778-3fd6-a3cd-0e54-9daf0d432ed1\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Represents the possible values for a top-level node on a foreign machine.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/microsoft.win32/toc2.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"Microsoft.Win32.RegistryHive\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","ms.topic":"managed-reference","ms.prod":".net","uhfHeaderId":"MSDocsHeader-DotNet","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/Microsoft.Win32.RegistryHive.yml","open_to_public_contributors":false,"api_name":["Microsoft.Win32.RegistryHive","Microsoft.Win32.RegistryHive.ClassesRoot","Microsoft.Win32.RegistryHive.CurrentConfig","Microsoft.Win32.RegistryHive.CurrentUser","Microsoft.Win32.RegistryHive.DynData","Microsoft.Win32.RegistryHive.LocalMachine","Microsoft.Win32.RegistryHive.PerformanceData","Microsoft.Win32.RegistryHive.Users"],"api_location":["mscorlib.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["Microsoft.Win32.RegistryHive","Microsoft::Win32::RegistryHive","Microsoft.Win32.RegistryHive.ClassesRoot","Microsoft::Win32::RegistryHive::ClassesRoot","Microsoft.Win32.RegistryHive.CurrentConfig","Microsoft::Win32::RegistryHive::CurrentConfig","Microsoft.Win32.RegistryHive.CurrentUser","Microsoft::Win32::RegistryHive::CurrentUser","Microsoft.Win32.RegistryHive.DynData","Microsoft::Win32::RegistryHive::DynData","Microsoft.Win32.RegistryHive.LocalMachine","Microsoft::Win32::RegistryHive::LocalMachine","Microsoft.Win32.RegistryHive.PerformanceData","Microsoft::Win32::RegistryHive::PerformanceData","Microsoft.Win32.RegistryHive.Users","Microsoft::Win32::RegistryHive::Users"],"dev_langs":["csharp"],"updated_at":"2017-04-01 05:59 PM","document_id":"6f609778-3fd6-a3cd-0e54-9daf0d432ed1","content_git_url":"https://github.com/dotnet/docs-internal/blob/master/xml/Microsoft.Win32/RegistryHive.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"RegistryHive enum | Microsoft Docs","_op_ogTitle":"RegistryHive enum","description":"Represents the possible values for a top-level node on a foreign machine.\n","toc_asset_id":"api/_splitted/Microsoft.Win32/toc.json","toc_rel":"_splitted/Microsoft.Win32/toc.json","source_url":"","ms.assetid":"Microsoft.Win32.RegistryHive","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/microsoft.win32.registryhive","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/microsoft.win32.registryhive","fileRelativePath":"api/Microsoft.Win32.RegistryHive.html"},"themesRelativePathToOutputRoot":"_themes/"}