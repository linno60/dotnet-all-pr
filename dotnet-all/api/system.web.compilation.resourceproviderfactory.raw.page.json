{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">ResourceProviderFactory</span>\r\n    \t\t\t\tClass\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Serves as the base class for classes that create resource providers.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public abstract class ResourceProviderFactory</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span></div><span class=\"lang-csharp\">ResourceProviderFactory</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \t<h3 class=\"accented\">Inherited Members</h3>\r\n  \t<h4 class=\"accented\"></h4>\r\n  \t<div class=\"cdlHolder\">\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a></span></div>\r\n  \t</div>\r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following code example shows a customized resource provider factory that retrieves cached values.  </p>\n<pre><code class=\"lang-vb\" name=\"System.Web.Compilation.ResourceProviderFactory#2\">&lt;DesignTimeResourceProviderFactoryAttribute(GetType(CustomDesignTimeResourceProviderFactory))&gt; _\nPublic Class CustomResourceProviderFactory\n    Inherits ResourceProviderFactory\n    Public Overrides Function CreateGlobalResourceProvider(ByVal classname As String) As IResourceProvider\n        Return New CustomResourceProvider(Nothing, classname)\n    End Function\n    Public Overrides Function CreateLocalResourceProvider(ByVal virtualPath As String) As IResourceProvider\n        Return New CustomResourceProvider(virtualPath, Nothing)\n    End Function\nEnd Class\n\n&#39; Define the resource provider for global and local resources.\nFriend Class CustomResourceProvider\n    Implements IResourceProvider\n    Dim _virtualPath As String\n    Dim _className As String\n\n    Public Sub New(ByVal virtualPath As String, ByVal classname As String)\n        _virtualPath = virtualPath\n        _className = classname\n    End Sub\n\n    Private Function GetResourceCache(ByVal culturename As String) As IDictionary\n        Return System.Web.HttpContext.Current.Cache(culturename)\n    End Function\n\n    Function GetObject(ByVal resourceKey As String, ByVal culture As CultureInfo) As Object Implements IResourceProvider.GetObject\n        Dim value As Object\n        Dim cultureName As String\n        cultureName = Nothing\n        If (IsNothing(culture)) Then\n            cultureName = CultureInfo.CurrentUICulture.Name\n        Else\n            cultureName = culture.Name\n        End If\n\n        value = GetResourceCache(cultureName)(resourceKey)\n        If (value = Nothing) Then\n            value = GetResourceCache(Nothing)(resourceKey)\n        End If\n        Return value\n    End Function\n\n\n    ReadOnly Property ResourceReader() As IResourceReader Implements IResourceProvider.ResourceReader\n        Get\n            Dim cultureName As String\n            Dim currentUICulture As CultureInfo\n            cultureName = Nothing\n            currentUICulture = CultureInfo.CurrentUICulture\n            If (Not (String.Equals(currentUICulture.Name, CultureInfo.InstalledUICulture.Name))) Then\n                cultureName = currentUICulture.Name\n            End If\n\n            Return New CustomResourceReader(GetResourceCache(cultureName))\n        End Get\n    End Property\nEnd Class\n\nFriend NotInheritable Class CustomResourceReader\n    Implements IResourceReader\n    Private _resources As IDictionary\n\n    Public Sub New(ByVal resources As IDictionary)\n        _resources = resources\n    End Sub\n\n    Function GetEnumerator1() As IDictionaryEnumerator Implements IResourceReader.GetEnumerator\n        Return _resources.GetEnumerator()\n    End Function\n\n    Sub Close() Implements IResourceReader.Close\n\n    End Sub\n\n    Function GetEnumerator() As IEnumerator Implements IEnumerable.GetEnumerator\n        Return _resources.GetEnumerator()\n    End Function\n\n    Sub Dispose() Implements IDisposable.Dispose\n\n    End Sub\nEnd Class\n</code></pre><pre><code class=\"lang-cs\" name=\"System.Web.Compilation.ResourceProviderFactory#2\">[\n    DesignTimeResourceProviderFactoryAttribute(\n        typeof(CustomDesignTimeResourceProviderFactory))\n]\npublic class CustomResourceProviderFactory : ResourceProviderFactory\n{\n    public override IResourceProvider\n      CreateGlobalResourceProvider(string classname)\n    {\n        return new CustomResourceProvider(null, classname);\n    }\n    public override IResourceProvider\n      CreateLocalResourceProvider(string virtualPath)\n    {\n        return new CustomResourceProvider(virtualPath, null);\n    }\n}\n\n// Define the resource provider for global and local resources.\ninternal class CustomResourceProvider : IResourceProvider\n{\n    string _virtualPath;\n    string _className;\n\n    public CustomResourceProvider(string virtualPath, string classname)\n    {\n        _virtualPath = virtualPath;\n        _className = classname;\n    }\n\n    private IDictionary GetResourceCache(string culturename)\n    {\n        return (IDictionary)\n            System.Web.HttpContext.Current.Cache[culturename];\n    }\n\n    object IResourceProvider.GetObject\n        (string resourceKey, CultureInfo culture)\n    {\n        object value;\n\n        string cultureName = null;\n        if (culture != null)\n        {\n            cultureName = culture.Name;\n        }\n        else\n        {\n            cultureName = CultureInfo.CurrentUICulture.Name;\n        }\n\n        value = GetResourceCache(cultureName)[resourceKey];\n        if (value == null)\n        {\n            value = GetResourceCache(null)[resourceKey];\n        }\n        return value;\n    }\n\n\n    IResourceReader IResourceProvider.ResourceReader\n    {\n        get\n        {\n            string cultureName = null;\n            CultureInfo currentUICulture = CultureInfo.CurrentUICulture;\n            if (!String.Equals(currentUICulture.Name,\n                CultureInfo.InstalledUICulture.Name))\n            {\n                cultureName = currentUICulture.Name;\n            }\n\n            return new CustomResourceReader\n                (GetResourceCache(cultureName));\n        }\n    }\n}\n\n\ninternal sealed class CustomResourceReader : IResourceReader\n{\n    private IDictionary _resources;\n\n    public CustomResourceReader(IDictionary resources)\n    {\n        _resources = resources;\n    }\n\n    IDictionaryEnumerator IResourceReader.GetEnumerator()\n    {\n        return _resources.GetEnumerator();\n    }\n\n    void IResourceReader.Close() { }\n\n    IEnumerator IEnumerable.GetEnumerator()\n    {\n        return _resources.GetEnumerator();\n    }\n\n    void IDisposable.Dispose() { return; }\n}\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>ResourceProviderFactory is an abstract class that serves as the base class for objects that return global and local resource providers. Classes must derive from ResourceProviderFactory to implement its functionality.</p>\n\r\n  \r\n  \r\n  \t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Constructors\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5 netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t\t<a id=\"System_Web_Compilation_ResourceProviderFactory__ctor_\"></a>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Web_Compilation_ResourceProviderFactory__ctor\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">ResourceProviderFactory()</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>When implemented in a derived class, initializes a new instance of the derived class.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">protected ResourceProviderFactory ();</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>An instance of an abstract class cannot be created. Classes that derive from <a class=\"xref\" href=\"system.web.compilation.resourceproviderfactory\" data-linktype=\"relative-path\">ResourceProviderFactory</a> can implement a constructor to set any default values.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t</section>\t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Methods\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5 netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t\t<a id=\"System_Web_Compilation_ResourceProviderFactory_CreateGlobalResourceProvider_\"></a>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Web_Compilation_ResourceProviderFactory_CreateGlobalResourceProvider_System_String_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">CreateGlobalResourceProvider(String)</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>When overridden in a derived class, creates a global resource provider.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public abstract System.Web.Compilation.IResourceProvider CreateGlobalResourceProvider (string classKey);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Parameters</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>classKey</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The name of the resource class.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Returns</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.web.compilation.iresourceprovider\" data-linktype=\"relative-path\">IResourceProvider</a></span>\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t<p>A global resource provider.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>When overridden in a derived class, this method returns an <a class=\"xref\" href=\"system.web.compilation.iresourceprovider\" data-linktype=\"relative-path\">IResourceProvider</a> object for the given <code>classKey</code> parameter. The method could be implemented such that <code>classKey</code> is the name of a .resx file in the App_GlobalResources folder.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5 netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t\t<a id=\"System_Web_Compilation_ResourceProviderFactory_CreateLocalResourceProvider_\"></a>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Web_Compilation_ResourceProviderFactory_CreateLocalResourceProvider_System_String_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">CreateLocalResourceProvider(String)</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>When overridden in a derived class, creates a local resource provider.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public abstract System.Web.Compilation.IResourceProvider CreateLocalResourceProvider (string virtualPath);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Parameters</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>virtualPath</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The path to a resource file.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Returns</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.web.compilation.iresourceprovider\" data-linktype=\"relative-path\">IResourceProvider</a></span>\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t<p>A local resource provider.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>When overridden in a derived class, this method returns an <a class=\"xref\" href=\"system.web.compilation.iresourceprovider\" data-linktype=\"relative-path\">IResourceProvider</a> object for the given <code>virtualPath</code> parameter. The method could be implemented such that <code>virtualPath</code> maps to a resource file.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t</section>\r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc1.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.Web.Compilation.ResourceProviderFactory.yml\">\r\n<meta name=\"APIName\" content=\"System.Web.Compilation.ResourceProviderFactory\">\r\n<meta name=\"APIName\" content=\"System.Web.Compilation.ResourceProviderFactory..ctor\">\r\n<meta name=\"APIName\" content=\"System.Web.Compilation.ResourceProviderFactory.CreateGlobalResourceProvider\">\r\n<meta name=\"APIName\" content=\"System.Web.Compilation.ResourceProviderFactory.CreateLocalResourceProvider\">\r\n<meta name=\"APILocation\" content=\"System.Web.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-31 02:21 PM\">\r\n<meta name=\"document_id\" content=\"b6bb7d4f-7ead-b8bb-19ab-5add79cc45f9\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Serves as the base class for classes that create resource providers.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.web.compilation/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Web.Compilation.ResourceProviderFactory\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.Web.Compilation.ResourceProviderFactory.yml","open_to_public_contributors":false,"api_name":["System.Web.Compilation.ResourceProviderFactory","System.Web.Compilation.ResourceProviderFactory..ctor","System.Web.Compilation.ResourceProviderFactory.CreateGlobalResourceProvider","System.Web.Compilation.ResourceProviderFactory.CreateLocalResourceProvider"],"api_location":["System.Web.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Web.Compilation.ResourceProviderFactory","System::Web::Compilation::ResourceProviderFactory","System.Web.Compilation.ResourceProviderFactory.#ctor","System::Web::Compilation::ResourceProviderFactory::#ctor","System.Web.Compilation.ResourceProviderFactory.CreateGlobalResourceProvider","System::Web::Compilation::ResourceProviderFactory::CreateGlobalResourceProvider","System.Web.Compilation.ResourceProviderFactory.CreateLocalResourceProvider","System::Web::Compilation::ResourceProviderFactory::CreateLocalResourceProvider"],"dev_langs":["csharp"],"updated_at":"2017-03-31 02:21 PM","document_id":"b6bb7d4f-7ead-b8bb-19ab-5add79cc45f9","content_git_url":"https://github.com/dotnet/docs-internal/blob/master/xml/System.Web.Compilation/ResourceProviderFactory.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"ResourceProviderFactory class | Microsoft Docs","_op_ogTitle":"ResourceProviderFactory class","description":"Serves as the base class for classes that create resource providers.\n","toc_asset_id":"api/_splitted/System.Web.Compilation/toc.json","toc_rel":"_splitted/System.Web.Compilation/toc.json","source_url":"","ms.assetid":"System.Web.Compilation.ResourceProviderFactory","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.web.compilation.resourceproviderfactory","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.web.compilation.resourceproviderfactory","fileRelativePath":"api/System.Web.Compilation.ResourceProviderFactory.html"},"themesRelativePathToOutputRoot":"_themes/"}