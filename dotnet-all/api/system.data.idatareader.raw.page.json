{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">IDataReader</span>\r\n      Interface\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Provides a means of reading one or more forward-only streams of result sets obtained by executing a command at a data source, and is implemented by .NET Framework data providers that access relational databases.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public interface IDataReader : IDisposable, System.Data.IDataRecord</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>The IDataReader and <a class=\"xref\" href=\"system.data.idatarecord\" data-linktype=\"relative-path\">IDataRecord</a> interfaces allow an inheriting class to implement a <code>DataReader</code> class, which provides a means of reading one or more forward-only streams of result sets. For more information about <code>DataReader</code> classes, see <a href=\"../topic/retrieving%20data%20using%20a%20datareader\" data-linktype=\"relative-path\">Retrieving Data Using a DataReader</a>.  </p>\n<p> An application does not create an instance of the IDataReader interface directly, but creates an instance of a class that inherits IDataReader.  </p>\n<p> Classes that inherit IDataReader must implement the inherited members, and typically define additional members to add provider-specific functionality.  </p>\n<p> Changes made to a result set by another process or thread while data is being read may be visible to the user of a class that implements an <code>IDataReader</code>. However, the precise behavior is both provider and timing dependent.</p>\n\r\n  \r\n  \r\n  \t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Properties\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Data_IDataReader_Depth\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Depth</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets a value indicating the depth of nesting for the current row.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public int Depth { get; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.int32\" data-linktype=\"relative-path\">Int32</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The level of nesting.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>The outermost table has a depth of zero.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Data_IDataReader_IsClosed\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">IsClosed</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets a value indicating whether the data reader is closed.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public bool IsClosed { get; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p><code>true</code> if the data reader is closed; otherwise, <code>false</code>.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>IsClosed and <a class=\"xref\" href=\"system.data.idatareader#System_Data_IDataReader_RecordsAffected_\" data-linktype=\"relative-path\">RecordsAffected</a> are the only properties that you can call after the <a class=\"xref\" href=\"system.data.idatareader\" data-linktype=\"relative-path\">IDataReader</a> is closed.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Data_IDataReader_RecordsAffected\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">RecordsAffected</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets the number of rows changed, inserted, or deleted by execution of the SQL statement.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public int RecordsAffected { get; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.int32\" data-linktype=\"relative-path\">Int32</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The number of rows changed, inserted, or deleted; 0 if no rows were affected or the statement failed; and -1 for SELECT statements.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>The RecordsAffected property is not set until all rows are read and you close the <a class=\"xref\" href=\"system.data.idatareader\" data-linktype=\"relative-path\">IDataReader</a>.  </p>\n<p> <a class=\"xref\" href=\"system.data.idatareader#System_Data_IDataReader_IsClosed_\" data-linktype=\"relative-path\">IsClosed</a> and RecordsAffected are the only properties that you can call after the <a class=\"xref\" href=\"system.data.idatareader\" data-linktype=\"relative-path\">IDataReader</a> is closed.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t  \r\n  \t\t</section>\t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Methods\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Data_IDataReader_Close\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Close()</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Closes the <a class=\"xref\" href=\"system.data.idatareader\" data-linktype=\"relative-path\">IDataReader</a> Object.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public void Close ();</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>You must explicitly call the Close method when you are through using the <a class=\"xref\" href=\"system.data.idatareader\" data-linktype=\"relative-path\">IDataReader</a> to use the associated <a class=\"xref\" href=\"system.data.idbconnection\" data-linktype=\"relative-path\">IDbConnection</a> for any other purpose.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Data_IDataReader_GetSchemaTable\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">GetSchemaTable()</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Returns a <a class=\"xref\" href=\"system.data.datatable\" data-linktype=\"relative-path\">DataTable</a> that describes the column metadata of the <a class=\"xref\" href=\"system.data.idatareader\" data-linktype=\"relative-path\">IDataReader</a>.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public System.Data.DataTable GetSchemaTable ();</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Returns</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.data.datatable\" data-linktype=\"relative-path\">DataTable</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>A <a class=\"xref\" href=\"system.data.datatable\" data-linktype=\"relative-path\">DataTable</a> that describes the column metadata.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Exceptions</div>\r\n  \t\t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.invalidoperationexception\" data-linktype=\"relative-path\">InvalidOperationException</a></span>\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t\t<p>The <a class=\"xref\" href=\"system.data.idatareader\" data-linktype=\"relative-path\">IDataReader</a> is closed.</p>\n\r\n  \t\t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>The implementation of GetSchemaTable method for the .NET Framework Data Provider for OLE DB maps to the OLE DB IColumnsRowset::GetColumnsRowset method, while implementations for other .NET Framework data providers do not use an OLE DB provider layer. The order in which GetSchemaTable returns metadata about each column in a table, and the DataReader columns that are returned, vary depending on which data provider you use. The following table lists data providers and members that implement GetSchemaTable.  </p>\n<table>\n<thead>\n<tr>\n<th>Data Provider</th>\n<th>Member</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>.NET Data Provider for ODBC</td>\n<td><a class=\"xref\" href=\"system.data.odbc.odbcdatareader#System_Data_Odbc_OdbcDataReader_GetSchemaTable_\" data-linktype=\"relative-path\">GetSchemaTable</a>.</td>\n</tr>\n<tr>\n<td>.NET Data Provider for OLE DB</td>\n<td><a class=\"xref\" href=\"system.data.oledb.oledbdatareader#System_Data_OleDb_OleDbDataReader_GetSchemaTable_\" data-linktype=\"relative-path\">GetSchemaTable</a>.</td>\n</tr>\n<tr>\n<td>.NET Data Provider for Oracle</td>\n<td><a class=\"xref\" href=\"system.data.oracleclient.oracledatareader#System_Data_OracleClient_OracleDataReader_GetSchemaTable_\" data-linktype=\"relative-path\">GetSchemaTable</a>.</td>\n</tr>\n<tr>\n<td>.NET Data Provider for SQL Server</td>\n<td><a class=\"xref\" href=\"system.data.sqlclient.sqldatareader#System_Data_SqlClient_SqlDataReader_GetSchemaTable_\" data-linktype=\"relative-path\">GetSchemaTable</a>.</td>\n</tr>\n</tbody>\n</table>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Data_IDataReader_NextResult\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">NextResult()</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Advances the data reader to the next result, when reading the results of batch SQL statements.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public bool NextResult ();</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Returns</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p><code>true</code> if there are more rows; otherwise, <code>false</code>.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>Used to process multiple results, which can be obtained by executing batch SQL statements.  </p>\n<p> By default, the data reader is positioned on the first result.  </p>\n<pre><code class=\"lang-vb\" name=\"IDataReader_NextResult#1\">Imports System\nImports System.Data\nImports System.Data.SqlClient\nImports System.Data.OleDb\nImports System.Data.Odbc\n\nModule Module1\n   Dim connectionTypeName As String = &quot;SqlClient&quot;\n   Dim connectionString As String = &quot;Data Source=(local);Initial Catalog=AdventureWorks2012;Integrated Security=SSPI&quot;\n\n   &#39; Dim connectionTypeName As String = &quot;Odbc&quot;\n   &#39; Dim connectionString As String = &quot;Driver={SQL Server Native Client 11.0};Server=(local);Database=AdventureWorks2012;Trusted_Connection=Yes&quot;\n\n   &#39; Dim connectionTypeName As String = &quot;OleDb&quot;\n   &#39; Dim connectionString As String = &quot;Provider=SQLNCLI11;Data Source=(local);Initial Catalog=AdventureWorks2012;Integrated Security=SSPI&quot;\n\n   Sub Main()\n      Using connection As IDbConnection = DatabaseConnectionFactory.GetConnection(connectionTypeName, connectionString)\n         Dim command As IDbCommand = connection.CreateCommand()\n         command.Connection = connection\n\n         &#39;these 2 queries are executed as a single batch and return 2 separate results\n         command.CommandText =\n             &quot;SELECT CountryRegionCode, Name FROM Person.CountryRegion;&quot; +\n             &quot;SELECT CountryRegionCode, StateProvinceCode, Name, StateProvinceID FROM Person.StateProvince;&quot;\n\n         connection.Open()\n\n         Using reader As IDataReader = command.ExecuteReader()\n            &#39;process the first result\n            displayCountryRegions(reader)\n\n            &#39;use NextResult to move to the second result and verify it is returned\n            If Not reader.NextResult() Then\n               Throw New InvalidOperationException(&quot;Expected second result (StateProvinces) but only one was returned&quot;)\n            End If\n\n            &#39;process the second result\n            displayStateProvinces(reader)\n\n            reader.Close()\n         End Using\n\n         connection.Close()\n      End Using\n   End Sub\n\n   Sub displayCountryRegions(reader As IDataReader)\n      If Not reader.FieldCount = 2 Then\n         Throw New InvalidOperationException(&quot;First resultset (CountryRegions) must contain exactly 2 columns&quot;)\n      End If\n\n      While reader.Read()\n         Console.WriteLine(&quot;CountryRegionCode={0}, Name={1}&quot; _\n             , reader.GetString(reader.GetOrdinal(&quot;CountryRegionCode&quot;)) _\n             , reader.GetString(reader.GetOrdinal(&quot;Name&quot;)))\n      End While\n   End Sub\n\n   Sub displayStateProvinces(reader As IDataReader)\n\n      If Not reader.FieldCount = 4 Then\n         Throw New InvalidOperationException(&quot;Second resultset (StateProvinces) must contain exactly 4 columns&quot;)\n      End If\n\n      While reader.Read()\n         Console.WriteLine(&quot;CountryRegionCode={0}, StateProvinceCode={1}, Name={2}, StateProvinceID={3}&quot; _\n             , reader.GetString(reader.GetOrdinal(&quot;CountryRegionCode&quot;)) _\n             , reader.GetString(reader.GetOrdinal(&quot;StateProvinceCode&quot;)) _\n             , reader.GetString(reader.GetOrdinal(&quot;Name&quot;)) _\n             , reader.GetInt32(reader.GetOrdinal(&quot;StateProvinceID&quot;)))\n      End While\n   End Sub\n\n   Class DatabaseConnectionFactory\n      Shared Function GetSqlConnection(connectionString As String) As SqlConnection\n         Return New SqlConnection(connectionString)\n      End Function\n\n      Shared Function GetOdbcConnection(connectionString As String) As OdbcConnection\n         Return New OdbcConnection(connectionString)\n      End Function\n\n      Shared Function GetOleDbConnection(connectionString As String) As OleDbConnection\n         Return New OleDbConnection(connectionString)\n      End Function\n\n      Public Shared Function GetConnection(connectionTypeName As String, connectionString As String) As IDbConnection\n\n         Select Case connectionTypeName\n            Case &quot;SqlClient&quot;\n               Return GetSqlConnection(connectionString)\n            Case &quot;Odbc&quot;\n               Return GetOdbcConnection(connectionString)\n            Case &quot;OleDb&quot;\n               Return GetOleDbConnection(connectionString)\n            Case Else\n               Throw New ArgumentException(&quot;Value must be SqlClient, Odbc or OleDb&quot;, &quot;connectionTypeName&quot;)\n         End Select\n\n      End Function\n   End Class\nEnd Module\n</code></pre><pre><code class=\"lang-cs\" name=\"IDataReader_NextResult#1\">using System;\nusing System.Data;\nusing System.Data.SqlClient;\nusing System.Data.OleDb;\nusing System.Data.Odbc;\n\nclass Program {\n   static void Main(string[] args) {\n\n      // string connectionTypeName = &quot;SqlClient&quot;;\n      // string connectionString = @&quot;Data Source=(local);Initial Catalog=AdventureWorks;Integrated Security=SSPI&quot;;\n\n      // string connectionTypeName = &quot;Odbc&quot;;\n      // string connectionString = @&quot;Driver={SQL Server Native Client 11.0};Server=(local);Database=AdventureWorks2012;Trusted_Connection=Yes&quot;;\n\n      string connectionTypeName = &quot;OleDb&quot;;\n      string connectionString = @&quot;Provider=SQLNCLI11;Data Source=(local);Initial Catalog=AdventureWorks;Integrated Security=SSPI&quot;;\n\n      using (IDbConnection connection = DatabaseConnectionFactory.GetConnection(connectionTypeName, connectionString)) {\n         IDbCommand command = connection.CreateCommand();\n         command.Connection = connection;\n\n         // these 2 queries are executed as a single batch and return 2 separate results\n         command.CommandText = &quot;SELECT CountryRegionCode, Name FROM Person.CountryRegion;&quot; + &quot;SELECT CountryRegionCode, StateProvinceCode, Name, StateProvinceID FROM Person.StateProvince;&quot;;\n\n         connection.Open();\n\n         using (IDataReader reader = command.ExecuteReader()) {\n\n            // process the first result\n            displayCountryRegions(reader);\n\n            // use NextResult to move to the second result and verify it is returned\n            if (!reader.NextResult())\n               throw new InvalidOperationException(&quot;Expected second result (StateProvinces) but only one was returned&quot;);\n\n            // process the second result\n            displayStateProvinces(reader);\n\n            reader.Close();\n         }\n\n         connection.Close();\n      }\n   }\n\n   static void displayCountryRegions(IDataReader reader) {\n      if (reader.FieldCount != 2)\n         throw new InvalidOperationException(&quot;First resultset (CountryRegions) must contain exactly 2 columns&quot;);\n\n      while (reader.Read()) {\n         Console.WriteLine(&quot;CountryRegionCode={0}, Name={1}&quot;\n             , reader.GetString(reader.GetOrdinal(&quot;CountryRegionCode&quot;))\n             , reader.GetString(reader.GetOrdinal(&quot;Name&quot;)));\n      }\n   }\n\n   static void displayStateProvinces(IDataReader reader) {\n      if (reader.FieldCount != 4)\n         throw new InvalidOperationException(&quot;Second resultset (StateProvinces) must contain exactly 4 columns&quot;);\n\n      while (reader.Read()) {\n         Console.WriteLine(&quot;CountryRegionCode={0}, StateProvinceCode={1}, Name={2}, StateProvinceID={3}&quot;\n             , reader.GetString(reader.GetOrdinal(&quot;CountryRegionCode&quot;))\n             , reader.GetString(reader.GetOrdinal(&quot;StateProvinceCode&quot;))\n             , reader.GetString(reader.GetOrdinal(&quot;Name&quot;))\n             , reader.GetInt32(reader.GetOrdinal(&quot;StateProvinceID&quot;)));\n      }\n   }\n\n   class DatabaseConnectionFactory {\n      static SqlConnection GetSqlConnection(string connectionString) {\n         return new SqlConnection(connectionString);\n      }\n\n      static OdbcConnection GetOdbcConnection(string connectionString) {\n         return new OdbcConnection(connectionString);\n      }\n\n      static OleDbConnection GetOleDbConnection(string connectionString) {\n         return new OleDbConnection(connectionString);\n      }\n\n      public static IDbConnection GetConnection(string connectionTypeName, string connectionString) {\n         switch (connectionTypeName) {\n            case &quot;SqlClient&quot;:\n               return GetSqlConnection(connectionString);\n            case &quot;Odbc&quot;:\n               return GetOdbcConnection(connectionString);\n            case &quot;OleDb&quot;:\n               return GetOleDbConnection(connectionString);\n            default:\n               throw new ArgumentException(&quot;Value must be SqlClient, Odbc or OleDb&quot;, &quot;connectionTypeName&quot;);\n         }\n      }\n   }\n}\n</code></pre>\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Data_IDataReader_Read\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Read()</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Advances the <a class=\"xref\" href=\"system.data.idatareader\" data-linktype=\"relative-path\">IDataReader</a> to the next record.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public bool Read ();</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Returns</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p><code>true</code> if there are more rows; otherwise, <code>false</code>.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>The default position of the <a class=\"xref\" href=\"system.data.idatareader\" data-linktype=\"relative-path\">IDataReader</a> is prior to the first record. Therefore you must call Read to begin accessing any data.  </p>\n<p> While the data reader is in use, the associated connection is busy serving the <a class=\"xref\" href=\"system.data.idatareader\" data-linktype=\"relative-path\">IDataReader</a>. This is the case until <a class=\"xref\" href=\"system.data.idatareader#System_Data_IDataReader_Close_\" data-linktype=\"relative-path\">Close</a> is called.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t  \r\n  \t\t</section>\r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"/dotnet-all/api/toc2.json\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.Data.IDataReader.yml\">\r\n<meta name=\"APIName\" content=\"System.Data.IDataReader\">\r\n<meta name=\"APIName\" content=\"System.Data.IDataReader.Close\">\r\n<meta name=\"APIName\" content=\"System.Data.IDataReader.Depth\">\r\n<meta name=\"APIName\" content=\"System.Data.IDataReader.GetSchemaTable\">\r\n<meta name=\"APIName\" content=\"System.Data.IDataReader.IsClosed\">\r\n<meta name=\"APIName\" content=\"System.Data.IDataReader.NextResult\">\r\n<meta name=\"APIName\" content=\"System.Data.IDataReader.Read\">\r\n<meta name=\"APIName\" content=\"System.Data.IDataReader.RecordsAffected\">\r\n<meta name=\"APILocation\" content=\"System.Data.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-22 03:41 AM\">\r\n<meta name=\"document_id\" content=\"cf7976c6-f2b0-02f0-71e0-efdfacb10ace\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Provides a means of reading one or more forward-only streams of result sets obtained by executing a command at a data source, and is implemented by .NET Framework data providers that access relationa…\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.data/toc2.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Data.IDataReader\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet-internal/toc.json","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.Data.IDataReader.yml","open_to_public_contributors":false,"api_name":["System.Data.IDataReader","System.Data.IDataReader.Close","System.Data.IDataReader.Depth","System.Data.IDataReader.GetSchemaTable","System.Data.IDataReader.IsClosed","System.Data.IDataReader.NextResult","System.Data.IDataReader.Read","System.Data.IDataReader.RecordsAffected"],"api_location":["System.Data.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Data.IDataReader","System::Data::IDataReader","System.Data.IDataReader.Close","System::Data::IDataReader::Close","System.Data.IDataReader.Depth","System::Data::IDataReader::Depth","System.Data.IDataReader.GetSchemaTable","System::Data::IDataReader::GetSchemaTable","System.Data.IDataReader.IsClosed","System::Data::IDataReader::IsClosed","System.Data.IDataReader.NextResult","System::Data::IDataReader::NextResult","System.Data.IDataReader.Read","System::Data::IDataReader::Read","System.Data.IDataReader.RecordsAffected","System::Data::IDataReader::RecordsAffected"],"dev_langs":["csharp"],"updated_at":"2017-03-22 03:41 AM","document_id":"cf7976c6-f2b0-02f0-71e0-efdfacb10ace","content_git_url":"https://github.com/TianqiZhang/ECMA2YamlTestRepo2/blob/master/xml/System.Data/IDataReader.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"IDataReader interface | Microsoft Docs","_op_ogTitle":"IDataReader interface","description":"Provides a means of reading one or more forward-only streams of result sets obtained by executing a command at a data source, and is implemented by .NET Framework data providers that access relationa…","toc_asset_id":"api/_splitted/System.Data/toc.json","toc_rel":"_splitted/System.Data/toc.json","source_url":"","ms.assetid":"System.Data.IDataReader","canonical_url":"https://docs.microsoft.com/en-us/dotnet-all/api/system.data.idatareader","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet-all/api/system.data.idatareader","fileRelativePath":"api/System.Data.IDataReader.html"},"themesRelativePathToOutputRoot":"_themes/"}