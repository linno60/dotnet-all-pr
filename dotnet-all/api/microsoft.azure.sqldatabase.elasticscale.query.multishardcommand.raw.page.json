{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">MultiShardCommand</span>\r\n    \t\t\t\tClass\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Complements the <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardconnection\" data-linktype=\"relative-path\">MultiShardConnection</a> with a command object \n            similar to the triad of <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection(v=vs.110).aspx\" data-linktype=\"external\">SqlConnection</a>, <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand(v=vs.110).aspx\" data-linktype=\"external\">SqlCommand</a>, and <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader(v=vs.110).aspx\" data-linktype=\"external\">SqlDataReader</a>. \n            The <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand\" data-linktype=\"relative-path\">MultiShardCommand</a> takes a T-SQL command statement as its input and executes the \n            command across its collection of shards specified by its corresponding <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardconnection\" data-linktype=\"relative-path\">MultiShardConnection</a>.\n            The results from processing the <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand\" data-linktype=\"relative-path\">MultiShardCommand</a> are made available through the \n            execute methods and the <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multisharddatareader\" data-linktype=\"relative-path\">MultiShardDataReader</a>.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">[System.ComponentModel.DesignerCategory(&quot;Code&quot;)]\n[System.Diagnostics.CodeAnalysis.SuppressMessage(&quot;Microsoft.Naming&quot;, &quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;, MessageId=&quot;Multi&quot;)]\npublic sealed class MultiShardCommand : System.Data.Common.DbCommand</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.data.common.dbcommand(v=vs.110).aspx\" data-linktype=\"external\">DbCommand</a></span></div><span class=\"lang-csharp\">MultiShardCommand</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Attributes</dt><dd>\r\n  \t\t<div class=\"cdlHolder\">\r\n  \t\t\t<span class=\"cdl\"><span class=\"xref\">System.ComponentModel.DesignerCategory</span></span>\r\n  \t\t\t<span class=\"cdl\"><span class=\"xref\">System.Diagnostics.CodeAnalysis.SuppressMessage</span></span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \t\t\r\n  \t\t\t<h2 class=\"accented \">Properties\r\n  \t\t</h2>\r\n  \t\t\t<table class=\"nameValue\">\r\n  \t\t\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.commandtext#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_CommandText\" data-linktype=\"relative-path\">CommandText</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>Gets or sets the command text to execute against the set of shards.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.commandtimeout#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_CommandTimeout\" data-linktype=\"relative-path\">CommandTimeout</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>Time in seconds to wait for the command to be executed on ALL shards.\n            A value of 0 indicates no wait time limit. The default is 300 seconds.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.commandtimeoutpershard#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_CommandTimeoutPerShard\" data-linktype=\"relative-path\">CommandTimeoutPerShard</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>This property controls the timeout for running\n            a command against individual shards.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.commandtype#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_CommandType\" data-linktype=\"relative-path\">CommandType</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.commandtype#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_CommandType\" data-linktype=\"relative-path\">CommandType</a>of the command to be executed.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.connection#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_Connection\" data-linktype=\"relative-path\">Connection</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>Gets the current instance of the <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardconnection\" data-linktype=\"relative-path\">MultiShardConnection</a> associated with this command.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.dbconnection#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_DbConnection\" data-linktype=\"relative-path\">DbConnection</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>Connections to shards. Not supported/exposed\n            since connections are managed internally by this instance</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.dbparametercollection#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_DbParameterCollection\" data-linktype=\"relative-path\">DbParameterCollection</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>Gets the SqlParameter Collection</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.dbtransaction#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_DbTransaction\" data-linktype=\"relative-path\">DbTransaction</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>This property is currently not supported. Accessing the property will result in an exception.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.designtimevisible#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_DesignTimeVisible\" data-linktype=\"relative-path\">DesignTimeVisible</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>This property is currently not supported. Accessing the property will result in an exception.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executionoptions#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecutionOptions\" data-linktype=\"relative-path\">ExecutionOptions</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>Gets or sets options that control how the command is executed.\n            For instance, you can use this to include the shard name as \n            an additional column into the result.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executionpolicy#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecutionPolicy\" data-linktype=\"relative-path\">ExecutionPolicy</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The execution policy to use when executing\n            commands against shards. Through this policy,\n            users can control whether complete results are required,\n            or whether partial results are acceptable.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.parameters#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_Parameters\" data-linktype=\"relative-path\">Parameters</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparametercollection(v=vs.110).aspx\" data-linktype=\"external\">SqlParameterCollection</a> associated with this command.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.retrybehavior#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_RetryBehavior\" data-linktype=\"relative-path\">RetryBehavior</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The retry behavior for detecting transient faults that could occur when connecting to and\n            executing commands against individual shards.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.updatedrowsource#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_UpdatedRowSource\" data-linktype=\"relative-path\">UpdatedRowSource</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>This property is currently not supported. Accessing the property will result in an exception.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t</table>\t\t\r\n  \t\t\t<h2 class=\"accented \">Methods\r\n  \t\t</h2>\r\n  \t\t\t<table class=\"nameValue\">\r\n  \t\t\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.cancel#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_Cancel\" data-linktype=\"relative-path\">Cancel()</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>Attempts to cancel an in progress <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand\" data-linktype=\"relative-path\">MultiShardCommand</a> \n            and any ongoing work that is performed at the shards on behalf of the command.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.createdbparameter#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_CreateDbParameter\" data-linktype=\"relative-path\">CreateDbParameter()</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>Creates an instance of the DbParameter</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.createparameter#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_CreateParameter\" data-linktype=\"relative-path\">CreateParameter()</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>Creates a new instance of a <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter(v=vs.110).aspx\" data-linktype=\"external\">SqlParameter</a> object.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.dispose#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_Dispose_System_Boolean_\" data-linktype=\"relative-path\">Dispose(Boolean)</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>Dispose off any unmanaged/managed resources held</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executedbdatareader#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecuteDbDataReader_System_Data_CommandBehavior_\" data-linktype=\"relative-path\">ExecuteDbDataReader(CommandBehavior)</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<ul>\n<li>Runs the given query against all shards and returns\n              a reader that encompasses results from them.<ul>\n<li>Uses the MultiShardExecutionPolicy.CompleteResults as the default execution policy</li>\n<li>Includes the $ShardName pseudo column in the results\n<param name=\"behavior\">Command behavior to use<returns>MultiShardDataReader instance that encompasses results from all shards</returns><exception cref=\"T:System.InvalidOperationException\">If the commandText is null or empty</exception><exception cref=\"T:System.InvalidOperationException\">If the command behavior is not supported \n(CloseConnection or SingleResult or SingleRow)</exception><exception cref=\"T:System.TimeoutException\">If the CommandTimeout elapsed prior to completion</exception></li>\n</ul>\n</li>\n</ul>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executedbdatareaderasync#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecuteDbDataReaderAsync_System_Data_CommandBehavior_System_Threading_CancellationToken_\" data-linktype=\"relative-path\">ExecuteDbDataReaderAsync(CommandBehavior, CancellationToken)</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<ul>\n<li>Executes the given query against all shards asynchronously<ul>\n<li>Uses the MultiShardExecutionPolicy.CompleteResults as the default execution policy</li>\n<li>Includes the $ShardName pseudo column in the results</li>\n</ul>\n</li>\n</ul>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executenonquery#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecuteNonQuery\" data-linktype=\"relative-path\">ExecuteNonQuery()</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>ExecuteNonQuery is currently not supported</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executenonqueryasync#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecuteNonQueryAsync_System_Threading_CancellationToken_\" data-linktype=\"relative-path\">ExecuteNonQueryAsync(CancellationToken)</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>ExecuteNonQueryAsync is currently not supported</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executereader#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecuteReader_System_Data_CommandBehavior_\" data-linktype=\"relative-path\">ExecuteReader(CommandBehavior)</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The ExecuteReader methods of the MultiShardCommand execute the given command statement on each shard \n            and return the concatenation (i.e. UNION ALL) of the individual results from the shards in a\n            <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multisharddatareader\" data-linktype=\"relative-path\">MultiShardDataReader</a>. The execution policy regarding result completeness can be controlled\n            by setting the <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardexecutionpolicy\" data-linktype=\"relative-path\">MultiShardExecutionPolicy</a>. The default execution policy is to return complete results.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executereader#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecuteReader\" data-linktype=\"relative-path\">ExecuteReader()</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The ExecuteReader methods of the MultiShardCommand execute the given command statement on each shard \n            and return the concatenation (i.e. UNION ALL) of the individual results from the shards in a\n            <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multisharddatareader\" data-linktype=\"relative-path\">MultiShardDataReader</a>. The execution policy regarding result completeness can be controlled\n            by setting the <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardexecutionpolicy\" data-linktype=\"relative-path\">MultiShardExecutionPolicy</a>. The default execution policy is to return complete results.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executereaderasync#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecuteReaderAsync\" data-linktype=\"relative-path\">ExecuteReaderAsync()</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The ExecuteReader methods of the MultiShardCommand execute the given command statement on each shard \n            and return the concatenation (i.e. UNION ALL) of the individual results from the shards in a\n            <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multisharddatareader\" data-linktype=\"relative-path\">MultiShardDataReader</a>. The execution policy regarding result completeness can be controlled\n            by setting the <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardexecutionpolicy\" data-linktype=\"relative-path\">MultiShardExecutionPolicy</a>. The default execution policy is to return complete results.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executereaderasync#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecuteReaderAsync_System_Threading_CancellationToken_\" data-linktype=\"relative-path\">ExecuteReaderAsync(CancellationToken)</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The ExecuteReader methods of the MultiShardCommand execute the given command statement on each shard \n            and return the concatenation (i.e. UNION ALL) of the individual results from the shards in a\n            <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multisharddatareader\" data-linktype=\"relative-path\">MultiShardDataReader</a>. The execution policy regarding result completeness can be controlled\n            by setting the <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardexecutionpolicy\" data-linktype=\"relative-path\">MultiShardExecutionPolicy</a>. The default execution policy is to return complete results.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executereaderasync#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecuteReaderAsync_System_Data_CommandBehavior_System_Threading_CancellationToken_\" data-linktype=\"relative-path\">ExecuteReaderAsync(CommandBehavior, CancellationToken)</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The ExecuteReader methods of the MultiShardCommand execute the given command statement on each shard \n            and return the concatenation (i.e. UNION ALL) of the individual results from the shards in a\n            <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multisharddatareader\" data-linktype=\"relative-path\">MultiShardDataReader</a>. The execution policy regarding result completeness can be controlled\n            by setting the <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardexecutionpolicy\" data-linktype=\"relative-path\">MultiShardExecutionPolicy</a>. The default execution policy is to return complete results.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executescalar#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecuteScalar\" data-linktype=\"relative-path\">ExecuteScalar()</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>ExecuteScalar is currently not supported</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.executescalarasync#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ExecuteScalarAsync_System_Threading_CancellationToken_\" data-linktype=\"relative-path\">ExecuteScalarAsync(CancellationToken)</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>ExecuteScalarAsync is currently not supported</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.prepare#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_Prepare\" data-linktype=\"relative-path\">Prepare()</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>This method is currently not supported. Invoking the property will result in an exception.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.resetcommandtimeout#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ResetCommandTimeout\" data-linktype=\"relative-path\">ResetCommandTimeout()</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>Resets the <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.commandtimeout#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_CommandTimeout\" data-linktype=\"relative-path\">CommandTimeout</a> property\n            to its default value</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.resetcommandtimeoutpershard#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_ResetCommandTimeoutPerShard\" data-linktype=\"relative-path\">ResetCommandTimeoutPerShard()</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>Resets the <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.commandtimeoutpershard#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_CommandTimeoutPerShard\" data-linktype=\"relative-path\">CommandTimeoutPerShard</a> property\n            to its default value</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t</table>\t\t\r\n  \t\t\t<h2 class=\"accented \">Events\r\n  \t\t</h2>\r\n  \t\t\t<table class=\"nameValue\">\r\n  \t\t\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.shardexecutionbegan\" data-linktype=\"relative-path\">ShardExecutionBegan</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The event handler invoked when execution has begun on a given shard.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.shardexecutioncanceled\" data-linktype=\"relative-path\">ShardExecutionCanceled</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The event handler invoked when execution on a given shard is canceled, either explicitly via\n            the provided <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.threading.cancellationtoken(v=vs.110).aspx\" data-linktype=\"external\">CancellationToken</a> or implicitly as a result of the chosen\n            <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardexecutionpolicy\" data-linktype=\"relative-path\">MultiShardExecutionPolicy</a>.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.shardexecutionfaulted\" data-linktype=\"relative-path\">ShardExecutionFaulted</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The event handler invoked when execution on a given shard has faulted. This handler is only\n            invoked on exceptions for which execution could not be retried further as a result of \n            the exception&#39;s non-transience or as a result of the chosen <a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.retrybehavior#Microsoft_Azure_SqlDatabase_ElasticScale_Query_MultiShardCommand_RetryBehavior\" data-linktype=\"relative-path\">RetryBehavior</a>.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t\t\t\t<tr data-moniker=\" 0\">\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.azure.sqldatabase.elasticscale.query.multishardcommand.shardexecutionsucceeded\" data-linktype=\"relative-path\">ShardExecutionSucceeded</a></span>\r\n  \t\t\t\t</td>\r\n  \t\t\t\t\t<td>\r\n  \t\t\t\t\t\t<p>The event handler invoked when execution has successfully completed on a given shard or its \n            shard-specific <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.data.idatareader(v=vs.110).aspx\" data-linktype=\"external\">IDataReader</a> has been returned.</p>\n\r\n  \t\t\t\t\t</td>\r\n  \t\t\t\t</tr>\r\n  \t\t</table>\r\n  \r\n  \r\n  \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"ms.devlang\" content=\"csharp\">\r\n<meta name=\"author\" content=\"erickson-doug\">\r\n<meta name=\"ms.author\" content=\"douge\">\r\n<meta name=\"manager\" content=\"douge\">\r\n<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc1.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.topic\" content=\"reference\">\r\n<meta name=\"ms.date\" content=\"11/16/2016\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"azuredotnet\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"Azure\">\r\n<meta name=\"depot_name\" content=\"Azure.azuredotnet\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/Azure/azure-docs-sdk-dotnet/blob/master/docs-ref-from-xml/Microsoft.Azure.SqlDatabase.ElasticScale.Query.MultiShardCommand.yml\">\r\n<meta name=\"APIName\" content=\"Microsoft.Azure.SqlDatabase.ElasticScale.Query.MultiShardCommand\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-04-01 03:03 AM\">\r\n<meta name=\"document_id\" content=\"d7bb63f5-cc44-932f-0fa5-08e6365ec5ff\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Complements the  with a command object \n            similar to the triad of , , and . \n            The  takes a T-SQL command statement as its input and executes the \n            command across its c…\">\r\n<meta name=\"toc_rel\" content=\"microsoft.azure.sqldatabase.elasticscale.query/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"Microsoft.Azure.SqlDatabase.ElasticScale.Query.MultiShardCommand\">\r\n","rawMetadata":{"ms.devlang":"csharp","author":"erickson-doug","ms.author":"douge","manager":"douge","breadcrumb_path":"breadcrumb/toc.json","apiPlatform":"dotnet","_op_documentIdPathDepotMapping":{"./":{"folder_relative_path_in_docset":"api-index"},"breadcrumb/":{"folder_relative_path_in_docset":"breadcrumb"},"docs-ref-autogen/":{"folder_relative_path_in_docset":"docs-ref-autogen"},"docs-ref-manual/":{"folder_relative_path_in_docset":"docs-ref-manual"},"docs-ref-overwrite/":{"folder_relative_path_in_docset":"docs-ref-overwrite"},"scripts/":{"folder_relative_path_in_docset":"scripts"}},"ms.topic":"reference","ms.date":"11/16/2016","search.ms_sitename":"Docs","search.ms_docsetname":"azuredotnet","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet/api/","locale":"en-us","site_name":"Docs","search.ms_product":"Azure","_op_openToPublicContributors":false,"depot_name":"Azure.azuredotnet","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/Azure/azure-docs-sdk-dotnet/blob/master/docs-ref-from-xml/Microsoft.Azure.SqlDatabase.ElasticScale.Query.MultiShardCommand.yml","open_to_public_contributors":false,"api_name":["Microsoft.Azure.SqlDatabase.ElasticScale.Query.MultiShardCommand"],"api_location":[],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["Microsoft.Azure.SqlDatabase.ElasticScale.Query.MultiShardCommand","Microsoft::Azure::SqlDatabase::ElasticScale::Query::MultiShardCommand"],"dev_langs":["csharp"],"updated_at":"2017-04-01 03:03 AM","document_id":"d7bb63f5-cc44-932f-0fa5-08e6365ec5ff","content_git_url":"https://github.com/Azure/azure-docs-sdk-dotnet/blob/master/xml/Microsoft.Azure.SqlDatabase.ElasticScale.Query/MultiShardCommand.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"MultiShardCommand class | Microsoft Docs","_op_ogTitle":"MultiShardCommand class","description":"Complements the  with a command object \n            similar to the triad of , , and . \n            The  takes a T-SQL command statement as its input and executes the \n            command across its c…","toc_asset_id":"Microsoft.Azure.SqlDatabase.ElasticScale.Query/toc.json","toc_rel":"Microsoft.Azure.SqlDatabase.ElasticScale.Query/toc.json","source_url":"","ms.assetid":"Microsoft.Azure.SqlDatabase.ElasticScale.Query.MultiShardCommand","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/microsoft.azure.sqldatabase.elasticscale.query.multishardcommand","_op_displayDate":"2016-11-16","_op_displayDate_source":"2016-11-16T00:00:00Z","_op_brand":"azure","_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/microsoft.azure.sqldatabase.elasticscale.query.multishardcommand","fileRelativePath":"Microsoft.Azure.SqlDatabase.ElasticScale.Query.MultiShardCommand.html"},"themesRelativePathToOutputRoot":"_themes/"}