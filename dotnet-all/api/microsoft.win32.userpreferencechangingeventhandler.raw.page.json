{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">UserPreferenceChangingEventHandler</span>\r\n      Delegate\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Represents the method that will handle the <a class=\"xref\" href=\"microsoft.win32.systemevents#Microsoft_Win32_SystemEvents_UserPreferenceChanging\" data-linktype=\"relative-path\">UserPreferenceChanging</a> event.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public delegate void UserPreferenceChangingEventHandler(object sender, UserPreferenceChangingEventArgs e);</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.delegate\" data-linktype=\"relative-path\">Delegate</a></span></div><span class=\"lang-csharp\">UserPreferenceChangingEventHandler</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following code example demonstrates how to use the UserPreferenceChangingEventHandler type to monitor the <a class=\"xref\" href=\"microsoft.win32.systemevents#Microsoft_Win32_SystemEvents_UserPreferenceChanging\" data-linktype=\"relative-path\">UserPreferenceChanging</a> event. This code example is part of a larger example provided for the <a class=\"xref\" href=\"microsoft.win32.systemevents\" data-linktype=\"relative-path\">SystemEvents</a> class.  </p>\n<pre><code class=\"lang-cpp\" name=\"SystemEvents#1\">#using &lt;System.dll&gt;\n\nusing namespace System;\nusing namespace Microsoft::Win32;\n\n// This method is called when a user preference changes.\nvoid SystemEvents_UserPreferenceChanging(Object^ sender,\n     UserPreferenceChangingEventArgs^ e)\n {\n     Console::WriteLine(&quot;The user preference is changing. Category={0}&quot;,\n         e-&gt;Category);\n }\n\n// This method is called when the palette changes.\nvoid SystemEvents_PaletteChanged(Object^ sender, EventArgs^ e)\n{\n    Console::WriteLine(&quot;The palette changed.&quot;);\n}\n\n// This method is called when the display settings change.\nvoid SystemEvents_DisplaySettingsChanged(Object^ sender,\n    EventArgs^ e)\n{\n    Console::WriteLine(&quot;The display settings changed.&quot;);\n}\n\nint main()\n{\n    // Set the SystemEvents class to receive event notification\n    // when a user preference changes, the palette changes, or\n    // when display settings change.\n    SystemEvents::UserPreferenceChanging += gcnew\n        UserPreferenceChangingEventHandler(\n        SystemEvents_UserPreferenceChanging);\n    SystemEvents::PaletteChanged += gcnew\n        EventHandler(SystemEvents_PaletteChanged);\n    SystemEvents::DisplaySettingsChanged += gcnew\n        EventHandler(SystemEvents_DisplaySettingsChanged);\n\n    // For demonstration purposes, this application sits idle\n    // waiting for events.\n    Console::WriteLine(&quot;This application is waiting for system events.&quot;);\n    Console::WriteLine(&quot;Press &lt;Enter&gt; to terminate this application.&quot;);\n    Console::ReadLine();\n}\n\n// This code produces the following output.\n//\n//  This app is waiting for system events.\n//  Press &lt;Enter&gt; to terminate this application.\n//  Display Settings changed.\n//  User preference is changing. Category=General\n</code></pre><pre><code class=\"lang-cs\" name=\"SystemEvents#1\">using System;\nusing Microsoft.Win32;\n\npublic sealed class App \n{\n    static void Main() \n    {         \n        // Set the SystemEvents class to receive event notification when a user \n        // preference changes, the palette changes, or when display settings change.\n        SystemEvents.UserPreferenceChanging += new \n            UserPreferenceChangingEventHandler(SystemEvents_UserPreferenceChanging);\n        SystemEvents.PaletteChanged += new \n            EventHandler(SystemEvents_PaletteChanged);\n        SystemEvents.DisplaySettingsChanged += new \n            EventHandler(SystemEvents_DisplaySettingsChanged);        \n\n        // For demonstration purposes, this application sits idle waiting for events.\n        Console.WriteLine(&quot;This application is waiting for system events.&quot;);\n        Console.WriteLine(&quot;Press &lt;Enter&gt; to terminate this application.&quot;);\n        Console.ReadLine();\n    }\n\n    // This method is called when a user preference changes.\n    static void SystemEvents_UserPreferenceChanging(object sender, UserPreferenceChangingEventArgs e) \n    {\n        Console.WriteLine(&quot;The user preference is changing. Category={0}&quot;, e.Category);\n    }\n\n    // This method is called when the palette changes.\n    static void SystemEvents_PaletteChanged(object sender, EventArgs e)\n    {\n        Console.WriteLine(&quot;The palette changed.&quot;);\n    }\n\n    // This method is called when the display settings change.\n    static void SystemEvents_DisplaySettingsChanged(object sender, EventArgs e)\n    {\n        Console.WriteLine(&quot;The display settings changed.&quot;);\n    }\n}\n\n// This code produces the following output.\n// \n//  This app is waiting for system events.\n//  Press &lt;Enter&gt; to terminate this application.\n//  Display Settings changed.\n//  User preference is changing. Category=General\n</code></pre><pre><code class=\"lang-vb\" name=\"SystemEvents#1\">Imports System\nImports Microsoft.Win32\nImports System.Windows.Forms\n\nFriend Class Form1\n    Inherits System.Windows.Forms.Form\n\n\n    Public Sub New()\n        MyBase.New()\n\n        &#39;This call is required by the Windows Form Designer.\n        InitializeComponent()\n\n        &#39;Set the SystemEvents class to receive event notification \n        &#39;when a user preference changes, the palette changes, or \n        &#39;when display settings change.\n        AddHandler SystemEvents.UserPreferenceChanging, _\n        AddressOf SystemEvents_UserPreferenceChanging\n\n        AddHandler SystemEvents.PaletteChanged, _\n        AddressOf SystemEvents_PaletteChanged\n\n        AddHandler SystemEvents.DisplaySettingsChanged, _\n        AddressOf SystemEvents_DisplaySettingsChanged\n\n    End Sub\n\n    &#39;Form overrides dispose to clean up the component list.\n    Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)\n        If disposing Then\n            If (components IsNot Nothing) Then\n                components.Dispose()\n            End If\n        End If\n        MyBase.Dispose(disposing)\n    End Sub\n\n\n    Private components As System.ComponentModel.IContainer\n\n    &lt;System.Diagnostics.DebuggerStepThrough()&gt; Private Sub InitializeComponent()\n\n        Me.SuspendLayout()\n\n        &#39;\n        &#39;Form1\n        &#39;\n        Me.ClientSize = New System.Drawing.Size(648, 398)\n        Me.Name = &quot;Form1&quot;\n        Me.Text = &quot;Form1&quot;\n        Me.ResumeLayout(False)\n\n    End Sub\n\n\n    &#39; This method is called when a user preference changes.\n    Private Sub SystemEvents_UserPreferenceChanging( _\n    ByVal sender As Object, _\n    ByVal e As UserPreferenceChangingEventArgs)\n\n        MessageBox.Show(&quot;UserPreferenceChanging: &quot; &amp; _\n        e.Category.ToString())\n    End Sub\n\n\n    &#39; This method is called when the palette changes.\n    Private Sub SystemEvents_PaletteChanged( _\n    ByVal sender As Object, _\n    ByVal e As EventArgs)\n\n        MessageBox.Show(&quot;PaletteChanged&quot;)\n\n    End Sub\n\n\n    &#39; This method is called when the display settings change.\n    Private Sub SystemEvents_DisplaySettingsChanged( _\n    ByVal sender As Object, _\n    ByVal e As EventArgs)\n\n        MessageBox.Show(&quot;The display settings changed.&quot;)\n\n    End Sub\n\nEnd Class\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>When you create a UserPreferenceChangingEventHandler delegate, you identify the method that will handle the event. To associate the event with your event-handling method, add an instance of the delegate to the event. The event-handling method is called whenever the event occurs, unless you remove the delegate. For more information about event-handler delegates, see <a href=\"http://msdn.microsoft.com/en-us/d98fd58b-fa4f-4598-8378-addf4355a115\" data-linktype=\"external\">NIB: Events and Delegates</a>.</p>\n\r\n  \r\n  \r\n  \r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc1.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/Microsoft.Win32.UserPreferenceChangingEventHandler.yml\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.UserPreferenceChangingEventHandler\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.UserPreferenceChangingEventHandler..ctor\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.UserPreferenceChangingEventHandler.Invoke\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.UserPreferenceChangingEventHandler.BeginInvoke\">\r\n<meta name=\"APIName\" content=\"Microsoft.Win32.UserPreferenceChangingEventHandler.EndInvoke\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-31 02:21 PM\">\r\n<meta name=\"document_id\" content=\"0974149d-487c-bfec-a162-bfb70e91e98a\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Represents the method that will handle the  event.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/microsoft.win32/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"Microsoft.Win32.UserPreferenceChangingEventHandler\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/Microsoft.Win32.UserPreferenceChangingEventHandler.yml","open_to_public_contributors":false,"api_name":["Microsoft.Win32.UserPreferenceChangingEventHandler","Microsoft.Win32.UserPreferenceChangingEventHandler..ctor","Microsoft.Win32.UserPreferenceChangingEventHandler.Invoke","Microsoft.Win32.UserPreferenceChangingEventHandler.BeginInvoke","Microsoft.Win32.UserPreferenceChangingEventHandler.EndInvoke"],"api_location":[],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["Microsoft.Win32.UserPreferenceChangingEventHandler","Microsoft::Win32::UserPreferenceChangingEventHandler"],"dev_langs":["csharp"],"updated_at":"2017-03-31 02:21 PM","document_id":"0974149d-487c-bfec-a162-bfb70e91e98a","content_git_url":"https://github.com/dotnet/docs-internal/blob/master/xml/Microsoft.Win32/UserPreferenceChangingEventHandler.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"UserPreferenceChangingEventHandler delegate | Microsoft Docs","_op_ogTitle":"UserPreferenceChangingEventHandler delegate","description":"Represents the method that will handle the  event.\n","toc_asset_id":"api/_splitted/Microsoft.Win32/toc.json","toc_rel":"_splitted/Microsoft.Win32/toc.json","source_url":"","ms.assetid":"Microsoft.Win32.UserPreferenceChangingEventHandler","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/microsoft.win32.userpreferencechangingeventhandler","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/microsoft.win32.userpreferencechangingeventhandler","fileRelativePath":"api/Microsoft.Win32.UserPreferenceChangingEventHandler.html"},"themesRelativePathToOutputRoot":"_themes/"}