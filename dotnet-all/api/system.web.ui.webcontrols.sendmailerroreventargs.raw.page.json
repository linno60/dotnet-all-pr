{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">SendMailErrorEventArgs</span>\r\n    \t\t\t\tClass\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Provides data for the <code>SendMailError</code> event of controls such as the <a class=\"xref\" href=\"system.web.ui.webcontrols.changepassword\" data-linktype=\"relative-path\">ChangePassword</a> control, the <a class=\"xref\" href=\"system.web.ui.webcontrols.createuserwizard\" data-linktype=\"relative-path\">CreateUserWizard</a> control, and the <a class=\"xref\" href=\"system.web.ui.webcontrols.passwordrecovery\" data-linktype=\"relative-path\">PasswordRecovery</a> control.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public class SendMailErrorEventArgs : EventArgs</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.eventargs\" data-linktype=\"relative-path\">EventArgs</a></span></div><span class=\"lang-csharp\">SendMailErrorEventArgs</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \t<h3 class=\"accented\">Inherited Members</h3>\r\n  \t<h4 class=\"accented\"></h4>\r\n  \t<div class=\"cdlHolder\">\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.eventargs#System_EventArgs_Empty\" data-linktype=\"relative-path\">Empty</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a></span></div>\r\n  \t</div>\r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following code example demonstrates an ASP.NET page that uses a <a class=\"xref\" href=\"system.web.ui.webcontrols.changepassword\" data-linktype=\"relative-path\">ChangePassword</a> Web control, and includes an event handler for the <a class=\"xref\" href=\"system.web.ui.webcontrols.changepassword#System_Web_UI_WebControls_ChangePassword_SendMailError\" data-linktype=\"relative-path\">SendMailError</a> event named SendMailError. The code example assumes that the ASP.NET Web site has been configured to use ASP.NET membership and Forms authentication, and that a user has been created whose name and password are known to you. For more information, see <a href=\"../Topic/How%20to:%20Implement%20Simple%20Forms%20Authentication.md\" data-linktype=\"relative-path\">How to: Implement Simple Forms Authentication</a>.  </p>\n<p> If the password change succeeds, the code in the <code>SendingMail</code> event handler attempts to send an e-mail message to the user to confirm the change. SMTP must already be configured on the server in order for this code example to work. For information about how to configure an SMTP server, see <a href=\"http://msdn.microsoft.com/en-us/ed204b58-24af-47d0-9687-60e5df5f17f8\" data-linktype=\"external\">NIB: How to: Install and Configure SMTP Virtual Servers in IIS 6.0</a>. For the purposes of this example, it is not necessary to configure an SMTP server; the example is constructed to test for a failure to send an e-mail message.  </p>\n<p> If a mail server is not configured correctly or some other error occurs and the e-mail message cannot be sent, the <code>SendMailError</code> function is called. A message is displayed to the user. In addition, an event is logged to the Windows Application event log with the assumption that an event source named MySamplesSite already exists. See the code example below to create the specified event source. For more information about creating an event source, see <a href=\"../topic/server%20event%20handling%20in%20asp.net%20web%20forms%20pages\" data-linktype=\"relative-path\">Server Event Handling in ASP.NET Web Forms Pages</a>. The <a class=\"xref\" href=\"system.web.ui.webcontrols.sendmailerroreventargs#System_Web_UI_WebControls_SendMailErrorEventArgs_Handled_\" data-linktype=\"relative-path\">Handled</a> property of the SendMailErrorEventArgs object is set to <code>true</code> to indicate that the error has been handled.  </p>\n<pre><code class=\"lang-cs\" name=\"System.Web.UI.WebControls.SendMailErrorEventHandler#1\">&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;True&quot; %&gt;\n\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;script runat=&quot;server&quot;&gt;\n\n  void MySendingMail(object sender, MailMessageEventArgs e)\n  {\n    Message1.Text = &quot;Sent mail to you to confirm the password change.&quot;;\n  }\n\n  void MySendMailError(object sender, SendMailErrorEventArgs e)\n  {\n    Message1.Text = &quot;Could not send email to confirm password change.&quot;;\n\n    // The MySamplesSite event source has already been created by an administrator.\n    System.Diagnostics.EventLog myLog = new System.Diagnostics.EventLog();\n    myLog.Log = &quot;Application&quot;;\n    myLog.Source = &quot;MySamplesSite&quot;;\n    myLog.WriteEntry(\n        &quot;Sending mail via SMTP failed with the following error: &quot; + \n        e.Exception.Message.ToString(), \n        System.Diagnostics.EventLogEntryType.Error);\n\n    e.Handled = true;\n  }\n\n&lt;/script&gt;\n\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head runat=&quot;server&quot;&gt;\n  &lt;title&gt;ChangePassword including a SendMailError Event&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;\n  &lt;div style=&quot;text-align:center&quot;&gt;\n\n    &lt;h1&gt;ChangePassword&lt;/h1&gt;\n    \n    &lt;asp:LoginView ID=&quot;LoginView1&quot; Runat=&quot;server&quot; \n      Visible=&quot;true&quot;&gt;\n      &lt;LoggedInTemplate&gt;\n        &lt;asp:LoginName ID=&quot;LoginName1&quot; Runat=&quot;server&quot; FormatString=&quot;You are logged in as {0}.&quot; /&gt;\n        &lt;br /&gt;\n      &lt;/LoggedInTemplate&gt;\n      &lt;AnonymousTemplate&gt;\n        You are not logged in\n      &lt;/AnonymousTemplate&gt;\n    &lt;/asp:LoginView&gt;&lt;br /&gt;\n    \n    &lt;asp:ChangePassword ID=&quot;ChangePassword1&quot; Runat=&quot;server&quot;\n      BorderStyle=&quot;Solid&quot; \n      BorderWidth=&quot;1&quot; \n      CancelDestinationPageUrl=&quot;~/Default.aspx&quot; \n      DisplayUserName=&quot;true&quot;\n      OnSendingMail=&quot;MySendingMail&quot; \n      OnSendMailError=&quot;MySendMailError&quot; \n      ContinueDestinationPageUrl=&quot;~/Default.aspx&quot; &gt;\n      &lt;MailDefinition \n        BodyFileName=&quot;~\\MailFiles\\ChangePasswordMail.htm&quot; \n        Subject=&quot;Activity information for you&quot;&gt;\n        &lt;EmbeddedObjects&gt;\n          &lt;asp:EmbeddedMailObject Name=&quot;LoginGif&quot; Path=&quot;~\\MailFiles\\Login.gif&quot; /&gt;\n          &lt;asp:EmbeddedMailObject Name=&quot;PrivacyNoticeTxt&quot; Path=&quot;~\\MailFiles\\PrivacyNotice.txt&quot; /&gt;\n        &lt;/EmbeddedObjects&gt;\n      &lt;/MailDefinition&gt;\n    &lt;/asp:ChangePassword&gt;&lt;br /&gt;\n  \n    &lt;asp:Label ID=&quot;Message1&quot; Runat=&quot;server&quot; ForeColor=&quot;Red&quot; /&gt;&lt;br /&gt;\n\n    &lt;asp:HyperLink ID=&quot;HyperLink1&quot; Runat=&quot;server&quot; \n      NavigateUrl=&quot;~/Default.aspx&quot;&gt;\n      Home\n    &lt;/asp:HyperLink&gt;\n    \n  &lt;/div&gt;\n  &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Web.UI.WebControls.SendMailErrorEventHandler#1\">&lt;%@ Page Language=&quot;VB&quot; AutoEventWireup=&quot;True&quot; %&gt;\n\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n\n&lt;script runat=&quot;server&quot;&gt;\n\n  Public Sub MySendingMail(ByVal Sender As Object, ByVal e As MailMessageEventArgs)\n    Message1.Text = &quot;Sent mail to you to confirm the password change.&quot;\n  End Sub\n\n  Public Sub MySendMailError(ByVal Sender As Object, ByVal e As SendMailErrorEventArgs)\n    Message1.Text = &quot;Could not send mail to confirm the password change.&quot;\n    \n    &#39; The MySamplesSite event source has already been created by an administrator.\n    Dim myLog As System.Diagnostics.EventLog\n    myLog = new System.Diagnostics.EventLog\n    myLog.Log = &quot;Application&quot;\n    myLog.Source = &quot;MySamplesSite&quot;\n    myLog.WriteEntry(&quot;Sending mail via SMTP failed with the following error: &quot; &amp; e.Exception.Message.ToString(), System.Diagnostics.EventLogEntryType.Error)\n\n    e.Handled = True\n    \n  End Sub\n\n&lt;/script&gt;\n\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;\n&lt;head runat=&quot;server&quot;&gt;\n  &lt;title&gt;ChangePassword including a SendMailError Event&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;\n  &lt;div style=&quot;text-align:center&quot;&gt;\n\n    &lt;h1&gt;ChangePassword&lt;/h1&gt;\n    \n    &lt;asp:LoginView ID=&quot;LoginView1&quot; Runat=&quot;server&quot; \n      Visible=&quot;true&quot;&gt;\n      &lt;LoggedInTemplate&gt;\n        &lt;asp:LoginName ID=&quot;LoginName1&quot; Runat=&quot;server&quot; FormatString=&quot;You are logged in as {0}.&quot; /&gt;\n        &lt;br /&gt;\n      &lt;/LoggedInTemplate&gt;\n      &lt;AnonymousTemplate&gt;\n        You are not logged in\n      &lt;/AnonymousTemplate&gt;\n    &lt;/asp:LoginView&gt;&lt;br /&gt;\n    \n    &lt;asp:ChangePassword ID=&quot;ChangePassword1&quot; Runat=&quot;server&quot;\n      BorderStyle=&quot;Solid&quot; \n      BorderWidth=&quot;1&quot; \n      CancelDestinationPageUrl=&quot;~/Default.aspx&quot; \n      DisplayUserName=&quot;true&quot;\n      OnSendingMail=&quot;MySendingMail&quot; \n      OnSendMailError=&quot;MySendMailError&quot; \n      ContinueDestinationPageUrl=&quot;~/Default.aspx&quot; &gt;\n      &lt;MailDefinition \n        BodyFileName=&quot;~\\MailFiles\\ChangePasswordMail.htm&quot; \n        Subject=&quot;Activity information for you&quot;&gt;\n        &lt;EmbeddedObjects&gt;\n          &lt;asp:EmbeddedMailObject Name=&quot;LoginGif&quot; Path=&quot;~\\MailFiles\\Login.gif&quot; /&gt;\n          &lt;asp:EmbeddedMailObject Name=&quot;PrivacyNoticeTxt&quot; Path=&quot;~\\MailFiles\\PrivacyNotice.txt&quot; /&gt;\n        &lt;/EmbeddedObjects&gt;\n      &lt;/MailDefinition&gt;\n    &lt;/asp:ChangePassword&gt;&lt;br /&gt;\n  \n    &lt;asp:Label ID=&quot;Message1&quot; Runat=&quot;server&quot; ForeColor=&quot;Red&quot; /&gt;&lt;br /&gt;\n\n    &lt;asp:HyperLink ID=&quot;HyperLink1&quot; Runat=&quot;server&quot; \n      NavigateUrl=&quot;~/Default.aspx&quot;&gt;\n      Home\n    &lt;/asp:HyperLink&gt;\n    \n  &lt;/div&gt;\n  &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><p> Use the following code example if you need to programmatically add the event source named MySamplesSite to your Application log. This event source must exist in order for the first code example to work correctly. The following code example requires Administrator privileges.  </p>\n<pre><code class=\"lang-vb\" name=\"System.Diagnostics.EventLog.CreateEventSource#1\">Imports System\nImports System.Collections.Generic\nImports System.Text\nImports System.Diagnostics\n\n\nNamespace CreateEventSource\n  Class Program\n    Sub Main()\n\n        Try\n            &#39; Create the source, if it does not already exist.\n            If Not (EventLog.SourceExists(&quot;MySamplesSite&quot;)) Then\n                EventLog.CreateEventSource(&quot;MySamplesSite&quot;, &quot;Application&quot;)\n                Console.WriteLine(&quot;Creating Event Source&quot;)\n            End If\n\n            &#39; Create an EventLog instance and assign its source.\n            Dim myLog As New EventLog\n            myLog.Source = &quot;MySamplesSite&quot;\n\n            &#39; Write an informational entry to the event log.\n            myLog.WriteEntry(&quot;Testing writing to event log.&quot;)\n\n            Console.WriteLine(&quot;Message written to event log.&quot;)\n        Catch e As Exception\n            Console.WriteLine(&quot;Exception:&quot;)\n            Console.WriteLine(e.ToString)\n        End Try\n\n    End Sub\n  End Class\nEnd Namespace\n</code></pre><pre><code class=\"lang-cs\" name=\"System.Diagnostics.EventLog.CreateEventSource#1\">#region Using directives\n\nusing System;\nusing System.Collections.Generic;\nusing System.Text;\nusing System.Diagnostics;\n\n#endregion\n\nnamespace CreateEventSource\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n\n            try\n            {\n                // Create the source, if it does not already exist.\n                if (!EventLog.SourceExists(&quot;MySamplesSite&quot;))\n                {\n                    EventLog.CreateEventSource(&quot;MySamplesSite&quot;, &quot;Application&quot;);\n                    Console.WriteLine(&quot;Creating Event Source&quot;);\n                }\n\n                // Create an EventLog instance and assign its source.\n                EventLog myLog = new EventLog();\n                myLog.Source = &quot;MySamplesSite&quot;;\n\n                // Write an informational entry to the event log.    \n                myLog.WriteEntry(&quot;Testing writing to event log.&quot;);\n\n                Console.WriteLine(&quot;Message written to event log.&quot;);\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(&quot;Exception:&quot;);\n                Console.WriteLine(&quot;{0}&quot;, e.ToString());\n            }\n        }\n    }\n}\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>The SendMailErrorEventArgs object contains an error message that is raised by the SMTP mail provider when an e-mail message cannot be sent by the <a class=\"xref\" href=\"system.web.ui.webcontrols.changepassword\" data-linktype=\"relative-path\">ChangePassword</a> control, or the <a class=\"xref\" href=\"system.web.ui.webcontrols.createuserwizard\" data-linktype=\"relative-path\">CreateUserWizard</a> control. In such a case, the SendMailErrorEventArgs object is sent to the <a class=\"xref\" href=\"system.web.ui.webcontrols.sendmailerroreventhandler\" data-linktype=\"relative-path\">SendMailErrorEventHandler</a>.  </p>\n<p> Create a <a class=\"xref\" href=\"system.web.ui.webcontrols.sendmailerroreventhandler\" data-linktype=\"relative-path\">SendMailErrorEventHandler</a> delegate to handle the event. Handling the event allows your Web application to continue to run even though an exception has occurred. This is useful when it is not critical to send an e-mail message. For example, if the exception occurs when a user is working through a multi-step wizard, it can be advantageous to log the error, display an informative message to the user, and allow the user to complete the wizard.  </p>\n<p> Examine the <a class=\"xref\" href=\"system.web.ui.webcontrols.sendmailerroreventargs#System_Web_UI_WebControls_SendMailErrorEventArgs_Exception_\" data-linktype=\"relative-path\">Exception</a> property to determine the actual cause of the exception. The most common reason for the exception is a configuration error in the <a href=\"../Topic/%3Csmtp%3E%20Element%20(Network%20Settings).md\" data-linktype=\"relative-path\">&amp;lt;smtp&amp;gt; Element (Network Settings)</a> of the machine configuration file. Although an error like this is typically discovered during the development and debugging of an application, mail servers can fail unexpectedly in a production environment, and you must determine whether you want the entire application to fail in that situation. If not, handling the event allows your application to proceed.  </p>\n<p> You must set the <a class=\"xref\" href=\"system.web.ui.webcontrols.sendmailerroreventargs#System_Web_UI_WebControls_SendMailErrorEventArgs_Handled_\" data-linktype=\"relative-path\">Handled</a> property to <code>true</code> to signal that the exception has been handled; otherwise, the exception is rethrown, and will include the original call stack and error message.  </p>\n<p> If you do not create an event handler for the <a class=\"xref\" href=\"system.web.ui.webcontrols.changepassword#System_Web_UI_WebControls_ChangePassword_SendMailError\" data-linktype=\"relative-path\">SendMailError</a> event, or if you create an event handler but leave the <a class=\"xref\" href=\"system.web.ui.webcontrols.sendmailerroreventargs#System_Web_UI_WebControls_SendMailErrorEventArgs_Handled_\" data-linktype=\"relative-path\">Handled</a> property set to <code>false</code>, your Web application will stop running if an error occurs when sending an e-mail message, and ASP.NET will display an error message.  </p>\n<p> The <a class=\"xref\" href=\"system.web.ui.webcontrols.changepassword#System_Web_UI_WebControls_ChangePassword_OnSendMailError_\" data-linktype=\"relative-path\">OnSendMailError</a> method also allows derived classes to handle the event, instead of this being done by the <a class=\"xref\" href=\"system.web.ui.webcontrols.sendmailerroreventhandler\" data-linktype=\"relative-path\">SendMailErrorEventHandler</a>. This is the preferred technique for handling the event in a class that is derived from <a class=\"xref\" href=\"system.web.ui.webcontrols.changepassword\" data-linktype=\"relative-path\">ChangePassword</a> or <a class=\"xref\" href=\"system.web.ui.webcontrols.createuserwizard\" data-linktype=\"relative-path\">CreateUserWizard</a>.  </p>\n<p> For more information about handling events, see <a href=\"../topic/server%20event%20handling%20in%20asp.net%20web%20forms%20pages\" data-linktype=\"relative-path\">Server Event Handling in ASP.NET Web Forms Pages</a>.</p>\n\r\n  \r\n  \r\n  \t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Constructors\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5 netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t\t<a id=\"System_Web_UI_WebControls_SendMailErrorEventArgs__ctor_\"></a>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Web_UI_WebControls_SendMailErrorEventArgs__ctor_System_Exception_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">SendMailErrorEventArgs(Exception)</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Initializes a new instance of the <a class=\"xref\" href=\"system.web.ui.webcontrols.sendmailerroreventargs\" data-linktype=\"relative-path\">SendMailErrorEventArgs</a> class.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public SendMailErrorEventArgs (Exception e);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Parameters</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>e</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.exception\" data-linktype=\"relative-path\">Exception</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>An <a class=\"xref\" href=\"system.exception\" data-linktype=\"relative-path\">Exception</a> object containing the exception.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t</section>\t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Properties\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5 netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t\t<a id=\"System_Web_UI_WebControls_SendMailErrorEventArgs_Exception_\"></a>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Web_UI_WebControls_SendMailErrorEventArgs_Exception\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Exception</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Returns the exception thrown by an SMTP mail service when an e-mail message cannot be sent.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public Exception Exception { get; set; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.exception\" data-linktype=\"relative-path\">Exception</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>An <a class=\"xref\" href=\"system.exception\" data-linktype=\"relative-path\">Exception</a> object that contains the exception.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>The Exception property contains the exception that is thrown by the SMTP mail provider when an e-mail message cannot be sent by the <a class=\"xref\" href=\"system.web.ui.webcontrols.changepassword\" data-linktype=\"relative-path\">ChangePassword</a> control or the <a class=\"xref\" href=\"system.web.ui.webcontrols.createuserwizard\" data-linktype=\"relative-path\">CreateUserWizard</a>. The most common reason for this exception is a configuration error in the <a href=\"../Topic/%3Csmtp%3E%20Element%20(Network%20Settings).md\" data-linktype=\"relative-path\">&amp;lt;smtp&amp;gt; Element (Network Settings)</a> of the machine configuration file, which produces the following exception message: <code>The transport failed to connect to the server.</code>  </p>\n<p> Exceptions are not thrown if there is an error in the e-mail message when embedding a file using <a class=\"xref\" href=\"system.web.ui.webcontrols.maildefinition#System_Web_UI_WebControls_MailDefinition_EmbeddedObjects_\" data-linktype=\"relative-path\">EmbeddedObjects</a>. Instead, the embedded file appears broken when the mail message is viewed.  </p>\n<p> You must set the <a class=\"xref\" href=\"system.web.ui.webcontrols.sendmailerroreventargs#System_Web_UI_WebControls_SendMailErrorEventArgs_Handled_\" data-linktype=\"relative-path\">Handled</a> object, passed as the <code>e</code> parameter of <a class=\"xref\" href=\"system.web.ui.webcontrols.sendmailerroreventargs\" data-linktype=\"relative-path\">SendMailErrorEventArgs</a>, to <code>true</code> to signal that the exception has been handled; otherwise, the exception is rethrown, and includes the original call stack and error message.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5 netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t\t<a id=\"System_Web_UI_WebControls_SendMailErrorEventArgs_Handled_\"></a>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Web_UI_WebControls_SendMailErrorEventArgs_Handled\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Handled</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Indicates if the SMTP exception that is contained in the <span class=\"xref\">stem.Web.UI.WebControls.SendMailErrorEventArgs.Exception*</span> property has been handled.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public bool Handled { get; set; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.boolean\" data-linktype=\"relative-path\">Boolean</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>If <code>true</code>, the exception is consumed and handled by the <a class=\"xref\" href=\"system.web.ui.webcontrols.sendmailerroreventhandler\" data-linktype=\"relative-path\">SendMailErrorEventHandler</a> delegate. If <code>false</code>, the exception is rethrown, including the original call stack and error message.  </p>\n<p> The default is <code>false</code>.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>The Handled property indicates if the <a class=\"xref\" href=\"system.web.ui.webcontrols.sendmailerroreventargs#System_Web_UI_WebControls_SendMailErrorEventArgs_Exception_\" data-linktype=\"relative-path\">Exception</a> has been handled. The exception is raised by the SMTP mail provider when an e-mail message cannot be sent by the <a class=\"xref\" href=\"system.web.ui.webcontrols.changepassword\" data-linktype=\"relative-path\">ChangePassword</a> control or the <a class=\"xref\" href=\"system.web.ui.webcontrols.createuserwizard\" data-linktype=\"relative-path\">CreateUserWizard</a>. The most common reason for the exception is a configuration error in the <a href=\"../Topic/%3Csmtp%3E%20Element%20(Network%20Settings).md\" data-linktype=\"relative-path\">&amp;lt;smtp&amp;gt; Element (Network Settings)</a> of the machine configuration file. Although an error like this is typically discovered during the development and debugging of an application, mail servers can fail unexpectedly in a production environment, and you must determine whether you want the entire application to fail in that situation. If not, handling the event allows your application to proceed.  </p>\n<p> If you do not create an event handler for the <a class=\"xref\" href=\"system.web.ui.webcontrols.changepassword#System_Web_UI_WebControls_ChangePassword_SendMailError\" data-linktype=\"relative-path\">SendMailError</a> event, or if you create an event handler but leave the Handled property set to <code>false</code>, your Web application will stop running if an error occurs when sending an e-mail message, and ASP.NET will display an error message. Handling the event allows your Web application to continue to run even though an exception has occurred. This is useful when it is not critical to send an e-mail message. For example, if the exception occurs when a user is working through a multi-step wizard, it can be advantageous to log the error, display an informative message to the user, and allow the user to complete the wizard.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t</section>\r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.Web.UI.WebControls.SendMailErrorEventArgs.yml\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.SendMailErrorEventArgs\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.SendMailErrorEventArgs..ctor\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.SendMailErrorEventArgs.Exception\">\r\n<meta name=\"APIName\" content=\"System.Web.UI.WebControls.SendMailErrorEventArgs.Handled\">\r\n<meta name=\"APILocation\" content=\"System.Web.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-31 05:47 AM\">\r\n<meta name=\"document_id\" content=\"3199083b-bd0c-7584-8456-f315bf71ffb5\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Provides data for the SendMailError event of controls such as the  control, the  control, and the  control.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.web.ui.webcontrols/toc2.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Web.UI.WebControls.SendMailErrorEventArgs\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.Web.UI.WebControls.SendMailErrorEventArgs.yml","open_to_public_contributors":false,"api_name":["System.Web.UI.WebControls.SendMailErrorEventArgs","System.Web.UI.WebControls.SendMailErrorEventArgs..ctor","System.Web.UI.WebControls.SendMailErrorEventArgs.Exception","System.Web.UI.WebControls.SendMailErrorEventArgs.Handled"],"api_location":["System.Web.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Web.UI.WebControls.SendMailErrorEventArgs","System::Web::UI::WebControls::SendMailErrorEventArgs","System.Web.UI.WebControls.SendMailErrorEventArgs.#ctor","System::Web::UI::WebControls::SendMailErrorEventArgs::#ctor","System.Web.UI.WebControls.SendMailErrorEventArgs.Exception","System::Web::UI::WebControls::SendMailErrorEventArgs::Exception","System.Web.UI.WebControls.SendMailErrorEventArgs.Handled","System::Web::UI::WebControls::SendMailErrorEventArgs::Handled"],"dev_langs":["csharp"],"updated_at":"2017-03-31 05:47 AM","document_id":"3199083b-bd0c-7584-8456-f315bf71ffb5","content_git_url":"https://github.com/dotnet/docs-internal/blob/master/xml/System.Web.UI.WebControls/SendMailErrorEventArgs.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"SendMailErrorEventArgs class | Microsoft Docs","_op_ogTitle":"SendMailErrorEventArgs class","description":"Provides data for the SendMailError event of controls such as the  control, the  control, and the  control.\n","toc_asset_id":"api/_splitted/System.Web.UI.WebControls/toc.json","toc_rel":"_splitted/System.Web.UI.WebControls/toc.json","source_url":"","ms.assetid":"System.Web.UI.WebControls.SendMailErrorEventArgs","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.webcontrols.sendmailerroreventargs","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.webcontrols.sendmailerroreventargs","fileRelativePath":"api/System.Web.UI.WebControls.SendMailErrorEventArgs.html"},"themesRelativePathToOutputRoot":"_themes/"}