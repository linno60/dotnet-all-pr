{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">IResourceProvider</span>\r\n      Interface\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Defines the interface a class must implement to act as a resource provider.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public interface IResourceProvider</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following code example shows a customized resource provider factory that retrieves cached values. The resource provider factory creates an instance of a class that implements IResourceProvider.  </p>\n<pre><code class=\"lang-vb\" name=\"System.Web.Compilation.ResourceProviderFactory#2\">    &lt;DesignTimeResourceProviderFactoryAttribute(GetType(CustomDesignTimeResourceProviderFactory))&gt; _\n    Public Class CustomResourceProviderFactory\n        Inherits ResourceProviderFactory\n        Public Overrides Function CreateGlobalResourceProvider(ByVal classname As String) As IResourceProvider\n            Return New CustomResourceProvider(Nothing, classname)\n        End Function\n        Public Overrides Function CreateLocalResourceProvider(ByVal virtualPath As String) As IResourceProvider\n            Return New CustomResourceProvider(virtualPath, Nothing)\n        End Function\n    End Class\n\n    &#39; Define the resource provider for global and local resources.\n    Friend Class CustomResourceProvider\n        Implements IResourceProvider\n        Dim _virtualPath As String\n        Dim _className As String\n\n        Public Sub New(ByVal virtualPath As String, ByVal classname As String)\n            _virtualPath = virtualPath\n            _className = classname\n        End Sub\n\n        Private Function GetResourceCache(ByVal culturename As String) As IDictionary\n            Return System.Web.HttpContext.Current.Cache(culturename)\n        End Function\n\n        Function GetObject(ByVal resourceKey As String, ByVal culture As CultureInfo) As Object Implements IResourceProvider.GetObject\n            Dim value As Object\n            Dim cultureName As String\n            cultureName = Nothing\n            If (IsNothing(culture)) Then\n                cultureName = CultureInfo.CurrentUICulture.Name\n            Else\n                cultureName = culture.Name\n            End If\n\n            value = GetResourceCache(cultureName)(resourceKey)\n            If (value = Nothing) Then\n                value = GetResourceCache(Nothing)(resourceKey)\n            End If\n            Return value\n        End Function\n\n\n        ReadOnly Property ResourceReader() As IResourceReader Implements IResourceProvider.ResourceReader\n            Get\n                Dim cultureName As String\n                Dim currentUICulture As CultureInfo\n                cultureName = Nothing\n                currentUICulture = CultureInfo.CurrentUICulture\n                If (Not (String.Equals(currentUICulture.Name, CultureInfo.InstalledUICulture.Name))) Then\n                    cultureName = currentUICulture.Name\n                End If\n\n                Return New CustomResourceReader(GetResourceCache(cultureName))\n            End Get\n        End Property\n    End Class\n\n    Friend NotInheritable Class CustomResourceReader\n        Implements IResourceReader\n        Private _resources As IDictionary\n\n        Public Sub New(ByVal resources As IDictionary)\n            _resources = resources\n        End Sub\n\n        Function GetEnumerator1() As IDictionaryEnumerator Implements IResourceReader.GetEnumerator\n            Return _resources.GetEnumerator()\n        End Function\n\n        Sub Close() Implements IResourceReader.Close\n\n        End Sub\n\n        Function GetEnumerator() As IEnumerator Implements IEnumerable.GetEnumerator\n            Return _resources.GetEnumerator()\n        End Function\n\n        Sub Dispose() Implements IDisposable.Dispose\n\n        End Sub\n    End Class\n</code></pre><pre><code class=\"lang-cs\" name=\"System.Web.Compilation.ResourceProviderFactory#2\">    [\n        DesignTimeResourceProviderFactoryAttribute(\n            typeof(CustomDesignTimeResourceProviderFactory))\n    ]\n    public class CustomResourceProviderFactory : ResourceProviderFactory\n    {\n        public override IResourceProvider\n          CreateGlobalResourceProvider(string classname)\n        {\n            return new CustomResourceProvider(null, classname);\n        }\n        public override IResourceProvider\n          CreateLocalResourceProvider(string virtualPath)\n        {\n            return new CustomResourceProvider(virtualPath, null);\n        }\n    }\n\n    // Define the resource provider for global and local resources.\n    internal class CustomResourceProvider : IResourceProvider\n    {\n        string _virtualPath;\n        string _className;\n\n        public CustomResourceProvider(string virtualPath, string classname)\n        {\n            _virtualPath = virtualPath;\n            _className = classname;\n        }\n\n        private IDictionary GetResourceCache(string culturename)\n        {\n            return (IDictionary)\n                System.Web.HttpContext.Current.Cache[culturename];\n        }\n\n        object IResourceProvider.GetObject\n            (string resourceKey, CultureInfo culture)\n        {\n            object value;\n\n            string cultureName = null;\n            if (culture != null)\n            {\n                cultureName = culture.Name;\n            }\n            else\n            {\n                cultureName = CultureInfo.CurrentUICulture.Name;\n            }\n\n            value = GetResourceCache(cultureName)[resourceKey];\n            if (value == null)\n            {\n                value = GetResourceCache(null)[resourceKey];\n            }\n            return value;\n        }\n\n\n        IResourceReader IResourceProvider.ResourceReader\n        {\n            get\n            {\n                string cultureName = null;\n                CultureInfo currentUICulture = CultureInfo.CurrentUICulture;\n                if (!String.Equals(currentUICulture.Name,\n                    CultureInfo.InstalledUICulture.Name))\n                {\n                    cultureName = currentUICulture.Name;\n                }\n\n                return new CustomResourceReader\n                    (GetResourceCache(cultureName));\n            }\n        }\n    }\n\n\n    internal sealed class CustomResourceReader : IResourceReader\n    {\n        private IDictionary _resources;\n\n        public CustomResourceReader(IDictionary resources)\n        {\n            _resources = resources;\n        }\n\n        IDictionaryEnumerator IResourceReader.GetEnumerator()\n        {\n            return _resources.GetEnumerator();\n        }\n\n        void IResourceReader.Close() { }\n\n        IEnumerator IEnumerable.GetEnumerator()\n        {\n            return _resources.GetEnumerator();\n        }\n\n        void IDisposable.Dispose() { return; }\n    }\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>A resource provider facilitates the retrieving of values from a resource file. When an expression of the form <code>&lt;%$ Resources: classKey, resourceKey %&gt;</code> is encountered during page parsing, the resource provider returns the localized value for the resource. The <a class=\"xref\" href=\"system.web.compilation.resourceproviderfactory\" data-linktype=\"relative-path\">ResourceProviderFactory</a> class creates instances of IResourceProvider objects for use in retrieving the values.</p>\n\r\n  \r\n  \r\n  \t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Properties\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5 netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Web_Compilation_IResourceProvider_ResourceReader\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">ResourceReader</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Gets an object to read resource values from a source.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public System.Resources.IResourceReader ResourceReader { get; }</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Value</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.resources.iresourcereader\" data-linktype=\"relative-path\">IResourceReader</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The <a class=\"xref\" href=\"system.resources.iresourcereader\" data-linktype=\"relative-path\">IResourceReader</a> associated with the current resource provider.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>An <a class=\"xref\" href=\"system.resources.iresourcereader\" data-linktype=\"relative-path\">IResourceReader</a> object reads sequential name/value pairs from a source. The <a class=\"xref\" href=\"system.resources.resourcereader\" data-linktype=\"relative-path\">ResourceReader</a> and <a class=\"xref\" href=\"system.resources.resxresourcereader\" data-linktype=\"relative-path\">ResXResourceReader</a> classes provide default <a class=\"xref\" href=\"system.resources.iresourcereader\" data-linktype=\"relative-path\">IResourceReader</a> interface implementation for reading from .resources and .resx files, respectively. Other implementations of the <a class=\"xref\" href=\"system.web.compilation.iresourceprovider\" data-linktype=\"relative-path\">IResourceProvider</a> interface could read from any source containing resource values.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t  \r\n  \t\t</section>\t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Methods\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5 netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_Web_Compilation_IResourceProvider_GetObject_System_String_System_Globalization_CultureInfo_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">GetObject(String,CultureInfo)</span>        \r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Returns a resource object for the key and culture.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public object GetObject (string resourceKey, System.Globalization.CultureInfo culture);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>resourceKey</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.string\" data-linktype=\"relative-path\">String</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The key identifying a particular resource.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>culture</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.globalization.cultureinfo\" data-linktype=\"relative-path\">CultureInfo</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The culture identifying a localized value for the resource.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"attributeList stack\">\r\n  \t\t\t\t\t\t\t\t<dt>Returns</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>An <a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a> that contains the resource value for the <code>resourceKey</code> and <code>culture</code>.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>When implemented, the GetObject method returns the localized value for a resource key based on the current culture. The implementing class could retrieve the <a class=\"xref\" href=\"system.globalization.cultureinfo#System_Globalization_CultureInfo_CurrentUICulture_\" data-linktype=\"relative-path\">CurrentUICulture</a> property if a value for the <code>culture</code> parameter is not passed in.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t  \r\n  \t\t</section>\r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.Web.Compilation.IResourceProvider.yml\">\r\n<meta name=\"APIName\" content=\"System.Web.Compilation.IResourceProvider\">\r\n<meta name=\"APIName\" content=\"System.Web.Compilation.IResourceProvider.GetObject\">\r\n<meta name=\"APIName\" content=\"System.Web.Compilation.IResourceProvider.ResourceReader\">\r\n<meta name=\"APILocation\" content=\"System.Web.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-24 01:41 AM\">\r\n<meta name=\"document_id\" content=\"6b6211d6-1ebb-0977-97c2-358a877cca1e\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Defines the interface a class must implement to act as a resource provider.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.web.compilation/toc2.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Web.Compilation.IResourceProvider\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.Web.Compilation.IResourceProvider.yml","open_to_public_contributors":false,"api_name":["System.Web.Compilation.IResourceProvider","System.Web.Compilation.IResourceProvider.GetObject","System.Web.Compilation.IResourceProvider.ResourceReader"],"api_location":["System.Web.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Web.Compilation.IResourceProvider","System::Web::Compilation::IResourceProvider","System.Web.Compilation.IResourceProvider.GetObject","System::Web::Compilation::IResourceProvider::GetObject","System.Web.Compilation.IResourceProvider.ResourceReader","System::Web::Compilation::IResourceProvider::ResourceReader"],"dev_langs":["csharp"],"updated_at":"2017-03-24 01:41 AM","document_id":"6b6211d6-1ebb-0977-97c2-358a877cca1e","content_git_url":"https://github.com/dotnet/docs/blob/master/xml/System.Web.Compilation/IResourceProvider.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"IResourceProvider interface | Microsoft Docs","_op_ogTitle":"IResourceProvider interface","description":"Defines the interface a class must implement to act as a resource provider.\n","toc_asset_id":"api/_splitted/System.Web.Compilation/toc.json","toc_rel":"_splitted/System.Web.Compilation/toc.json","source_url":"","ms.assetid":"System.Web.Compilation.IResourceProvider","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.web.compilation.iresourceprovider","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.web.compilation.iresourceprovider","fileRelativePath":"api/System.Web.Compilation.IResourceProvider.html"},"themesRelativePathToOutputRoot":"_themes/"}