{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">DataGridViewCellToolTipTextNeededEventHandler</span>\r\n      Delegate\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Represents the method that will handle the <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_CellToolTipTextNeeded\" data-linktype=\"relative-path\">CellToolTipTextNeeded</a> event of a <a class=\"xref\" href=\"system.windows.forms.datagridview\" data-linktype=\"relative-path\">DataGridView</a>.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public delegate void DataGridViewCellToolTipTextNeededEventHandler(object sender, DataGridViewCellToolTipTextNeededEventArgs e);</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.delegate\" data-linktype=\"relative-path\">Delegate</a></span></div><span class=\"lang-csharp\">DataGridViewCellToolTipTextNeededEventHandler</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following code example uses ToolTips to display additional information about cell contents in the <code>ReportsTo</code> column.  </p>\n<pre><code class=\"lang-cs\" name=\"System.Windows.Forms.DataGridView_SharedRowScenarios#30\">private DataTable Populate(string query, bool resetUnsharedCounter)\n{\n    if (resetUnsharedCounter)\n    {\n        ResetCounter();\n    }\n\n    // Alter the data source as necessary\n    SqlDataAdapter adapter = new SqlDataAdapter(query,\n        new SqlConnection(&quot;Integrated Security=SSPI;Persist Security Info=False;&quot; +\n        &quot;Initial Catalog=Northwind;Data Source=localhost&quot;));\n\n    DataTable table = new DataTable();\n    table.Locale = System.Globalization.CultureInfo.InvariantCulture;\n    adapter.Fill(table);\n    return table;\n}\n\nprivate Label count = new Label();\nprivate int unsharedRowCounter;\n\nprivate void ResetCounter()\n{\n    unsharedRowCounter = 0;\n    count.Text = unsharedRowCounter.ToString();\n}\n\nprivate void dataGridView1_CellToolTipTextNeeded(object sender,\n    DataGridViewCellToolTipTextNeededEventArgs e)\n{\n\n    if (theCellImHoveringOver.ColumnIndex == dataGridView1.Columns[&quot;ReportsTo&quot;].Index &amp;&amp;\n        theCellImHoveringOver.RowIndex &gt; -1)\n    {\n\n        string reportsTo = dataGridView1.Rows[theCellImHoveringOver.RowIndex].\n            Cells[theCellImHoveringOver.ColumnIndex].Value.ToString();\n\n        if (String.IsNullOrEmpty(reportsTo))\n        {\n            e.ToolTipText = &quot;The buck stops here!&quot;;\n        }\n        else\n        {\n            DataTable table = Populate(\n                &quot;select firstname, lastname from employees where employeeid = &#39;&quot; +\n                dataGridView1.Rows[theCellImHoveringOver.RowIndex].\n                Cells[theCellImHoveringOver.ColumnIndex].Value.ToString() +\n                &quot;&#39;&quot;, false);\n\n            e.ToolTipText = &quot;Reports to &quot; + table.Rows[0].ItemArray[0] + &quot; &quot; +\n                table.Rows[0].ItemArray[1];\n        }\n    }\n}\n</code></pre><pre><code class=\"lang-cpp\" name=\"System.Windows.Forms.DataGridView_SharedRowScenarios#30\">DataTable^ Populate( String^ query, bool resetUnsharedCounter )\n{\n    if ( resetUnsharedCounter )\n    {\n        ResetCounter();\n    }\n\n\n    // Alter the data source as necessary\n    SqlDataAdapter^ adapter = gcnew SqlDataAdapter( query,\n        gcnew SqlConnection( L&quot;Integrated Security=SSPI;Persist Security Info=False;&quot;\n        L&quot;Initial Catalog=Northwind;Data Source= localhost&quot; ) );\n    DataTable^ table = gcnew DataTable;\n    adapter-&gt;Fill( table );\n    return table;\n}\n\nLabel^ count;\nint unsharedRowCounter;\nvoid ResetCounter()\n{\n    unsharedRowCounter = 0;\n    count-&gt;Text = unsharedRowCounter.ToString();\n}\n\nvoid dataGridView1_CellToolTipTextNeeded( Object^ /*sender*/,\n    DataGridViewCellToolTipTextNeededEventArgs^ e )\n{\n    if ( theCellImHoveringOver-&gt;ColumnIndex == dataGridView1-&gt;Columns[ L&quot;ReportsTo&quot; ]-&gt;Index &amp;&amp; theCellImHoveringOver-&gt;RowIndex &gt; -1 )\n    {\n        String^ reportsTo = dataGridView1-&gt;Rows[ theCellImHoveringOver-&gt;RowIndex ]-&gt;Cells[ theCellImHoveringOver-&gt;ColumnIndex ]-&gt;Value-&gt;ToString();\n        if ( reportsTo-&gt;Equals( L&quot;&quot; ) )\n        {\n            e-&gt;ToolTipText = L&quot;The buck stops here!&quot;;\n        }\n        else\n        {\n            DataTable^ table = Populate( String::Format( L&quot;select firstname, lastname from employees where employeeid = &#39;{0}&#39;&quot;,\n                dataGridView1-&gt;Rows[ theCellImHoveringOver-&gt;RowIndex ]-&gt;Cells[ theCellImHoveringOver-&gt;ColumnIndex ]-&gt;Value ), false );\n            e-&gt;ToolTipText = String::Format( L&quot;Reports to {0} {1}&quot;, table-&gt;Rows[ 0 ]-&gt;ItemArray[ 0 ], table-&gt;Rows[ 0 ]-&gt;ItemArray[ 1 ] );\n        }\n    }\n}\n\n</code></pre><pre><code class=\"lang-vb\" name=\"System.Windows.Forms.DataGridView_SharedRowScenarios#30\">Private Function Populate(ByVal query As String, ByVal resetUnsharedCounter As Boolean) As DataTable\n\n    If resetUnsharedCounter Then\n        ResetCounter()\n    End If\n\n    &#39; Alter the data source as necessary\n    Dim adapter As New SqlDataAdapter(query, _\n        New SqlConnection(&quot;Integrated Security=SSPI;Persist Security Info=False;&quot; &amp; _\n        &quot;Initial Catalog=Northwind;Data Source=localhost&quot;))\n\n    Dim table As New DataTable()\n    table.Locale = System.Globalization.CultureInfo.InvariantCulture\n    adapter.Fill(table)\n    Return table\nEnd Function\n\nPrivate count As New Label()\nPrivate unsharedRowCounter As Integer\n\nPrivate Sub ResetCounter()\n    unsharedRowCounter = 0\n    count.Text = unsharedRowCounter.ToString()\nEnd Sub\n\nPrivate Sub DataGridView1_CellToolTipTextNeeded(ByVal sender As Object, _\n    ByVal e As DataGridViewCellToolTipTextNeededEventArgs) _\n    Handles dataGridView1.CellToolTipTextNeeded\n\n    If theCellImHoveringOver.ColumnIndex = dataGridView1.Columns(&quot;ReportsTo&quot;).Index AndAlso _\n            theCellImHoveringOver.RowIndex &gt; -1 Then\n\n        Dim reportsTo As String = dataGridView1.Rows(theCellImHoveringOver.RowIndex). _\n            Cells(theCellImHoveringOver.ColumnIndex).Value.ToString()\n        If String.IsNullOrEmpty(reportsTo) Then\n            e.ToolTipText = &quot;The buck stops here!&quot;\n        Else\n            Dim table As DataTable = Populate( _\n                &quot;select firstname, lastname from employees where employeeid = &#39;&quot; &amp; _\n                dataGridView1.Rows(theCellImHoveringOver.RowIndex). _\n                Cells(theCellImHoveringOver.ColumnIndex).Value.ToString() &amp; _\n                &quot;&#39;&quot;, False)\n\n            e.ToolTipText = &quot;Reports to &quot; &amp; table.Rows(0).Item(0).ToString() &amp; &quot; &quot; &amp; table.Rows(0).Item(1).ToString()\n        End If\n    End If\nEnd Sub\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>The <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_CellToolTipTextNeeded\" data-linktype=\"relative-path\">CellToolTipTextNeeded</a> event occurs only when the <a class=\"xref\" href=\"system.windows.forms.datagridview\" data-linktype=\"relative-path\">DataGridView</a> control <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_DataSource_\" data-linktype=\"relative-path\">DataSource</a> property is set or its <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_VirtualMode_\" data-linktype=\"relative-path\">VirtualMode</a> property is <code>true</code>.  </p>\n<p> When you handle the <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_CellToolTipTextNeeded\" data-linktype=\"relative-path\">CellToolTipTextNeeded</a> event, the ToolTip text you specify in the handler is shown whenever the mouse pointer is over a cell and the control <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_ShowCellToolTips_\" data-linktype=\"relative-path\">ShowCellToolTips</a> property value is <code>true</code>. The <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_CellToolTipTextNeeded\" data-linktype=\"relative-path\">CellToolTipTextNeeded</a> event is useful when you want to display ToolTips determined by the current state or value of a cell.  </p>\n<p> The <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_CellToolTipTextNeeded\" data-linktype=\"relative-path\">CellToolTipTextNeeded</a> event also occurs whenever the value of the <a class=\"xref\" href=\"system.windows.forms.datagridviewcell#System_Windows_Forms_DataGridViewCell_ToolTipText_\" data-linktype=\"relative-path\">ToolTipText</a> property is retrieved, either programmatically or when the mouse pointer enters a cell.  </p>\n<p> You can use the <a class=\"xref\" href=\"system.windows.forms.datagridviewcelleventargs#System_Windows_Forms_DataGridViewCellEventArgs_ColumnIndex_\" data-linktype=\"relative-path\">ColumnIndex</a> and <a class=\"xref\" href=\"system.windows.forms.datagridviewcelleventargs#System_Windows_Forms_DataGridViewCellEventArgs_RowIndex_\" data-linktype=\"relative-path\">RowIndex</a> properties to determine the state or value of a cell, and use this information to set the <a class=\"xref\" href=\"system.windows.forms.datagridviewcelltooltiptextneededeventargs#System_Windows_Forms_DataGridViewCellToolTipTextNeededEventArgs_ToolTipText_\" data-linktype=\"relative-path\">ToolTipText</a> property. This property is initialized with the value of the cell <a class=\"xref\" href=\"system.windows.forms.datagridviewcell#System_Windows_Forms_DataGridViewCell_ToolTipText_\" data-linktype=\"relative-path\">ToolTipText</a> property, which the event value overrides.  </p>\n<p> Handle the <a class=\"xref\" href=\"system.windows.forms.datagridview#System_Windows_Forms_DataGridView_CellToolTipTextNeeded\" data-linktype=\"relative-path\">CellToolTipTextNeeded</a> event when working with large amounts of data to avoid the performance penalties of setting the cell <a class=\"xref\" href=\"system.windows.forms.datagridviewcell#System_Windows_Forms_DataGridViewCell_ToolTipText_\" data-linktype=\"relative-path\">ToolTipText</a> value for multiple cells. For more information, see <a href=\"../topic/best%20practices%20for%20scaling%20the%20windows%20forms%20datagridview%20control\" data-linktype=\"relative-path\">Best Practices for Scaling the Windows Forms DataGridView Control</a>.  </p>\n<p> For more information about handling events, see <a href=\"http://msdn.microsoft.com/en-us/01e4f1bc-e55e-413f-98c7-6588493e5f67\" data-linktype=\"external\">NIB: Consuming Events</a>.  </p>\n<p> When you create a DataGridViewCellToolTipTextNeededEventHandler delegate, you identify the method that will handle the event. To associate the event with your event handler, add an instance of the delegate to the event. The event handler is called whenever the event occurs, unless you remove the delegate. For more information about event-handler delegates, see <a href=\"http://msdn.microsoft.com/en-us/d98fd58b-fa4f-4598-8378-addf4355a115\" data-linktype=\"external\">NIB: Events and Delegates</a>.</p>\n\r\n  \r\n  \r\n  \r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler.yml\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler..ctor\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler.Invoke\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler.BeginInvoke\">\r\n<meta name=\"APIName\" content=\"System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler.EndInvoke\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-29 05:54 AM\">\r\n<meta name=\"document_id\" content=\"865d5982-23b8-ad69-9728-b1234039be3e\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Represents the method that will handle the  event of a .\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.windows.forms/toc2.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler.yml","open_to_public_contributors":false,"api_name":["System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler","System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler..ctor","System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler.Invoke","System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler.BeginInvoke","System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler.EndInvoke"],"api_location":[],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler","System::Windows::Forms::DataGridViewCellToolTipTextNeededEventHandler"],"dev_langs":["csharp"],"updated_at":"2017-03-29 05:54 AM","document_id":"865d5982-23b8-ad69-9728-b1234039be3e","content_git_url":"https://github.com/dotnet/docs-internal/blob/master/xml/System.Windows.Forms/DataGridViewCellToolTipTextNeededEventHandler.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"DataGridViewCellToolTipTextNeededEventHandler delegate | Microsoft Docs","_op_ogTitle":"DataGridViewCellToolTipTextNeededEventHandler delegate","description":"Represents the method that will handle the  event of a .\n","toc_asset_id":"api/_splitted/System.Windows.Forms/toc.json","toc_rel":"_splitted/System.Windows.Forms/toc.json","source_url":"","ms.assetid":"System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.datagridviewcelltooltiptextneededeventhandler","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.datagridviewcelltooltiptextneededeventhandler","fileRelativePath":"api/System.Windows.Forms.DataGridViewCellToolTipTextNeededEventHandler.html"},"themesRelativePathToOutputRoot":"_themes/"}