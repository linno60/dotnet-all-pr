{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">XpsImage</span>\r\n    \t\t\t\tClass\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Represents an image in an <a class=\"xref\" href=\"system.windows.xps.packaging.xpsdocument\" data-linktype=\"relative-path\">XpsDocument</a>.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public class XpsImage : System.Windows.Xps.Packaging.XpsResource</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.xps.packaging.xpspartbase\" data-linktype=\"relative-path\">XpsPartBase</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.xps.packaging.xpsresource\" data-linktype=\"relative-path\">XpsResource</a></span></div><span class=\"lang-csharp\">XpsImage</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \t<h3 class=\"accented\">Inherited Members</h3>\r\n  \t<h4 class=\"accented\"></h4>\r\n  \t<div class=\"cdlHolder\">\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.xps.packaging.xpspartbase#System_Windows_Xps_Packaging_XpsPartBase_Uri\" data-linktype=\"relative-path\">Uri</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.xps.packaging.xpsresource#System_Windows_Xps_Packaging_XpsResource_Commit\" data-linktype=\"relative-path\">Commit()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.xps.packaging.xpsresource#System_Windows_Xps_Packaging_XpsResource_GetStream\" data-linktype=\"relative-path\">GetStream()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.xps.packaging.xpsresource#System_Windows_Xps_Packaging_XpsResource_RelativeUri_System_Uri_\" data-linktype=\"relative-path\">RelativeUri(Uri)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.windows.xps.packaging.xpsresource#System_Windows_Xps_Packaging_XpsResource_System_IDisposable_Dispose\" data-linktype=\"relative-path\">IDisposable.Dispose()</a></span></div>\r\n  \t</div>\r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following example shows how to add images to an <a class=\"xref\" href=\"system.windows.xps.packaging.xpsdocument\" data-linktype=\"relative-path\">XpsDocument</a>.  </p>\n<pre><code class=\"lang-cs\" name=\"XpsCreate#XpsCreateAddPageResources\">// -------------------------- AddPageResources ----------------------------\nprivate Dictionary&lt;string, List&lt;XpsResource&gt;&gt;\n        AddPageResources(IXpsFixedPageWriter fixedPageWriter)\n{\n    // Collection of all resources for this page.\n    //   Key: &quot;XpsImage&quot;, &quot;XpsFont&quot;\n    //   Value: List of XpsImage or XpsFont\n    Dictionary&lt;string, List&lt;XpsResource&gt;&gt; resources =\n        new Dictionary&lt;string, List&lt;XpsResource&gt;&gt;();\n\n    // Collections of images and fonts used in the current page.\n    List&lt;XpsResource&gt; xpsImages = new List&lt;XpsResource&gt;();\n    List&lt;XpsResource&gt; xpsFonts  = new List&lt;XpsResource&gt;();\n\n    try\n    {\n        XpsImage xpsImage;\n        XpsFont  xpsFont;\n\n        // Add, Write, and Commit image1 to the current page.\n        xpsImage = fixedPageWriter.AddImage(XpsImageType.JpegImageType);\n        WriteToStream(xpsImage.GetStream(), image1);\n        xpsImage.Commit();\n        xpsImages.Add(xpsImage);    // Add image1 as a required resource.\n\n        // Add, Write, and Commit font 1 to the current page.\n        xpsFont = fixedPageWriter.AddFont();\n        WriteObfuscatedStream(\n            xpsFont.Uri.ToString(), xpsFont.GetStream(), font1);\n        xpsFont.Commit();\n        xpsFonts.Add(xpsFont);      // Add font1 as a required resource.\n\n        // Add, Write, and Commit image2 to the current page.\n        xpsImage = fixedPageWriter.AddImage(XpsImageType.TiffImageType);\n        WriteToStream(xpsImage.GetStream(), image2);\n        xpsImage.Commit();\n        xpsImages.Add(xpsImage);    // Add image2 as a required resource.\n\n        // Add, Write, and Commit font2 to the current page.\n        xpsFont = fixedPageWriter.AddFont(false);\n        WriteToStream(xpsFont.GetStream(), font2);\n        xpsFont.Commit();\n        xpsFonts.Add(xpsFont);      // Add font2 as a required resource.\n\n        // Return the image and font resources in a combined collection.\n        resources.Add(&quot;XpsImage&quot;, xpsImages);\n        resources.Add(&quot;XpsFont&quot;, xpsFonts);\n        return resources;\n    }\n    catch (XpsPackagingException xpsException)\n    {\n        throw xpsException;\n    }\n}// end:AddPageResources()\n</code></pre><pre><code class=\"lang-cpp\" name=\"XpsCreate#XpsCreateAddPageResources\">// -------------------------- AddPageResources ----------------------------\nDictionary&lt;System::String^,List&lt;XpsResource^&gt;^&gt;^ AddPageResources (IXpsFixedPageWriter^ fixedPageWriter) \n{\n   // Collection of all resources for this page.\n   //   Key: &quot;XpsImage&quot;, &quot;XpsFont&quot;\n   //   Value: List of XpsImage or XpsFont\n   Dictionary&lt;System::String^,List&lt;XpsResource^&gt;^&gt;^ resources = gcnew Dictionary&lt;System::String^,List&lt;XpsResource^&gt;^&gt;();\n\n   // Collections of images and fonts used in the current page.\n   List&lt;XpsResource^&gt;^ xpsImages = gcnew List&lt;XpsResource^&gt;();\n   List&lt;XpsResource^&gt;^ xpsFonts = gcnew List&lt;XpsResource^&gt;();\n\n   try\n   {\n      XpsImage^ xpsImage;\n      XpsFont^ xpsFont;\n\n      // Add, Write, and Commit image1 to the current page.\n      xpsImage = fixedPageWriter-&gt;AddImage(XpsImageType::JpegImageType);\n      WriteToStream(xpsImage-&gt;GetStream(), image1);\n      xpsImage-&gt;Commit();\n      xpsImages-&gt;Add(xpsImage);    // Add image1 as a required resource.\n\n      // Add, Write, and Commit font 1 to the current page.\n      xpsFont = fixedPageWriter-&gt;AddFont();\n      WriteObfuscatedStream(xpsFont-&gt;Uri-&gt;ToString(), xpsFont-&gt;GetStream(), font1);\n      xpsFont-&gt;Commit();\n      xpsFonts-&gt;Add(xpsFont);      // Add font1 as a required resource.\n\n      // Add, Write, and Commit image2 to the current page.\n      xpsImage = fixedPageWriter-&gt;AddImage(XpsImageType::TiffImageType);\n      WriteToStream(xpsImage-&gt;GetStream(), image2);\n      xpsImage-&gt;Commit();\n      xpsImages-&gt;Add(xpsImage);    // Add image2 as a required resource.\n\n      // Add, Write, and Commit font2 to the current page.\n      xpsFont = fixedPageWriter-&gt;AddFont(false);\n      WriteToStream(xpsFont-&gt;GetStream(), font2);\n      xpsFont-&gt;Commit();\n      xpsFonts-&gt;Add(xpsFont);      // Add font2 as a required resource.\n\n      // Return the image and font resources in a combined collection.\n      resources-&gt;Add(&quot;XpsImage&quot;, xpsImages);\n      resources-&gt;Add(&quot;XpsFont&quot;, xpsFonts);\n      return resources;\n   } catch (XpsPackagingException^ xpsException)\n   {\n      throw xpsException;\n\n   } \n};// end:AddPageResources()\n</code></pre><pre><code class=\"lang-vb\" name=\"XpsCreate#XpsCreateAddPageResources\">&#39; -------------------------- AddPageResources ----------------------------\nPrivate Function AddPageResources(ByVal fixedPageWriter As IXpsFixedPageWriter) As Dictionary(Of String, List(Of XpsResource))\n    &#39; Collection of all resources for this page.\n    &#39;   Key: &quot;XpsImage&quot;, &quot;XpsFont&quot;\n    &#39;   Value: List of XpsImage or XpsFont\n    Dim resources As New Dictionary(Of String, List(Of XpsResource))()\n\n    &#39; Collections of images and fonts used in the current page.\n    Dim xpsImages As New List(Of XpsResource)()\n    Dim xpsFonts As New List(Of XpsResource)()\n\n    Try\n        Dim xpsImage As XpsImage\n        Dim xpsFont As XpsFont\n\n        &#39; Add, Write, and Commit image1 to the current page.\n        xpsImage = fixedPageWriter.AddImage(XpsImageType.JpegImageType)\n        WriteToStream(xpsImage.GetStream(), image1)\n        xpsImage.Commit()\n        xpsImages.Add(xpsImage) &#39; Add image1 as a required resource.\n\n        &#39; Add, Write, and Commit font 1 to the current page.\n        xpsFont = fixedPageWriter.AddFont()\n        WriteObfuscatedStream(xpsFont.Uri.ToString(), xpsFont.GetStream(), font1)\n        xpsFont.Commit()\n        xpsFonts.Add(xpsFont) &#39; Add font1 as a required resource.\n\n        &#39; Add, Write, and Commit image2 to the current page.\n        xpsImage = fixedPageWriter.AddImage(XpsImageType.TiffImageType)\n        WriteToStream(xpsImage.GetStream(), image2)\n        xpsImage.Commit()\n        xpsImages.Add(xpsImage) &#39; Add image2 as a required resource.\n\n        &#39; Add, Write, and Commit font2 to the current page.\n        xpsFont = fixedPageWriter.AddFont(False)\n        WriteToStream(xpsFont.GetStream(), font2)\n        xpsFont.Commit()\n        xpsFonts.Add(xpsFont) &#39; Add font2 as a required resource.\n\n        &#39; Return the image and font resources in a combined collection.\n        resources.Add(&quot;XpsImage&quot;, xpsImages)\n        resources.Add(&quot;XpsFont&quot;, xpsFonts)\n        Return resources\n    Catch xpsException As XpsPackagingException\n        Throw xpsException\n    End Try\nEnd Function &#39; end:AddPageResources()\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>The XpsImage class has no public constructor.  </p>\n<p> Use the <a class=\"xref\" href=\"system.windows.xps.packaging.ixpsfixedpagewriter#System_Windows_Xps_Packaging_IXpsFixedPageWriter_AddImage_\" data-linktype=\"relative-path\">AddImage</a> method to add an image and obtain a reference to it in a new document.  </p>\n<p> Use the <a class=\"xref\" href=\"system.windows.xps.packaging.ixpsfixedpagereader#System_Windows_Xps_Packaging_IXpsFixedPageReader_GetImage_\" data-linktype=\"relative-path\">GetImage</a> method to obtain an image reference in an existing document.  </p>\n<p> Based on settings of <a class=\"xref\" href=\"system.windows.xps.serialization.xpsserializationmanager\" data-linktype=\"relative-path\">XpsSerializationManager</a> and <a class=\"xref\" href=\"system.windows.xps.serialization.xpspackagingpolicy\" data-linktype=\"relative-path\">XpsPackagingPolicy</a>, such as <a class=\"xref\" href=\"system.windows.xps.serialization.fontsubsettercommitpolicies\" data-linktype=\"relative-path\">FontSubsetterCommitPolicies</a> and <a class=\"xref\" href=\"system.windows.xps.packaging.packageinterleavingorder\" data-linktype=\"relative-path\">PackageInterleavingOrder</a>, the flush operation of the <a class=\"xref\" href=\"system.windows.xps.packaging.xpsresource#System_Windows_Xps_Packaging_XpsResource_Commit_\" data-linktype=\"relative-path\">Commit</a> method of the XpsImage class may be delayed until the complete <a class=\"xref\" href=\"system.windows.xps.packaging.xpsdocument\" data-linktype=\"relative-path\">XpsDocument</a> is closed.</p>\n\r\n  \r\n  \r\n  \r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc1.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.Windows.Xps.Packaging.XpsImage.yml\">\r\n<meta name=\"APIName\" content=\"System.Windows.Xps.Packaging.XpsImage\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-31 02:21 PM\">\r\n<meta name=\"document_id\" content=\"b3fd40d9-03a7-23b7-8cc5-7be8b30ae39d\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Represents an image in an .\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.windows.xps.packaging/toc1.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.Windows.Xps.Packaging.XpsImage\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.Windows.Xps.Packaging.XpsImage.yml","open_to_public_contributors":false,"api_name":["System.Windows.Xps.Packaging.XpsImage"],"api_location":[],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.Windows.Xps.Packaging.XpsImage","System::Windows::Xps::Packaging::XpsImage"],"dev_langs":["csharp"],"updated_at":"2017-03-31 02:21 PM","document_id":"b3fd40d9-03a7-23b7-8cc5-7be8b30ae39d","content_git_url":"https://github.com/dotnet/docs-internal/blob/master/xml/System.Windows.Xps.Packaging/XpsImage.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"XpsImage class | Microsoft Docs","_op_ogTitle":"XpsImage class","description":"Represents an image in an .\n","toc_asset_id":"api/_splitted/System.Windows.Xps.Packaging/toc.json","toc_rel":"_splitted/System.Windows.Xps.Packaging/toc.json","source_url":"","ms.assetid":"System.Windows.Xps.Packaging.XpsImage","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.windows.xps.packaging.xpsimage","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.windows.xps.packaging.xpsimage","fileRelativePath":"api/System.Windows.Xps.Packaging.XpsImage.html"},"themesRelativePathToOutputRoot":"_themes/"}