{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">XPathMessageQueryCollection</span>\r\n    \t\t\t\tClass\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Contains a collection of <a class=\"xref\" href=\"system.servicemodel.xpathmessagequery\" data-linktype=\"relative-path\">XPathMessageQuery</a> objects.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public class XPathMessageQueryCollection : System.ServiceModel.Dispatcher.MessageQueryCollection</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \t<dl class=\"attributeList stack\">\r\n  \t\t<dt>Inheritance</dt><dd>\r\n  \t\t<div class=\"pdlHolder\">\r\n  \t\t<div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object\" data-linktype=\"relative-path\">Object</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1\" data-linktype=\"relative-path\">Collection&lt;T&gt;</a></span></div><div class=\"pdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.dispatcher.messagequerycollection\" data-linktype=\"relative-path\">MessageQueryCollection</a></span></div><span class=\"lang-csharp\">XPathMessageQueryCollection</span>\r\n  \t\t</div>\r\n  \t\t</dd>\r\n  \t</dl>\r\n  \r\n  \r\n  \r\n  \r\n  \t<h3 class=\"accented\">Inherited Members</h3>\r\n  \t<h4 class=\"accented\"></h4>\r\n  \t<div class=\"cdlHolder\">\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_Add__0_\" data-linktype=\"relative-path\">Add(T)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_Clear\" data-linktype=\"relative-path\">Clear()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_ClearItems\" data-linktype=\"relative-path\">ClearItems()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_Contains__0_\" data-linktype=\"relative-path\">Contains(T)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_CopyTo__0___System_Int32_\" data-linktype=\"relative-path\">CopyTo(T[], Int32)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_Count\" data-linktype=\"relative-path\">Count</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_GetEnumerator\" data-linktype=\"relative-path\">GetEnumerator()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_IndexOf__0_\" data-linktype=\"relative-path\">IndexOf(T)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_Insert_System_Int32__0_\" data-linktype=\"relative-path\">Insert(Int32, T)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_InsertItem_System_Int32__0_\" data-linktype=\"relative-path\">InsertItem(Int32, T)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_Item_System_Int32_\" data-linktype=\"relative-path\">Item(Int32)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_Items\" data-linktype=\"relative-path\">Items</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_Remove__0_\" data-linktype=\"relative-path\">Remove(T)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_RemoveAt_System_Int32_\" data-linktype=\"relative-path\">RemoveAt(Int32)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_SetItem_System_Int32__0_\" data-linktype=\"relative-path\">SetItem(Int32, T)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_Generic_ICollection_T__IsReadOnly\" data-linktype=\"relative-path\">ICollection&lt;T&gt;.IsReadOnly</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_ICollection_CopyTo_System_Array_System_Int32_\" data-linktype=\"relative-path\">ICollection.CopyTo(Array, Int32)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_ICollection_IsSynchronized\" data-linktype=\"relative-path\">ICollection.IsSynchronized</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_ICollection_SyncRoot\" data-linktype=\"relative-path\">ICollection.SyncRoot</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_IEnumerable_GetEnumerator\" data-linktype=\"relative-path\">IEnumerable.GetEnumerator()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_IList_Add_System_Object_\" data-linktype=\"relative-path\">IList.Add(Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_IList_Contains_System_Object_\" data-linktype=\"relative-path\">IList.Contains(Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_IList_IndexOf_System_Object_\" data-linktype=\"relative-path\">IList.IndexOf(Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_IList_Insert_System_Int32_System_Object_\" data-linktype=\"relative-path\">IList.Insert(Int32, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_IList_IsFixedSize\" data-linktype=\"relative-path\">IList.IsFixedSize</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_IList_IsReadOnly\" data-linktype=\"relative-path\">IList.IsReadOnly</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_IList_Item_System_Int32_\" data-linktype=\"relative-path\">IList.Item(Int32)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.objectmodel.collection-1#System_Collections_ObjectModel_Collection_1_System_Collections_IList_Remove_System_Object_\" data-linktype=\"relative-path\">IList.Remove(Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_\" data-linktype=\"relative-path\">Equals(Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_Equals_System_Object_System_Object_\" data-linktype=\"relative-path\">Equals(Object, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetHashCode\" data-linktype=\"relative-path\">GetHashCode()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_GetType\" data-linktype=\"relative-path\">GetType()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_MemberwiseClone\" data-linktype=\"relative-path\">MemberwiseClone()</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ReferenceEquals_System_Object_System_Object_\" data-linktype=\"relative-path\">ReferenceEquals(Object, Object)</a></span></div>\r\n  \t\t\t<div class=\"cdl\"><span class=\"lang-csharp\"><a class=\"xref\" href=\"system.object#System_Object_ToString\" data-linktype=\"relative-path\">ToString()</a></span></div>\r\n  \t</div>\r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following example creates a message and XPath message queries. The queries are evaluated by the <a class=\"xref\" href=\"system.servicemodel.xpathmessagequery\" data-linktype=\"relative-path\">XPathMessageQuery</a> objects contained in an XPathMessageQueryCollection object. The results of each query are tested using the <a class=\"xref\" href=\"system.servicemodel.dispatcher.xpathresult#System_ServiceModel_Dispatcher_XPathResult_ResultType_\" data-linktype=\"relative-path\">ResultType</a> property of the <a class=\"xref\" href=\"system.servicemodel.dispatcher.xpathresult\" data-linktype=\"relative-path\">XPathResult</a> class.  </p>\n<pre><code class=\"lang-vb\" name=\"XPathMessageQuery#0\">Imports System.IO\nImports System.Xml\nImports System.ServiceModel.Dispatcher\nImports System.ServiceModel\nImports System.ServiceModel.Channels\nImports System.Xml.XPath\n\nNamespace MessageQueryExamples\n\n\n    Public Class Program\n\n        Public Shared Sub Main(ByVal args As String())\n\n            &#39; The XPathMessageQueryCollection inherits from MessageQueryCollection.\n            Dim queryCollection As XPathMessageQueryCollection = MessageHelper.SetupQueryCollection()\n\n\n            &#39; Create a message and a copy of the message. You must create a buffered copy to access the message body.\n            Dim mess As Message = MessageHelper.CreateMessage()\n            Dim mb As MessageBuffer = mess.CreateBufferedCopy(Integer.MaxValue)\n\n\n            &#39; Evaluate every query in the collection. \n            Dim q As XPathMessageQuery\n            For Each q In queryCollection\n\n                &#39; Evaluate the query. Note the result type is an XPathResult.\n                Dim qPathResult As XPathResult = q.Evaluate(Of XPathResult)(mb)\n\n                &#39; Use the XPathResult to determine the result type.\n                Console.WriteLine(&quot;Result type: {0}&quot;, qPathResult.ResultType)\n\n                &#39; The following code prints the result according to the result type.\n\n                If qPathResult.ResultType = XPathResultType.String Then\n                    Console.WriteLine(&quot;{0} = {1}&quot;, q.Expression, qPathResult.GetResultAsString())\n                End If\n                If (qPathResult.ResultType = XPathResultType.NodeSet) Then\n\n                    &#39; Iterate through the node set.\n                    Dim ns As XPathNodeIterator = qPathResult.GetResultAsNodeset()\n                    Dim n As XPathNavigator\n                    For Each n In ns\n                        Console.WriteLine(&quot;     {0} = {1}&quot;, q.Expression, n.Value)\n                    Next\n                End If\n                If qPathResult.ResultType = XPathResultType.Number Then\n                    Console.WriteLine(&quot;    {0} = {1}&quot;, q.Expression, qPathResult.GetResultAsNumber())\n                End If\n                If qPathResult.ResultType = XPathResultType.Boolean Then\n                    Console.WriteLine(&quot;    {0} ={1}&quot;, q.Expression, qPathResult.GetResultAsBoolean())\n                End If\n\n                If qPathResult.ResultType = XPathResultType.Error Then\n                    Console.WriteLine(&quot;    Error!&quot;)\n                End If\n\n            Next\n\n            Console.WriteLine()\n\n            &#39; The alternate code below demonstrates similar funcionality using a MessageQueryTable.\n            &#39; The difference is the KeyValuePair that requires a key to index each value.\n            &#39; The code uses the expression as the key, and an arbitrary value for the value.           \n\n            &#39;Dim mq As MessageQueryTable(Of String) = MessageHelper.SetupTable()\n            &#39;Dim kv As KeyValuePair(Of MessageQuery, String)\n            &#39;For Each kv In mq\n            &#39;    &#39;\n            &#39;    Dim xp As XPathMessageQuery = CType(kv.Key, XPathMessageQuery)\n            &#39;    Console.WriteLine(&quot;Value = {0}&quot;, kv.Value)\n            &#39;    Console.WriteLine(&quot;{0} = {1}&quot;, xp.Expression, xp.Evaluate(Of String)(mb))\n            &#39;Next\n\n            Console.ReadLine()\n        End Sub\n        Private Shared Sub Evaluate(ByVal p1 As Object)\n            Throw New NotImplementedException\n        End Sub\n    End Class\n\n    Public Class MessageHelper\n\n        Shared messageBody As String = _\n              &quot;&lt;PurchaseOrder date=&#39;today&#39;&gt;&quot; + _\n                  &quot;&lt;Number&gt;ABC-2009-XYZ&lt;/Number&gt;&quot; + _\n                  &quot;&lt;Department&gt;OnlineSales&lt;/Department&gt;&quot; + _\n                  &quot;&lt;Items&gt;&quot; + _\n                      &quot;&lt;Item product=&#39;nail&#39; quantity=&#39;1&#39;&gt;item1&lt;/Item&gt;&quot; + _\n                      &quot;&lt;Item product=&#39;screw&#39; quantity=&#39;2&#39;&gt;item2&lt;/Item&gt;&quot; + _\n                      &quot;&lt;Item product=&#39;brad&#39; quantity=&#39;3&#39;&gt;&quot; + _\n                          &quot;&lt;SpecialOffer/&gt;&quot; + _\n                          &quot;Special item4&quot; + _\n                      &quot;&lt;/Item&gt;&quot; + _\n                      &quot;&lt;Item product=&#39;SpecialNails&#39; quantity=&#39;9&#39;&gt;item5&lt;/Item&gt;&quot; + _\n                      &quot;&lt;Item product=&#39;SpecialBrads&#39; quantity=&#39;11&#39;&gt;&quot; + _\n                          &quot;&lt;SpecialOffer/&gt;&quot; + _\n                          &quot;Special item6&quot; + _\n                      &quot;&lt;/Item&gt;&quot; + _\n                      &quot;&lt;Item product=&#39;hammer&#39; quantity=&#39;1&#39;&gt;item7&lt;/Item&gt;&quot; + _\n                      &quot;&lt;Item product=&#39;wrench&#39; quantity=&#39;2&#39;&gt;item8&lt;/Item&gt;&quot; + _\n                  &quot;&lt;/Items&gt;&quot; + _\n                &quot;&lt;Comments&gt;&quot; + _\n                &quot;Rush order&quot; + _\n                &quot;&lt;/Comments&gt;&quot; + _\n              &quot;&lt;/PurchaseOrder&gt;&quot;\n\n        Public Shared xpath As String = &quot;/s12:Envelope/s12:Body/PurchaseOrder/Items/Item[@quantity = 1]&quot;\n        Public Shared xpath2 As String = &quot;/s12:Envelope/s12:Body/PurchaseOrder/Items/Item[@product = &#39;nail&#39;]&quot;\n        Public Shared xpath3 As String = &quot;/s12:Envelope/s12:Body/PurchaseOrder/Comments&quot;\n        Public Shared xpath4 As String = &quot;count(/s12:Envelope/s12:Body/PurchaseOrder/Items/Item)&quot;\n        Public Shared xpath5 As String = &quot;substring(string(/s12:Envelope/s12:Body/PurchaseOrder/Number),5,4)&quot;\n        Public Shared xpath6 As String = &quot;/s12:Envelope/s12:Body/PurchaseOrder/Department=&#39;OnlineSales&#39;&quot;\n        Public Shared xpath7 As String = &quot;//PurchaseOrder/@date&quot;\n        Public Shared xpath8 As String = &quot;//SpecialOffer/ancestor::Item[@product = &#39;brad&#39;]&quot;\n\n        &#39; Invoke the correlation data function.\n\n\n        Public Shared xpath9 As String = &quot;sm:correlation-data(&#39;CorrelationData1&#39;)&quot;\n        Public Shared xpath10 As String = &quot;sm:correlation-data(&#39;CorrelationData2&#39;)&quot;\n\n        Public Shared xpath11 As String = &quot;/s12:Envelope/s12:Body/PurchaseOrder/Items/Item[@quantity = 2]&quot;\n\n\n        Public Shared Function CreateMessage() As Message\n\n            Dim stringReader As New StringReader(messageBody)\n            Dim xmlReader As New XmlTextReader(stringReader)\n            Dim message As Message = message.CreateMessage( _\n                MessageVersion.Soap12WSAddressing10, &quot;http://purchaseorder&quot;, xmlReader)\n\n            &#39; Add two correlation properties using lambda expressions. The property names are\n            &#39; CorrelationData1 and CorrelationData2. The first goes to &quot;value1&quot; and the\n            &#39; second to &quot;value2&quot;. You can use your own property names and values.\n            Dim data As New CorrelationDataMessageProperty()\n\n            data.Add(&quot;CorrelationData1&quot;, Function() &quot;value1&quot;)\n            data.Add(&quot;CorrelationData2&quot;, Function() &quot;value2&quot;)\n            message.Properties(CorrelationDataMessageProperty.Name) = data\n\n\n            Return message\n        End Function\n\n\n        Public Shared Function SetupQueryCollection() As XPathMessageQueryCollection\n\n            &#39; Create the query collection and add the XPath queries to it. To create\n            &#39; the query, you must also use a new XPathMessageContext.\n\n            Dim queryCollection As New XPathMessageQueryCollection()\n\n            Dim context As XPathMessageContext = New XPathMessageContext()\n            queryCollection.Add(New XPathMessageQuery(xpath, context))\n            queryCollection.Add(New XPathMessageQuery(xpath2, context))\n            queryCollection.Add(New XPathMessageQuery(xpath3, context))\n            queryCollection.Add(New XPathMessageQuery(xpath4, context))\n            queryCollection.Add(New XPathMessageQuery(xpath5, context))\n            queryCollection.Add(New XPathMessageQuery(xpath6, context))\n            queryCollection.Add(New XPathMessageQuery(xpath7, context))\n            queryCollection.Add(New XPathMessageQuery(xpath8, context))\n            queryCollection.Add(New XPathMessageQuery(xpath9, context))\n            queryCollection.Add(New XPathMessageQuery(xpath10, context))\n            queryCollection.Add(New XPathMessageQuery(xpath11, context))\n\n            Return queryCollection\n        End Function\n\n        Public Shared Function SetupTable() As MessageQueryTable(Of String)\n\n            &#39; This is optional code to demonstrate using a MessageQueryTable.\n            &#39; Compare this to the MessageQueryCollection.\n            Dim table As MessageQueryTable(Of String) = New MessageQueryTable(Of String)()\n            Dim context As XPathMessageContext = New XPathMessageContext()\n\n\n            &#39; The code adds a KeyValuePair to the table. Each pair requires\n            &#39; a query used as the Key, and a value that is paired to the key.\n            table.Add(New XPathMessageQuery(xpath, context), &quot;value10&quot;)\n            table.Add(New XPathMessageQuery(xpath2, context), &quot;value20&quot;)\n            table.Add(New XPathMessageQuery(xpath3, context), &quot;value30&quot;)\n            table.Add(New XPathMessageQuery(xpath4, context), &quot;value40&quot;)\n            table.Add(New XPathMessageQuery(xpath5, context), &quot;value50&quot;)\n            table.Add(New XPathMessageQuery(xpath6, context), &quot;value60&quot;)\n            table.Add(New XPathMessageQuery(xpath7, context), &quot;value70&quot;)\n            table.Add(New XPathMessageQuery(xpath8, context), &quot;value80&quot;)\n            table.Add(New XPathMessageQuery(xpath9, context), &quot;value90&quot;)\n            table.Add(New XPathMessageQuery(xpath10, context), &quot;value100&quot;)\n            table.Add(New XPathMessageQuery(xpath11, context), &quot;value110&quot;)\n            Return table\n        End Function\n    End Class\nEnd Namespace\n</code></pre><pre><code class=\"lang-cs\" name=\"XPathMessageQuery#0\">using System;\nusing System.IO;\nusing System.Xml;\nusing System.ServiceModel.Dispatcher;\nusing System.ServiceModel;\nusing System.ServiceModel.Channels;\nusing System.Xml.XPath;\n\nnamespace MessageQueryExamples\n{\n    \n    class Program\n    {\n        static void Main(string[] args)\n        {\n            // The XPathMessageQueryCollection inherits from MessageQueryCollection.\n            XPathMessageQueryCollection queryCollection = MessageHelper.SetupQueryCollection();\n\n\n            // Create a message and a copy of the message. You must create a buffered copy to access the message body.\n            Message mess = MessageHelper.CreateMessage();\n            MessageBuffer mb = mess.CreateBufferedCopy(int.MaxValue);\n\n\n            // Evaluate every query in the collection. \n            foreach (XPathMessageQuery q in queryCollection)\n            {\n                // Evaluate the query. Note the result type is an XPathResult.\n                XPathResult qPathResult = q.Evaluate&lt;XPathResult&gt;(mb);\n\n                // Use the XPathResult to determine the result type.\n                Console.WriteLine(&quot;Result type: {0}&quot;, qPathResult.ResultType);\n\n                // The following code prints the result according to the result type.\n\n                if (qPathResult.ResultType == XPathResultType.String)\n                    Console.WriteLine(&quot;{0} = {1}&quot;, q.Expression, qPathResult.GetResultAsString());\n\n                if (qPathResult.ResultType == XPathResultType.NodeSet)\n                {\n                    // Iterate through the node set.\n                    XPathNodeIterator ns = qPathResult.GetResultAsNodeset();\n                    foreach (XPathNavigator n in ns)\n                        Console.WriteLine(&quot;\\t{0} = {1}&quot;, q.Expression, n.Value);\n                }\n                if (qPathResult.ResultType == XPathResultType.Number)\n                    Console.WriteLine(&quot;\\t{0} = {1}&quot;, q.Expression, qPathResult.GetResultAsNumber());\n\n                if (qPathResult.ResultType == XPathResultType.Boolean)\n                    Console.WriteLine(&quot;\\t{0} ={1}&quot;, q.Expression, qPathResult.GetResultAsBoolean());\n\n                if (qPathResult.ResultType == XPathResultType.Error)\n                    Console.WriteLine(&quot;\\tError!&quot;);\n            }\n\n            Console.WriteLine();\n\n            // The alternate code below demonstrates similar funcionality using a MessageQueryTable.\n            // The difference is the KeyValuePair that requires a key to index each value.\n            // The code uses the expression as the key, and an arbitrary value for the value.           \n\n            //MessageQueryTable&lt;string&gt; mq = MessageHelper.SetupTable();\n            //foreach (KeyValuePair&lt;MessageQuery, string&gt; kv in mq)\n            //{\n            //    XPathMessageQuery xp = (XPathMessageQuery)kv.Key;\n            //    Console.WriteLine(&quot;Value = {0}&quot;, kv.Value);\n            //    Console.WriteLine(&quot;{0} = {1}&quot;, xp.Expression, xp.Evaluate&lt;string&gt;(mb));\n            //}\n\n            Console.ReadLine();\n        }\n    }\n\n    public class MessageHelper\n    {\n        static string messageBody =\n              &quot;&lt;PurchaseOrder date=&#39;today&#39;&gt;&quot; +\n                  &quot;&lt;Number&gt;ABC-2009-XYZ&lt;/Number&gt;&quot; +\n                  &quot;&lt;Department&gt;OnlineSales&lt;/Department&gt;&quot; +\n                  &quot;&lt;Items&gt;&quot; +\n                      &quot;&lt;Item product=&#39;nail&#39; quantity=&#39;1&#39;&gt;item1&lt;/Item&gt;&quot; +\n                      &quot;&lt;Item product=&#39;screw&#39; quantity=&#39;2&#39;&gt;item2&lt;/Item&gt;&quot; +\n                      &quot;&lt;Item product=&#39;brad&#39; quantity=&#39;3&#39;&gt;&quot; +\n                          &quot;&lt;SpecialOffer/&gt;&quot; +\n                          &quot;Special item4&quot; +\n                      &quot;&lt;/Item&gt;&quot; +\n                      &quot;&lt;Item product=&#39;SpecialNails&#39; quantity=&#39;9&#39;&gt;item5&lt;/Item&gt;&quot; +\n                      &quot;&lt;Item product=&#39;SpecialBrads&#39; quantity=&#39;11&#39;&gt;&quot; +\n                          &quot;&lt;SpecialOffer/&gt;&quot; +\n                          &quot;Special item6&quot; +\n                      &quot;&lt;/Item&gt;&quot; +\n                      &quot;&lt;Item product=&#39;hammer&#39; quantity=&#39;1&#39;&gt;item7&lt;/Item&gt;&quot; +\n                      &quot;&lt;Item product=&#39;wrench&#39; quantity=&#39;2&#39;&gt;item8&lt;/Item&gt;&quot; +\n                  &quot;&lt;/Items&gt;&quot; +\n                &quot;&lt;Comments&gt;&quot; +\n                &quot;Rush order&quot; +\n                &quot;&lt;/Comments&gt;&quot; +\n              &quot;&lt;/PurchaseOrder&gt;&quot;;\n\n        public static string xpath = &quot;/s12:Envelope/s12:Body/PurchaseOrder/Items/Item[@quantity = 1]&quot;;\n        public static string xpath2 = &quot;/s12:Envelope/s12:Body/PurchaseOrder/Items/Item[@product = &#39;nail&#39;]&quot;;\n        public static string xpath3 = &quot;/s12:Envelope/s12:Body/PurchaseOrder/Comments&quot;;\n        public static string xpath4 = &quot;count(/s12:Envelope/s12:Body/PurchaseOrder/Items/Item)&quot;;\n        public static string xpath5 = &quot;substring(string(/s12:Envelope/s12:Body/PurchaseOrder/Number),5,4)&quot;;\n        public static string xpath6 = &quot;/s12:Envelope/s12:Body/PurchaseOrder/Department=&#39;OnlineSales&#39;&quot;;\n        public static string xpath7 = &quot;//PurchaseOrder/@date&quot;;\n        public static string xpath8 = &quot;//SpecialOffer/ancestor::Item[@product = &#39;brad&#39;]&quot;;\n\n        // Invoke the correlation data function.\n\n\n        public static string xpath9 = &quot;sm:correlation-data(&#39;CorrelationData1&#39;)&quot;;\n        public static string xpath10 = &quot;sm:correlation-data(&#39;CorrelationData2&#39;)&quot;;\n\n        public static string xpath11 = &quot;/s12:Envelope/s12:Body/PurchaseOrder/Items/Item[@quantity = 2]&quot;;\n\n\n        public static Message CreateMessage()\n        {\n            StringReader stringReader = new StringReader(messageBody);\n            XmlTextReader xmlReader = new XmlTextReader(stringReader);\n            Message message = Message.CreateMessage(MessageVersion.Soap12WSAddressing10, &quot;http://purchaseorder&quot;, xmlReader);\n\n            // Add two correlation properties using lambda expressions. The property names are\n            // CorrelationData1 and CorrelationData2. The first goes to &quot;value1&quot; and the\n            // second to &quot;value2&quot;. You can use your own property names and values.\n            CorrelationDataMessageProperty data = new CorrelationDataMessageProperty();\n\n            data.Add(&quot;CorrelationData1&quot;, () =&gt; &quot;value1&quot;);\n            data.Add(&quot;CorrelationData2&quot;, () =&gt; &quot;value2&quot;);\n            message.Properties[CorrelationDataMessageProperty.Name] = data;\n\n            return message;\n        }\n\n\n\n        public static XPathMessageQueryCollection SetupQueryCollection()\n        {\n            // Create the query collection and add the XPath queries to it. To create\n            // the query, you must also use a new XPathMessageContext.\n\n            XPathMessageQueryCollection queryCollection = new XPathMessageQueryCollection();\n\n            XPathMessageContext context = new XPathMessageContext();\n            queryCollection.Add(new XPathMessageQuery(xpath, context));\n            queryCollection.Add(new XPathMessageQuery(xpath2, context));\n            queryCollection.Add(new XPathMessageQuery(xpath3, context));\n            queryCollection.Add(new XPathMessageQuery(xpath4, context));\n            queryCollection.Add(new XPathMessageQuery(xpath5, context));\n            queryCollection.Add(new XPathMessageQuery(xpath6, context));\n            queryCollection.Add(new XPathMessageQuery(xpath7, context));\n            queryCollection.Add(new XPathMessageQuery(xpath8, context));\n            queryCollection.Add(new XPathMessageQuery(xpath9, context));\n            queryCollection.Add(new XPathMessageQuery(xpath10, context));\n            queryCollection.Add(new XPathMessageQuery(xpath11, context));\n\n            return queryCollection;\n        }\n\n        public static MessageQueryTable&lt;string&gt; SetupTable()\n        {\n            // This is optional code to demonstrate using a MessageQueryTable.\n            // Compare this to the MessageQueryCollection.\n            MessageQueryTable&lt;string&gt; table = new MessageQueryTable&lt;string&gt;();\n            XPathMessageContext context = new XPathMessageContext();\n\n\n            // The code adds a KeyValuePair to the table. Each pair requires\n            // a query used as the Key, and a value that is paired to the key.\n            table.Add(new XPathMessageQuery(xpath, context), &quot;value10&quot;);\n            table.Add(new XPathMessageQuery(xpath2, context), &quot;value20&quot;);\n            table.Add(new XPathMessageQuery(xpath3, context), &quot;value30&quot;);\n            table.Add(new XPathMessageQuery(xpath4, context), &quot;value40&quot;);\n            table.Add(new XPathMessageQuery(xpath5, context), &quot;value50&quot;);\n            table.Add(new XPathMessageQuery(xpath6, context), &quot;value60&quot;);\n            table.Add(new XPathMessageQuery(xpath7, context), &quot;value70&quot;);\n            table.Add(new XPathMessageQuery(xpath8, context), &quot;value80&quot;);\n            table.Add(new XPathMessageQuery(xpath9, context), &quot;value90&quot;);\n            table.Add(new XPathMessageQuery(xpath10, context), &quot;value100&quot;);\n            table.Add(new XPathMessageQuery(xpath11, context), &quot;value110&quot;);\n            return table;\n        }\n    }    \n}\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>For more information about message queries, see the <a class=\"xref\" href=\"system.servicemodel.dispatcher.messagequery\" data-linktype=\"relative-path\">MessageQuery</a> and <a class=\"xref\" href=\"system.servicemodel.dispatcher.messagequerycollection\" data-linktype=\"relative-path\">MessageQueryCollection</a> classes.</p>\n\r\n  \r\n  \r\n  \t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Constructors\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceModel_Dispatcher_XPathMessageQueryCollection__ctor\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">XPathMessageQueryCollection()</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Initializes a new instance of the <a class=\"xref\" href=\"system.servicemodel.dispatcher.xpathmessagequerycollection\" data-linktype=\"relative-path\">XPathMessageQueryCollection</a> class.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public XPathMessageQueryCollection ();</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t</section>\t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Methods\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceModel_Dispatcher_XPathMessageQueryCollection_Evaluate__1_System_ServiceModel_Channels_Message_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Evaluate&lt;TResult&gt;(Message)</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Runs a query against the message. The body cannot be queried.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public override System.Collections.Generic.IEnumerable&lt;System.Collections.Generic.KeyValuePair&lt;System.ServiceModel.Dispatcher.MessageQuery,TResult&gt;&gt; Evaluate&lt;TResult&gt; (System.ServiceModel.Channels.Message message);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Parameters</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>message</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.channels.message\" data-linktype=\"relative-path\">Message</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The message to query.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Returns</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.generic.ienumerable-1\" data-linktype=\"relative-path\">IEnumerable</a>&lt;<a class=\"xref\" href=\"system.collections.generic.keyvaluepair-2\" data-linktype=\"relative-path\">KeyValuePair</a>&lt;<a class=\"xref\" href=\"system.servicemodel.dispatcher.messagequery\" data-linktype=\"relative-path\">MessageQuery</a>,<span class=\"xref\">TResult</span>&gt;&gt;</span>\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t<span class=\"xref\">stem.Collections.Generic.IEnumerable`1</span>  \n\n<p> An enumerable collection of results that satisfy the query.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceModel_Dispatcher_XPathMessageQueryCollection_Evaluate__1_System_ServiceModel_Channels_MessageBuffer_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">Evaluate&lt;TResult&gt;(MessageBuffer)</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Runs an XPath query against the message.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public override System.Collections.Generic.IEnumerable&lt;System.Collections.Generic.KeyValuePair&lt;System.ServiceModel.Dispatcher.MessageQuery,TResult&gt;&gt; Evaluate&lt;TResult&gt; (System.ServiceModel.Channels.MessageBuffer buffer);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Parameters</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>buffer</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.channels.messagebuffer\" data-linktype=\"relative-path\">MessageBuffer</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The message to query.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Returns</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<div class=\"subtle\">\r\n  \t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.collections.generic.ienumerable-1\" data-linktype=\"relative-path\">IEnumerable</a>&lt;<a class=\"xref\" href=\"system.collections.generic.keyvaluepair-2\" data-linktype=\"relative-path\">KeyValuePair</a>&lt;<a class=\"xref\" href=\"system.servicemodel.dispatcher.messagequery\" data-linktype=\"relative-path\">MessageQuery</a>,<span class=\"xref\">TResult</span>&gt;&gt;</span>\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t<span class=\"xref\">stem.Collections.Generic.IEnumerable`1</span>  \n\n<p> An enumerable collection of results that satisfy the query.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceModel_Dispatcher_XPathMessageQueryCollection_InsertItem_System_Int32_System_ServiceModel_Dispatcher_MessageQuery_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">InsertItem(Int32, MessageQuery)</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Inserts the XPath query object into the collection at the specified index.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">protected override void InsertItem (int index, System.ServiceModel.Dispatcher.MessageQuery item);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Parameters</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>index</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.int32\" data-linktype=\"relative-path\">Int32</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The location in the collection to insert the item.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo stack\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>item</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.dispatcher.messagequery\" data-linktype=\"relative-path\">MessageQuery</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The XPath query object to insert.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceModel_Dispatcher_XPathMessageQueryCollection_RemoveItem_System_Int32_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">RemoveItem(Int32)</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Removes the item from the collection at the specified index.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">protected override void RemoveItem (int index);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Parameters</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>index</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.int32\" data-linktype=\"relative-path\">Int32</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The location from which to remove the item.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\t\t\t<div data-moniker=\" netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceModel_Dispatcher_XPathMessageQueryCollection_SetItem_System_Int32_System_ServiceModel_Dispatcher_MessageQuery_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">SetItem(Int32, MessageQuery)</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Replaces the element at the specified index.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">protected override void SetItem (int index, System.ServiceModel.Dispatcher.MessageQuery item);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Parameters</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>index</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.int32\" data-linktype=\"relative-path\">Int32</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The zero-based index of the element to replace.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo stack\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>item</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.dispatcher.messagequery\" data-linktype=\"relative-path\">MessageQuery</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The new value for the element at the specified index.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t</section>\r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.ServiceModel.Dispatcher.XPathMessageQueryCollection.yml\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.Dispatcher.XPathMessageQueryCollection\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.Dispatcher.XPathMessageQueryCollection..ctor\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.Dispatcher.XPathMessageQueryCollection.Evaluate&lt;TResult&gt;\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.Dispatcher.XPathMessageQueryCollection.InsertItem\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.Dispatcher.XPathMessageQueryCollection.RemoveItem\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.Dispatcher.XPathMessageQueryCollection.SetItem\">\r\n<meta name=\"APILocation\" content=\"System.ServiceModel.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-29 05:54 AM\">\r\n<meta name=\"document_id\" content=\"36dcc8f2-9dc3-6d2c-9e4f-ffa423e4750d\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Contains a collection of  objects.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.servicemodel.dispatcher/toc2.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.ServiceModel.Dispatcher.XPathMessageQueryCollection\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.ServiceModel.Dispatcher.XPathMessageQueryCollection.yml","open_to_public_contributors":false,"api_name":["System.ServiceModel.Dispatcher.XPathMessageQueryCollection","System.ServiceModel.Dispatcher.XPathMessageQueryCollection..ctor","System.ServiceModel.Dispatcher.XPathMessageQueryCollection.Evaluate<TResult>","System.ServiceModel.Dispatcher.XPathMessageQueryCollection.InsertItem","System.ServiceModel.Dispatcher.XPathMessageQueryCollection.RemoveItem","System.ServiceModel.Dispatcher.XPathMessageQueryCollection.SetItem"],"api_location":["System.ServiceModel.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.ServiceModel.Dispatcher.XPathMessageQueryCollection","System::ServiceModel::Dispatcher::XPathMessageQueryCollection","System.ServiceModel.Dispatcher.XPathMessageQueryCollection.#ctor","System::ServiceModel::Dispatcher::XPathMessageQueryCollection::#ctor","System.ServiceModel.Dispatcher.XPathMessageQueryCollection.Evaluate``1","System::ServiceModel::Dispatcher::XPathMessageQueryCollection::Evaluate``1","System.ServiceModel.Dispatcher.XPathMessageQueryCollection.InsertItem","System::ServiceModel::Dispatcher::XPathMessageQueryCollection::InsertItem","System.ServiceModel.Dispatcher.XPathMessageQueryCollection.RemoveItem","System::ServiceModel::Dispatcher::XPathMessageQueryCollection::RemoveItem","System.ServiceModel.Dispatcher.XPathMessageQueryCollection.SetItem","System::ServiceModel::Dispatcher::XPathMessageQueryCollection::SetItem"],"dev_langs":["csharp"],"updated_at":"2017-03-29 05:54 AM","document_id":"36dcc8f2-9dc3-6d2c-9e4f-ffa423e4750d","content_git_url":"https://github.com/dotnet/docs-internal/blob/master/xml/System.ServiceModel.Dispatcher/XPathMessageQueryCollection.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"XPathMessageQueryCollection class | Microsoft Docs","_op_ogTitle":"XPathMessageQueryCollection class","description":"Contains a collection of  objects.\n","toc_asset_id":"api/_splitted/System.ServiceModel.Dispatcher/toc.json","toc_rel":"_splitted/System.ServiceModel.Dispatcher/toc.json","source_url":"","ms.assetid":"System.ServiceModel.Dispatcher.XPathMessageQueryCollection","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.servicemodel.dispatcher.xpathmessagequerycollection","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.servicemodel.dispatcher.xpathmessagequerycollection","fileRelativePath":"api/System.ServiceModel.Dispatcher.XPathMessageQueryCollection.html"},"themesRelativePathToOutputRoot":"_themes/"}