{"content":"\r\n  \r\n  <h1>\r\n    <span class=\"lang-csharp\">IPolicyImportExtension</span>\r\n      Interface\r\n  </h1>\r\n  \r\n  <h2 class=\"hiddenAnchor\">Definition</h2>\r\n  \r\n  <div class=\"metadata\">\r\n  \r\n  \r\n  </div>\r\n  \r\n  <div class=\"summaryHolder\">\r\n  \t<div class=\"summary\">\r\n  \t\t<p>Defines a method for objects that import custom policy assertions about bindings.</p>\n\r\n  \t</div>\r\n  </div><nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n    <h3>In this Article</h3>\r\n  </nav>\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\">public interface IPolicyImportExtension</code></pre>\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \t<h2 class=\"accented\">Examples</h2>\r\n  \t<p>The following code example shows the use of the <a class=\"xref\" href=\"system.servicemodel.description.policyassertioncollection#System_ServiceModel_Description_PolicyAssertionCollection_Remove_\" data-linktype=\"relative-path\">Remove</a> method to locate, return, and remove the assertion in one step.  </p>\n<pre><code class=\"lang-cs\" name=\"CustomPolicySample#1\">  #region IPolicyImporter Members\n  public const string name1 = &quot;acme&quot;;\n  public const string ns1 = &quot;http://Microsoft/WCF/Documentation/CustomPolicyAssertions&quot;;\n\n  /*\n   * Importing policy assertions usually means modifying the bindingelement stack in some way\n   * to support the policy assertion. The procedure is:\n   * 1. Find the custom assertion to import.\n   * 2. Insert a supporting custom bindingelement or modify the current binding element collection\n   *     to support the assertion.\n   * 3. Remove the assertion from the collection. Once the ImportPolicy method has returned, \n   *     any remaining assertions for the binding cause the binding to fail import and not be \n   *     constructed.\n   */\n  public void ImportPolicy(MetadataImporter importer, PolicyConversionContext context)\n  {\n    Console.WriteLine(&quot;The custom policy importer has been called.&quot;);\n    // Locate the custom assertion and remove it.\n    XmlElement customAssertion = context.GetBindingAssertions().Remove(name1, ns1);\n    if (customAssertion != null)\n    {\n      Console.WriteLine(\n        &quot;Removed our custom assertion from the imported &quot;\n        + &quot;assertions collection and inserting our custom binding element.&quot;\n      );\n      // Here we would add the binding modification that implemented the policy.\n      // This sample does not do this.\n      Console.ForegroundColor = ConsoleColor.Red;\n      Console.WriteLine(customAssertion.NamespaceURI + &quot; : &quot; + customAssertion.Name);\n      Console.WriteLine(customAssertion.OuterXml);\n      Console.ForegroundColor = ConsoleColor.Gray;\n    }\n }\n#endregion\n</code></pre><pre><code class=\"lang-vb\" name=\"CustomPolicySample#1\">\t#Region &quot;IPolicyImporter Members&quot;\n\tPublic Const name1 As String = &quot;acme&quot;\n\tPublic Const ns1 As String = &quot;http://Microsoft/WCF/Documentation/CustomPolicyAssertions&quot;\n\n&#39;    \n&#39;     * Importing policy assertions usually means modifying the bindingelement stack in some way\n&#39;     * to support the policy assertion. The procedure is:\n&#39;     * 1. Find the custom assertion to import.\n&#39;     * 2. Insert a supporting custom bindingelement or modify the current binding element collection\n&#39;     *     to support the assertion.\n&#39;     * 3. Remove the assertion from the collection. Once the ImportPolicy method has returned, \n&#39;     *     any remaining assertions for the binding cause the binding to fail import and not be \n&#39;     *     constructed.\n&#39;     \n\tPublic Sub ImportPolicy(ByVal importer As MetadataImporter, ByVal context As PolicyConversionContext) Implements IPolicyImportExtension.ImportPolicy\n\t  Console.WriteLine(&quot;The custom policy importer has been called.&quot;)\n\t  &#39; Locate the custom assertion and remove it.\n\t  Dim customAssertion As XmlElement = context.GetBindingAssertions().Remove(name1, ns1)\n\t  If customAssertion IsNot Nothing Then\n\t\tConsole.WriteLine(&quot;Removed our custom assertion from the imported &quot; &amp; &quot;assertions collection and inserting our custom binding element.&quot;)\n\t\t&#39; Here we would add the binding modification that implemented the policy.\n\t\t&#39; This sample does not do this.\n\t\tConsole.ForegroundColor = ConsoleColor.Red\n\t\tConsole.WriteLine(customAssertion.NamespaceURI &amp; &quot; : &quot; &amp; customAssertion.Name)\n\t\tConsole.WriteLine(customAssertion.OuterXml)\n\t\tConsole.ForegroundColor = ConsoleColor.Gray\n\t  End If\n\tEnd Sub\n  #End Region\n</code></pre><p> The following code example shows the client application configuration file to load the custom policy importer when the <a class=\"xref\" href=\"system.servicemodel.description.metadataresolver\" data-linktype=\"relative-path\">System.ServiceModel.Description.MetadataResolver</a> is invoked.  </p>\n<p> The following code example shows the use of the <a class=\"xref\" href=\"system.servicemodel.description.metadataresolver\" data-linktype=\"relative-path\">MetadataResolver</a> to download and resolve metadata into description objects.  </p>\n<pre><code class=\"lang-vb\" name=\"CustomPolicySample#10\">&#39; Download all metadata. \nDim endpoints As ServiceEndpointCollection = MetadataResolver.Resolve(GetType(IStatefulService), New EndpointAddress(&quot;http://localhost:8080/StatefulService/mex&quot;))\n</code></pre><pre><code class=\"lang-cs\" name=\"CustomPolicySample#10\">// Download all metadata. \nServiceEndpointCollection endpoints\n  = MetadataResolver.Resolve(\n    typeof(IStatefulService),\n    new EndpointAddress(&quot;http://localhost:8080/StatefulService/mex&quot;)\n  );\n</code></pre>\r\n  \r\n  \t<h2 class=\"accented\">Remarks</h2>\r\n  \t<p>Implement the IPolicyImportExtension interface to search WSDL information exposed by a particular endpoint for custom policy assertions about endpoint capabilities or requirements. Typically, a policy importer searches for a specific assertion and either inserts a binding element, configures a binding element, or modifies the contract to support the requirements of the assertion.  </p>\n<p> Unlike its counterpart, <a class=\"xref\" href=\"system.servicemodel.description.ipolicyexportextension\" data-linktype=\"relative-path\">IPolicyExportExtension</a>, IPolicyImportExtension does not require implementation by a <a class=\"xref\" href=\"system.servicemodel.channels.bindingelement\" data-linktype=\"relative-path\">BindingElement</a> object; you can load it using the client configuration section shown in the Examples section or programmatically by adding it to the <a class=\"xref\" href=\"system.servicemodel.description.wsdlimporter\" data-linktype=\"relative-path\">System.ServiceModel.Description.WsdlImporter</a> constructor.  </p>\n<p> Windows Communication Foundation (WCF) passes two objects to the <a class=\"xref\" href=\"system.servicemodel.description.ipolicyimportextension#System_ServiceModel_Description_IPolicyImportExtension_ImportPolicy_\" data-linktype=\"relative-path\">ImportPolicy</a> method, a <a class=\"xref\" href=\"system.servicemodel.description.metadataimporter\" data-linktype=\"relative-path\">MetadataImporter</a> and a <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext\" data-linktype=\"relative-path\">PolicyConversionContext</a>. Typically the <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext\" data-linktype=\"relative-path\">PolicyConversionContext</a> object already contains the policy assertions for each binding scope.  </p>\n<p> An IPolicyImportExtension implementation performs the following steps:  </p>\n<ol>\n<li><p>Locates the custom policy assertion for which it is responsible by calling either the <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext#System_ServiceModel_Description_PolicyConversionContext_GetBindingAssertions_\" data-linktype=\"relative-path\">GetBindingAssertions</a>, <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext#System_ServiceModel_Description_PolicyConversionContext_GetMessageBindingAssertions_\" data-linktype=\"relative-path\">GetMessageBindingAssertions</a>, or <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext#System_ServiceModel_Description_PolicyConversionContext_GetOperationBindingAssertions_\" data-linktype=\"relative-path\">GetOperationBindingAssertions</a> methods, depending upon the scope.  </p>\n</li>\n<li><p>Removes the policy assertion from the assertion collection. The <a class=\"xref\" href=\"system.servicemodel.description.policyassertioncollection#System_ServiceModel_Description_PolicyAssertionCollection_Remove_\" data-linktype=\"relative-path\">Remove</a> method locates, returns, and removes the assertion in one step.  </p>\n</li>\n<li><p>Modify the binding stack or the contract by either adding a required custom <a class=\"xref\" href=\"system.servicemodel.channels.bindingelement\" data-linktype=\"relative-path\">BindingElement</a> to the <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext#System_ServiceModel_Description_PolicyConversionContext_BindingElements_\" data-linktype=\"relative-path\">BindingElements</a> property or by modifying the <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext#System_ServiceModel_Description_PolicyConversionContext_Contract_\" data-linktype=\"relative-path\">Contract</a> property.  </p>\n</li>\n</ol>\n<p> Step 2 is important. After all policy importers have been called, WCF checks for the existence of any policy assertions that remain. If one exists, WCF assumes that the policy import was unsuccessful and does not import the associated binding.  </p>\n<div class=\"IMPORTANT\"><h5>Important</h5><p> A malicious metadata supplier can attempt to send malformed XML as part of metadata in an attempt to exploit a policy importer. It is strongly recommended that custom policy importers be robust to all forms of XML that can be passed to it.  </p>\n</div>\n<p> Custom <a class=\"xref\" href=\"system.servicemodel.description.metadataimporter\" data-linktype=\"relative-path\">MetadataImporter</a> implementations must implement their own <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext\" data-linktype=\"relative-path\">PolicyConversionContext</a> object to extract the policy assertions attached to the custom metadata format.  </p>\n<p> If you want to export and import custom WSDL elements that are not policy assertions, see <a class=\"xref\" href=\"system.servicemodel.description.iwsdlexportextension\" data-linktype=\"relative-path\">System.ServiceModel.Description.IWsdlExportExtension</a> and <a class=\"xref\" href=\"system.servicemodel.description.iwsdlimportextension\" data-linktype=\"relative-path\">System.ServiceModel.Description.IWsdlImportExtension</a>.  </p>\n<div class=\"NOTE\"><h5>Note</h5><p> You can use custom policy importers and exporters with the <a href=\"../topic/servicemodel%20metadata%20utility%20tool%20(svcutil.exe)\" data-linktype=\"relative-path\">ServiceModel Metadata Utility Tool (Svcutil.exe)</a> by using the same configuration elements in a configuration file and the <code>/svcutilConfig:&lt;configFile&gt;</code> option.</p>\n</div>\n\r\n  \r\n  \r\n  \t\t<section>\r\n  \t\t\t<h2 class=\"accented \">Methods\r\n  \t\t</h2>\r\n  \t\t\r\n  \t\t\t\t\t<div data-moniker=\" netframework-3.0 netframework-3.5-client netframework-3.5 netframework-4.0-client netframework-4.0 netframework-4.5.1 netframework-4.5.2 netframework-4.5 netframework-4.6.1 netframework-4.6.2 netframework-4.6\">\r\n  \t\t\r\n  \t\t\t\t\t<a id=\"System_ServiceModel_Description_IPolicyImportExtension_ImportPolicy_\"></a>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberNameHolder\" id=\"System_ServiceModel_Description_IPolicyImportExtension_ImportPolicy_System_ServiceModel_Description_MetadataImporter_System_ServiceModel_Description_PolicyConversionContext_\">\r\n  \t\t\t\t\t<h3 class=\"accented\">\r\n  \t\t\t\t\t\t<span class=\"lang-csharp\">ImportPolicy(MetadataImporter, PolicyConversionContext)</span>\r\n  \t\t\t\t\t</h3>\r\n  \t\t\t\t</div>\r\n  \t\t\r\n  \t\t\t\t<div class=\"memberInfo\">\r\n  \t\t\t\t\t<p>Defines a method that can import custom policy assertions and add implementing binding elements.</p>\n\r\n  \t\t\r\n  \t\t\t\t\t\t<pre class=\"wrap loading\"><code class=\"csharp lang-csharp\" dir=\"ltr\">public void ImportPolicy (System.ServiceModel.Description.MetadataImporter importer, System.ServiceModel.Description.PolicyConversionContext context);</code></pre>\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfoTitle stack\">Parameters</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>importer</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.description.metadataimporter\" data-linktype=\"relative-path\">MetadataImporter</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The <a class=\"xref\" href=\"system.servicemodel.description.metadataimporter\" data-linktype=\"relative-path\">MetadataImporter</a> object in use.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\t\t\t\t\t<div class=\"propertyInfo stack\">\r\n  \t\t\t\t\t\t\t<dl class=\"parameterList\">\r\n  \t\t\t\t\t\t\t\t<dt>context</dt>\r\n  \t\t\t\t\t\t\t\t<dd>\r\n  \t\t\t\t\t\t\t\t\t\t<span class=\"lang-csharp\"><a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext\" data-linktype=\"relative-path\">PolicyConversionContext</a></span>\r\n  \t\t\t\t\t\t\t\t</dd>\r\n  \t\t\t\t\t\t\t</dl>\r\n  \t\t\t\t\t\t\t<p>The <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext\" data-linktype=\"relative-path\">PolicyConversionContext</a> that contains both the policy assertions that can be imported and the collections of binding elements to which implementing binding elements can be added.</p>\n\r\n  \t\t\t\t\t\t\t</div>\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\r\n  \t\t\t\t\t\t<h4 class=\"accented\">Remarks</h4>\r\n  \t\t\t\t\t\t<p>Implement the <code>ImportPolicy</code> method to obtain policy assertions and perform some modification of the imported contract or binding to support the assertion. Typically, a policy importer responds to finding a custom policy assertion by configuring or inserting a binding element into the binding being imported.  </p>\n<p> Windows Communication Foundation (WCF) passes two objects to the ImportPolicy method, a <a class=\"xref\" href=\"system.servicemodel.description.metadataimporter\" data-linktype=\"relative-path\">MetadataImporter</a> and a <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext\" data-linktype=\"relative-path\">PolicyConversionContext</a>. Typically the <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext\" data-linktype=\"relative-path\">PolicyConversionContext</a> object already contains the policy assertions for each binding scope.  </p>\n<p> An <a class=\"xref\" href=\"system.servicemodel.description.ipolicyimportextension\" data-linktype=\"relative-path\">IPolicyImportExtension</a> implementation performs the following steps:  </p>\n<ol>\n<li><p>Locates the custom policy assertion for which it is responsible by calling either the <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext#System_ServiceModel_Description_PolicyConversionContext_GetBindingAssertions_\" data-linktype=\"relative-path\">GetBindingAssertions</a>, <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext#System_ServiceModel_Description_PolicyConversionContext_GetMessageBindingAssertions_\" data-linktype=\"relative-path\">GetMessageBindingAssertions</a>, or <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext#System_ServiceModel_Description_PolicyConversionContext_GetOperationBindingAssertions_\" data-linktype=\"relative-path\">GetOperationBindingAssertions</a> methods, depending upon the scope.  </p>\n</li>\n<li><p>Removes the policy assertion from the assertion collection. The <a class=\"xref\" href=\"system.servicemodel.description.policyassertioncollection#System_ServiceModel_Description_PolicyAssertionCollection_Remove_\" data-linktype=\"relative-path\">Remove</a> method locates, returns, and removes the assertion in one step.  </p>\n</li>\n<li><p>Modifies the binding stack or the contract by either adding a required custom <a class=\"xref\" href=\"system.servicemodel.channels.bindingelement\" data-linktype=\"relative-path\">BindingElement</a> to the <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext#System_ServiceModel_Description_PolicyConversionContext_BindingElements_\" data-linktype=\"relative-path\">BindingElements</a> property or by modifying the <a class=\"xref\" href=\"system.servicemodel.description.policyconversioncontext#System_ServiceModel_Description_PolicyConversionContext_Contract_\" data-linktype=\"relative-path\">Contract</a> property.  </p>\n</li>\n</ol>\n<p> Step 2 is important. After all policy importers have been called, WCF checks for the existence of any policy assertions that remain. If one exists, WCF assumes that the policy import was unsuccessful and does not import the associated binding.</p>\n\r\n  \t\t\r\n  \t\t\t\t</div>\r\n  \t\t\t</div>\r\n  \t\t\r\n  \t\t</section>\r\n  \r\n  \r\n","outputRootRelativePath":"../","pageMetadata":"<meta name=\"author\" content=\"dotnet-bot\">\r\n<meta name=\"ms.author\" content=\"dotnetcontent\">\r\n<meta name=\"manager\" content=\"wpickett\">\r\n<meta name=\"breadcrumb_path\" content=\"../toc2.json\">\r\n<meta name=\"apiPlatform\" content=\"dotnet\">\r\n<meta name=\"ms.topic\" content=\"managed-reference\">\r\n<meta name=\"ms.prod\" content=\".net\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"docs-internal\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"MSDN\">\r\n<meta name=\"depot_name\" content=\"MSDN.docs-internal\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/dotnet/docs-internal/blob/master/api/System.ServiceModel.Description.IPolicyImportExtension.yml\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.Description.IPolicyImportExtension\">\r\n<meta name=\"APIName\" content=\"System.ServiceModel.Description.IPolicyImportExtension.ImportPolicy\">\r\n<meta name=\"APILocation\" content=\"System.ServiceModel.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2017-03-31 05:47 AM\">\r\n<meta name=\"document_id\" content=\"412bb6be-aeeb-4191-69bb-446bed470788\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"Defines a method for objects that import custom policy assertions about bindings.\n\">\r\n<meta name=\"toc_rel\" content=\"_splitted/system.servicemodel.description/toc2.json\">\r\n<meta name=\"source_url\" content=\"\">\r\n<meta name=\"ms.assetid\" content=\"System.ServiceModel.Description.IPolicyImportExtension\">\r\n","rawMetadata":{"author":"dotnet-bot","ms.author":"dotnetcontent","manager":"wpickett","breadcrumb_path":"/dotnet/toc.json","apiPlatform":"dotnet","ms.topic":"managed-reference","ms.prod":".net","search.ms_sitename":"Docs","search.ms_docsetname":"docs-internal","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet-internal/","locale":"en-us","site_name":"Docs","search.ms_product":"MSDN","_op_openToPublicContributors":false,"depot_name":"MSDN.docs-internal","_op_gitRefSkeletonCommitHistory":[],"original_ref_skeleton_git_url":"https://github.com/dotnet/docs-internal/blob/master/api/System.ServiceModel.Description.IPolicyImportExtension.yml","open_to_public_contributors":false,"api_name":["System.ServiceModel.Description.IPolicyImportExtension","System.ServiceModel.Description.IPolicyImportExtension.ImportPolicy"],"api_location":["System.ServiceModel.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["System.ServiceModel.Description.IPolicyImportExtension","System::ServiceModel::Description::IPolicyImportExtension","System.ServiceModel.Description.IPolicyImportExtension.ImportPolicy","System::ServiceModel::Description::IPolicyImportExtension::ImportPolicy"],"dev_langs":["csharp"],"updated_at":"2017-03-31 05:47 AM","document_id":"412bb6be-aeeb-4191-69bb-446bed470788","content_git_url":"https://github.com/dotnet/docs-internal/blob/master/xml/System.ServiceModel.Description/IPolicyImportExtension.xml","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"IPolicyImportExtension interface | Microsoft Docs","_op_ogTitle":"IPolicyImportExtension interface","description":"Defines a method for objects that import custom policy assertions about bindings.\n","toc_asset_id":"api/_splitted/System.ServiceModel.Description/toc.json","toc_rel":"_splitted/System.ServiceModel.Description/toc.json","source_url":"","ms.assetid":"System.ServiceModel.Description.IPolicyImportExtension","canonical_url":"https://docs.microsoft.com/en-us/dotnet/api/system.servicemodel.description.ipolicyimportextension","_op_searchScope":[".NET"],"_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/api/system.servicemodel.description.ipolicyimportextension","fileRelativePath":"api/System.ServiceModel.Description.IPolicyImportExtension.html"},"themesRelativePathToOutputRoot":"_themes/"}