{"content":"    \r\n    <h1 id=\"Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1\">\r\n      <span class=\"lang-csharp\">IReliableConcurrentQueue&lt;T&gt;</span>\r\n      <span class=\"lang-vb\">IReliableConcurrentQueue(Of T)</span>\r\n        Interface\r\n    </h1>\r\n    \r\n    \r\n    <nav id=\"center-doc-outline\" class=\"doc-outline\" ms.cmpgrp=\"intopic toc\" role=\"navigation\" aria-label=\"On page navigation\">\r\n      <h3>In this Article</h3>\r\n    </nav><div class=\"summary\">\r\n    \t\t<div class=\"memberEditButton\">\r\n    \t\t\t<a href=\"https://msazure.visualstudio.com/DefaultCollection/One/_git/WindowsFabric?path=src/prod/src/managed/Microsoft.ServiceFabric.Data.Interfaces/Collections/Preview/IReliableConcurrentQueue.cs&amp;version=GBdevelop&amp;line=65\" ms.cmpnm=\"editMember\" data-linktype=\"external\"><i class=\"icon icon-editor\"></i>Edit</a>\r\n    \t\t</div>\r\n    \t<p>\nPreview feature. Not for production use. See the <a href=\"https://aka.ms/reliableconcurrentqueuepreview\" data-linktype=\"external\">documentation</a> for details.\n</p>\n<p>\nRepresents a reliable collection of persisted, replicated values with best-effort first-in first-out ordering.\n</p>\n\r\n    </div><h2>Syntax</h2>\r\n    \r\n    \t<h3>Declaration</h3>\r\n    \t<pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">public interface IReliableConcurrentQueue&lt;T&gt; : IReliableState</code><code class=\"vb lang-vb\">Public Interface IReliableConcurrentQueue(Of T)\n    Inherits IReliableState</code></pre>\r\n    \r\n    \r\n    \t<h2>Type Parameters</h2>\r\n    \r\n    \t<table class=\"nameValue\">\r\n    \t\t<tr>\r\n    \t\t<td>\r\n    \t\tT\r\n    \t\t</td>\r\n    \t\t<td>\r\n    \t\t<p>The type of the values contained in the reliable queue slim.</p>\n\r\n    \t\t</td>\r\n    \t\t</tr>\r\n    \t</table>\r\n    \r\n    \r\n      <div class=\"referencebox inheritedMembers\">\r\n        <h3>Inherited Members</h3>\r\n        <h4>Microsoft.ServiceFabric.Data.IReliableState</h4>\r\n          <div class=\"lang-csharp\">\r\n            <a class=\"xref\" href=\"microsoft.servicefabric.data.ireliablestate#Microsoft_ServiceFabric_Data_IReliableState_Name\" data-linktype=\"relative-path\">Name</a>\r\n          </div>\r\n          <div class=\"lang-vb\">\r\n            <a class=\"xref\" href=\"microsoft.servicefabric.data.ireliablestate#Microsoft_ServiceFabric_Data_IReliableState_Name\" data-linktype=\"relative-path\">Name</a>\r\n          </div>\r\n          \r\n      </div>\r\n    \r\n    \r\n      <h2>Remarks</h2>\r\n      <p>\nIntended as an alternative to <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.ireliablequeue-1\" data-linktype=\"relative-path\">IReliableQueue&lt;T&gt;</a> for workloads where strict ordering is not required, as by relaxing\nthe ordering constraint, concurrency can be greatly improved.  <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.ireliablequeue-1\" data-linktype=\"relative-path\">IReliableQueue&lt;T&gt;</a> restricts concurrent consumers\nand producers to a maximum of one each, while <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1\" data-linktype=\"relative-path\">IReliableConcurrentQueue&lt;T&gt;</a> imposes no such restriction.\n</p>\n<p>\n<a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1\" data-linktype=\"relative-path\">IReliableConcurrentQueue&lt;T&gt;</a> does not offer the same transaction isolation semantics as the other reliable data structures.  See the \nindividual operations and properties (<a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_EnqueueAsync_Microsoft_ServiceFabric_Data_ITransaction__0_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">EnqueueAsync(ITransaction, T, CancellationToken, Nullable&lt;TimeSpan&gt;)</a>, <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_Microsoft_ServiceFabric_Data_ITransaction_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">DequeueAsync(ITransaction, CancellationToken, Nullable&lt;TimeSpan&gt;)</a>, and <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_Count\" data-linktype=\"relative-path\">Count</a>) for details on what isolation, \nif any, they provide.\n</p>\n<p>\nIt is expected that values will be relatively short-lived in the queue; in other words, that the egress (<a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_Microsoft_ServiceFabric_Data_ITransaction_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">DequeueAsync(ITransaction, CancellationToken, Nullable&lt;TimeSpan&gt;)</a>) rate is \nequal to or greater than the ingress (<a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_EnqueueAsync_Microsoft_ServiceFabric_Data_ITransaction__0_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">EnqueueAsync(ITransaction, T, CancellationToken, Nullable&lt;TimeSpan&gt;)</a>) rate.  Violating this expectation \nmay worsen system performance.  A planned queue capacity constraint which will throttle incoming Enqueues once the capacity is reached\nwill help in maintaining this property.\nproperty.\n</p>\n<p>\nAs the ordering of elements is not strictly guaranteed, assumptions about the ordering of any two values in the queue MUST NOT\nbe made.  The best-effort first-in first-out ordering is provided for fairness; the time that an value spends in the queue should\nbe related to the failure rate (failures may alter the queue&#39;s ordering) and the dequeue rate, but not the enqueue rate.\n</p>\n<p>\n<a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1\" data-linktype=\"relative-path\">IReliableConcurrentQueue&lt;T&gt;</a> does not offer a Peek operation, however by combining <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_Microsoft_ServiceFabric_Data_ITransaction_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">DequeueAsync(ITransaction, CancellationToken, Nullable&lt;TimeSpan&gt;)</a> and <a class=\"xref\" href=\"microsoft.servicefabric.data.itransaction#Microsoft_ServiceFabric_Data_ITransaction_Abort\" data-linktype=\"relative-path\">Abort()</a>\nthe same semantic can be achieved.  See <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_Microsoft_ServiceFabric_Data_ITransaction_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">DequeueAsync(ITransaction, CancellationToken, Nullable&lt;TimeSpan&gt;)</a> for additional details and an example.\n</p>\n<p>\nValues stored in this queue MUST NOT be mutated outside the context of an operation on the queue. It is\nhighly recommended to make <em>T</em> immutable in order to avoid accidental data corruption.\n</p>\n<p>\nTransaction is the unit of concurrency: Users can have multiple transactions in-flight at any given point of time but for a given transaction each API must be called one at a time.\nSo all Reliable Collection APIs that take in a transaction and return a Task, must be awaited one at a time.\n<a class=\"xref\" href=\"microsoft.servicefabric.data.itransaction\" data-linktype=\"relative-path\">ITransaction</a>\n</p>\n\r\n    \r\n    \r\n    <h2>Properties\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_Count\" data-linktype=\"self-bookmark\">Count</a></div>\r\n            <div class=\"lang-vb\"><a href=\"#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_Count\" data-linktype=\"self-bookmark\">Count</a></div>\r\n          </td>\r\n            <td>\r\n            <p>\nPreview feature. Not for production use. See the <a href=\"https://aka.ms/reliableconcurrentqueuepreview\" data-linktype=\"external\">documentation</a> for details.\n</p>\n<p>\nGets the number of values in the <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1\" data-linktype=\"relative-path\">IReliableConcurrentQueue&lt;T&gt;</a>.\n</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <h2>Methods\r\n     summary</h2>\r\n    \r\n    <table class=\"nameValue\">\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_Microsoft_ServiceFabric_Data_ITransaction_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"self-bookmark\">DequeueAsync(ITransaction, CancellationToken, Nullable&lt;TimeSpan&gt;)</a></div>\r\n            <div class=\"lang-vb\"><a href=\"#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_Microsoft_ServiceFabric_Data_ITransaction_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"self-bookmark\">DequeueAsync(ITransaction, CancellationToken, Nullable(Of TimeSpan))</a></div>\r\n          </td>\r\n            <td>\r\n            <p>\nPreview feature. Not for production use. See the <a href=\"https://aka.ms/reliableconcurrentqueuepreview\" data-linktype=\"external\">documentation</a> for details.\n</p>\n<p>\nTentatively dequeue a value from the queue.\n</p>\n\r\n            </td>\r\n        </tr>\r\n        <tr class=\" enable-platform-filter\">\r\n          <td>\r\n            <div class=\"lang-csharp\"><a href=\"#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_EnqueueAsync_Microsoft_ServiceFabric_Data_ITransaction__0_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"self-bookmark\">EnqueueAsync(ITransaction, T, CancellationToken, Nullable&lt;TimeSpan&gt;)</a></div>\r\n            <div class=\"lang-vb\"><a href=\"#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_EnqueueAsync_Microsoft_ServiceFabric_Data_ITransaction__0_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"self-bookmark\">EnqueueAsync(ITransaction, T, CancellationToken, Nullable(Of TimeSpan))</a></div>\r\n          </td>\r\n            <td>\r\n            <p>\nPreview feature. Not for production use. See the <a href=\"https://aka.ms/reliableconcurrentqueuepreview\" data-linktype=\"external\">documentation</a> for details.\n</p>\n<p>\nStage the enqueue of a value into the queue.\n</p>\n\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"properties\">\r\n        <h2>Properties\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_Count\">\r\n    \r\n            <a id=\"Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_Count_\"></a>\r\n    \r\n            <div class=\"memberEditButton\">\r\n              <a href=\"https://msazure.visualstudio.com/DefaultCollection/One/_git/WindowsFabric?path=src/prod/src/managed/Microsoft.ServiceFabric.Data.Interfaces/Collections/Preview/IReliableConcurrentQueue.cs&amp;version=GBdevelop&amp;line=323\" ms.cmpnm=\"editMember\" data-linktype=\"external\"><i class=\"icon icon-editor\"></i>Edit</a>\r\n            </div>\r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">Count</div>        \r\n            <div class=\"lang-vb\">Count</div>        \r\n          </div>\r\n    \r\n            <p>\nPreview feature. Not for production use. See the <a href=\"https://aka.ms/reliableconcurrentqueuepreview\" data-linktype=\"external\">documentation</a> for details.\n</p>\n<p>\nGets the number of values in the <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1\" data-linktype=\"relative-path\">IReliableConcurrentQueue&lt;T&gt;</a>.\n</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">long Count { get; }</code><code class=\"vb lang-vb\">ReadOnly Property Count As Long</code></pre>\r\n    \r\n    \r\n    \r\n    \r\n              <h4>Property Value</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.int64(v=vs.110).aspx\" data-linktype=\"external\">Int64</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.int64(v=vs.110).aspx\" data-linktype=\"external\">Int64</a></div>\r\n                  </div>\r\n                  <p>The number of values in  the <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1\" data-linktype=\"relative-path\">IReliableConcurrentQueue&lt;T&gt;</a>.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.fabric.fabricnotreadableexception\" data-linktype=\"relative-path\">FabricNotReadableException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"system.fabric.fabricnotreadableexception\" data-linktype=\"relative-path\">FabricNotReadableException</a></div>\r\n                  </div>\r\n                  <p>The replica is currently not readable.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.fabric.fabricobjectclosedexception\" data-linktype=\"relative-path\">FabricObjectClosedException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"system.fabric.fabricobjectclosedexception\" data-linktype=\"relative-path\">FabricObjectClosedException</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1\" data-linktype=\"relative-path\">IReliableConcurrentQueue&lt;T&gt;</a> was closed by the runtime.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>\nThis count represents the number of values currently visible to <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_Microsoft_ServiceFabric_Data_ITransaction_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">DequeueAsync(ITransaction, CancellationToken, Nullable&lt;TimeSpan&gt;)</a>.  Uncommitted Enqueues will not\nincrease the count, however uncommitted Dequeues will decrease the count.\n</p>\n<p>\nNote that this API does not take a transaction parameter.  Since the effects of <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_Microsoft_ServiceFabric_Data_ITransaction_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">DequeueAsync(ITransaction, CancellationToken, Nullable&lt;TimeSpan&gt;)</a> are not isolated\nfrom other transactions, the count also cannot be isolated from other transactions.<br></p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>This example shows how to monitor the queue&#39;s count infinitely, until the cancellation token is canceled.\n<pre><code>protected override async Task RunAsync(CancellationToken cancellationToken)\n{\n    var concurrentQueue = await this.StateManager.GetOrAddAsync&lt;IReliableConcurrentQueue&lt;long&gt;&gt;(new Uri(&quot;fabric:/concurrentQueue&quot;));<p>\n<pre><code>// Assumption: values are being enqueued/dequeued in another place (e.g. the communication listener).\nvar observer = Task.Run(\n    async () =&amp;gt;\n        {\n            while (true)\n            {\n                cancellationToken.ThrowIfCancellationRequested();\n\n                try\n                {\n                    Console.WriteLine(&quot;Count: &quot; + concurrentQueue.Count);\n                }\n                catch (FabricNotReadableException e)\n                {\n                    // Retry until the queue is readable or a different exception is thrown.\n                    Console.WriteLine(&quot;Queue is not readable, retrying the observation: &quot; + e);\n                }\n                catch (FabricObjectClosedException e)\n                {\n                    // Gracefully exit as this is happening due to replica close.\n                    Console.WriteLine(&quot;Replica is closing, stopping observer: &quot; + e);\n                    return;\n                }\n\n                await Task.Delay(TimeSpan.FromMilliseconds(100), cancellationToken);\n            }\n        },\n    cancellationToken);\n</code></pre><p>}</code></pre></p>\n\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section><section class=\"memberGroup\">\r\n      <header class=\"header enable-platform-filter\" id=\"methods\">\r\n        <h2>Methods\r\n    </h2>\r\n      </header>\r\n    \r\n      <ul class=\"list-clean enable-platform-filter\">\r\n    \r\n        <li class=\" enable-platform-filter\" id=\"Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_Microsoft_ServiceFabric_Data_ITransaction_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\">\r\n    \r\n            <a id=\"Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_\"></a>\r\n    \r\n            <div class=\"memberEditButton\">\r\n              <a href=\"https://msazure.visualstudio.com/DefaultCollection/One/_git/WindowsFabric?path=src/prod/src/managed/Microsoft.ServiceFabric.Data.Interfaces/Collections/Preview/IReliableConcurrentQueue.cs&amp;version=GBdevelop&amp;line=258\" ms.cmpnm=\"editMember\" data-linktype=\"external\"><i class=\"icon icon-editor\"></i>Edit</a>\r\n            </div>\r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">DequeueAsync(ITransaction, CancellationToken, Nullable&lt;TimeSpan&gt;)</div>        \r\n            <div class=\"lang-vb\">DequeueAsync(ITransaction, CancellationToken, Nullable(Of TimeSpan))</div>        \r\n          </div>\r\n    \r\n            <p>\nPreview feature. Not for production use. See the <a href=\"https://aka.ms/reliableconcurrentqueuepreview\" data-linktype=\"external\">documentation</a> for details.\n</p>\n<p>\nTentatively dequeue a value from the queue.\n</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">Task&lt;T&gt; DequeueAsync(ITransaction tx, CancellationToken cancellationToken = null, TimeSpan? timeout = null)</code><code class=\"vb lang-vb\">Function DequeueAsync(tx As ITransaction, cancellationToken As CancellationToken = Nothing, timeout As TimeSpan? = Nothing) As Task(Of T)</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>tx</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.servicefabric.data.itransaction\" data-linktype=\"relative-path\">ITransaction</a></div>\r\n                    <div class=\"lang-vb\"><a class=\"xref\" href=\"microsoft.servicefabric.data.itransaction\" data-linktype=\"relative-path\">ITransaction</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>Transaction to associate this operation with.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>cancellationToken</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.threading.cancellationtoken(v=vs.110).aspx\" data-linktype=\"external\">CancellationToken</a></div>\r\n                    <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.threading.cancellationtoken(v=vs.110).aspx\" data-linktype=\"external\">CancellationToken</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The token to monitor for cancellation requests. The default is <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/dd780763(v=vs.110).aspx\" data-linktype=\"external\">None</a>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>timeout</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/b3h38hb0(v=vs.110).aspx\" data-linktype=\"external\">Nullable</a>&lt;<a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.timespan(v=vs.110).aspx\" data-linktype=\"external\">TimeSpan</a>&gt;</div>\r\n                    <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/b3h38hb0(v=vs.110).aspx\" data-linktype=\"external\">Nullable</a>(Of <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.timespan(v=vs.110).aspx\" data-linktype=\"external\">TimeSpan</a>)</div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The amount of time to wait for the operation to complete before throwing a TimeoutException. The default is null.  If null is passed, a default timeout will be used.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/dd321424(v=vs.110).aspx\" data-linktype=\"external\">Task</a>&lt;T&gt;</div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/dd321424(v=vs.110).aspx\" data-linktype=\"external\">Task</a>(Of T)</div>\r\n                  </div>\r\n                  <p>A task that represents the asynchronous dequeue operation.  The task result is the value dequeued.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.fabric.fabricnotprimaryexception\" data-linktype=\"relative-path\">FabricNotPrimaryException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"system.fabric.fabricnotprimaryexception\" data-linktype=\"relative-path\">FabricNotPrimaryException</a></div>\r\n                  </div>\r\n                  <p>The replica is no longer in <cref name=\"ReplicaRole.Primary\"></cref>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.fabric.fabricnotreadableexception\" data-linktype=\"relative-path\">FabricNotReadableException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"system.fabric.fabricnotreadableexception\" data-linktype=\"relative-path\">FabricNotReadableException</a></div>\r\n                  </div>\r\n                  <p>The replica is currently not readable.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.fabric.fabricobjectclosedexception\" data-linktype=\"relative-path\">FabricObjectClosedException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"system.fabric.fabricobjectclosedexception\" data-linktype=\"relative-path\">FabricObjectClosedException</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1\" data-linktype=\"relative-path\">IReliableConcurrentQueue&lt;T&gt;</a> was closed by the runtime.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.queueemptyexception\" data-linktype=\"relative-path\">QueueEmptyException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.queueemptyexception\" data-linktype=\"relative-path\">QueueEmptyException</a></div>\r\n                  </div>\r\n                  <p>The queue is currently empty.  Retriable; when encountering this exception, the caller should wait some time for additional enqueue operations\nbefore issuing another dequeue.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.timeoutexception(v=vs.110).aspx\" data-linktype=\"external\">TimeoutException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.timeoutexception(v=vs.110).aspx\" data-linktype=\"external\">TimeoutException</a></div>\r\n                  </div>\r\n                  <p>The operation was unable to be completed within the given timeout.  The transaction should be aborted and\na new transaction should be created to retry.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.argumentnullexception(v=vs.110).aspx\" data-linktype=\"external\">ArgumentNullException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.argumentnullexception(v=vs.110).aspx\" data-linktype=\"external\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p><em>tx</em> is null.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.operationcanceledexception(v=vs.110).aspx\" data-linktype=\"external\">OperationCanceledException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.operationcanceledexception(v=vs.110).aspx\" data-linktype=\"external\">OperationCanceledException</a></div>\r\n                  </div>\r\n                  <p>The operation was canceled via <em>cancellationToken</em>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.invalidoperationexception(v=vs.110).aspx\" data-linktype=\"external\">InvalidOperationException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.invalidoperationexception(v=vs.110).aspx\" data-linktype=\"external\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>Thrown when a method call is invalid for the object&#39;s current state.\nExample, transaction used is already terminated: committed or aborted.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>\nWhile <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_Microsoft_ServiceFabric_Data_ITransaction_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">DequeueAsync(ITransaction, CancellationToken, Nullable&lt;TimeSpan&gt;)</a> can only return values for which the corresponding <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_EnqueueAsync_Microsoft_ServiceFabric_Data_ITransaction__0_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">EnqueueAsync(ITransaction, T, CancellationToken, Nullable&lt;TimeSpan&gt;)</a> was committed, Dequeue operations are not isolated\nfrom one another.  Once a transaction has dequeued a value, other transactions cannot dequeue it, but are not blocked from dequeuing other values.\n</p>\n<p>\nWhen a transaction or transactions including one or more <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_Microsoft_ServiceFabric_Data_ITransaction_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">DequeueAsync(ITransaction, CancellationToken, Nullable&lt;TimeSpan&gt;)</a> operations aborts, the dequeued values will be added back at\nthe head of the queue in an arbitrary order.  This will ensure that these values will be dequeued again soon, improving the fairness of the\ndata structure, but without enforcing strict ordering (which would require reducing the allowed concurrency, as in <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.ireliablequeue-1\" data-linktype=\"relative-path\">IReliableQueue&lt;T&gt;</a>).\n</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>This example shows how to dequeue and log infinitely with retry, until the cancellation token is canceled.<br><pre><code>protected override async Task RunAsync(CancellationToken cancellationToken)\n{\n    var concurrentQueue = await this.StateManager.GetOrAddAsync&lt;IReliableConcurrentQueue&lt;long&gt;&gt;(new Uri(&quot;fabric:/concurrentQueue&quot;));<p>\n<pre><code>// Assumption: values are being enqueued by another source (e.g. the communication listener).\nwhile (true)\n{\n    cancellationToken.ThrowIfCancellationRequested();\n\n    try\n    {\n        using (var tx = this.StateManager.CreateTransaction())\n        {\n            var dequeueOutput = await concurrentQueue.DequeueAsync(tx, cancellationToken);\n            await tx.CommitAsync();\n            Console.WriteLine(&quot;Dequeue #&quot; + dequeueOutput);\n        }\n    }\n    catch (FabricNotPrimaryException e)\n    {\n        // Gracefully exit RunAsync as the new primary should have RunAsync invoked on it and continue work.\n        // If instead dequeue was being executed as part of a client request, the client would be signaled to re-resolve.\n        Console.WriteLine(&quot;Replica is not primary, exiting RunAsync: &quot; + e);\n        return;\n    }\n    catch (FabricNotReadableException e)\n    {\n        // Retry until the queue is readable or a different exception is thrown.\n        Console.WriteLine(&quot;Queue is not readable, retrying the transaction: &quot; + e);\n    }\n    catch (FabricObjectClosedException e)\n    {\n        // Gracefully exit RunAsync as this is happening due to replica close.\n        // If instead dequeue was being executed as part of a client request, the client would be signaled to re-resolve.\n        Console.WriteLine(&quot;Replica is closing, exiting RunAsync: &quot; + e);\n        return;\n    }\n    catch (QueueEmptyException e)\n    {\n        Console.WriteLine(&quot;Queue was empty for DequeueAsync, retrying the transaction: &quot; + e);\n    }\n    catch (TimeoutException e)\n    {\n        Console.WriteLine(&quot;Encountered TimeoutException during DequeueAsync, retrying the transaction: &quot; + e);\n    }\n\n    // Delay and retry.\n    await Task.Delay(TimeSpan.FromMilliseconds(100), cancellationToken);\n}\n</code></pre><p>}</code></pre></p>\n\r\n    \r\n    \r\n        </li>\r\n        <li class=\" enable-platform-filter\" id=\"Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_EnqueueAsync_Microsoft_ServiceFabric_Data_ITransaction__0_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\">\r\n    \r\n            <a id=\"Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_EnqueueAsync_\"></a>\r\n    \r\n            <div class=\"memberEditButton\">\r\n              <a href=\"https://msazure.visualstudio.com/DefaultCollection/One/_git/WindowsFabric?path=src/prod/src/managed/Microsoft.ServiceFabric.Data.Interfaces/Collections/Preview/IReliableConcurrentQueue.cs&amp;version=GBdevelop&amp;line=156\" ms.cmpnm=\"editMember\" data-linktype=\"external\"><i class=\"icon icon-editor\"></i>Edit</a>\r\n            </div>\r\n    \r\n          <div class=\"memberName\">\r\n            <div class=\"lang-csharp\">EnqueueAsync(ITransaction, T, CancellationToken, Nullable&lt;TimeSpan&gt;)</div>        \r\n            <div class=\"lang-vb\">EnqueueAsync(ITransaction, T, CancellationToken, Nullable(Of TimeSpan))</div>        \r\n          </div>\r\n    \r\n            <p>\nPreview feature. Not for production use. See the <a href=\"https://aka.ms/reliableconcurrentqueuepreview\" data-linktype=\"external\">documentation</a> for details.\n</p>\n<p>\nStage the enqueue of a value into the queue.\n</p>\n\r\n    \r\n            <pre class=\"memberDeclaration\"><code class=\"csharp lang-csharp\">Task EnqueueAsync(ITransaction tx, T value, CancellationToken cancellationToken = null, TimeSpan? timeout = null)</code><code class=\"vb lang-vb\">Function EnqueueAsync(tx As ITransaction, value As T, cancellationToken As CancellationToken = Nothing, timeout As TimeSpan? = Nothing) As Task</code></pre>\r\n    \r\n    \r\n              <h4>Parameters</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <dl>\r\n                  <dt>tx</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"microsoft.servicefabric.data.itransaction\" data-linktype=\"relative-path\">ITransaction</a></div>\r\n                    <div class=\"lang-vb\"><a class=\"xref\" href=\"microsoft.servicefabric.data.itransaction\" data-linktype=\"relative-path\">ITransaction</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>Transaction to associate this operation with.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>value</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><span class=\"xref\">T</span></div>\r\n                    <div class=\"lang-vb\"><span class=\"xref\">T</span></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The value to add to the end of the queue. The value can be null for reference types.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>cancellationToken</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.threading.cancellationtoken(v=vs.110).aspx\" data-linktype=\"external\">CancellationToken</a></div>\r\n                    <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.threading.cancellationtoken(v=vs.110).aspx\" data-linktype=\"external\">CancellationToken</a></div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The token to monitor for cancellation requests. The default is <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/dd780763(v=vs.110).aspx\" data-linktype=\"external\">None</a>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <dl>\r\n                  <dt>timeout</dt>\r\n                  <dd>\r\n                    <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/b3h38hb0(v=vs.110).aspx\" data-linktype=\"external\">Nullable</a>&lt;<a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.timespan(v=vs.110).aspx\" data-linktype=\"external\">TimeSpan</a>&gt;</div>\r\n                    <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/b3h38hb0(v=vs.110).aspx\" data-linktype=\"external\">Nullable</a>(Of <a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.timespan(v=vs.110).aspx\" data-linktype=\"external\">TimeSpan</a>)</div>\r\n                  </dd>\r\n                  </dl>\r\n                  <p>The amount of time to wait for the operation to complete before throwing a TimeoutException. The default is null.  If null is passed, a default timeout will be used.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n              <h4>Returns</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.threading.tasks.task(v=vs.110).aspx\" data-linktype=\"external\">Task</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.threading.tasks.task(v=vs.110).aspx\" data-linktype=\"external\">Task</a></div>\r\n                  </div>\r\n                  <p>Task that represents the asynchronous enqueue operation.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n    \r\n              <h4>Exceptions</h4>\r\n              <ul class=\"memberDetails\">\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.fabric.fabricnotprimaryexception\" data-linktype=\"relative-path\">FabricNotPrimaryException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"system.fabric.fabricnotprimaryexception\" data-linktype=\"relative-path\">FabricNotPrimaryException</a></div>\r\n                  </div>\r\n                  <p>The replica is no longer in <cref name=\"ReplicaRole.Primary\"></cref>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.fabric.fabricnotreadableexception\" data-linktype=\"relative-path\">FabricNotReadableException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"system.fabric.fabricnotreadableexception\" data-linktype=\"relative-path\">FabricNotReadableException</a></div>\r\n                  </div>\r\n                  <p>The replica is currently not readable.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"system.fabric.fabricobjectclosedexception\" data-linktype=\"relative-path\">FabricObjectClosedException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"system.fabric.fabricobjectclosedexception\" data-linktype=\"relative-path\">FabricObjectClosedException</a></div>\r\n                  </div>\r\n                  <p>The <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1\" data-linktype=\"relative-path\">IReliableConcurrentQueue&lt;T&gt;</a> was closed by the runtime.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.timeoutexception(v=vs.110).aspx\" data-linktype=\"external\">TimeoutException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.timeoutexception(v=vs.110).aspx\" data-linktype=\"external\">TimeoutException</a></div>\r\n                  </div>\r\n                  <p>The operation was unable to be completed within the given timeout.  The transaction should be aborted and\na new transaction should be created to retry.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.argumentnullexception(v=vs.110).aspx\" data-linktype=\"external\">ArgumentNullException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.argumentnullexception(v=vs.110).aspx\" data-linktype=\"external\">ArgumentNullException</a></div>\r\n                  </div>\r\n                  <p><em>tx</em> is null.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.operationcanceledexception(v=vs.110).aspx\" data-linktype=\"external\">OperationCanceledException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.operationcanceledexception(v=vs.110).aspx\" data-linktype=\"external\">OperationCanceledException</a></div>\r\n                  </div>\r\n                  <p>The operation was canceled via <em>cancellationToken</em>.</p>\n\r\n                </li>\r\n                <li>\r\n                  <div class=\"single\">                \r\n                      <div class=\"lang-csharp\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.invalidoperationexception(v=vs.110).aspx\" data-linktype=\"external\">InvalidOperationException</a></div>\r\n                      <div class=\"lang-vb\"><a class=\"xref\" href=\"https://msdn.microsoft.com/en-us/library/system.invalidoperationexception(v=vs.110).aspx\" data-linktype=\"external\">InvalidOperationException</a></div>\r\n                  </div>\r\n                  <p>Thrown when a method call is invalid for the object&#39;s current state.\nExample, transaction used is already terminated: committed or aborted.</p>\n\r\n                </li>\r\n              </ul>\r\n    \r\n          \r\n    \r\n            <h4>Remarks</h4>\r\n            <p>A <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_DequeueAsync_Microsoft_ServiceFabric_Data_ITransaction_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">DequeueAsync(ITransaction, CancellationToken, Nullable&lt;TimeSpan&gt;)</a> operation cannot return any value for which its <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_EnqueueAsync_Microsoft_ServiceFabric_Data_ITransaction__0_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">EnqueueAsync(ITransaction, T, CancellationToken, Nullable&lt;TimeSpan&gt;)</a> has not yet been committed.\nThis includes the transaction in which the value was enqueued; as a consequence, <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1\" data-linktype=\"relative-path\">IReliableConcurrentQueue&lt;T&gt;</a> does not support Read-Your-Writes.</p>\n\r\n    \r\n            <h4>Example</h4>\r\n            <p>This example shows how to use <a class=\"xref\" href=\"microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1#Microsoft_ServiceFabric_Data_Collections_Preview_IReliableConcurrentQueue_1_EnqueueAsync_Microsoft_ServiceFabric_Data_ITransaction__0_System_Threading_CancellationToken_System_Nullable_System_TimeSpan__\" data-linktype=\"relative-path\">EnqueueAsync(ITransaction, T, CancellationToken, Nullable&lt;TimeSpan&gt;)</a> to enqueue a value with retry.\n<pre><code>protected override async Task RunAsync(CancellationToken cancellationToken)\n{\n    var concurrentQueue = await this.StateManager.GetOrAddAsync&lt;IReliableConcurrentQueue&lt;long&gt;&gt;(new Uri(&quot;fabric:/concurrentQueue&quot;));<p>\n<pre><code>while (true)\n{\n    cancellationToken.ThrowIfCancellationRequested();\n\n    try\n    {\n        using (var tx = this.StateManager.CreateTransaction())\n        {\n            await concurrentQueue.EnqueueAsync(tx, 12L, cancellationToken);\n            await tx.CommitAsync();\n\n            return;\n        }\n    }\n    catch (FabricNotPrimaryException e)\n    {\n        // Gracefully exit RunAsync as the new primary should have RunAsync invoked on it and continue work.\n        // If instead enqueue was being executed as part of a client request, the client would be signaled to re-resolve.\n        Console.WriteLine(&quot;Replica is not primary, exiting RunAsync: &quot; + e);\n        return;\n    }\n    catch (FabricNotReadableException e)\n    {\n        // Retry until the queue is readable or a different exception is thrown.\n        Console.WriteLine(&quot;Queue is not readable, retrying the transaction: &quot; + e);\n    }\n    catch (FabricObjectClosedException e)\n    {\n        // Gracefully exit RunAsync as this is happening due to replica close.\n        // If instead enqueue was being executed as part of a client request, the client would be signaled to re-resolve.\n        Console.WriteLine(&quot;Replica is closing, exiting RunAsync: &quot; + e);\n        return;\n    }\n    catch (TimeoutException e)\n    {\n        Console.WriteLine(&quot;Encountered TimeoutException during EnqueueAsync, retrying the transaction: &quot; + e);\n    }\n\n    // Delay and retry.\n    await Task.Delay(TimeSpan.FromMilliseconds(100), cancellationToken);\n}\n</code></pre><p>}</code></pre></p>\n\r\n    \r\n    \r\n        </li>\r\n      </ul>\r\n    </section>\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n      <h2>Details</h2>\r\n        <div class=\"lang-csharp lang-vb enable-lang-filter detailTile\">\r\n          <h4>Namespace</h4>    \r\n          <div>Microsoft.ServiceFabric.Data.Collections.Preview</div>\r\n        </div>\r\n        <div class=\"lang-csharp lang-vb enable-lang-filter detailTile\">\r\n          <h4>Assembly</h4>    \r\n          <div>Microsoft.ServiceFabric.Data.Interfaces.dll</div>\r\n        </div>\r\n    \r\n    \r\n","outputRootRelativePath":"./","pageMetadata":"<meta name=\"ms.devlang\" content=\"csharp\">\r\n<meta name=\"author\" content=\"erickson-doug\">\r\n<meta name=\"ms.author\" content=\"douge\">\r\n<meta name=\"manager\" content=\"douge\">\r\n<meta name=\"breadcrumb_path\" content=\"breadcrumb/toc1.json\">\r\n<meta name=\"ms.topic\" content=\"reference\">\r\n<meta name=\"ms.service\" content=\"service-fabric\">\r\n<meta name=\"ms.date\" content=\"11/16/2016\">\r\n<meta name=\"search.ms_sitename\" content=\"Docs\">\r\n<meta name=\"search.ms_docsetname\" content=\"azuredotnet\">\r\n<meta name=\"version\" content=\"0\">\r\n<meta name=\"locale\" content=\"en-us\">\r\n<meta name=\"site_name\" content=\"Docs\">\r\n<meta name=\"search.ms_product\" content=\"Azure\">\r\n<meta name=\"depot_name\" content=\"Azure.azuredotnet\">\r\n<meta name=\"ref_skeleton_gitcommit\" content=\"https://github.com/Azure/azure-docs-sdk-dotnet/blob/8ece26063f2f27414f0bad873159ee6212f3448d/docs-ref-manual/Data/ServiceFabric/Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue-1.yml\">\r\n<meta name=\"original_ref_skeleton_git_url\" content=\"https://github.com/Azure/azure-docs-sdk-dotnet/blob/live/docs-ref-manual/Data/ServiceFabric/Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue-1.yml\">\r\n<meta name=\"APIName\" content=\"Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue&lt;T&gt;\">\r\n<meta name=\"APIName\" content=\"Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue&lt;T&gt;.EnqueueAsync\">\r\n<meta name=\"APIName\" content=\"Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue&lt;T&gt;.DequeueAsync\">\r\n<meta name=\"APIName\" content=\"Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue&lt;T&gt;.Count\">\r\n<meta name=\"APIName\" content=\"Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue&lt;T&gt;.get_Count\">\r\n<meta name=\"APILocation\" content=\"Microsoft.ServiceFabric.Data.Interfaces.dll\">\r\n<meta name=\"TopicType\" content=\"apiref\">\r\n<meta name=\"APIType\" content=\"Assembly\">\r\n<meta name=\"updated_at\" content=\"2016-12-26 05:25 AM\">\r\n<meta name=\"document_id\" content=\"95031da0-8aa2-30e6-a8a3-09d2d3ce1d64\">\r\n<meta name=\"pagetype\" content=\"Reference\">\r\n<meta name=\"description\" content=\"\nPreview feature. Not for production use. See the documentation for details.\n\n\nRepresents a reliable collection of persisted, replicated values with best-effort first-in first-out ordering.\n\n\">\r\n<meta name=\"toc_rel\" content=\"toc1.json\">\r\n<meta name=\"source_url\" content=\"https://msazure.visualstudio.com/DefaultCollection/One/_git/WindowsFabric?path=src/prod/src/managed/Microsoft.ServiceFabric.Data.Interfaces/Collections/Preview/IReliableConcurrentQueue.cs&amp;version=GBdevelop&amp;line=66\">\r\n<meta name=\"ms.assetid\" content=\"Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue`1\">\r\n","rawMetadata":{"ms.devlang":"csharp","author":"erickson-doug","ms.author":"douge","manager":"douge","breadcrumb_path":"breadcrumb/toc.json","_op_documentIdPathDepotMapping":{"./":{"folder_relative_path_in_docset":"api-index"},"breadcrumb/":{"folder_relative_path_in_docset":"breadcrumb"},"docs-ref-autogen/":{"folder_relative_path_in_docset":"docs-ref-autogen"},"docs-ref-manual/":{"folder_relative_path_in_docset":"docs-ref-manual"},"docs-ref-overwrite/":{"folder_relative_path_in_docset":"docs-ref-overwrite"},"scripts/":{"folder_relative_path_in_docset":"scripts"}},"ms.topic":"reference","ms.service":"service-fabric","ms.date":"11/16/2016","search.ms_sitename":"Docs","search.ms_docsetname":"azuredotnet","version":0,"_op_canonicalUrlPrefix":"https://docs.microsoft.com/en-us/dotnet/api/","locale":"en-us","site_name":"Docs","search.ms_product":"Azure","_op_openToPublicContributors":false,"depot_name":"Azure.azuredotnet","_op_gitRefSkeletonCommitHistory":[{"author_name":"Qinen Zhu","author_email":"qinzhu@microsoft.com","committer_name":"Qinen Zhu","comitter_email":"qinzhu@microsoft.com","message":"Rename folder name","commit_sha":"8ece26063f2f27414f0bad873159ee6212f3448d","commit_date":"2016-12-19 15:23:17 +0800"}],"ref_skeleton_gitcommit":"https://github.com/Azure/azure-docs-sdk-dotnet/blob/8ece26063f2f27414f0bad873159ee6212f3448d/docs-ref-manual/Data/ServiceFabric/Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue-1.yml","original_ref_skeleton_git_url":"https://github.com/Azure/azure-docs-sdk-dotnet/blob/live/docs-ref-manual/Data/ServiceFabric/Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue-1.yml","open_to_public_contributors":false,"api_name":["Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue<T>","Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue<T>.EnqueueAsync","Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue<T>.DequeueAsync","Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue<T>.Count","Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue<T>.get_Count"],"api_location":["Microsoft.ServiceFabric.Data.Interfaces.dll"],"topic_type":["apiref"],"api_type":["Assembly"],"f1_keywords":["Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue`1","Microsoft::ServiceFabric::Data::Collections::Preview::IReliableConcurrentQueue`1","Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue`1.EnqueueAsync","Microsoft::ServiceFabric::Data::Collections::Preview::IReliableConcurrentQueue`1::EnqueueAsync","Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue`1.DequeueAsync","Microsoft::ServiceFabric::Data::Collections::Preview::IReliableConcurrentQueue`1::DequeueAsync","Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue`1.Count","Microsoft::ServiceFabric::Data::Collections::Preview::IReliableConcurrentQueue`1::Count"],"dev_langs":["csharp","vb"],"updated_at":"2016-12-26 05:25 AM","document_id":"95031da0-8aa2-30e6-a8a3-09d2d3ce1d64","layout":"Reference","_op_layout":"Reference","pagetype":"Reference","title":"IReliableConcurrentQueue<T> interface | Microsoft Docs","_op_ogTitle":"IReliableConcurrentQueue<T> interface","description":"\nPreview feature. Not for production use. See the documentation for details.\n\n\nRepresents a reliable collection of persisted, replicated values with best-effort first-in first-out ordering.\n\n","toc_asset_id":"toc.json","toc_rel":"toc.json","content_git_url":"","source_url":"https://msazure.visualstudio.com/DefaultCollection/One/_git/WindowsFabric?path=src/prod/src/managed/Microsoft.ServiceFabric.Data.Interfaces/Collections/Preview/IReliableConcurrentQueue.cs&version=GBdevelop&line=66","ms.assetid":"Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue`1","canonical_url":"https://docs.microsoft.com/en-us/dotnet/microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1","_op_displayDate":"2016-11-16","_op_displayDate_source":"2016-11-16T00:00:00Z","_op_brand":"azure","_op_canonicalUrl":"https://docs.microsoft.com/en-us/dotnet/microsoft.servicefabric.data.collections.preview.ireliableconcurrentqueue-1","fileRelativePath":"Microsoft.ServiceFabric.Data.Collections.Preview.IReliableConcurrentQueue-1.html"},"themesRelativePathToOutputRoot":"_themes/"}